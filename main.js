var P6=(Z)=>{let $,J=new Set,X=(G,W)=>{let j=typeof G==="function"?G($):G;if(!Object.is(j,$)){let _=$;$=(W!=null?W:typeof j!=="object"||j===null)?j:Object.assign({},$,j),J.forEach((z)=>z($,_))}},Q=()=>$,U={setState:X,getState:Q,getInitialState:()=>q,subscribe:(G)=>{return J.add(G),()=>J.delete(G)}},q=$=Z(X,Q,U);return U},C6=(Z)=>Z?P6(Z):P6;function GY(Z,$){let J;try{J=Z()}catch(Q){return}return{getItem:(Q)=>{var Y;let K=(q)=>{if(q===null)return null;return JSON.parse(q,$==null?void 0:$.reviver)},U=(Y=J.getItem(Q))!=null?Y:null;if(U instanceof Promise)return U.then(K);return K(U)},setItem:(Q,Y)=>J.setItem(Q,JSON.stringify(Y,$==null?void 0:$.replacer)),removeItem:(Q)=>J.removeItem(Q)}}var g8=(Z)=>($)=>{try{let J=Z($);if(J instanceof Promise)return J;return{then(X){return g8(X)(J)},catch(X){return this}}}catch(J){return{then(X){return this},catch(X){return g8(X)(J)}}}},WY=(Z,$)=>(J,X,Q)=>{let Y={storage:GY(()=>localStorage),partialize:(O)=>O,version:0,merge:(O,H)=>({...H,...O}),...$},K=!1,U=new Set,q=new Set,G=Y.storage;if(!G)return Z((...O)=>{console.warn(`[zustand persist middleware] Unable to update item '${Y.name}', the given storage is currently unavailable.`),J(...O)},X,Q);let W=()=>{let O=Y.partialize({...X()});return G.setItem(Y.name,{state:O,version:Y.version})},j=Q.setState;Q.setState=(O,H)=>{return j(O,H),W()};let _=Z((...O)=>{return J(...O),W()},X,Q);Q.getInitialState=()=>_;let z,V=()=>{var O,H;if(!G)return;K=!1,U.forEach((D)=>{var M;return D((M=X())!=null?M:_)});let R=((H=Y.onRehydrateStorage)==null?void 0:H.call(Y,(O=X())!=null?O:_))||void 0;return g8(G.getItem.bind(G))(Y.name).then((D)=>{if(D)if(typeof D.version==="number"&&D.version!==Y.version){if(Y.migrate){let M=Y.migrate(D.state,D.version);if(M instanceof Promise)return M.then((L)=>[!0,L]);return[!0,M]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,D.state];return[!1,void 0]}).then((D)=>{var M;let[L,B]=D;if(z=Y.merge(B,(M=X())!=null?M:_),J(z,!0),L)return W()}).then(()=>{R==null||R(z,void 0),z=X(),K=!0,q.forEach((D)=>D(z))}).catch((D)=>{R==null||R(void 0,D)})};if(Q.persist={setOptions:(O)=>{if(Y={...Y,...O},O.storage)G=O.storage},clearStorage:()=>{G==null||G.removeItem(Y.name)},getOptions:()=>Y,rehydrate:()=>V(),hasHydrated:()=>K,onHydrate:(O)=>{return U.add(O),()=>{U.delete(O)}},onFinishHydration:(O)=>{return q.add(O),()=>{q.delete(O)}}},!Y.skipHydration)V();return z||_},T6=WY;var y6=`This series of exercises takes you through the basic syntax and concepts of OCaml. All exercies can be run right here in your browser.

We start with the basics and build up to the more advanced concepts. The objective is to write a (very simple) clone of FFTW in OCaml.

(Fun fact, while FFTW is a C library, the core \`genfft\` part is written in OCaml)

If you're coming from C-styled languages, the functional style might take some time to get used to. But no worries, we'll get there. For now, let's start with the classic "Hello World" program.

In OCaml, the \`print_endline\` function is used to print to the console. So, to print a message you would use something like:

\`\`\`ocaml
print_endline "some message";;
\`\`\`
Now, when writing code in an OCaml script, you generally use a single semicolon (;) to sequence commands or simply rely on the compiler's structure.

However, in the in-browser environment (like we're using here), you must use double semicolons (;;) to signal to the interpreter that you have finished your expression and want it evaluated.

For exerices here though, you can simply use a single semicolon and skip the double semicolons (since we add them before running the code automatically for you). This bit of information was just for you to keep in mind for later.

Now, check if the code in the exercise window looks alright and fix it if needed. Then, you can user the \`Run\` button to run the code.

# Problem Statement

Use \`print_endline\` to print out "Hello, world!"

`;var k6=`print_endline "some message";;
`;var S6=`(* no tests needed here *)
`;var OY={id:"1.1",title:"Hello World",description:y6,initialCode:k6,testCode:S6,validate:(Z,$)=>{let J=$.toLowerCase();if(J.includes("hello")&&J.includes("world"))return!0;return"Expected output to contain: hello and world"}},b6=OY;var x6="Like most (good) languages, OCaml is a statically typed language. This means the compiler checks for type errors before your code ever runs. But unlike C or Java, instead of manually declaring the type of each variable, in OCaml, you can let the compiler infer the type of the variable for you.\n\n## Ints vs. Floats\n\nOcaml does this by a smart use of operators. For example, if you were adding two integers, you would use the standard operator:\n\n```ocaml\n1 + 2;;\n```\nBut, if you were adding an two floating point numbers, you would use the floating point operator:\n\n```ocaml\n1. +. 2.;;\n```\nNotice the `.` after the `+` operator. It tells the compiler that the operation is a floating point operation. f you try to use + with floats, or +. with ints, the compiler will complain.\n\nNow, to assign the result of such operation to a variable, we would use the let keyword. For example:\n\n```ocaml\nlet x = 1 + 2;;\n```\nSo think of the right hand side to be be an expression or a function that is evalauted and the result is then assigned to the variable on the left hand side (x in this case).\n\n## Functions\n\nThe `let` keyword can also be used to define functions. Typically in C-style languages you would define a function like this:\n\n```c\nfloat sum(float a, float b) {\n    return a + b;\n}\n```\nBut in OCaml, you could define a function like this:\n\n```ocaml\nlet sum a b = a +. b;;\n```\nHere `let` is the keyword that defines a function. Then, `sum` is the name of the function. Right after that, we have the arguments of the function i.e. `a` and `b` here.\n\nSo one way to read the function would be, the function `sum` takes two arguments `a` and `b` and the expression used to calculate the result is the one to the right of the `=` sign.\n\nOnce we define the function, we can use it like this:\n\n```ocaml\nlet x = sum 1. 2.;;\n```\nSo here, what we're doing is evaluate the function sum, which takes two arguments `1.` and `2.` and assigns the result to the variable `x`.\n\n# Problem Statement\n\nImplement a function average that takes two floating-point numbers and returns their average as a float.\n";var w6=`(* use the same function name and signature but fix the implementation *)

let average a b = (a + b);

(* do not edit below this line *)

let x = average 1. 2.;;`;var h6=`let () =
  let result = average 2. 5. in
  if result <> 3.5 then begin
    print_endline ("Test failed: average 2. 5. returned " ^ (string_of_float result) ^ " but expected 3.5");
    failwith "Test failed"
  end else
    print_endline "Test passed: average 2. 5. = 3.5";;`;var IY={id:"1.2",title:"Int, Float and Functions",description:x6,initialCode:w6,testCode:h6,validate:()=>{return!0}},v6=IY;var u6=`We looked at the \`let\` keyword earlier. But there's something fundamentally different about how OCaml treats functions compared to C-style languages.

Say you want to process a list of numbers - add 5 to some, multiply by 2 for others. In C with function pointers, you might write something like:

\`\`\`c
int add_five(int x) { return x + 5; }
int add_ten(int x) { return x + 10; }

void process(int* arr, int len, int (*fn)(int)) {
    for(int i = 0; i < len; i++) {
        arr[i] = fn(arr[i]);
    }
}

process(arr, len, add_five);
\`\`\`
But now, say you wanted to process the list with additional similar functions (likesay \`add_ten\`). For this, you'd have to write a new function that does this and then call it with \`process\` like this:

\`\`\`c
...
process(arr, len, add_five);

//now add ten
process(arr, len, add_ten);
\`\`\`

So what if you could build up  \`add_ten\` and \`add_five\` from a general \`add\` function?

## Currying

In OCaml, when you write something like:

\`\`\`ocaml
let sum x y = x + y;;
\`\`\`
Here, technically, \`sum\` is not a function that takes two arguments. It builds up like this: When you call \`sum 1 2\`, what actually happens is, \`sum 1\` returns a new function that adds 1 to its argument.

Now, that new function is immediately called with \`2\` as its argument which gives the result \`3\`.

This is called currying (names after Haskell Curry) and what this means is technically, every function in Ocaml takes exactly one argument. So multi-argument functions are essentially just syntactic sugar.

But why do this? What benefits does this give us?

## Partial Application

Since multi-argument functions are built up via currying, if we provide fewer argumnets than a function expects, we get a perfectly usable function back.

Again, we can compare this with C-styled languages. If we had a multi-argument function, we would need all argumnets to call it.

Well, this idea, called partial application can be useful in creating specialised functions without wrappers as we saw earlier.

If we already had \`add\` and \`multiply\` functions, we could we could create specialised functions by partail application like this:

\`\`\`ocaml
let add x y = x + y;;
let multiply x y = x * y;;

(* now we can create specialized functions *)
let add_five = add 5;;
let multiply_by_two = multiply 2;;
\`\`\`
Notice how although \`add\` requires two arguments, we can define \`add_five\` as a derived function of add but it just adds 5 to its input.

While this example is a bit silly, the point was to intoduce the way in which currying and partial application work.

# Problem Statement

Given two functions, \`add\` and \`multiply\`, create a function \`add_thirteen\` and a function \`multiply_by_17\`
`;var m6=`let add x y = x + y;;
let multiply x y = x * y;;

(* do not edit above *)


(* ?? your code goes in here *)


(* do not edit below *)

let num1 = add_thirteen 13;;
let num2 =  multiply_by_17 17;;
`;var f6=`(* This code is silently appended to the user's code *)
let () =
  let result1 = add_thirteen 7 in
  if result1 <> 20 then begin
    print_endline ("Test failed: add_thirteen 7 returned " ^ (string_of_int result1) ^ " but expected 20");
    failwith "Test failed"
  end else
    print_endline "✓ Test passed: add_thirteen 7 = 20";;

let () =
  let result2 = multiply_by_17 2 in
  if result2 <> 34 then begin
    print_endline ("Test failed: multiply_by_17 2 returned " ^ (string_of_int result2) ^ " but expected 34");
    failwith "Test failed"
  end else
    print_endline "✓ Test passed: multiply_by_17 2 = 34";;
`;var AY={id:"1.3",title:"Currying",description:u6,initialCode:m6,testCode:f6,validate:()=>!0},g6=AY;var f1=[b6,v6,g6];var X7=C6()(T6((Z,$)=>({currentExerciseId:f1[0]?.id||"1.1",completedIds:[],markComplete:(J)=>{let{completedIds:X}=$();if(!X.includes(J))Z({completedIds:[...X,J]})},setCurrent:(J)=>Z({currentExerciseId:J})}),{name:"sowar-storage"}));var l8=[],c6=[];(()=>{let Z="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(($)=>$?parseInt($,36):1);for(let $=0,J=0;$<Z.length;$++)($%2?c6:l8).push(J=J+Z[$])})();function MY(Z){if(Z<768)return!1;for(let $=0,J=l8.length;;){let X=$+J>>1;if(Z<l8[X])J=X;else if(Z>=c6[X])$=X+1;else return!0;if($==J)return!1}}function p6(Z){return Z>=127462&&Z<=127487}var l6=8205;function s6(Z,$,J=!0,X=!0){return(J?n6:LY)(Z,$,X)}function n6(Z,$,J){if($==Z.length)return $;if($&&i6(Z.charCodeAt($))&&a6(Z.charCodeAt($-1)))$--;let X=p8(Z,$);$+=d6(X);while($<Z.length){let Q=p8(Z,$);if(X==l6||Q==l6||J&&MY(Q))$+=d6(Q),X=Q;else if(p6(Q)){let Y=0,K=$-2;while(K>=0&&p6(p8(Z,K)))Y++,K-=2;if(Y%2==0)break;else $+=2}else break}return $}function LY(Z,$,J){while($>0){let X=n6(Z,$-2,J);if(X<$)return X;$--}return 0}function p8(Z,$){let J=Z.charCodeAt($);if(!a6(J)||$+1==Z.length)return J;let X=Z.charCodeAt($+1);if(!i6(X))return J;return(J-55296<<10)+(X-56320)+65536}function i6(Z){return Z>=56320&&Z<57344}function a6(Z){return Z>=55296&&Z<56320}function d6(Z){return Z<65536?1:2}class e{lineAt(Z){if(Z<0||Z>this.length)throw RangeError(`Invalid position ${Z} in document of length ${this.length}`);return this.lineInner(Z,!1,1,0)}line(Z){if(Z<1||Z>this.lines)throw RangeError(`Invalid line number ${Z} in ${this.lines}-line document`);return this.lineInner(Z,!0,1,0)}replace(Z,$,J){[Z,$]=B7(this,Z,$);let X=[];if(this.decompose(0,Z,X,2),J.length)J.decompose(0,J.length,X,3);return this.decompose($,this.length,X,1),E1.from(X,this.length-($-Z)+J.length)}append(Z){return this.replace(this.length,this.length,Z)}slice(Z,$=this.length){[Z,$]=B7(this,Z,$);let J=[];return this.decompose(Z,$,J,0),E1.from(J,$-Z)}eq(Z){if(Z==this)return!0;if(Z.length!=this.length||Z.lines!=this.lines)return!1;let $=this.scanIdentical(Z,1),J=this.length-this.scanIdentical(Z,-1),X=new M7(this),Q=new M7(Z);for(let Y=$,K=$;;){if(X.next(Y),Q.next(Y),Y=0,X.lineBreak!=Q.lineBreak||X.done!=Q.done||X.value!=Q.value)return!1;if(K+=X.value.length,X.done||K>=J)return!0}}iter(Z=1){return new M7(this,Z)}iterRange(Z,$=this.length){return new ZZ(this,Z,$)}iterLines(Z,$){let J;if(Z==null)J=this.iter();else{if($==null)$=this.lines+1;let X=this.line(Z).from;J=this.iterRange(X,Math.max(X,$==this.lines+1?this.length:$<=1?0:this.line($-1).to))}return new $Z(J)}toString(){return this.sliceString(0)}toJSON(){let Z=[];return this.flatten(Z),Z}constructor(){}static of(Z){if(Z.length==0)throw RangeError("A document must have at least one line");if(Z.length==1&&!Z[0])return e.empty;return Z.length<=32?new F0(Z):E1.from(F0.split(Z,[]))}}class F0 extends e{constructor(Z,$=BY(Z)){super();this.text=Z,this.length=$}get lines(){return this.text.length}get children(){return null}lineInner(Z,$,J,X){for(let Q=0;;Q++){let Y=this.text[Q],K=X+Y.length;if(($?J:K)>=Z)return new $$(X,K,J,Y);X=K+1,J++}}decompose(Z,$,J,X){let Q=Z<=0&&$>=this.length?this:new F0(r6(this.text,Z,$),Math.min($,this.length)-Math.max(0,Z));if(X&1){let Y=J.pop(),K=U9(Q.text,Y.text.slice(),0,Q.length);if(K.length<=32)J.push(new F0(K,Y.length+Q.length));else{let U=K.length>>1;J.push(new F0(K.slice(0,U)),new F0(K.slice(U)))}}else J.push(Q)}replace(Z,$,J){if(!(J instanceof F0))return super.replace(Z,$,J);[Z,$]=B7(this,Z,$);let X=U9(this.text,U9(J.text,r6(this.text,0,Z)),$),Q=this.length+J.length-($-Z);if(X.length<=32)return new F0(X,Q);return E1.from(F0.split(X,[]),Q)}sliceString(Z,$=this.length,J=`
`){[Z,$]=B7(this,Z,$);let X="";for(let Q=0,Y=0;Q<=$&&Y<this.text.length;Y++){let K=this.text[Y],U=Q+K.length;if(Q>Z&&Y)X+=J;if(Z<U&&$>Q)X+=K.slice(Math.max(0,Z-Q),$-Q);Q=U+1}return X}flatten(Z){for(let $ of this.text)Z.push($)}scanIdentical(){return 0}static split(Z,$){let J=[],X=-1;for(let Q of Z)if(J.push(Q),X+=Q.length+1,J.length==32)$.push(new F0(J,X)),J=[],X=-1;if(X>-1)$.push(new F0(J,X));return $}}class E1 extends e{constructor(Z,$){super();this.children=Z,this.length=$,this.lines=0;for(let J of Z)this.lines+=J.lines}lineInner(Z,$,J,X){for(let Q=0;;Q++){let Y=this.children[Q],K=X+Y.length,U=J+Y.lines-1;if(($?U:K)>=Z)return Y.lineInner(Z,$,J,X);X=K+1,J=U+1}}decompose(Z,$,J,X){for(let Q=0,Y=0;Y<=$&&Q<this.children.length;Q++){let K=this.children[Q],U=Y+K.length;if(Z<=U&&$>=Y){let q=X&((Y<=Z?1:0)|(U>=$?2:0));if(Y>=Z&&U<=$&&!q)J.push(K);else K.decompose(Z-Y,$-Y,J,q)}Y=U+1}}replace(Z,$,J){if([Z,$]=B7(this,Z,$),J.lines<this.lines)for(let X=0,Q=0;X<this.children.length;X++){let Y=this.children[X],K=Q+Y.length;if(Z>=Q&&$<=K){let U=Y.replace(Z-Q,$-Q,J),q=this.lines-Y.lines+U.lines;if(U.lines<q>>4&&U.lines>q>>6){let G=this.children.slice();return G[X]=U,new E1(G,this.length-($-Z)+J.length)}return super.replace(Q,K,U)}Q=K+1}return super.replace(Z,$,J)}sliceString(Z,$=this.length,J=`
`){[Z,$]=B7(this,Z,$);let X="";for(let Q=0,Y=0;Q<this.children.length&&Y<=$;Q++){let K=this.children[Q],U=Y+K.length;if(Y>Z&&Q)X+=J;if(Z<U&&$>Y)X+=K.sliceString(Z-Y,$-Y,J);Y=U+1}return X}flatten(Z){for(let $ of this.children)$.flatten(Z)}scanIdentical(Z,$){if(!(Z instanceof E1))return 0;let J=0,[X,Q,Y,K]=$>0?[0,0,this.children.length,Z.children.length]:[this.children.length-1,Z.children.length-1,-1,-1];for(;;X+=$,Q+=$){if(X==Y||Q==K)return J;let U=this.children[X],q=Z.children[Q];if(U!=q)return J+U.scanIdentical(q,$);J+=U.length+1}}static from(Z,$=Z.reduce((J,X)=>J+X.length+1,-1)){let J=0;for(let _ of Z)J+=_.lines;if(J<32){let _=[];for(let z of Z)z.flatten(_);return new F0(_,$)}let X=Math.max(32,J>>5),Q=X<<1,Y=X>>1,K=[],U=0,q=-1,G=[];function W(_){let z;if(_.lines>Q&&_ instanceof E1)for(let V of _.children)W(V);else if(_.lines>Y&&(U>Y||!U))j(),K.push(_);else if(_ instanceof F0&&U&&(z=G[G.length-1])instanceof F0&&_.lines+z.lines<=32)U+=_.lines,q+=_.length+1,G[G.length-1]=new F0(z.text.concat(_.text),z.length+1+_.length);else{if(U+_.lines>X)j();U+=_.lines,q+=_.length+1,G.push(_)}}function j(){if(U==0)return;K.push(G.length==1?G[0]:E1.from(G,q)),q=-1,U=G.length=0}for(let _ of Z)W(_);return j(),K.length==1?K[0]:new E1(K,$)}}e.empty=new F0([""],0);function BY(Z){let $=-1;for(let J of Z)$+=J.length+1;return $}function U9(Z,$,J=0,X=1e9){for(let Q=0,Y=0,K=!0;Y<Z.length&&Q<=X;Y++){let U=Z[Y],q=Q+U.length;if(q>=J){if(q>X)U=U.slice(0,X-Q);if(Q<J)U=U.slice(J-Q);if(K)$[$.length-1]+=U,K=!1;else $.push(U)}Q=q+1}return $}function r6(Z,$,J){return U9(Z,[""],$,J)}class M7{constructor(Z,$=1){this.dir=$,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[Z],this.offsets=[$>0?1:(Z instanceof F0?Z.text.length:Z.children.length)<<1]}nextInner(Z,$){this.done=this.lineBreak=!1;for(;;){let J=this.nodes.length-1,X=this.nodes[J],Q=this.offsets[J],Y=Q>>1,K=X instanceof F0?X.text.length:X.children.length;if(Y==($>0?K:0)){if(J==0)return this.done=!0,this.value="",this;if($>0)this.offsets[J-1]++;this.nodes.pop(),this.offsets.pop()}else if((Q&1)==($>0?0:1)){if(this.offsets[J]+=$,Z==0)return this.lineBreak=!0,this.value=`
`,this;Z--}else if(X instanceof F0){let U=X.text[Y+($<0?-1:0)];if(this.offsets[J]+=$,U.length>Math.max(0,Z))return this.value=Z==0?U:$>0?U.slice(Z):U.slice(0,U.length-Z),this;Z-=U.length}else{let U=X.children[Y+($<0?-1:0)];if(Z>U.length)Z-=U.length,this.offsets[J]+=$;else{if($<0)this.offsets[J]--;this.nodes.push(U),this.offsets.push($>0?1:(U instanceof F0?U.text.length:U.children.length)<<1)}}}}next(Z=0){if(Z<0)this.nextInner(-Z,-this.dir),Z=this.value.length;return this.nextInner(Z,this.dir)}}class ZZ{constructor(Z,$,J){this.value="",this.done=!1,this.cursor=new M7(Z,$>J?-1:1),this.pos=$>J?Z.length:0,this.from=Math.min($,J),this.to=Math.max($,J)}nextInner(Z,$){if($<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;Z+=Math.max(0,$<0?this.pos-this.to:this.from-this.pos);let J=$<0?this.pos-this.from:this.to-this.pos;if(Z>J)Z=J;J-=Z;let{value:X}=this.cursor.next(Z);return this.pos+=(X.length+Z)*$,this.value=X.length<=J?X:$<0?X.slice(X.length-J):X.slice(0,J),this.done=!this.value,this}next(Z=0){if(Z<0)Z=Math.max(Z,this.from-this.pos);else if(Z>0)Z=Math.min(Z,this.to-this.pos);return this.nextInner(Z,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class $Z{constructor(Z){this.inner=Z,this.afterBreak=!0,this.value="",this.done=!1}next(Z=0){let{done:$,lineBreak:J,value:X}=this.inner.next(Z);if($&&this.afterBreak)this.value="",this.afterBreak=!1;else if($)this.done=!0,this.value="";else if(J)if(this.afterBreak)this.value="";else this.afterBreak=!0,this.next();else this.value=X,this.afterBreak=!1;return this}get lineBreak(){return!1}}if(typeof Symbol<"u")e.prototype[Symbol.iterator]=function(){return this.iter()},M7.prototype[Symbol.iterator]=ZZ.prototype[Symbol.iterator]=$Z.prototype[Symbol.iterator]=function(){return this};class $${constructor(Z,$,J,X){this.from=Z,this.to=$,this.number=J,this.text=X}get length(){return this.to-this.from}}function B7(Z,$,J){return $=Math.max(0,Math.min(Z.length,$)),[$,Math.max($,Math.min(Z.length,J))]}function H0(Z,$,J=!0,X=!0){return s6(Z,$,J,X)}function EY(Z){return Z>=56320&&Z<57344}function PY(Z){return Z>=55296&&Z<56320}function y0(Z,$){let J=Z.charCodeAt($);if(!PY(J)||$+1==Z.length)return J;let X=Z.charCodeAt($+1);if(!EY(X))return J;return(J-55296<<10)+(X-56320)+65536}function U4(Z){if(Z<=65535)return String.fromCharCode(Z);return Z-=65536,String.fromCharCode((Z>>10)+55296,(Z&1023)+56320)}function n0(Z){return Z<65536?1:2}var c8=/\r\n?|\n/,T0=function(Z){return Z[Z.Simple=0]="Simple",Z[Z.TrackDel=1]="TrackDel",Z[Z.TrackBefore=2]="TrackBefore",Z[Z.TrackAfter=3]="TrackAfter",Z}(T0||(T0={}));class _1{constructor(Z){this.sections=Z}get length(){let Z=0;for(let $=0;$<this.sections.length;$+=2)Z+=this.sections[$];return Z}get newLength(){let Z=0;for(let $=0;$<this.sections.length;$+=2){let J=this.sections[$+1];Z+=J<0?this.sections[$]:J}return Z}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(Z){for(let $=0,J=0,X=0;$<this.sections.length;){let Q=this.sections[$++],Y=this.sections[$++];if(Y<0)Z(J,X,Q),X+=Q;else X+=Y;J+=Q}}iterChangedRanges(Z,$=!1){s8(this,Z,$)}get invertedDesc(){let Z=[];for(let $=0;$<this.sections.length;){let J=this.sections[$++],X=this.sections[$++];if(X<0)Z.push(J,X);else Z.push(X,J)}return new _1(Z)}composeDesc(Z){return this.empty?Z:Z.empty?this:J$(this,Z)}mapDesc(Z,$=!1){return Z.empty?this:n8(this,Z,$)}mapPos(Z,$=-1,J=T0.Simple){let X=0,Q=0;for(let Y=0;Y<this.sections.length;){let K=this.sections[Y++],U=this.sections[Y++],q=X+K;if(U<0){if(q>Z)return Q+(Z-X);Q+=K}else{if(J!=T0.Simple&&q>=Z&&(J==T0.TrackDel&&X<Z&&q>Z||J==T0.TrackBefore&&X<Z||J==T0.TrackAfter&&q>Z))return null;if(q>Z||q==Z&&$<0&&!K)return Z==X||$<0?Q:Q+U;Q+=U}X=q}if(Z>X)throw RangeError(`Position ${Z} is out of range for changeset of length ${X}`);return Q}touchesRange(Z,$=Z){for(let J=0,X=0;J<this.sections.length&&X<=$;){let Q=this.sections[J++],Y=this.sections[J++],K=X+Q;if(Y>=0&&X<=$&&K>=Z)return X<Z&&K>$?"cover":!0;X=K}return!1}toString(){let Z="";for(let $=0;$<this.sections.length;){let J=this.sections[$++],X=this.sections[$++];Z+=(Z?" ":"")+J+(X>=0?":"+X:"")}return Z}toJSON(){return this.sections}static fromJSON(Z){if(!Array.isArray(Z)||Z.length%2||Z.some(($)=>typeof $!="number"))throw RangeError("Invalid JSON representation of ChangeDesc");return new _1(Z)}static create(Z){return new _1(Z)}}class D0 extends _1{constructor(Z,$){super(Z);this.inserted=$}apply(Z){if(this.length!=Z.length)throw RangeError("Applying change set to a document with the wrong length");return s8(this,($,J,X,Q,Y)=>Z=Z.replace(X,X+(J-$),Y),!1),Z}mapDesc(Z,$=!1){return n8(this,Z,$,!0)}invert(Z){let $=this.sections.slice(),J=[];for(let X=0,Q=0;X<$.length;X+=2){let Y=$[X],K=$[X+1];if(K>=0){$[X]=K,$[X+1]=Y;let U=X>>1;while(J.length<U)J.push(e.empty);J.push(Y?Z.slice(Q,Q+Y):e.empty)}Q+=Y}return new D0($,J)}compose(Z){return this.empty?Z:Z.empty?this:J$(this,Z,!0)}map(Z,$=!1){return Z.empty?this:n8(this,Z,$,!0)}iterChanges(Z,$=!1){s8(this,Z,$)}get desc(){return _1.create(this.sections)}filter(Z){let $=[],J=[],X=[],Q=new E7(this);Z:for(let Y=0,K=0;;){let U=Y==Z.length?1e9:Z[Y++];while(K<U||K==U&&Q.len==0){if(Q.done)break Z;let G=Math.min(Q.len,U-K);x0(X,G,-1);let W=Q.ins==-1?-1:Q.off==0?Q.ins:0;if(x0($,G,W),W>0)g1(J,$,Q.text);Q.forward(G),K+=G}let q=Z[Y++];while(K<q){if(Q.done)break Z;let G=Math.min(Q.len,q-K);x0($,G,-1),x0(X,G,Q.ins==-1?-1:Q.off==0?Q.ins:0),Q.forward(G),K+=G}}return{changes:new D0($,J),filtered:_1.create(X)}}toJSON(){let Z=[];for(let $=0;$<this.sections.length;$+=2){let J=this.sections[$],X=this.sections[$+1];if(X<0)Z.push(J);else if(X==0)Z.push([J]);else Z.push([J].concat(this.inserted[$>>1].toJSON()))}return Z}static of(Z,$,J){let X=[],Q=[],Y=0,K=null;function U(G=!1){if(!G&&!X.length)return;if(Y<$)x0(X,$-Y,-1);let W=new D0(X,Q);K=K?K.compose(W.map(K)):W,X=[],Q=[],Y=0}function q(G){if(Array.isArray(G))for(let W of G)q(W);else if(G instanceof D0){if(G.length!=$)throw RangeError(`Mismatched change set length (got ${G.length}, expected ${$})`);U(),K=K?K.compose(G.map(K)):G}else{let{from:W,to:j=W,insert:_}=G;if(W>j||W<0||j>$)throw RangeError(`Invalid change range ${W} to ${j} (in doc of length ${$})`);let z=!_?e.empty:typeof _=="string"?e.of(_.split(J||c8)):_,V=z.length;if(W==j&&V==0)return;if(W<Y)U();if(W>Y)x0(X,W-Y,-1);x0(X,j-W,V),g1(Q,X,z),Y=j}}return q(Z),U(!K),K}static empty(Z){return new D0(Z?[Z,-1]:[],[])}static fromJSON(Z){if(!Array.isArray(Z))throw RangeError("Invalid JSON representation of ChangeSet");let $=[],J=[];for(let X=0;X<Z.length;X++){let Q=Z[X];if(typeof Q=="number")$.push(Q,-1);else if(!Array.isArray(Q)||typeof Q[0]!="number"||Q.some((Y,K)=>K&&typeof Y!="string"))throw RangeError("Invalid JSON representation of ChangeSet");else if(Q.length==1)$.push(Q[0],0);else{while(J.length<X)J.push(e.empty);J[X]=e.of(Q.slice(1)),$.push(Q[0],J[X].length)}}return new D0($,J)}static createSet(Z,$){return new D0(Z,$)}}function x0(Z,$,J,X=!1){if($==0&&J<=0)return;let Q=Z.length-2;if(Q>=0&&J<=0&&J==Z[Q+1])Z[Q]+=$;else if(Q>=0&&$==0&&Z[Q]==0)Z[Q+1]+=J;else if(X)Z[Q]+=$,Z[Q+1]+=J;else Z.push($,J)}function g1(Z,$,J){if(J.length==0)return;let X=$.length-2>>1;if(X<Z.length)Z[Z.length-1]=Z[Z.length-1].append(J);else{while(Z.length<X)Z.push(e.empty);Z.push(J)}}function s8(Z,$,J){let X=Z.inserted;for(let Q=0,Y=0,K=0;K<Z.sections.length;){let U=Z.sections[K++],q=Z.sections[K++];if(q<0)Q+=U,Y+=U;else{let G=Q,W=Y,j=e.empty;for(;;){if(G+=U,W+=q,q&&X)j=j.append(X[K-2>>1]);if(J||K==Z.sections.length||Z.sections[K+1]<0)break;U=Z.sections[K++],q=Z.sections[K++]}$(Q,G,Y,W,j),Q=G,Y=W}}}function n8(Z,$,J,X=!1){let Q=[],Y=X?[]:null,K=new E7(Z),U=new E7($);for(let q=-1;;)if(K.done&&U.len||U.done&&K.len)throw Error("Mismatched change set lengths");else if(K.ins==-1&&U.ins==-1){let G=Math.min(K.len,U.len);x0(Q,G,-1),K.forward(G),U.forward(G)}else if(U.ins>=0&&(K.ins<0||q==K.i||K.off==0&&(U.len<K.len||U.len==K.len&&!J))){let G=U.len;x0(Q,U.ins,-1);while(G){let W=Math.min(K.len,G);if(K.ins>=0&&q<K.i&&K.len<=W){if(x0(Q,0,K.ins),Y)g1(Y,Q,K.text);q=K.i}K.forward(W),G-=W}U.next()}else if(K.ins>=0){let G=0,W=K.len;while(W)if(U.ins==-1){let j=Math.min(W,U.len);G+=j,W-=j,U.forward(j)}else if(U.ins==0&&U.len<W)W-=U.len,U.next();else break;if(x0(Q,G,q<K.i?K.ins:0),Y&&q<K.i)g1(Y,Q,K.text);q=K.i,K.forward(K.len-W)}else if(K.done&&U.done)return Y?D0.createSet(Q,Y):_1.create(Q);else throw Error("Mismatched change set lengths")}function J$(Z,$,J=!1){let X=[],Q=J?[]:null,Y=new E7(Z),K=new E7($);for(let U=!1;;)if(Y.done&&K.done)return Q?D0.createSet(X,Q):_1.create(X);else if(Y.ins==0)x0(X,Y.len,0,U),Y.next();else if(K.len==0&&!K.done){if(x0(X,0,K.ins,U),Q)g1(Q,X,K.text);K.next()}else if(Y.done||K.done)throw Error("Mismatched change set lengths");else{let q=Math.min(Y.len2,K.len),G=X.length;if(Y.ins==-1){let W=K.ins==-1?-1:K.off?0:K.ins;if(x0(X,q,W,U),Q&&W)g1(Q,X,K.text)}else if(K.ins==-1){if(x0(X,Y.off?0:Y.len,q,U),Q)g1(Q,X,Y.textBit(q))}else if(x0(X,Y.off?0:Y.len,K.off?0:K.ins,U),Q&&!K.off)g1(Q,X,K.text);U=(Y.ins>q||K.ins>=0&&K.len>q)&&(U||X.length>G),Y.forward2(q),K.forward(q)}}class E7{constructor(Z){this.set=Z,this.i=0,this.next()}next(){let{sections:Z}=this.set;if(this.i<Z.length)this.len=Z[this.i++],this.ins=Z[this.i++];else this.len=0,this.ins=-2;this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:Z}=this.set,$=this.i-2>>1;return $>=Z.length?e.empty:Z[$]}textBit(Z){let{inserted:$}=this.set,J=this.i-2>>1;return J>=$.length&&!Z?e.empty:$[J].slice(this.off,Z==null?void 0:this.off+Z)}forward(Z){if(Z==this.len)this.next();else this.len-=Z,this.off+=Z}forward2(Z){if(this.ins==-1)this.forward(Z);else if(Z==this.ins)this.next();else this.ins-=Z,this.off+=Z}}class Y7{constructor(Z,$,J){this.from=Z,this.to=$,this.flags=J}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let Z=this.flags&7;return Z==7?null:Z}get goalColumn(){let Z=this.flags>>6;return Z==16777215?void 0:Z}map(Z,$=-1){let J,X;if(this.empty)J=X=Z.mapPos(this.from,$);else J=Z.mapPos(this.from,1),X=Z.mapPos(this.to,-1);return J==this.from&&X==this.to?this:new Y7(J,X,this.flags)}extend(Z,$=Z){if(Z<=this.anchor&&$>=this.anchor)return A.range(Z,$);let J=Math.abs(Z-this.anchor)>Math.abs($-this.anchor)?Z:$;return A.range(this.anchor,J)}eq(Z,$=!1){return this.anchor==Z.anchor&&this.head==Z.head&&this.goalColumn==Z.goalColumn&&(!$||!this.empty||this.assoc==Z.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(Z){if(!Z||typeof Z.anchor!="number"||typeof Z.head!="number")throw RangeError("Invalid JSON representation for SelectionRange");return A.range(Z.anchor,Z.head)}static create(Z,$,J){return new Y7(Z,$,J)}}class A{constructor(Z,$){this.ranges=Z,this.mainIndex=$}map(Z,$=-1){if(Z.empty)return this;return A.create(this.ranges.map((J)=>J.map(Z,$)),this.mainIndex)}eq(Z,$=!1){if(this.ranges.length!=Z.ranges.length||this.mainIndex!=Z.mainIndex)return!1;for(let J=0;J<this.ranges.length;J++)if(!this.ranges[J].eq(Z.ranges[J],$))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new A([this.main],0)}addRange(Z,$=!0){return A.create([Z].concat(this.ranges),$?0:this.mainIndex+1)}replaceRange(Z,$=this.mainIndex){let J=this.ranges.slice();return J[$]=Z,A.create(J,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((Z)=>Z.toJSON()),main:this.mainIndex}}static fromJSON(Z){if(!Z||!Array.isArray(Z.ranges)||typeof Z.main!="number"||Z.main>=Z.ranges.length)throw RangeError("Invalid JSON representation for EditorSelection");return new A(Z.ranges.map(($)=>Y7.fromJSON($)),Z.main)}static single(Z,$=Z){return new A([A.range(Z,$)],0)}static create(Z,$=0){if(Z.length==0)throw RangeError("A selection needs at least one range");for(let J=0,X=0;X<Z.length;X++){let Q=Z[X];if(Q.empty?Q.from<=J:Q.from<J)return A.normalized(Z.slice(),$);J=Q.to}return new A(Z,$)}static cursor(Z,$=0,J,X){return Y7.create(Z,Z,($==0?0:$<0?8:16)|(J==null?7:Math.min(6,J))|(X!==null&&X!==void 0?X:16777215)<<6)}static range(Z,$,J,X){let Q=(J!==null&&J!==void 0?J:16777215)<<6|(X==null?7:Math.min(6,X));return $<Z?Y7.create($,Z,48|Q):Y7.create(Z,$,($>Z?8:0)|Q)}static normalized(Z,$=0){let J=Z[$];Z.sort((X,Q)=>X.from-Q.from),$=Z.indexOf(J);for(let X=1;X<Z.length;X++){let Q=Z[X],Y=Z[X-1];if(Q.empty?Q.from<=Y.to:Q.from<Y.to){let K=Y.from,U=Math.max(Q.to,Y.to);if(X<=$)$--;Z.splice(--X,2,Q.anchor>Q.head?A.range(U,K):A.range(K,U))}}return new A(Z,$)}}function X$(Z,$){for(let J of Z.ranges)if(J.to>$)throw RangeError("Selection points outside of document")}var JZ=0;class S{constructor(Z,$,J,X,Q){this.combine=Z,this.compareInput=$,this.compare=J,this.isStatic=X,this.id=JZ++,this.default=Z([]),this.extensions=typeof Q=="function"?Q(this):Q}get reader(){return this}static define(Z={}){return new S(Z.combine||(($)=>$),Z.compareInput||(($,J)=>$===J),Z.compare||(!Z.combine?XZ:($,J)=>$===J),!!Z.static,Z.enables)}of(Z){return new X4([],this,0,Z)}compute(Z,$){if(this.isStatic)throw Error("Can't compute a static facet");return new X4(Z,this,1,$)}computeN(Z,$){if(this.isStatic)throw Error("Can't compute a static facet");return new X4(Z,this,2,$)}from(Z,$){if(!$)$=(J)=>J;return this.compute([Z],(J)=>$(J.field(Z)))}}function XZ(Z,$){return Z==$||Z.length==$.length&&Z.every((J,X)=>J===$[X])}class X4{constructor(Z,$,J,X){this.dependencies=Z,this.facet=$,this.type=J,this.value=X,this.id=JZ++}dynamicSlot(Z){var $;let J=this.value,X=this.facet.compareInput,Q=this.id,Y=Z[Q]>>1,K=this.type==2,U=!1,q=!1,G=[];for(let W of this.dependencies)if(W=="doc")U=!0;else if(W=="selection")q=!0;else if(((($=Z[W.id])!==null&&$!==void 0?$:1)&1)==0)G.push(Z[W.id]);return{create(W){return W.values[Y]=J(W),1},update(W,j){if(U&&j.docChanged||q&&(j.docChanged||j.selection)||i8(W,G)){let _=J(W);if(K?!o6(_,W.values[Y],X):!X(_,W.values[Y]))return W.values[Y]=_,1}return 0},reconfigure:(W,j)=>{let _,z=j.config.address[Q];if(z!=null){let V=W9(j,z);if(this.dependencies.every((O)=>{return O instanceof S?j.facet(O)===W.facet(O):O instanceof _0?j.field(O,!1)==W.field(O,!1):!0})||(K?o6(_=J(W),V,X):X(_=J(W),V)))return W.values[Y]=V,0}else _=J(W);return W.values[Y]=_,1}}}}function o6(Z,$,J){if(Z.length!=$.length)return!1;for(let X=0;X<Z.length;X++)if(!J(Z[X],$[X]))return!1;return!0}function i8(Z,$){let J=!1;for(let X of $)if(Q4(Z,X)&1)J=!0;return J}function CY(Z,$,J){let X=J.map((q)=>Z[q.id]),Q=J.map((q)=>q.type),Y=X.filter((q)=>!(q&1)),K=Z[$.id]>>1;function U(q){let G=[];for(let W=0;W<X.length;W++){let j=W9(q,X[W]);if(Q[W]==2)for(let _ of j)G.push(_);else G.push(j)}return $.combine(G)}return{create(q){for(let G of X)Q4(q,G);return q.values[K]=U(q),1},update(q,G){if(!i8(q,Y))return 0;let W=U(q);if($.compare(W,q.values[K]))return 0;return q.values[K]=W,1},reconfigure(q,G){let W=i8(q,X),j=G.config.facets[$.id],_=G.facet($);if(j&&!W&&XZ(J,j))return q.values[K]=_,0;let z=U(q);if($.compare(z,_))return q.values[K]=_,0;return q.values[K]=z,1}}}var Q9=S.define({static:!0});class _0{constructor(Z,$,J,X,Q){this.id=Z,this.createF=$,this.updateF=J,this.compareF=X,this.spec=Q,this.provides=void 0}static define(Z){let $=new _0(JZ++,Z.create,Z.update,Z.compare||((J,X)=>J===X),Z);if(Z.provide)$.provides=Z.provide($);return $}create(Z){let $=Z.facet(Q9).find((J)=>J.field==this);return(($===null||$===void 0?void 0:$.create)||this.createF)(Z)}slot(Z){let $=Z[this.id]>>1;return{create:(J)=>{return J.values[$]=this.create(J),1},update:(J,X)=>{let Q=J.values[$],Y=this.updateF(Q,X);if(this.compareF(Q,Y))return 0;return J.values[$]=Y,1},reconfigure:(J,X)=>{let Q=J.facet(Q9),Y=X.facet(Q9),K;if((K=Q.find((U)=>U.field==this))&&K!=Y.find((U)=>U.field==this))return J.values[$]=K.create(J),1;if(X.config.address[this.id]!=null)return J.values[$]=X.field(this),0;return J.values[$]=this.create(J),1}}}init(Z){return[this,Q9.of({field:this,create:Z})]}get extension(){return this}}var Q7={lowest:4,low:3,default:2,high:1,highest:0};function J4(Z){return($)=>new QZ($,Z)}var O1={highest:J4(Q7.highest),high:J4(Q7.high),default:J4(Q7.default),low:J4(Q7.low),lowest:J4(Q7.lowest)};class QZ{constructor(Z,$){this.inner=Z,this.prec=$}}class j9{of(Z){return new q9(this,Z)}reconfigure(Z){return j9.reconfigure.of({compartment:this,extension:Z})}get(Z){return Z.config.compartments.get(this)}}class q9{constructor(Z,$){this.compartment=Z,this.inner=$}}class G9{constructor(Z,$,J,X,Q,Y){this.base=Z,this.compartments=$,this.dynamicSlots=J,this.address=X,this.staticValues=Q,this.facets=Y,this.statusTemplate=[];while(this.statusTemplate.length<J.length)this.statusTemplate.push(0)}staticFacet(Z){let $=this.address[Z.id];return $==null?Z.default:this.staticValues[$>>1]}static resolve(Z,$,J){let X=[],Q=Object.create(null),Y=new Map;for(let j of TY(Z,$,Y))if(j instanceof _0)X.push(j);else(Q[j.facet.id]||(Q[j.facet.id]=[])).push(j);let K=Object.create(null),U=[],q=[];for(let j of X)K[j.id]=q.length<<1,q.push((_)=>j.slot(_));let G=J===null||J===void 0?void 0:J.config.facets;for(let j in Q){let _=Q[j],z=_[0].facet,V=G&&G[j]||[];if(_.every((O)=>O.type==0))if(K[z.id]=U.length<<1|1,XZ(V,_))U.push(J.facet(z));else{let O=z.combine(_.map((H)=>H.value));U.push(J&&z.compare(O,J.facet(z))?J.facet(z):O)}else{for(let O of _)if(O.type==0)K[O.id]=U.length<<1|1,U.push(O.value);else K[O.id]=q.length<<1,q.push((H)=>O.dynamicSlot(H));K[z.id]=q.length<<1,q.push((O)=>CY(O,z,_))}}let W=q.map((j)=>j(K));return new G9(Z,Y,W,K,U,Q)}}function TY(Z,$,J){let X=[[],[],[],[],[]],Q=new Map;function Y(K,U){let q=Q.get(K);if(q!=null){if(q<=U)return;let G=X[q].indexOf(K);if(G>-1)X[q].splice(G,1);if(K instanceof q9)J.delete(K.compartment)}if(Q.set(K,U),Array.isArray(K))for(let G of K)Y(G,U);else if(K instanceof q9){if(J.has(K.compartment))throw RangeError("Duplicate use of compartment in extensions");let G=$.get(K.compartment)||K.inner;J.set(K.compartment,G),Y(G,U)}else if(K instanceof QZ)Y(K.inner,K.prec);else if(K instanceof _0){if(X[U].push(K),K.provides)Y(K.provides,U)}else if(K instanceof X4){if(X[U].push(K),K.facet.extensions)Y(K.facet.extensions,Q7.default)}else{let G=K.extension;if(!G)throw Error(`Unrecognized extension value in extension set (${K}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);Y(G,U)}}return Y(Z,Q7.default),X.reduce((K,U)=>K.concat(U))}function Q4(Z,$){if($&1)return 2;let J=$>>1,X=Z.status[J];if(X==4)throw Error("Cyclic dependency between fields and/or facets");if(X&2)return X;Z.status[J]=4;let Q=Z.computeSlot(Z,Z.config.dynamicSlots[J]);return Z.status[J]=2|Q}function W9(Z,$){return $&1?Z.config.staticValues[$>>1]:Z.values[$>>1]}var Q$=S.define(),a8=S.define({combine:(Z)=>Z.some(($)=>$),static:!0}),Y$=S.define({combine:(Z)=>Z.length?Z[0]:void 0,static:!0}),K$=S.define(),U$=S.define(),q$=S.define(),G$=S.define({combine:(Z)=>Z.length?Z[0]:!1});class i0{constructor(Z,$){this.type=Z,this.value=$}static define(){return new W$}}class W${of(Z){return new i0(this,Z)}}class j${constructor(Z){this.map=Z}of(Z){return new p(this,Z)}}class p{constructor(Z,$){this.type=Z,this.value=$}map(Z){let $=this.type.map(this.value,Z);return $===void 0?void 0:$==this.value?this:new p(this.type,$)}is(Z){return this.type==Z}static define(Z={}){return new j$(Z.map||(($)=>$))}static mapEffects(Z,$){if(!Z.length)return Z;let J=[];for(let X of Z){let Q=X.map($);if(Q)J.push(Q)}return J}}p.reconfigure=p.define();p.appendConfig=p.define();class N0{constructor(Z,$,J,X,Q,Y){if(this.startState=Z,this.changes=$,this.selection=J,this.effects=X,this.annotations=Q,this.scrollIntoView=Y,this._doc=null,this._state=null,J)X$(J,$.newLength);if(!Q.some((K)=>K.type==N0.time))this.annotations=Q.concat(N0.time.of(Date.now()))}static create(Z,$,J,X,Q,Y){return new N0(Z,$,J,X,Q,Y)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){if(!this._state)this.startState.applyTransaction(this);return this._state}annotation(Z){for(let $ of this.annotations)if($.type==Z)return $.value;return}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(Z){let $=this.annotation(N0.userEvent);return!!($&&($==Z||$.length>Z.length&&$.slice(0,Z.length)==Z&&$[Z.length]=="."))}}N0.time=i0.define();N0.userEvent=i0.define();N0.addToHistory=i0.define();N0.remote=i0.define();function yY(Z,$){let J=[];for(let X=0,Q=0;;){let Y,K;if(X<Z.length&&(Q==$.length||$[Q]>=Z[X]))Y=Z[X++],K=Z[X++];else if(Q<$.length)Y=$[Q++],K=$[Q++];else return J;if(!J.length||J[J.length-1]<Y)J.push(Y,K);else if(J[J.length-1]<K)J[J.length-1]=K}}function _$(Z,$,J){var X;let Q,Y,K;if(J)Q=$.changes,Y=D0.empty($.changes.length),K=Z.changes.compose($.changes);else Q=$.changes.map(Z.changes),Y=Z.changes.mapDesc($.changes,!0),K=Z.changes.compose(Q);return{changes:K,selection:$.selection?$.selection.map(Y):(X=Z.selection)===null||X===void 0?void 0:X.map(Q),effects:p.mapEffects(Z.effects,Q).concat(p.mapEffects($.effects,Y)),annotations:Z.annotations.length?Z.annotations.concat($.annotations):$.annotations,scrollIntoView:Z.scrollIntoView||$.scrollIntoView}}function r8(Z,$,J){let X=$.selection,Q=L7($.annotations);if($.userEvent)Q=Q.concat(N0.userEvent.of($.userEvent));return{changes:$.changes instanceof D0?$.changes:D0.of($.changes||[],J,Z.facet(Y$)),selection:X&&(X instanceof A?X:A.single(X.anchor,X.head)),effects:L7($.effects),annotations:Q,scrollIntoView:!!$.scrollIntoView}}function z$(Z,$,J){let X=r8(Z,$.length?$[0]:{},Z.doc.length);if($.length&&$[0].filter===!1)J=!1;for(let Y=1;Y<$.length;Y++){if($[Y].filter===!1)J=!1;let K=!!$[Y].sequential;X=_$(X,r8(Z,$[Y],K?X.changes.newLength:Z.doc.length),K)}let Q=N0.create(Z,X.changes,X.selection,X.effects,X.annotations,X.scrollIntoView);return SY(J?kY(Q):Q)}function kY(Z){let $=Z.startState,J=!0;for(let Q of $.facet(K$)){let Y=Q(Z);if(Y===!1){J=!1;break}if(Array.isArray(Y))J=J===!0?Y:yY(J,Y)}if(J!==!0){let Q,Y;if(J===!1)Y=Z.changes.invertedDesc,Q=D0.empty($.doc.length);else{let K=Z.changes.filter(J);Q=K.changes,Y=K.filtered.mapDesc(K.changes).invertedDesc}Z=N0.create($,Q,Z.selection&&Z.selection.map(Y),p.mapEffects(Z.effects,Y),Z.annotations,Z.scrollIntoView)}let X=$.facet(U$);for(let Q=X.length-1;Q>=0;Q--){let Y=X[Q](Z);if(Y instanceof N0)Z=Y;else if(Array.isArray(Y)&&Y.length==1&&Y[0]instanceof N0)Z=Y[0];else Z=z$($,L7(Y),!1)}return Z}function SY(Z){let $=Z.startState,J=$.facet(q$),X=Z;for(let Q=J.length-1;Q>=0;Q--){let Y=J[Q](Z);if(Y&&Object.keys(Y).length)X=_$(X,r8($,Y,Z.changes.newLength),!0)}return X==Z?Z:N0.create($,Z.changes,Z.selection,X.effects,X.annotations,X.scrollIntoView)}var bY=[];function L7(Z){return Z==null?bY:Array.isArray(Z)?Z:[Z]}var Y0=function(Z){return Z[Z.Word=0]="Word",Z[Z.Space=1]="Space",Z[Z.Other=2]="Other",Z}(Y0||(Y0={})),xY=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,o8;try{o8=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(Z){}function wY(Z){if(o8)return o8.test(Z);for(let $=0;$<Z.length;$++){let J=Z[$];if(/\w/.test(J)||J>""&&(J.toUpperCase()!=J.toLowerCase()||xY.test(J)))return!0}return!1}function hY(Z){return($)=>{if(!/\S/.test($))return Y0.Space;if(wY($))return Y0.Word;for(let J=0;J<Z.length;J++)if($.indexOf(Z[J])>-1)return Y0.Word;return Y0.Other}}class n{constructor(Z,$,J,X,Q,Y){if(this.config=Z,this.doc=$,this.selection=J,this.values=X,this.status=Z.statusTemplate.slice(),this.computeSlot=Q,Y)Y._state=this;for(let K=0;K<this.config.dynamicSlots.length;K++)Q4(this,K<<1);this.computeSlot=null}field(Z,$=!0){let J=this.config.address[Z.id];if(J==null){if($)throw RangeError("Field is not present in this state");return}return Q4(this,J),W9(this,J)}update(...Z){return z$(this,Z,!0)}applyTransaction(Z){let $=this.config,{base:J,compartments:X}=$;for(let K of Z.effects)if(K.is(j9.reconfigure)){if($)X=new Map,$.compartments.forEach((U,q)=>X.set(q,U)),$=null;X.set(K.value.compartment,K.value.extension)}else if(K.is(p.reconfigure))$=null,J=K.value;else if(K.is(p.appendConfig))$=null,J=L7(J).concat(K.value);let Q;if(!$)$=G9.resolve(J,X,this),Q=new n($,this.doc,this.selection,$.dynamicSlots.map(()=>null),(U,q)=>q.reconfigure(U,this),null).values;else Q=Z.startState.values.slice();let Y=Z.startState.facet(a8)?Z.newSelection:Z.newSelection.asSingle();new n($,Z.newDoc,Y,Q,(K,U)=>U.update(K,Z),Z)}replaceSelection(Z){if(typeof Z=="string")Z=this.toText(Z);return this.changeByRange(($)=>({changes:{from:$.from,to:$.to,insert:Z},range:A.cursor($.from+Z.length)}))}changeByRange(Z){let $=this.selection,J=Z($.ranges[0]),X=this.changes(J.changes),Q=[J.range],Y=L7(J.effects);for(let K=1;K<$.ranges.length;K++){let U=Z($.ranges[K]),q=this.changes(U.changes),G=q.map(X);for(let j=0;j<K;j++)Q[j]=Q[j].map(G);let W=X.mapDesc(q,!0);Q.push(U.range.map(W)),X=X.compose(G),Y=p.mapEffects(Y,G).concat(p.mapEffects(L7(U.effects),W))}return{changes:X,selection:A.create(Q,$.mainIndex),effects:Y}}changes(Z=[]){if(Z instanceof D0)return Z;return D0.of(Z,this.doc.length,this.facet(n.lineSeparator))}toText(Z){return e.of(Z.split(this.facet(n.lineSeparator)||c8))}sliceDoc(Z=0,$=this.doc.length){return this.doc.sliceString(Z,$,this.lineBreak)}facet(Z){let $=this.config.address[Z.id];if($==null)return Z.default;return Q4(this,$),W9(this,$)}toJSON(Z){let $={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(Z)for(let J in Z){let X=Z[J];if(X instanceof _0&&this.config.address[X.id]!=null)$[J]=X.spec.toJSON(this.field(Z[J]),this)}return $}static fromJSON(Z,$={},J){if(!Z||typeof Z.doc!="string")throw RangeError("Invalid JSON representation for EditorState");let X=[];if(J){for(let Q in J)if(Object.prototype.hasOwnProperty.call(Z,Q)){let Y=J[Q],K=Z[Q];X.push(Y.init((U)=>Y.spec.fromJSON(K,U)))}}return n.create({doc:Z.doc,selection:A.fromJSON(Z.selection),extensions:$.extensions?X.concat([$.extensions]):X})}static create(Z={}){let $=G9.resolve(Z.extensions||[],new Map),J=Z.doc instanceof e?Z.doc:e.of((Z.doc||"").split($.staticFacet(n.lineSeparator)||c8)),X=!Z.selection?A.single(0):Z.selection instanceof A?Z.selection:A.single(Z.selection.anchor,Z.selection.head);if(X$(X,J.length),!$.staticFacet(a8))X=X.asSingle();return new n($,J,X,$.dynamicSlots.map(()=>null),(Q,Y)=>Y.create(Q),null)}get tabSize(){return this.facet(n.tabSize)}get lineBreak(){return this.facet(n.lineSeparator)||`
`}get readOnly(){return this.facet(G$)}phrase(Z,...$){for(let J of this.facet(n.phrases))if(Object.prototype.hasOwnProperty.call(J,Z)){Z=J[Z];break}if($.length)Z=Z.replace(/\$(\$|\d*)/g,(J,X)=>{if(X=="$")return"$";let Q=+(X||1);return!Q||Q>$.length?J:$[Q-1]});return Z}languageDataAt(Z,$,J=-1){let X=[];for(let Q of this.facet(Q$))for(let Y of Q(this,$,J))if(Object.prototype.hasOwnProperty.call(Y,Z))X.push(Y[Z]);return X}charCategorizer(Z){let $=this.languageDataAt("wordChars",Z);return hY($.length?$[0]:"")}wordAt(Z){let{text:$,from:J,length:X}=this.doc.lineAt(Z),Q=this.charCategorizer(Z),Y=Z-J,K=Z-J;while(Y>0){let U=H0($,Y,!1);if(Q($.slice(U,Y))!=Y0.Word)break;Y=U}while(K<X){let U=H0($,K);if(Q($.slice(K,U))!=Y0.Word)break;K=U}return Y==K?null:A.range(Y+J,K+J)}}n.allowMultipleSelections=a8;n.tabSize=S.define({combine:(Z)=>Z.length?Z[0]:4});n.lineSeparator=Y$;n.readOnly=G$;n.phrases=S.define({compare(Z,$){let J=Object.keys(Z),X=Object.keys($);return J.length==X.length&&J.every((Q)=>Z[Q]==$[Q])}});n.languageData=Q$;n.changeFilter=K$;n.transactionFilter=U$;n.transactionExtender=q$;j9.reconfigure=p.define();function w0(Z,$,J={}){let X={};for(let Q of Z)for(let Y of Object.keys(Q)){let K=Q[Y],U=X[Y];if(U===void 0)X[Y]=K;else if(U===K||K===void 0);else if(Object.hasOwnProperty.call(J,Y))X[Y]=J[Y](U,K);else throw Error("Config merge conflict for field "+Y)}for(let Q in $)if(X[Q]===void 0)X[Q]=$[Q];return X}class z1{eq(Z){return this==Z}range(Z,$=Z){return Y4.create(Z,$,this)}}z1.prototype.startSide=z1.prototype.endSide=0;z1.prototype.point=!1;z1.prototype.mapMode=T0.TrackDel;function YZ(Z,$){return Z==$||Z.constructor==$.constructor&&Z.eq($)}class Y4{constructor(Z,$,J){this.from=Z,this.to=$,this.value=J}static create(Z,$,J){return new Y4(Z,$,J)}}function t8(Z,$){return Z.from-$.from||Z.value.startSide-$.value.startSide}class KZ{constructor(Z,$,J,X){this.from=Z,this.to=$,this.value=J,this.maxPoint=X}get length(){return this.to[this.to.length-1]}findIndex(Z,$,J,X=0){let Q=J?this.to:this.from;for(let Y=X,K=Q.length;;){if(Y==K)return Y;let U=Y+K>>1,q=Q[U]-Z||(J?this.value[U].endSide:this.value[U].startSide)-$;if(U==Y)return q>=0?Y:K;if(q>=0)K=U;else Y=U+1}}between(Z,$,J,X){for(let Q=this.findIndex($,-1e9,!0),Y=this.findIndex(J,1e9,!1,Q);Q<Y;Q++)if(X(this.from[Q]+Z,this.to[Q]+Z,this.value[Q])===!1)return!1}map(Z,$){let J=[],X=[],Q=[],Y=-1,K=-1;for(let U=0;U<this.value.length;U++){let q=this.value[U],G=this.from[U]+Z,W=this.to[U]+Z,j,_;if(G==W){let z=$.mapPos(G,q.startSide,q.mapMode);if(z==null)continue;if(j=_=z,q.startSide!=q.endSide){if(_=$.mapPos(G,q.endSide),_<j)continue}}else if(j=$.mapPos(G,q.startSide),_=$.mapPos(W,q.endSide),j>_||j==_&&q.startSide>0&&q.endSide<=0)continue;if((_-j||q.endSide-q.startSide)<0)continue;if(Y<0)Y=j;if(q.point)K=Math.max(K,_-j);J.push(q),X.push(j-Y),Q.push(_-Y)}return{mapped:J.length?new KZ(X,Q,J,K):null,pos:Y}}}class i{constructor(Z,$,J,X){this.chunkPos=Z,this.chunk=$,this.nextLayer=J,this.maxPoint=X}static create(Z,$,J,X){return new i(Z,$,J,X)}get length(){let Z=this.chunk.length-1;return Z<0?0:Math.max(this.chunkEnd(Z),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let Z=this.nextLayer.size;for(let $ of this.chunk)Z+=$.value.length;return Z}chunkEnd(Z){return this.chunkPos[Z]+this.chunk[Z].length}update(Z){let{add:$=[],sort:J=!1,filterFrom:X=0,filterTo:Q=this.length}=Z,Y=Z.filter;if($.length==0&&!Y)return this;if(J)$=$.slice().sort(t8);if(this.isEmpty)return $.length?i.of($):this;let K=new UZ(this,null,-1).goto(0),U=0,q=[],G=new s0;while(K.value||U<$.length)if(U<$.length&&(K.from-$[U].from||K.startSide-$[U].value.startSide)>=0){let W=$[U++];if(!G.addInner(W.from,W.to,W.value))q.push(W)}else if(K.rangeIndex==1&&K.chunkIndex<this.chunk.length&&(U==$.length||this.chunkEnd(K.chunkIndex)<$[U].from)&&(!Y||X>this.chunkEnd(K.chunkIndex)||Q<this.chunkPos[K.chunkIndex])&&G.addChunk(this.chunkPos[K.chunkIndex],this.chunk[K.chunkIndex]))K.nextChunk();else{if(!Y||X>K.to||Q<K.from||Y(K.from,K.to,K.value)){if(!G.addInner(K.from,K.to,K.value))q.push(Y4.create(K.from,K.to,K.value))}K.next()}return G.finishInner(this.nextLayer.isEmpty&&!q.length?i.empty:this.nextLayer.update({add:q,filter:Y,filterFrom:X,filterTo:Q}))}map(Z){if(Z.empty||this.isEmpty)return this;let $=[],J=[],X=-1;for(let Y=0;Y<this.chunk.length;Y++){let K=this.chunkPos[Y],U=this.chunk[Y],q=Z.touchesRange(K,K+U.length);if(q===!1)X=Math.max(X,U.maxPoint),$.push(U),J.push(Z.mapPos(K));else if(q===!0){let{mapped:G,pos:W}=U.map(K,Z);if(G)X=Math.max(X,G.maxPoint),$.push(G),J.push(W)}}let Q=this.nextLayer.map(Z);return $.length==0?Q:new i(J,$,Q||i.empty,X)}between(Z,$,J){if(this.isEmpty)return;for(let X=0;X<this.chunk.length;X++){let Q=this.chunkPos[X],Y=this.chunk[X];if($>=Q&&Z<=Q+Y.length&&Y.between(Q,Z-Q,$-Q,J)===!1)return}this.nextLayer.between(Z,$,J)}iter(Z=0){return K4.from([this]).goto(Z)}get isEmpty(){return this.nextLayer==this}static iter(Z,$=0){return K4.from(Z).goto($)}static compare(Z,$,J,X,Q=-1){let Y=Z.filter((W)=>W.maxPoint>0||!W.isEmpty&&W.maxPoint>=Q),K=$.filter((W)=>W.maxPoint>0||!W.isEmpty&&W.maxPoint>=Q),U=t6(Y,K,J),q=new A7(Y,U,Q),G=new A7(K,U,Q);if(J.iterGaps((W,j,_)=>e6(q,W,G,j,_,X)),J.empty&&J.length==0)e6(q,0,G,0,0,X)}static eq(Z,$,J=0,X){if(X==null)X=999999999;let Q=Z.filter((G)=>!G.isEmpty&&$.indexOf(G)<0),Y=$.filter((G)=>!G.isEmpty&&Z.indexOf(G)<0);if(Q.length!=Y.length)return!1;if(!Q.length)return!0;let K=t6(Q,Y),U=new A7(Q,K,0).goto(J),q=new A7(Y,K,0).goto(J);for(;;){if(U.to!=q.to||!e8(U.active,q.active)||U.point&&(!q.point||!YZ(U.point,q.point)))return!1;if(U.to>X)return!0;U.next(),q.next()}}static spans(Z,$,J,X,Q=-1){let Y=new A7(Z,null,Q).goto($),K=$,U=Y.openStart;for(;;){let q=Math.min(Y.to,J);if(Y.point){let G=Y.activeForPoint(Y.to),W=Y.pointFrom<$?G.length+1:Y.point.startSide<0?G.length:Math.min(G.length,U);X.point(K,q,Y.point,G,W,Y.pointRank),U=Math.min(Y.openEnd(q),G.length)}else if(q>K)X.span(K,q,Y.active,U),U=Y.openEnd(q);if(Y.to>J)return U+(Y.point&&Y.to>J?1:0);K=Y.to,Y.next()}}static of(Z,$=!1){let J=new s0;for(let X of Z instanceof Y4?[Z]:$?vY(Z):Z)J.add(X.from,X.to,X.value);return J.finish()}static join(Z){if(!Z.length)return i.empty;let $=Z[Z.length-1];for(let J=Z.length-2;J>=0;J--)for(let X=Z[J];X!=i.empty;X=X.nextLayer)$=new i(X.chunkPos,X.chunk,$,Math.max(X.maxPoint,$.maxPoint));return $}}i.empty=new i([],[],null,-1);function vY(Z){if(Z.length>1)for(let $=Z[0],J=1;J<Z.length;J++){let X=Z[J];if(t8($,X)>0)return Z.slice().sort(t8);$=X}return Z}i.empty.nextLayer=i.empty;class s0{finishChunk(Z){if(this.chunks.push(new KZ(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,Z)this.from=[],this.to=[],this.value=[]}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(Z,$,J){if(!this.addInner(Z,$,J))(this.nextLayer||(this.nextLayer=new s0)).add(Z,$,J)}addInner(Z,$,J){let X=Z-this.lastTo||J.startSide-this.last.endSide;if(X<=0&&(Z-this.lastFrom||J.startSide-this.last.startSide)<0)throw Error("Ranges must be added sorted by `from` position and `startSide`");if(X<0)return!1;if(this.from.length==250)this.finishChunk(!0);if(this.chunkStart<0)this.chunkStart=Z;if(this.from.push(Z-this.chunkStart),this.to.push($-this.chunkStart),this.last=J,this.lastFrom=Z,this.lastTo=$,this.value.push(J),J.point)this.maxPoint=Math.max(this.maxPoint,$-Z);return!0}addChunk(Z,$){if((Z-this.lastTo||$.value[0].startSide-this.last.endSide)<0)return!1;if(this.from.length)this.finishChunk(!0);this.setMaxPoint=Math.max(this.setMaxPoint,$.maxPoint),this.chunks.push($),this.chunkPos.push(Z);let J=$.value.length-1;return this.last=$.value[J],this.lastFrom=$.from[J]+Z,this.lastTo=$.to[J]+Z,!0}finish(){return this.finishInner(i.empty)}finishInner(Z){if(this.from.length)this.finishChunk(!1);if(this.chunks.length==0)return Z;let $=i.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(Z):Z,this.setMaxPoint);return this.from=null,$}}function t6(Z,$,J){let X=new Map;for(let Y of Z)for(let K=0;K<Y.chunk.length;K++)if(Y.chunk[K].maxPoint<=0)X.set(Y.chunk[K],Y.chunkPos[K]);let Q=new Set;for(let Y of $)for(let K=0;K<Y.chunk.length;K++){let U=X.get(Y.chunk[K]);if(U!=null&&(J?J.mapPos(U):U)==Y.chunkPos[K]&&!(J===null||J===void 0?void 0:J.touchesRange(U,U+Y.chunk[K].length)))Q.add(Y.chunk[K])}return Q}class UZ{constructor(Z,$,J,X=0){this.layer=Z,this.skip=$,this.minPoint=J,this.rank=X}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(Z,$=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(Z,$,!1),this}gotoInner(Z,$,J){while(this.chunkIndex<this.layer.chunk.length){let X=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(X)||this.layer.chunkEnd(this.chunkIndex)<Z||X.maxPoint<this.minPoint))break;this.chunkIndex++,J=!1}if(this.chunkIndex<this.layer.chunk.length){let X=this.layer.chunk[this.chunkIndex].findIndex(Z-this.layer.chunkPos[this.chunkIndex],$,!0);if(!J||this.rangeIndex<X)this.setRangeIndex(X)}this.next()}forward(Z,$){if((this.to-Z||this.endSide-$)<0)this.gotoInner(Z,$,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let Z=this.layer.chunkPos[this.chunkIndex],$=this.layer.chunk[this.chunkIndex],J=Z+$.from[this.rangeIndex];if(this.from=J,this.to=Z+$.to[this.rangeIndex],this.value=$.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(Z){if(Z==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)while(this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]))this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=Z}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(Z){return this.from-Z.from||this.startSide-Z.startSide||this.rank-Z.rank||this.to-Z.to||this.endSide-Z.endSide}}class K4{constructor(Z){this.heap=Z}static from(Z,$=null,J=-1){let X=[];for(let Q=0;Q<Z.length;Q++)for(let Y=Z[Q];!Y.isEmpty;Y=Y.nextLayer)if(Y.maxPoint>=J)X.push(new UZ(Y,$,J,Q));return X.length==1?X[0]:new K4(X)}get startSide(){return this.value?this.value.startSide:0}goto(Z,$=-1e9){for(let J of this.heap)J.goto(Z,$);for(let J=this.heap.length>>1;J>=0;J--)d8(this.heap,J);return this.next(),this}forward(Z,$){for(let J of this.heap)J.forward(Z,$);for(let J=this.heap.length>>1;J>=0;J--)d8(this.heap,J);if((this.to-Z||this.value.endSide-$)<0)this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let Z=this.heap[0];if(this.from=Z.from,this.to=Z.to,this.value=Z.value,this.rank=Z.rank,Z.value)Z.next();d8(this.heap,0)}}}function d8(Z,$){for(let J=Z[$];;){let X=($<<1)+1;if(X>=Z.length)break;let Q=Z[X];if(X+1<Z.length&&Q.compare(Z[X+1])>=0)Q=Z[X+1],X++;if(J.compare(Q)<0)break;Z[X]=J,Z[$]=Q,$=X}}class A7{constructor(Z,$,J){this.minPoint=J,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=K4.from(Z,$,J)}goto(Z,$=-1e9){return this.cursor.goto(Z,$),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=Z,this.endSide=$,this.openStart=-1,this.next(),this}forward(Z,$){while(this.minActive>-1&&(this.activeTo[this.minActive]-Z||this.active[this.minActive].endSide-$)<0)this.removeActive(this.minActive);this.cursor.forward(Z,$)}removeActive(Z){Y9(this.active,Z),Y9(this.activeTo,Z),Y9(this.activeRank,Z),this.minActive=Z$(this.active,this.activeTo)}addActive(Z){let $=0,{value:J,to:X,rank:Q}=this.cursor;while($<this.activeRank.length&&(Q-this.activeRank[$]||X-this.activeTo[$])>0)$++;if(K9(this.active,$,J),K9(this.activeTo,$,X),K9(this.activeRank,$,Q),Z)K9(Z,$,this.cursor.from);this.minActive=Z$(this.active,this.activeTo)}next(){let Z=this.to,$=this.point;this.point=null;let J=this.openStart<0?[]:null;for(;;){let X=this.minActive;if(X>-1&&(this.activeTo[X]-this.cursor.from||this.active[X].endSide-this.cursor.startSide)<0){if(this.activeTo[X]>Z){this.to=this.activeTo[X],this.endSide=this.active[X].endSide;break}if(this.removeActive(X),J)Y9(J,X)}else if(!this.cursor.value){this.to=this.endSide=1e9;break}else if(this.cursor.from>Z){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let Q=this.cursor.value;if(!Q.point)this.addActive(J),this.cursor.next();else if($&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=Q,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=Q.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}}if(J){this.openStart=0;for(let X=J.length-1;X>=0&&J[X]<Z;X--)this.openStart++}}activeForPoint(Z){if(!this.active.length)return this.active;let $=[];for(let J=this.active.length-1;J>=0;J--){if(this.activeRank[J]<this.pointRank)break;if(this.activeTo[J]>Z||this.activeTo[J]==Z&&this.active[J].endSide>=this.point.endSide)$.push(this.active[J])}return $.reverse()}openEnd(Z){let $=0;for(let J=this.activeTo.length-1;J>=0&&this.activeTo[J]>Z;J--)$++;return $}}function e6(Z,$,J,X,Q,Y){Z.goto($),J.goto(X);let K=X+Q,U=X,q=X-$,G=!!Y.boundChange;for(let W=!1;;){let j=Z.to+q-J.to,_=j||Z.endSide-J.endSide,z=_<0?Z.to+q:J.to,V=Math.min(z,K);if(Z.point||J.point){if(!(Z.point&&J.point&&YZ(Z.point,J.point)&&e8(Z.activeForPoint(Z.to),J.activeForPoint(J.to))))Y.comparePoint(U,V,Z.point,J.point);W=!1}else{if(W)Y.boundChange(U);if(V>U&&!e8(Z.active,J.active))Y.compareRange(U,V,Z.active,J.active);if(G&&V<K&&(j||Z.openEnd(z)!=J.openEnd(z)))W=!0}if(z>K)break;if(U=z,_<=0)Z.next();if(_>=0)J.next()}}function e8(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++)if(Z[J]!=$[J]&&!YZ(Z[J],$[J]))return!1;return!0}function Y9(Z,$){for(let J=$,X=Z.length-1;J<X;J++)Z[J]=Z[J+1];Z.pop()}function K9(Z,$,J){for(let X=Z.length-1;X>=$;X--)Z[X+1]=Z[X];Z[$]=J}function Z$(Z,$){let J=-1,X=1e9;for(let Q=0;Q<$.length;Q++)if(($[Q]-X||Z[Q].endSide-Z[J].endSide)<0)J=Q,X=$[Q];return J}function x1(Z,$,J=Z.length){let X=0;for(let Q=0;Q<J&&Q<Z.length;)if(Z.charCodeAt(Q)==9)X+=$-X%$,Q++;else X++,Q=H0(Z,Q);return X}function _9(Z,$,J,X){for(let Q=0,Y=0;;){if(Y>=$)return Q;if(Q==Z.length)break;Y+=Z.charCodeAt(Q)==9?J-Y%J:1,Q=H0(Z,Q)}return X===!0?-1:Z.length}var O$=typeof Symbol>"u"?"__"+"ͼ":Symbol.for("ͼ"),qZ=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),V$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class V1{constructor(Z,$){this.rules=[];let{finish:J}=$||{};function X(Y){return/^@/.test(Y)?[Y]:Y.split(/,\s*/)}function Q(Y,K,U,q){let G=[],W=/^@(\w+)\b/.exec(Y[0]),j=W&&W[1]=="keyframes";if(W&&K==null)return U.push(Y[0]+";");for(let _ in K){let z=K[_];if(/&/.test(_))Q(_.split(/,\s*/).map((V)=>Y.map((O)=>V.replace(/&/,O))).reduce((V,O)=>V.concat(O)),z,U);else if(z&&typeof z=="object"){if(!W)throw RangeError("The value of a property ("+_+") should be a primitive value.");Q(X(_),z,G,j)}else if(z!=null)G.push(_.replace(/_.*/,"").replace(/[A-Z]/g,(V)=>"-"+V.toLowerCase())+": "+z+";")}if(G.length||j)U.push((J&&!W&&!q?Y.map(J):Y).join(", ")+" {"+G.join(" ")+"}")}for(let Y in Z)Q(X(Y),Z[Y],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let Z=V$[O$]||1;return V$[O$]=Z+1,"ͼ"+Z.toString(36)}static mount(Z,$,J){let X=Z[qZ],Q=J&&J.nonce;if(!X)X=new H$(Z,Q);else if(Q)X.setNonce(Q);X.mount(Array.isArray($)?$:[$],Z)}}var N$=new Map;class H${constructor(Z,$){let J=Z.ownerDocument||Z,X=J.defaultView;if(!Z.head&&Z.adoptedStyleSheets&&X.CSSStyleSheet){let Q=N$.get(J);if(Q)return Z[qZ]=Q;this.sheet=new X.CSSStyleSheet,N$.set(J,this)}else if(this.styleTag=J.createElement("style"),$)this.styleTag.setAttribute("nonce",$);this.modules=[],Z[qZ]=this}mount(Z,$){let J=this.sheet,X=0,Q=0;for(let Y=0;Y<Z.length;Y++){let K=Z[Y],U=this.modules.indexOf(K);if(U<Q&&U>-1)this.modules.splice(U,1),Q--,U=-1;if(U==-1){if(this.modules.splice(Q++,0,K),J)for(let q=0;q<K.rules.length;q++)J.insertRule(K.rules[q],X++)}else{while(Q<U)X+=this.modules[Q++].rules.length;X+=K.rules.length,Q++}}if(J){if($.adoptedStyleSheets.indexOf(this.sheet)<0)$.adoptedStyleSheets=[this.sheet,...$.adoptedStyleSheets]}else{let Y="";for(let U=0;U<this.modules.length;U++)Y+=this.modules[U].getRules()+`
`;this.styleTag.textContent=Y;let K=$.head||$;if(this.styleTag.parentNode!=K)K.insertBefore(this.styleTag,K.firstChild)}}setNonce(Z){if(this.styleTag&&this.styleTag.getAttribute("nonce")!=Z)this.styleTag.setAttribute("nonce",Z)}}var w1={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},P7={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},uY=typeof navigator<"u"&&/Mac/.test(navigator.platform),mY=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(z0=0;z0<10;z0++)w1[48+z0]=w1[96+z0]=String(z0);var z0;for(z0=1;z0<=24;z0++)w1[z0+111]="F"+z0;var z0;for(z0=65;z0<=90;z0++)w1[z0]=String.fromCharCode(z0+32),P7[z0]=String.fromCharCode(z0);var z0;for(q4 in w1)if(!P7.hasOwnProperty(q4))P7[q4]=w1[q4];var q4;function I$(Z){var $=uY&&Z.metaKey&&Z.shiftKey&&!Z.ctrlKey&&!Z.altKey||mY&&Z.shiftKey&&Z.key&&Z.key.length==1||Z.key=="Unidentified",J=!$&&Z.key||(Z.shiftKey?P7:w1)[Z.keyCode]||Z.key||"Unidentified";if(J=="Esc")J="Escape";if(J=="Del")J="Delete";if(J=="Left")J="ArrowLeft";if(J=="Up")J="ArrowUp";if(J=="Right")J="ArrowRight";if(J=="Down")J="ArrowDown";return J}function $0(){var Z=arguments[0];if(typeof Z=="string")Z=document.createElement(Z);var $=1,J=arguments[1];if(J&&typeof J=="object"&&J.nodeType==null&&!Array.isArray(J)){for(var X in J)if(Object.prototype.hasOwnProperty.call(J,X)){var Q=J[X];if(typeof Q=="string")Z.setAttribute(X,Q);else if(Q!=null)Z[X]=Q}$++}for(;$<arguments.length;$++)R$(Z,arguments[$]);return Z}function R$(Z,$){if(typeof $=="string")Z.appendChild(document.createTextNode($));else if($==null);else if($.nodeType!=null)Z.appendChild($);else if(Array.isArray($))for(var J=0;J<$.length;J++)R$(Z,$[J]);else throw RangeError("Unsupported child node: "+$)}var v0=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},IZ=typeof document<"u"?document:{documentElement:{style:{}}},RZ=/Edge\/(\d+)/.exec(v0.userAgent),Y3=/MSIE \d/.test(v0.userAgent),FZ=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(v0.userAgent),f9=!!(Y3||FZ||RZ),F$=!f9&&/gecko\/(\d+)/i.test(v0.userAgent),GZ=!f9&&/Chrome\/(\d+)/.exec(v0.userAgent),D$="webkitFontSmoothing"in IZ.documentElement.style,DZ=!f9&&/Apple Computer/.test(v0.vendor),A$=DZ&&(/Mobile\/\w+/.test(v0.userAgent)||v0.maxTouchPoints>2),x={mac:A$||/Mac/.test(v0.platform),windows:/Win/.test(v0.platform),linux:/Linux|X11/.test(v0.platform),ie:f9,ie_version:Y3?IZ.documentMode||6:FZ?+FZ[1]:RZ?+RZ[1]:0,gecko:F$,gecko_version:F$?+(/Firefox\/(\d+)/.exec(v0.userAgent)||[0,0])[1]:0,chrome:!!GZ,chrome_version:GZ?+GZ[1]:0,ios:A$,android:/Android\b/.test(v0.userAgent),webkit:D$,webkit_version:D$?+(/\bAppleWebKit\/(\d+)/.exec(v0.userAgent)||[0,0])[1]:0,safari:DZ,safari_version:DZ?+(/\bVersion\/(\d+(\.\d+)?)/.exec(v0.userAgent)||[0,0])[1]:0,tabSize:IZ.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function lZ(Z,$){for(let J in Z)if(J=="class"&&$.class)$.class+=" "+Z.class;else if(J=="style"&&$.style)$.style+=";"+Z.style;else $[J]=Z[J];return $}var k9=Object.create(null);function dZ(Z,$,J){if(Z==$)return!0;if(!Z)Z=k9;if(!$)$=k9;let X=Object.keys(Z),Q=Object.keys($);if(X.length-(J&&X.indexOf(J)>-1?1:0)!=Q.length-(J&&Q.indexOf(J)>-1?1:0))return!1;for(let Y of X)if(Y!=J&&(Q.indexOf(Y)==-1||Z[Y]!==$[Y]))return!1;return!0}function fY(Z,$){for(let J=Z.attributes.length-1;J>=0;J--){let X=Z.attributes[J].name;if($[X]==null)Z.removeAttribute(X)}for(let J in $){let X=$[J];if(J=="style")Z.style.cssText=X;else if(Z.getAttribute(J)!=X)Z.setAttribute(J,X)}}function M$(Z,$,J){let X=!1;if($){for(let Q in $)if(!(J&&(Q in J)))if(X=!0,Q=="style")Z.style.cssText="";else Z.removeAttribute(Q)}if(J){for(let Q in J)if(!($&&$[Q]==J[Q]))if(X=!0,Q=="style")Z.style.cssText=J[Q];else Z.setAttribute(Q,J[Q])}return X}function gY(Z){let $=Object.create(null);for(let J=0;J<Z.attributes.length;J++){let X=Z.attributes[J];$[X.name]=X.value}return $}class r0{eq(Z){return!1}updateDOM(Z,$){return!1}compare(Z){return this==Z||this.constructor==Z.constructor&&this.eq(Z)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(Z){return!0}coordsAt(Z,$,J){return null}get isHidden(){return!1}get editable(){return!1}destroy(Z){}}var b0=function(Z){return Z[Z.Text=0]="Text",Z[Z.WidgetBefore=1]="WidgetBefore",Z[Z.WidgetAfter=2]="WidgetAfter",Z[Z.WidgetRange=3]="WidgetRange",Z}(b0||(b0={}));class m extends z1{constructor(Z,$,J,X){super();this.startSide=Z,this.endSide=$,this.widget=J,this.spec=X}get heightRelevant(){return!1}static mark(Z){return new M4(Z)}static widget(Z){let $=Math.max(-1e4,Math.min(1e4,Z.side||0)),J=!!Z.block;return $+=J&&!Z.inlineOrder?$>0?300000000:-400000000:$>0?1e8:-1e8,new q7(Z,$,$,J,Z.widget||null,!1)}static replace(Z){let $=!!Z.block,J,X;if(Z.isBlockGap)J=-500000000,X=400000000;else{let{start:Q,end:Y}=K3(Z,$);J=(Q?$?-300000000:-1:500000000)-1,X=(Y?$?200000000:1:-600000000)+1}return new q7(Z,J,X,$,Z.widget||null,!0)}static line(Z){return new L4(Z)}static set(Z,$=!1){return i.of(Z,$)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}m.none=i.empty;class M4 extends m{constructor(Z){let{start:$,end:J}=K3(Z);super($?-1:500000000,J?1:-600000000,null,Z);this.tagName=Z.tagName||"span",this.attrs=Z.class&&Z.attributes?lZ(Z.attributes,{class:Z.class}):Z.class?{class:Z.class}:Z.attributes||k9}eq(Z){return this==Z||Z instanceof M4&&this.tagName==Z.tagName&&dZ(this.attrs,Z.attrs)}range(Z,$=Z){if(Z>=$)throw RangeError("Mark decorations may not be empty");return super.range(Z,$)}}M4.prototype.point=!1;class L4 extends m{constructor(Z){super(-200000000,-200000000,null,Z)}eq(Z){return Z instanceof L4&&this.spec.class==Z.spec.class&&dZ(this.spec.attributes,Z.spec.attributes)}range(Z,$=Z){if($!=Z)throw RangeError("Line decoration ranges must be zero-length");return super.range(Z,$)}}L4.prototype.mapMode=T0.TrackBefore;L4.prototype.point=!0;class q7 extends m{constructor(Z,$,J,X,Q,Y){super($,J,Q,Z);this.block=X,this.isReplace=Y,this.mapMode=!X?T0.TrackDel:$<=0?T0.TrackBefore:T0.TrackAfter}get type(){return this.startSide!=this.endSide?b0.WidgetRange:this.startSide<=0?b0.WidgetBefore:b0.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(Z){return Z instanceof q7&&pY(this.widget,Z.widget)&&this.block==Z.block&&this.startSide==Z.startSide&&this.endSide==Z.endSide}range(Z,$=Z){if(this.isReplace&&(Z>$||Z==$&&this.startSide>0&&this.endSide<=0))throw RangeError("Invalid range for replacement decoration");if(!this.isReplace&&$!=Z)throw RangeError("Widget decorations can only have zero-length ranges");return super.range(Z,$)}}q7.prototype.point=!0;function K3(Z,$=!1){let{inclusiveStart:J,inclusiveEnd:X}=Z;if(J==null)J=Z.inclusive;if(X==null)X=Z.inclusive;return{start:J!==null&&J!==void 0?J:$,end:X!==null&&X!==void 0?X:$}}function pY(Z,$){return Z==$||!!(Z&&$&&Z.compare($))}function y7(Z,$,J,X=0){let Q=J.length-1;if(Q>=0&&J[Q]+X>=Z)J[Q]=Math.max(J[Q],$);else J.push(Z,$)}class R4 extends z1{constructor(Z,$){super();this.tagName=Z,this.attributes=$}eq(Z){return Z==this||Z instanceof R4&&this.tagName==Z.tagName&&dZ(this.attributes,Z.attributes)}static create(Z){return new R4(Z.tagName,Z.attributes||k9)}static set(Z,$=!1){return i.of(Z,$)}}R4.prototype.startSide=R4.prototype.endSide=-1;function b7(Z){let $;if(Z.nodeType==11)$=Z.getSelection?Z:Z.ownerDocument;else $=Z;return $.getSelection()}function AZ(Z,$){return $?Z==$||Z.contains($.nodeType!=1?$.parentNode:$):!1}function V4(Z,$){if(!$.anchorNode)return!1;try{return AZ(Z,$.anchorNode)}catch(J){return!1}}function A9(Z){if(Z.nodeType==3)return F4(Z,0,Z.nodeValue.length).getClientRects();else if(Z.nodeType==1)return Z.getClientRects();else return[]}function N4(Z,$,J,X){return J?L$(Z,$,J,X,-1)||L$(Z,$,J,X,1):!1}function d1(Z){for(var $=0;;$++)if(Z=Z.previousSibling,!Z)return $}function S9(Z){return Z.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(Z.nodeName)}function L$(Z,$,J,X,Q){for(;;){if(Z==J&&$==X)return!0;if($==(Q<0?0:v1(Z))){if(Z.nodeName=="DIV")return!1;let Y=Z.parentNode;if(!Y||Y.nodeType!=1)return!1;$=d1(Z)+(Q<0?0:1),Z=Y}else if(Z.nodeType==1){if(Z=Z.childNodes[$+(Q<0?-1:0)],Z.nodeType==1&&Z.contentEditable=="false")return!1;$=Q<0?v1(Z):0}else return!1}}function v1(Z){return Z.nodeType==3?Z.nodeValue.length:Z.childNodes.length}function b9(Z,$){let J=$?Z.left:Z.right;return{left:J,right:J,top:Z.top,bottom:Z.bottom}}function lY(Z){let $=Z.visualViewport;if($)return{left:0,right:$.width,top:0,bottom:$.height};return{left:0,right:Z.innerWidth,top:0,bottom:Z.innerHeight}}function U3(Z,$){let J=$.width/Z.offsetWidth,X=$.height/Z.offsetHeight;if(J>0.995&&J<1.005||!isFinite(J)||Math.abs($.width-Z.offsetWidth)<1)J=1;if(X>0.995&&X<1.005||!isFinite(X)||Math.abs($.height-Z.offsetHeight)<1)X=1;return{scaleX:J,scaleY:X}}function dY(Z,$,J,X,Q,Y,K,U){let q=Z.ownerDocument,G=q.defaultView||window;for(let W=Z,j=!1;W&&!j;)if(W.nodeType==1){let _,z=W==q.body,V=1,O=1;if(z)_=lY(G);else{if(/^(fixed|sticky)$/.test(getComputedStyle(W).position))j=!0;if(W.scrollHeight<=W.clientHeight&&W.scrollWidth<=W.clientWidth){W=W.assignedSlot||W.parentNode;continue}let D=W.getBoundingClientRect();({scaleX:V,scaleY:O}=U3(W,D)),_={left:D.left,right:D.left+W.clientWidth*V,top:D.top,bottom:D.top+W.clientHeight*O}}let H=0,R=0;if(Q=="nearest"){if($.top<_.top){if(R=$.top-(_.top+K),J>0&&$.bottom>_.bottom+R)R=$.bottom-_.bottom+K}else if($.bottom>_.bottom){if(R=$.bottom-_.bottom+K,J<0&&$.top-R<_.top)R=$.top-(_.top+K)}}else{let D=$.bottom-$.top,M=_.bottom-_.top;R=(Q=="center"&&D<=M?$.top+D/2-M/2:Q=="start"||Q=="center"&&J<0?$.top-K:$.bottom-M+K)-_.top}if(X=="nearest"){if($.left<_.left){if(H=$.left-(_.left+Y),J>0&&$.right>_.right+H)H=$.right-_.right+Y}else if($.right>_.right){if(H=$.right-_.right+Y,J<0&&$.left<_.left+H)H=$.left-(_.left+Y)}}else H=(X=="center"?$.left+($.right-$.left)/2-(_.right-_.left)/2:X=="start"==U?$.left-Y:$.right-(_.right-_.left)+Y)-_.left;if(H||R)if(z)G.scrollBy(H,R);else{let D=0,M=0;if(R){let L=W.scrollTop;W.scrollTop+=R/O,M=(W.scrollTop-L)*O}if(H){let L=W.scrollLeft;W.scrollLeft+=H/V,D=(W.scrollLeft-L)*V}if($={left:$.left-D,top:$.top-M,right:$.right-D,bottom:$.bottom-M},D&&Math.abs(D-H)<1)X="nearest";if(M&&Math.abs(M-R)<1)Q="nearest"}if(z)break;if($.top<_.top||$.bottom>_.bottom||$.left<_.left||$.right>_.right)$={left:Math.max($.left,_.left),right:Math.min($.right,_.right),top:Math.max($.top,_.top),bottom:Math.min($.bottom,_.bottom)};W=W.assignedSlot||W.parentNode}else if(W.nodeType==11)W=W.host;else break}function cY(Z){let $=Z.ownerDocument,J,X;for(let Q=Z.parentNode;Q;)if(Q==$.body||J&&X)break;else if(Q.nodeType==1){if(!X&&Q.scrollHeight>Q.clientHeight)X=Q;if(!J&&Q.scrollWidth>Q.clientWidth)J=Q;Q=Q.assignedSlot||Q.parentNode}else if(Q.nodeType==11)Q=Q.host;else break;return{x:J,y:X}}class q3{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(Z){return this.anchorNode==Z.anchorNode&&this.anchorOffset==Z.anchorOffset&&this.focusNode==Z.focusNode&&this.focusOffset==Z.focusOffset}setRange(Z){let{anchorNode:$,focusNode:J}=Z;this.set($,Math.min(Z.anchorOffset,$?v1($):0),J,Math.min(Z.focusOffset,J?v1(J):0))}set(Z,$,J,X){this.anchorNode=Z,this.anchorOffset=$,this.focusNode=J,this.focusOffset=X}}var K7=null;if(x.safari&&x.safari_version>=26)K7=!1;function G3(Z){if(Z.setActive)return Z.setActive();if(K7)return Z.focus(K7);let $=[];for(let J=Z;J;J=J.parentNode)if($.push(J,J.scrollTop,J.scrollLeft),J==J.ownerDocument)break;if(Z.focus(K7==null?{get preventScroll(){return K7={preventScroll:!0},!0}}:void 0),!K7){K7=!1;for(let J=0;J<$.length;){let X=$[J++],Q=$[J++],Y=$[J++];if(X.scrollTop!=Q)X.scrollTop=Q;if(X.scrollLeft!=Y)X.scrollLeft=Y}}}var B$;function F4(Z,$,J=$){let X=B$||(B$=document.createRange());return X.setEnd(Z,J),X.setStart(Z,$),X}function k7(Z,$,J,X){let Q={key:$,code:$,keyCode:J,which:J,cancelable:!0};if(X)({altKey:Q.altKey,ctrlKey:Q.ctrlKey,shiftKey:Q.shiftKey,metaKey:Q.metaKey}=X);let Y=new KeyboardEvent("keydown",Q);Y.synthetic=!0,Z.dispatchEvent(Y);let K=new KeyboardEvent("keyup",Q);return K.synthetic=!0,Z.dispatchEvent(K),Y.defaultPrevented||K.defaultPrevented}function sY(Z){while(Z){if(Z&&(Z.nodeType==9||Z.nodeType==11&&Z.host))return Z;Z=Z.assignedSlot||Z.parentNode}return null}function nY(Z,$){let{focusNode:J,focusOffset:X}=$;if(!J||$.anchorNode!=J||$.anchorOffset!=X)return!1;X=Math.min(X,v1(J));for(;;)if(X){if(J.nodeType!=1)return!1;let Q=J.childNodes[X-1];if(Q.contentEditable=="false")X--;else J=Q,X=v1(J)}else if(J==Z)return!0;else X=d1(J),J=J.parentNode}function W3(Z){return Z.scrollTop>Math.max(1,Z.scrollHeight-Z.clientHeight-4)}function j3(Z,$){for(let J=Z,X=$;;)if(J.nodeType==3&&X>0)return{node:J,offset:X};else if(J.nodeType==1&&X>0){if(J.contentEditable=="false")return null;J=J.childNodes[X-1],X=v1(J)}else if(J.parentNode&&!S9(J))X=d1(J),J=J.parentNode;else return null}function _3(Z,$){for(let J=Z,X=$;;)if(J.nodeType==3&&X<J.nodeValue.length)return{node:J,offset:X};else if(J.nodeType==1&&X<J.childNodes.length){if(J.contentEditable=="false")return null;J=J.childNodes[X],X=0}else if(J.parentNode&&!S9(J))X=d1(J)+1,J=J.parentNode;else return null}class I1{constructor(Z,$,J=!0){this.node=Z,this.offset=$,this.precise=J}static before(Z,$){return new I1(Z.parentNode,d1(Z),$)}static after(Z,$){return new I1(Z.parentNode,d1(Z)+1,$)}}var Q0=function(Z){return Z[Z.LTR=0]="LTR",Z[Z.RTL=1]="RTL",Z}(Q0||(Q0={})),G7=Q0.LTR,cZ=Q0.RTL;function z3(Z){let $=[];for(let J=0;J<Z.length;J++)$.push(1<<+Z[J]);return $}var iY=z3("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),aY=z3("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),MZ=Object.create(null),P1=[];for(let Z of["()","[]","{}"]){let $=Z.charCodeAt(0),J=Z.charCodeAt(1);MZ[$]=J,MZ[J]=-$}function O3(Z){return Z<=247?iY[Z]:1424<=Z&&Z<=1524?2:1536<=Z&&Z<=1785?aY[Z-1536]:1774<=Z&&Z<=2220?4:8192<=Z&&Z<=8204?256:64336<=Z&&Z<=65023?4:1}var rY=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class C1{get dir(){return this.level%2?cZ:G7}constructor(Z,$,J){this.from=Z,this.to=$,this.level=J}side(Z,$){return this.dir==$==Z?this.to:this.from}forward(Z,$){return Z==(this.dir==$)}static find(Z,$,J,X){let Q=-1;for(let Y=0;Y<Z.length;Y++){let K=Z[Y];if(K.from<=$&&K.to>=$){if(K.level==J)return Y;if(Q<0||(X!=0?X<0?K.from<$:K.to>$:Z[Q].level>K.level))Q=Y}}if(Q<0)throw RangeError("Index out of range");return Q}}function V3(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++){let X=Z[J],Q=$[J];if(X.from!=Q.from||X.to!=Q.to||X.direction!=Q.direction||!V3(X.inner,Q.inner))return!1}return!0}var K0=[];function oY(Z,$,J,X,Q){for(let Y=0;Y<=X.length;Y++){let K=Y?X[Y-1].to:$,U=Y<X.length?X[Y].from:J,q=Y?256:Q;for(let G=K,W=q,j=q;G<U;G++){let _=O3(Z.charCodeAt(G));if(_==512)_=W;else if(_==8&&j==4)_=16;if(K0[G]=_==4?2:_,_&7)j=_;W=_}for(let G=K,W=q,j=q;G<U;G++){let _=K0[G];if(_==128)if(G<U-1&&W==K0[G+1]&&W&24)_=K0[G]=W;else K0[G]=256;else if(_==64){let z=G+1;while(z<U&&K0[z]==64)z++;let V=G&&W==8||z<J&&K0[z]==8?j==1?1:8:256;for(let O=G;O<z;O++)K0[O]=V;G=z-1}else if(_==8&&j==1)K0[G]=1;if(W=_,_&7)j=_}}}function tY(Z,$,J,X,Q){let Y=Q==1?2:1;for(let K=0,U=0,q=0;K<=X.length;K++){let G=K?X[K-1].to:$,W=K<X.length?X[K].from:J;for(let j=G,_,z,V;j<W;j++)if(z=MZ[_=Z.charCodeAt(j)])if(z<0){for(let O=U-3;O>=0;O-=3)if(P1[O+1]==-z){let H=P1[O+2],R=H&2?Q:!(H&4)?0:H&1?Y:Q;if(R)K0[j]=K0[P1[O]]=R;U=O;break}}else if(P1.length==189)break;else P1[U++]=j,P1[U++]=_,P1[U++]=q;else if((V=K0[j])==2||V==1){let O=V==Q;q=O?0:1;for(let H=U-3;H>=0;H-=3){let R=P1[H+2];if(R&2)break;if(O)P1[H+2]|=2;else{if(R&4)break;P1[H+2]|=4}}}}}function eY(Z,$,J,X){for(let Q=0,Y=X;Q<=J.length;Q++){let K=Q?J[Q-1].to:Z,U=Q<J.length?J[Q].from:$;for(let q=K;q<U;){let G=K0[q];if(G==256){let W=q+1;for(;;)if(W==U){if(Q==J.length)break;W=J[Q++].to,U=Q<J.length?J[Q].from:$}else if(K0[W]==256)W++;else break;let j=Y==1,_=(W<$?K0[W]:X)==1,z=j==_?j?1:2:X;for(let V=W,O=Q,H=O?J[O-1].to:Z;V>q;){if(V==H)V=J[--O].from,H=O?J[O-1].to:Z;K0[--V]=z}q=W}else Y=G,q++}}}function LZ(Z,$,J,X,Q,Y,K){let U=X%2?2:1;if(X%2==Q%2)for(let q=$,G=0;q<J;){let W=!0,j=!1;if(G==Y.length||q<Y[G].from){let O=K0[q];if(O!=U)W=!1,j=O==16}let _=!W&&U==1?[]:null,z=W?X:X+1,V=q;Z:for(;;)if(G<Y.length&&V==Y[G].from){if(j)break Z;let O=Y[G];if(!W)for(let H=O.to,R=G+1;;){if(H==J)break Z;if(R<Y.length&&Y[R].from==H)H=Y[R++].to;else if(K0[H]==U)break Z;else break}if(G++,_)_.push(O);else{if(O.from>q)K.push(new C1(q,O.from,z));let H=O.direction==G7!=!(z%2);BZ(Z,H?X+1:X,Q,O.inner,O.from,O.to,K),q=O.to}V=O.to}else if(V==J||(W?K0[V]!=U:K0[V]==U))break;else V++;if(_)LZ(Z,q,V,X+1,Q,_,K);else if(q<V)K.push(new C1(q,V,z));q=V}else for(let q=J,G=Y.length;q>$;){let W=!0,j=!1;if(!G||q>Y[G-1].to){let O=K0[q-1];if(O!=U)W=!1,j=O==16}let _=!W&&U==1?[]:null,z=W?X:X+1,V=q;Z:for(;;)if(G&&V==Y[G-1].to){if(j)break Z;let O=Y[--G];if(!W)for(let H=O.from,R=G;;){if(H==$)break Z;if(R&&Y[R-1].to==H)H=Y[--R].from;else if(K0[H-1]==U)break Z;else break}if(_)_.push(O);else{if(O.to<q)K.push(new C1(O.to,q,z));let H=O.direction==G7!=!(z%2);BZ(Z,H?X+1:X,Q,O.inner,O.from,O.to,K),q=O.from}V=O.from}else if(V==$||(W?K0[V-1]!=U:K0[V-1]==U))break;else V--;if(_)LZ(Z,V,q,X+1,Q,_,K);else if(V<q)K.push(new C1(V,q,z));q=V}}function BZ(Z,$,J,X,Q,Y,K){let U=$%2?2:1;oY(Z,Q,Y,X,U),tY(Z,Q,Y,X,U),eY(Q,Y,X,U),LZ(Z,Q,Y,$,J,X,K)}function ZK(Z,$,J){if(!Z)return[new C1(0,0,$==cZ?1:0)];if($==G7&&!J.length&&!rY.test(Z))return N3(Z.length);if(J.length)while(Z.length>K0.length)K0[K0.length]=256;let X=[],Q=$==G7?0:1;return BZ(Z,Q,Q,J,0,Z.length,X),X}function N3(Z){return[new C1(0,Z,0)]}var H3="";function $K(Z,$,J,X,Q){var Y;let K=X.head-Z.from,U=C1.find($,K,(Y=X.bidiLevel)!==null&&Y!==void 0?Y:-1,X.assoc),q=$[U],G=q.side(Q,J);if(K==G){let _=U+=Q?1:-1;if(_<0||_>=$.length)return null;q=$[U=_],K=q.side(!Q,J),G=q.side(Q,J)}let W=H0(Z.text,K,q.forward(Q,J));if(W<q.from||W>q.to)W=G;H3=Z.text.slice(Math.min(K,W),Math.max(K,W));let j=U==(Q?$.length-1:0)?null:$[U+(Q?1:-1)];if(j&&W==G&&j.level+(Q?0:1)<q.level)return A.cursor(j.side(!Q,J)+Z.from,j.forward(Q,J)?1:-1,j.level);return A.cursor(W+Z.from,q.forward(Q,J)?-1:1,q.level)}function JK(Z,$,J){for(let X=$;X<J;X++){let Q=O3(Z.charCodeAt(X));if(Q==1)return G7;if(Q==2||Q==4)return cZ}return G7}var I3=S.define(),R3=S.define(),F3=S.define(),D3=S.define(),EZ=S.define(),A3=S.define(),M3=S.define(),sZ=S.define(),nZ=S.define(),L3=S.define({combine:(Z)=>Z.some(($)=>$)}),B3=S.define({combine:(Z)=>Z.some(($)=>$)}),E3=S.define();class S7{constructor(Z,$="nearest",J="nearest",X=5,Q=5,Y=!1){this.range=Z,this.y=$,this.x=J,this.yMargin=X,this.xMargin=Q,this.isSnapshot=Y}map(Z){return Z.empty?this:new S7(this.range.map(Z),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(Z){return this.range.to<=Z.doc.length?this:new S7(A.cursor(Z.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}var z9=p.define({map:(Z,$)=>Z.map($)}),P3=p.define();function S0(Z,$,J){let X=Z.facet(D3);if(X.length)X[0]($);else if(window.onerror&&window.onerror(String($),J,void 0,void 0,$));else if(J)console.error(J+":",$);else console.error($)}var h1=S.define({combine:(Z)=>Z.length?Z[0]:!0}),XK=0,C7=S.define({combine(Z){return Z.filter(($,J)=>{for(let X=0;X<J;X++)if(Z[X].plugin==$.plugin)return!1;return!0})}});class j0{constructor(Z,$,J,X,Q){this.id=Z,this.create=$,this.domEventHandlers=J,this.domEventObservers=X,this.baseExtensions=Q(this),this.extension=this.baseExtensions.concat(C7.of({plugin:this,arg:void 0}))}of(Z){return this.baseExtensions.concat(C7.of({plugin:this,arg:Z}))}static define(Z,$){let{eventHandlers:J,eventObservers:X,provide:Q,decorations:Y}=$||{};return new j0(XK++,Z,J,X,(K)=>{let U=[];if(Y)U.push(g9.of((q)=>{let G=q.plugin(K);return G?Y(G):m.none}));if(Q)U.push(Q(K));return U})}static fromClass(Z,$){return j0.define((J,X)=>new Z(J,X),$)}}class M9{constructor(Z){this.spec=Z,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(Z){if(!this.value){if(this.spec)try{this.value=this.spec.plugin.create(Z,this.spec.arg)}catch($){S0(Z.state,$,"CodeMirror plugin crashed"),this.deactivate()}}else if(this.mustUpdate){let $=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update($)}catch(J){if(S0($.state,J,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(X){}this.deactivate()}}return this}destroy(Z){var $;if(($=this.value)===null||$===void 0?void 0:$.destroy)try{this.value.destroy()}catch(J){S0(Z.state,J,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}var C3=S.define(),iZ=S.define(),g9=S.define(),T3=S.define(),aZ=S.define(),B4=S.define(),y3=S.define();function E$(Z,$){let J=Z.state.facet(y3);if(!J.length)return J;let X=J.map((Y)=>Y instanceof Function?Y(Z):Y),Q=[];return i.spans(X,$.from,$.to,{point(){},span(Y,K,U,q){let G=Y-$.from,W=K-$.from,j=Q;for(let _=U.length-1;_>=0;_--,q--){let z=U[_].spec.bidiIsolate,V;if(z==null)z=JK($.text,G,W);if(q>0&&j.length&&(V=j[j.length-1]).to==G&&V.direction==z)V.to=W,j=V.inner;else{let O={from:G,to:W,direction:z,inner:[]};j.push(O),j=O.inner}}}}),Q}var k3=S.define();function rZ(Z){let $=0,J=0,X=0,Q=0;for(let Y of Z.state.facet(k3)){let K=Y(Z);if(K){if(K.left!=null)$=Math.max($,K.left);if(K.right!=null)J=Math.max(J,K.right);if(K.top!=null)X=Math.max(X,K.top);if(K.bottom!=null)Q=Math.max(Q,K.bottom)}}return{left:$,right:J,top:X,bottom:Q}}var G4=S.define();class $1{constructor(Z,$,J,X){this.fromA=Z,this.toA=$,this.fromB=J,this.toB=X}join(Z){return new $1(Math.min(this.fromA,Z.fromA),Math.max(this.toA,Z.toA),Math.min(this.fromB,Z.fromB),Math.max(this.toB,Z.toB))}addToSet(Z){let $=Z.length,J=this;for(;$>0;$--){let X=Z[$-1];if(X.fromA>J.toA)continue;if(X.toA<J.fromA)break;J=J.join(X),Z.splice($-1,1)}return Z.splice($,0,J),Z}static extendWithRanges(Z,$){if($.length==0)return Z;let J=[];for(let X=0,Q=0,Y=0;;){let K=X<Z.length?Z[X].fromB:1e9,U=Q<$.length?$[Q]:1e9,q=Math.min(K,U);if(q==1e9)break;let G=q+Y,W=q,j=G;for(;;)if(Q<$.length&&$[Q]<=W){let _=$[Q+1];Q+=2,W=Math.max(W,_);for(let z=X;z<Z.length&&Z[z].fromB<=W;z++)Y=Z[z].toA-Z[z].toB;j=Math.max(j,_+Y)}else if(X<Z.length&&Z[X].fromB<=W){let _=Z[X++];W=Math.max(W,_.toB),j=Math.max(j,_.toA),Y=_.toA-_.toB}else break;J.push(new $1(G,j,q,W))}return J}}class x9{constructor(Z,$,J){this.view=Z,this.state=$,this.transactions=J,this.flags=0,this.startState=Z.state,this.changes=D0.empty(this.startState.doc.length);for(let Q of J)this.changes=this.changes.compose(Q.changes);let X=[];this.changes.iterChangedRanges((Q,Y,K,U)=>X.push(new $1(Q,Y,K,U))),this.changedRanges=X}static create(Z,$,J){return new x9(Z,$,J)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((Z)=>Z.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var QK=[];class A0{constructor(Z,$,J=0){this.dom=Z,this.length=$,this.flags=J,this.parent=null,Z.cmTile=this}get breakAfter(){return this.flags&1}get children(){return QK}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(Z){if(this.flags|=2,this.flags&4){this.flags&=-5;let $=this.domAttrs;if($)fY(this.dom,$)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(Z){this.dom=Z,Z.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(Z,$=this.posAtStart){let J=$;for(let X of this.children){if(X==Z)return J;J+=X.length+X.breakAfter}throw RangeError("Invalid child in posBefore")}posAfter(Z){return this.posBefore(Z)+Z.length}covers(Z){return!0}coordsIn(Z,$){return null}domPosFor(Z,$){let J=d1(this.dom),X=this.length?Z>0:$>0;return new I1(this.parent.dom,J+(X?1:0),Z==0||Z==this.length)}markDirty(Z){if(this.flags&=-3,Z)this.flags|=4;if(this.parent&&this.parent.flags&2)this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let Z=this;Z;Z=Z.parent)if(Z instanceof P4)return Z;return null}static get(Z){return Z.cmTile}}class E4 extends A0{constructor(Z){super(Z,0);this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(Z){this.children.push(Z),Z.parent=this}sync(Z){if(this.flags&2)return;super.sync(Z);let $=this.dom,J=null,X,Q=(Z===null||Z===void 0?void 0:Z.node)==$?Z:null,Y=0;for(let K of this.children){if(K.sync(Z),Y+=K.length+K.breakAfter,X=J?J.nextSibling:$.firstChild,Q&&X!=K.dom)Q.written=!0;if(K.dom.parentNode==$)while(X&&X!=K.dom)X=P$(X);else $.insertBefore(K.dom,X);J=K.dom}if(X=J?J.nextSibling:$.firstChild,Q&&X)Q.written=!0;while(X)X=P$(X);this.length=Y}}function P$(Z){let $=Z.nextSibling;return Z.parentNode.removeChild(Z),$}class P4 extends E4{constructor(Z,$){super($);this.view=Z}owns(Z){for(;Z;Z=Z.parent)if(Z==this)return!0;return!1}isBlock(){return!0}nearest(Z){for(;;){if(!Z)return null;let $=A0.get(Z);if($&&this.owns($))return $;Z=Z.parentNode}}blockTiles(Z){for(let $=[],J=this,X=0,Q=0;;)if(X==J.children.length){if(!$.length)return;if(J=J.parent,J.breakAfter)Q++;X=$.pop()}else{let Y=J.children[X++];if(Y instanceof l1)$.push(X),J=Y,X=0;else{let K=Q+Y.length,U=Z(Y,Q);if(U!==void 0)return U;Q=K+Y.breakAfter}}}resolveBlock(Z,$){let J,X=-1,Q,Y=-1;if(this.blockTiles((K,U)=>{let q=U+K.length;if(Z>=U&&Z<=q){if(K.isWidget()&&$>=-1&&$<=1){if(K.flags&32)return!0;if(K.flags&16)J=void 0}if((U<Z||Z==q&&($<-1?K.length:K.covers(1)))&&(!J||!K.isWidget()&&J.isWidget()))J=K,X=Z-U;if((q>Z||Z==U&&($>1?K.length:K.covers(-1)))&&(!Q||!K.isWidget()&&Q.isWidget()))Q=K,Y=Z-U}}),!J&&!Q)throw Error("No tile at position "+Z);return J&&$<0||!Q?{tile:J,offset:X}:{tile:Q,offset:Y}}}class l1 extends E4{constructor(Z,$){super(Z);this.wrapper=$}isBlock(){return!0}covers(Z){if(!this.children.length)return!1;return Z<0?this.children[0].covers(-1):this.lastChild.covers(1)}get domAttrs(){return this.wrapper.attributes}static of(Z,$){let J=new l1($||document.createElement(Z.tagName),Z);if(!$)J.flags|=4;return J}}class x7 extends E4{constructor(Z,$){super(Z);this.attrs=$}isLine(){return!0}static start(Z,$,J){let X=new x7($||document.createElement("div"),Z);if(!$||!J)X.flags|=4;return X}get domAttrs(){return this.attrs}resolveInline(Z,$,J){let X=null,Q=-1,Y=null,K=-1;function U(G,W){for(let j=0,_=0;j<G.children.length&&_<=W;j++){let z=G.children[j],V=_+z.length;if(V>=W){if(z.isComposite())U(z,W-_);else if((!Y||Y.isHidden&&($>0||J&&KK(Y,z)))&&(V>W||z.flags&32))Y=z,K=W-_;else if(_<W||z.flags&16&&!z.isHidden)X=z,Q=W-_}_=V}}U(this,Z);let q=($<0?X:Y)||X||Y;return q?{tile:q,offset:q==X?Q:K}:null}coordsIn(Z,$){let J=this.resolveInline(Z,$,!0);if(!J)return YK(this);return J.tile.coordsIn(Math.max(0,J.offset),$)}domIn(Z,$){let J=this.resolveInline(Z,$);if(J){let{tile:X,offset:Q}=J;if(this.dom.contains(X.dom)){if(X.isText())return new I1(X.dom,Math.min(X.dom.nodeValue.length,Q));return X.domPosFor(Q,X.flags&16?1:X.flags&32?-1:$)}let Y=J.tile.parent,K=!1;for(let U of Y.children){if(K)return new I1(U.dom,0);if(U==J.tile)K=!0}}return new I1(this.dom,0)}}function YK(Z){let $=Z.dom.lastChild;if(!$)return Z.dom.getBoundingClientRect();let J=A9($);return J[J.length-1]||null}function KK(Z,$){let J=Z.coordsIn(0,1),X=$.coordsIn(0,1);return J&&X&&X.top<J.bottom}class p0 extends E4{constructor(Z,$){super(Z);this.mark=$}get domAttrs(){return this.mark.attrs}static of(Z,$){let J=new p0($||document.createElement(Z.tagName),Z);if(!$)J.flags|=4;return J}}class U7 extends A0{constructor(Z,$){super(Z,$.length);this.text=$}sync(Z){if(this.flags&2)return;if(super.sync(Z),this.dom.nodeValue!=this.text){if(Z&&Z.node==this.dom)Z.written=!0;this.dom.nodeValue=this.text}}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(Z,$){let J=this.dom.nodeValue.length;if(Z>J)Z=J;let X=Z,Q=Z,Y=0;if(Z==0&&$<0||Z==J&&$>=0){if(!(x.chrome||x.gecko)){if(Z)X--,Y=1;else if(Q<J)Q++,Y=-1}}else if($<0)X--;else if(Q<J)Q++;let K=F4(this.dom,X,Q).getClientRects();if(!K.length)return null;let U=K[(Y?Y<0:$>=0)?0:K.length-1];if(x.safari&&!Y&&U.width==0)U=Array.prototype.find.call(K,(q)=>q.width)||U;return Y?b9(U,Y<0):U||null}static of(Z,$){let J=new U7($||document.createTextNode(Z),Z);if(!$)J.flags|=2;return J}}class W7 extends A0{constructor(Z,$,J,X){super(Z,$,X);this.widget=J}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(Z){if(this.flags&48)return!1;return(this.flags&(Z<0?64:128))>0}coordsIn(Z,$){return this.coordsInWidget(Z,$,!1)}coordsInWidget(Z,$,J){let X=this.widget.coordsAt(this.dom,Z,$);if(X)return X;if(J)return b9(this.dom.getBoundingClientRect(),this.length?Z==0:$<=0);else{let Q=this.dom.getClientRects(),Y=null;if(!Q.length)return null;let K=this.flags&16?!0:this.flags&32?!1:Z>0;for(let U=K?Q.length-1:0;;U+=K?-1:1)if(Y=Q[U],Z>0?U==0:U==Q.length-1||Y.top<Y.bottom)break;return b9(Y,!K)}}get overrideDOMText(){if(!this.length)return e.empty;let{root:Z}=this;if(!Z)return e.empty;let $=this.posAtStart;return Z.view.state.doc.slice($,$+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(Z,$,J,X,Q){if(!Q){if(Q=Z.toDOM($),!Z.editable)Q.contentEditable="false"}return new W7(Q,J,Z,X)}}class D4 extends A0{constructor(Z){let $=document.createElement("img");$.className="cm-widgetBuffer",$.setAttribute("aria-hidden","true");super($,0,Z)}get isHidden(){return!0}get overrideDOMText(){return e.empty}coordsIn(Z){return this.dom.getBoundingClientRect()}}class S3{constructor(Z){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=Z}advance(Z,$,J){let{tile:X,index:Q,beforeBreak:Y,parents:K}=this;while(Z||$>0)if(!X.isComposite())if(Q==X.length)Y=!!X.breakAfter,{tile:X,index:Q}=K.pop(),Q++;else if(!Z)break;else{let U=Math.min(Z,X.length-Q);if(J)J.skip(X,Q,Q+U);Z-=U,Q+=U}else if(Y){if(!Z)break;if(J)J.break();Z--,Y=!1}else if(Q==X.children.length){if(!Z&&!K.length)break;if(J)J.leave(X);Y=!!X.breakAfter,{tile:X,index:Q}=K.pop(),Q++}else{let U=X.children[Q],q=U.breakAfter;if(($>0?U.length<=Z:U.length<Z)&&(!J||J.skip(U,0,U.length)!==!1||!U.isComposite))Y=!!q,Q++,Z-=U.length;else if(K.push({tile:X,index:Q}),X=U,Q=0,J&&U.isComposite())J.enter(U)}return this.tile=X,this.index=Q,this.beforeBreak=Y,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class b3{constructor(Z,$,J,X){this.from=Z,this.to=$,this.wrapper=J,this.rank=X}}class x3{constructor(Z,$,J){this.cache=Z,this.root=$,this.blockWrappers=J,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(Z,$,J,X){var Q;this.flushBuffer();let Y=this.ensureMarks($,J),K=Y.lastChild;if(K&&K.isText()&&!(K.flags&8)){this.cache.reused.set(K,2);let U=Y.children[Y.children.length-1]=new U7(K.dom,K.text+Z);U.parent=Y}else Y.append(X||U7.of(Z,(Q=this.cache.find(U7))===null||Q===void 0?void 0:Q.dom));this.pos+=Z.length,this.afterWidget=null}addComposition(Z,$){let J=this.curLine;if(J.dom!=$.line.dom)J.setDOM(this.cache.reused.has($.line)?WZ($.line.dom):$.line.dom),this.cache.reused.set($.line,2);let X=J;for(let K=$.marks.length-1;K>=0;K--){let U=$.marks[K],q=X.lastChild;if(q instanceof p0&&q.mark.eq(U.mark)){if(q.dom!=U.dom)q.setDOM(WZ(U.dom));X=q}else{if(this.cache.reused.get(U)){let W=A0.get(U.dom);if(W)W.setDOM(WZ(U.dom))}let G=p0.of(U.mark,U.dom);X.append(G),X=G}this.cache.reused.set(U,2)}let Q=A0.get(Z.text);if(Q)this.cache.reused.set(Q,2);let Y=new U7(Z.text,Z.text.nodeValue);Y.flags|=8,X.append(Y)}addInlineWidget(Z,$,J){let X=this.afterWidget&&Z.flags&48&&(this.afterWidget.flags&48)==(Z.flags&48);if(!X)this.flushBuffer();let Q=this.ensureMarks($,J);if(!X&&!(Z.flags&16))Q.append(this.getBuffer(1));Q.append(Z),this.pos+=Z.length,this.afterWidget=Z}addMark(Z,$,J){this.flushBuffer(),this.ensureMarks($,J).append(Z),this.pos+=Z.length,this.afterWidget=null}addBlockWidget(Z){this.getBlockPos().append(Z),this.pos+=Z.length,this.lastBlock=Z,this.endLine()}continueWidget(Z){let $=this.afterWidget||this.lastBlock;$.length+=Z,this.pos+=Z}addLineStart(Z,$){var J;if(!Z)Z=u3;let X=x7.start(Z,$||((J=this.cache.find(x7))===null||J===void 0?void 0:J.dom),!!$);this.getBlockPos().append(this.lastBlock=this.curLine=X)}addLine(Z){this.getBlockPos().append(Z),this.pos+=Z.length,this.lastBlock=Z,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(Z){if(!this.blockPosCovered())this.addLineStart(Z)}ensureLine(Z){if(!this.curLine)this.addLineStart(Z)}ensureMarks(Z,$){var J;let X=this.curLine;for(let Q=Z.length-1;Q>=0;Q--){let Y=Z[Q],K;if($>0&&(K=X.lastChild)&&K instanceof p0&&K.mark.eq(Y))X=K,$--;else{let U=p0.of(Y,(J=this.cache.find(p0,(q)=>q.mark.eq(Y)))===null||J===void 0?void 0:J.dom);X.append(U),X=U,$=0}}return X}endLine(){if(this.curLine){this.flushBuffer();let Z=this.curLine.lastChild;if(!Z||!C$(this.curLine,!1)||Z.dom.nodeName!="BR"&&Z.isWidget()&&!(x.ios&&C$(this.curLine,!0)))this.curLine.append(this.cache.findWidget(jZ,0,32)||new W7(jZ.toDOM(),0,jZ,32));this.curLine=this.afterWidget=null}}updateBlockWrappers(){if(this.wrapperPos>this.pos+1e4)this.blockWrappers.goto(this.pos),this.wrappers.length=0;for(let Z=this.wrappers.length-1;Z>=0;Z--)if(this.wrappers[Z].to<this.pos)this.wrappers.splice(Z,1);for(let Z=this.blockWrappers;Z.value&&Z.from<=this.pos;Z.next())if(Z.to>=this.pos){let $=new b3(Z.from,Z.to,Z.value,Z.rank),J=this.wrappers.length;while(J>0&&(this.wrappers[J-1].rank-$.rank||this.wrappers[J-1].to-$.to)<0)J--;this.wrappers.splice(J,0,$)}this.wrapperPos=this.pos}getBlockPos(){var Z;this.updateBlockWrappers();let $=this.root;for(let J of this.wrappers){let X=$.lastChild;if(J.from<this.pos&&X instanceof l1&&X.wrapper.eq(J.wrapper))$=X;else{let Q=l1.of(J.wrapper,(Z=this.cache.find(l1,(Y)=>Y.wrapper.eq(J.wrapper)))===null||Z===void 0?void 0:Z.dom);$.append(Q),$=Q}}return $}blockPosCovered(){let Z=this.lastBlock;return Z!=null&&!Z.breakAfter&&(!Z.isWidget()||(Z.flags&160)>0)}getBuffer(Z){let $=2|(Z<0?16:32),J=this.cache.find(D4,void 0,1);if(J)J.flags=$;return J||new D4($)}flushBuffer(){if(this.afterWidget&&!(this.afterWidget.flags&32))this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null}}class w3{constructor(Z){this.skipCount=0,this.text="",this.textOff=0,this.cursor=Z.iter()}skip(Z){if(this.textOff+Z<=this.text.length)this.textOff+=Z;else this.skipCount+=Z-(this.text.length-this.textOff),this.text="",this.textOff=0}next(Z){if(this.textOff==this.text.length){let{value:X,lineBreak:Q,done:Y}=this.cursor.next(this.skipCount);if(this.skipCount=0,Y)throw Error("Ran out of text content when drawing inline views");this.text=X;let K=this.textOff=Math.min(Z,X.length);return Q?null:X.slice(0,K)}let $=Math.min(this.text.length,this.textOff+Z),J=this.text.slice(this.textOff,$);return this.textOff=$,J}}var w9=[W7,x7,U7,p0,D4,l1,P4];for(let Z=0;Z<w9.length;Z++)w9[Z].bucket=Z;class h3{constructor(Z){this.view=Z,this.buckets=w9.map(()=>[]),this.index=w9.map(()=>0),this.reused=new Map}add(Z){let $=Z.constructor.bucket,J=this.buckets[$];if(J.length<6)J.push(Z);else J[this.index[$]=(this.index[$]+1)%6]=Z}find(Z,$,J=2){let X=Z.bucket,Q=this.buckets[X],Y=this.index[X];for(let K=Q.length-1;K>=0;K--){let U=(K+Y)%Q.length,q=Q[U];if((!$||$(q))&&!this.reused.has(q)){if(Q.splice(U,1),U<Y)this.index[X]--;return this.reused.set(q,J),q}}return null}findWidget(Z,$,J){let X=this.buckets[0];if(X.length)for(let Q=0,Y=0;;Q++){if(Q==X.length){if(Y)return null;Y=1,Q=0}let K=X[Q];if(!this.reused.has(K)&&(Y==0?K.widget.compare(Z):K.widget.constructor==Z.constructor&&Z.updateDOM(K.dom,this.view))){if(X.splice(Q,1),Q<this.index[0])this.index[0]--;if(K.widget==Z&&K.length==$&&(K.flags&497)==J)return this.reused.set(K,1),K;else return this.reused.set(K,2),new W7(K.dom,$,Z,K.flags&-498|J)}}}reuse(Z){return this.reused.set(Z,1),Z}maybeReuse(Z,$=2){if(this.reused.has(Z))return;return this.reused.set(Z,$),Z.dom}clear(){for(let Z=0;Z<this.buckets.length;Z++)this.buckets[Z].length=this.index[Z]=0}}class v3{constructor(Z,$,J,X,Q){this.view=Z,this.decorations=X,this.disallowBlockEffectsFor=Q,this.openWidget=!1,this.openMarks=0,this.cache=new h3(Z),this.text=new w3(Z.state.doc),this.builder=new x3(this.cache,new P4(Z,Z.contentDOM),i.iter(J)),this.cache.reused.set($,2),this.old=new S3($),this.reuseWalker={skip:(Y,K,U)=>{if(this.cache.add(Y),Y.isComposite())return!1},enter:(Y)=>this.cache.add(Y),leave:()=>{},break:()=>{}}}run(Z,$){let J=$&&this.getCompositionContext($.text);for(let X=0,Q=0,Y=0;;){let K=Y<Z.length?Z[Y++]:null,U=K?K.fromA:this.old.root.length;if(U>X){let q=U-X;this.preserve(q,!Y,!K),X=U,Q+=q}if(!K)break;if($&&K.fromA<=$.range.fromA&&K.toA>=$.range.toA)this.forward(K.fromA,$.range.fromA,$.range.fromA<$.range.toA?1:-1),this.emit(Q,$.range.fromB),this.cache.clear(),this.builder.addComposition($,J),this.text.skip($.range.toB-$.range.fromB),this.forward($.range.fromA,K.toA),this.emit($.range.toB,K.toB);else this.forward(K.fromA,K.toA),this.emit(Q,K.toB);Q=K.toB,X=K.toA}if(this.builder.curLine)this.builder.endLine();return this.builder.root}preserve(Z,$,J){let X=GK(this.old),Q=this.openMarks;this.old.advance(Z,J?1:-1,{skip:(Y,K,U)=>{if(Y.isWidget())if(this.openWidget)this.builder.continueWidget(U-K);else{let q=U>0||K<Y.length?W7.of(Y.widget,this.view,U-K,Y.flags&496,this.cache.maybeReuse(Y)):this.cache.reuse(Y);if(q.flags&256)q.flags&=-2,this.builder.addBlockWidget(q);else this.builder.ensureLine(null),this.builder.addInlineWidget(q,X,Q),Q=X.length}else if(Y.isText()){if(this.builder.ensureLine(null),!K&&U==Y.length)this.builder.addText(Y.text,X,Q,this.cache.reuse(Y));else this.cache.add(Y),this.builder.addText(Y.text.slice(K,U),X,Q);Q=X.length}else if(Y.isLine())Y.flags&=-2,this.cache.reused.set(Y,1),this.builder.addLine(Y);else if(Y instanceof D4)this.cache.add(Y);else if(Y instanceof p0)this.builder.ensureLine(null),this.builder.addMark(Y,X,Q),this.cache.reused.set(Y,1),Q=X.length;else return!1;this.openWidget=!1},enter:(Y)=>{if(Y.isLine())this.builder.addLineStart(Y.attrs,this.cache.maybeReuse(Y));else if(this.cache.add(Y),Y instanceof p0)X.unshift(Y.mark);this.openWidget=!1},leave:(Y)=>{if(Y.isLine()){if(X.length)X.length=Q=0}else if(Y instanceof p0)X.shift(),Q=Math.min(Q,X.length)},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(Z)}emit(Z,$){let J=null,X=this.builder,Q=0,Y=i.spans(this.decorations,Z,$,{point:(K,U,q,G,W,j)=>{if(q instanceof q7){if(this.disallowBlockEffectsFor[j]){if(q.block)throw RangeError("Block decorations may not be specified via plugins");if(U>this.view.state.doc.lineAt(K).to)throw RangeError("Decorations that replace line breaks may not be specified via plugins")}if(Q=G.length,W>G.length)X.continueWidget(U-K);else{let _=q.widget||(q.block?j7.block:j7.inline),z=UK(q),V=this.cache.findWidget(_,U-K,z)||W7.of(_,this.view,U-K,z);if(q.block){if(q.startSide>0)X.addLineStartIfNotCovered(J);X.addBlockWidget(V)}else X.ensureLine(J),X.addInlineWidget(V,G,W)}J=null}else J=qK(J,q);if(U>K)this.text.skip(U-K)},span:(K,U,q,G)=>{for(let W=K;W<U;){let j=this.text.next(Math.min(512,U-W));if(j==null)X.addLineStartIfNotCovered(J),X.addBreak(),W++;else X.ensureLine(J),X.addText(j,q,G),W+=j.length;J=null}}});X.addLineStartIfNotCovered(J),this.openWidget=Y>Q,this.openMarks=Y}forward(Z,$,J=1){if($-Z<=10)this.old.advance($-Z,J,this.reuseWalker);else this.old.advance(5,-1,this.reuseWalker),this.old.advance($-Z-10,-1),this.old.advance(5,J,this.reuseWalker)}getCompositionContext(Z){let $=[],J=null;for(let X=Z.parentNode;;X=X.parentNode){let Q=A0.get(X);if(X==this.view.contentDOM)break;if(Q instanceof p0)$.push(Q);else if(Q===null||Q===void 0?void 0:Q.isLine())J=Q;else if(X.nodeName=="DIV"&&!J&&X!=this.view.contentDOM)J=new x7(X,u3);else $.push(p0.of(new M4({tagName:X.nodeName.toLowerCase(),attributes:gY(X)}),X))}return{line:J,marks:$}}}function C$(Z,$){let J=(X)=>{for(let Q of X.children)if(($?Q.isText():Q.length)||J(Q))return!0;return!1};return J(Z)}function UK(Z){let $=Z.isReplace?(Z.startSide<0?64:0)|(Z.endSide>0?128:0):Z.startSide>0?32:16;if(Z.block)$|=256;return $}var u3={class:"cm-line"};function qK(Z,$){let J=$.spec.attributes,X=$.spec.class;if(!J&&!X)return Z;if(!Z)Z={class:"cm-line"};if(J)lZ(J,Z);if(X)Z.class+=" "+X;return Z}function GK(Z){let $=[];for(let J=Z.parents.length;J>1;J--){let X=J==Z.parents.length?Z.tile:Z.parents[J].tile;if(X instanceof p0)$.push(X.mark)}return $}function WZ(Z){let $=A0.get(Z);if($)$.setDOM(Z.cloneNode());return Z}class j7 extends r0{constructor(Z){super();this.tag=Z}eq(Z){return Z.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(Z){return Z.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}j7.inline=new j7("span");j7.block=new j7("div");var jZ=new class extends r0{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class PZ{constructor(Z){this.view=Z,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=m.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new P4(Z,Z.contentDOM),this.updateInner([new $1(0,0,0,Z.state.doc.length)],null)}update(Z){var $;let J=Z.changedRanges;if(this.minWidth>0&&J.length)if(!J.every(({fromA:G,toA:W})=>W<this.minWidthFrom||G>this.minWidthTo))this.minWidth=this.minWidthFrom=this.minWidthTo=0;else this.minWidthFrom=Z.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=Z.changes.mapPos(this.minWidthTo,1);this.updateEditContextFormatting(Z);let X=-1;if(this.view.inputState.composing>=0&&!this.view.observer.editContext){if(($=this.domChanged)===null||$===void 0?void 0:$.newSel)X=this.domChanged.newSel.head;else if(!HK(Z.changes,this.hasComposition)&&!Z.selectionSet)X=Z.state.selection.main.head}let Q=X>-1?jK(this.view,Z.changes,X):null;if(this.domChanged=null,this.hasComposition){let{from:G,to:W}=this.hasComposition;J=new $1(G,W,Z.changes.mapPos(G,-1),Z.changes.mapPos(W,1)).addToSet(J.slice())}if(this.hasComposition=Q?{from:Q.range.fromB,to:Q.range.toB}:null,(x.ie||x.chrome)&&!Q&&Z&&Z.state.doc.lines!=Z.startState.doc.lines)this.forceSelection=!0;let Y=this.decorations,K=this.blockWrappers;this.updateDeco();let U=OK(Y,this.decorations,Z.changes);if(U.length)J=$1.extendWithRanges(J,U);let q=VK(K,this.blockWrappers,Z.changes);if(q.length)J=$1.extendWithRanges(J,q);if(Q&&!J.some((G)=>G.fromA<=Q.range.fromA&&G.toA>=Q.range.toA))J=Q.range.addToSet(J.slice());if(this.tile.flags&2&&J.length==0)return!1;else{if(this.updateInner(J,Q),Z.transactions.length)this.lastUpdate=Date.now();return!0}}updateInner(Z,$){this.view.viewState.mustMeasureContent=!0;let{observer:J}=this.view;J.ignore(()=>{if($||Z.length){let Y=this.tile,K=new v3(this.view,Y,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=K.run(Z,$),CZ(Y,K.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let Q=x.chrome||x.ios?{node:J.selectionRange.focusNode,written:!1}:void 0;if(this.tile.sync(Q),Q&&(Q.written||J.selectionRange.focusNode!=Q.node||!this.tile.dom.contains(Q.node)))this.forceSelection=!0;this.tile.dom.style.height=""});let X=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length){for(let Q of this.tile.children)if(Q.isWidget()&&Q.widget instanceof L9)X.push(Q.dom)}J.updateGaps(X)}updateEditContextFormatting(Z){this.editContextFormatting=this.editContextFormatting.map(Z.changes);for(let $ of Z.transactions)for(let J of $.effects)if(J.is(P3))this.editContextFormatting=J.value}updateSelection(Z=!1,$=!1){if(Z||!this.view.observer.selectionRange.focusNode)this.view.observer.readSelectionRange();let{dom:J}=this.tile,X=this.view.root.activeElement,Q=X==J,Y=!Q&&!(this.view.state.facet(h1)||J.tabIndex>-1)&&V4(J,this.view.observer.selectionRange)&&!(X&&J.contains(X));if(!(Q||$||Y))return;let K=this.forceSelection;this.forceSelection=!1;let U=this.view.state.selection.main,q,G;if(U.empty)G=q=this.inlineDOMNearPos(U.anchor,U.assoc||1);else G=this.inlineDOMNearPos(U.head,U.head==U.from?1:-1),q=this.inlineDOMNearPos(U.anchor,U.anchor==U.from?1:-1);if(x.gecko&&U.empty&&!this.hasComposition&&WK(q)){let j=document.createTextNode("");this.view.observer.ignore(()=>q.node.insertBefore(j,q.node.childNodes[q.offset]||null)),q=G=new I1(j,0),K=!0}let W=this.view.observer.selectionRange;if(K||!W.focusNode||(!N4(q.node,q.offset,W.anchorNode,W.anchorOffset)||!N4(G.node,G.offset,W.focusNode,W.focusOffset))&&!this.suppressWidgetCursorChange(W,U))this.view.observer.ignore(()=>{if(x.android&&x.chrome&&J.contains(W.focusNode)&&NK(W.focusNode,J))J.blur(),J.focus({preventScroll:!0});let j=b7(this.view.root);if(!j);else if(U.empty){if(x.gecko){let _=_K(q.node,q.offset);if(_&&_!=3){let z=(_==1?j3:_3)(q.node,q.offset);if(z)q=new I1(z.node,z.offset)}}if(j.collapse(q.node,q.offset),U.bidiLevel!=null&&j.caretBidiLevel!==void 0)j.caretBidiLevel=U.bidiLevel}else if(j.extend){j.collapse(q.node,q.offset);try{j.extend(G.node,G.offset)}catch(_){}}else{let _=document.createRange();if(U.anchor>U.head)[q,G]=[G,q];_.setEnd(G.node,G.offset),_.setStart(q.node,q.offset),j.removeAllRanges(),j.addRange(_)}if(Y&&this.view.root.activeElement==J){if(J.blur(),X)X.focus()}}),this.view.observer.setSelectionRange(q,G);this.impreciseAnchor=q.precise?null:new I1(W.anchorNode,W.anchorOffset),this.impreciseHead=G.precise?null:new I1(W.focusNode,W.focusOffset)}suppressWidgetCursorChange(Z,$){return this.hasComposition&&$.empty&&N4(Z.focusNode,Z.focusOffset,Z.anchorNode,Z.anchorOffset)&&this.posFromDOM(Z.focusNode,Z.focusOffset)==$.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:Z}=this,$=Z.state.selection.main,J=b7(Z.root),{anchorNode:X,anchorOffset:Q}=Z.observer.selectionRange;if(!J||!$.empty||!$.assoc||!J.modify)return;let Y=this.lineAt($.head,$.assoc);if(!Y)return;let K=Y.posAtStart;if($.head==K||$.head==K+Y.length)return;let U=this.coordsAt($.head,-1),q=this.coordsAt($.head,1);if(!U||!q||U.bottom>q.top)return;let G=this.domAtPos($.head+$.assoc,$.assoc);J.collapse(G.node,G.offset),J.modify("move",$.assoc<0?"forward":"backward","lineboundary"),Z.observer.readSelectionRange();let W=Z.observer.selectionRange;if(Z.docView.posFromDOM(W.anchorNode,W.anchorOffset)!=$.from)J.collapse(X,Q)}posFromDOM(Z,$){let J=this.tile.nearest(Z);if(!J)return this.tile.dom.compareDocumentPosition(Z)&2?0:this.view.state.doc.length;let X=J.posAtStart;if(J.isComposite()){let Q;if(Z==J.dom)Q=J.dom.childNodes[$];else{let Y=v1(Z)==0?0:$==0?-1:1;for(;;){let K=Z.parentNode;if(K==J.dom)break;if(Y==0&&K.firstChild!=K.lastChild)if(Z==K.firstChild)Y=-1;else Y=1;Z=K}if(Y<0)Q=Z;else Q=Z.nextSibling}if(Q==J.dom.firstChild)return X;while(Q&&!A0.get(Q))Q=Q.nextSibling;if(!Q)return X+J.length;for(let Y=0,K=X;;Y++){let U=J.children[Y];if(U.dom==Q)return K;K+=U.length+U.breakAfter}}else if(J.isText())return Z==J.dom?X+$:X+($?J.length:0);else return X}domAtPos(Z,$){let{tile:J,offset:X}=this.tile.resolveBlock(Z,$);if(J.isWidget())return J.domPosFor(Z,$);return J.domIn(X,$)}inlineDOMNearPos(Z,$){let J,X=-1,Q=!1,Y,K=-1,U=!1;if(this.tile.blockTiles((q,G)=>{if(q.isWidget()){if(q.flags&32&&G>=Z)return!0;if(q.flags&16)Q=!0}else{let W=G+q.length;if(G<=Z)J=q,X=Z-G,Q=W<Z;if(W>=Z&&!Y)Y=q,K=Z-G,U=G>Z;if(G>Z&&Y)return!0}}),!J&&!Y)return this.domAtPos(Z,$);if(Q&&Y)J=null;else if(U&&J)Y=null;return J&&$<0||!Y?J.domIn(X,$):Y.domIn(K,$)}coordsAt(Z,$){let{tile:J,offset:X}=this.tile.resolveBlock(Z,$);if(J.isWidget()){if(J.widget instanceof L9)return null;return J.coordsInWidget(X,$,!0)}return J.coordsIn(X,$)}lineAt(Z,$){let{tile:J}=this.tile.resolveBlock(Z,$);return J.isLine()?J:null}coordsForChar(Z){let{tile:$,offset:J}=this.tile.resolveBlock(Z,1);if(!$.isLine())return null;function X(Q,Y){if(Q.isComposite())for(let K of Q.children){if(K.length>=Y){let U=X(K,Y);if(U)return U}if(Y-=K.length,Y<0)break}else if(Q.isText()&&Y<Q.length){let K=H0(Q.text,Y);if(K==Y)return null;let U=F4(Q.dom,Y,K).getClientRects();for(let q=0;q<U.length;q++){let G=U[q];if(q==U.length-1||G.top<G.bottom&&G.left<G.right)return G}}return null}return X($,J)}measureVisibleLineHeights(Z){let $=[],{from:J,to:X}=Z,Q=this.view.contentDOM.clientWidth,Y=Q>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,K=-1,U=this.view.textDirection==Q0.LTR,q=0,G=(W,j,_)=>{for(let z=0;z<W.children.length;z++){if(j>X)break;let V=W.children[z],O=j+V.length,H=V.dom.getBoundingClientRect(),{height:R}=H;if(_&&!z)q+=H.top-_.top;if(V instanceof l1){if(O>J)G(V,j,H)}else if(j>=J){if(q>0)$.push(-q);if($.push(R+q),q=0,Y){let D=V.dom.lastChild,M=D?A9(D):[];if(M.length){let L=M[M.length-1],B=U?L.right-H.left:H.right-L.left;if(B>K)K=B,this.minWidth=Q,this.minWidthFrom=j,this.minWidthTo=O}}}if(_&&z==W.children.length-1)q+=_.bottom-H.bottom;j=O+V.breakAfter}};return G(this.tile,0,null),$}textDirectionAt(Z){let{tile:$}=this.tile.resolveBlock(Z,1);return getComputedStyle($.dom).direction=="rtl"?Q0.RTL:Q0.LTR}measureTextSize(){let Z=this.tile.blockTiles((Y)=>{if(Y.isLine()&&Y.children.length&&Y.length<=20){let K=0,U;for(let q of Y.children){if(!q.isText()||/[^ -~]/.test(q.text))return;let G=A9(q.dom);if(G.length!=1)return;K+=G[0].width,U=G[0].height}if(K)return{lineHeight:Y.dom.getBoundingClientRect().height,charWidth:K/Y.length,textHeight:U}}});if(Z)return Z;let $=document.createElement("div"),J,X,Q;return $.className="cm-line",$.style.width="99999px",$.style.position="absolute",$.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild($);let Y=A9($.firstChild)[0];J=$.getBoundingClientRect().height,X=Y&&Y.width?Y.width/27:7,Q=Y&&Y.height?Y.height:J,$.remove()}),{lineHeight:J,charWidth:X,textHeight:Q}}computeBlockGapDeco(){let Z=[],$=this.view.viewState;for(let J=0,X=0;;X++){let Q=X==$.viewports.length?null:$.viewports[X],Y=Q?Q.from-1:this.view.state.doc.length;if(Y>J){let K=($.lineBlockAt(Y).bottom-$.lineBlockAt(J).top)/this.view.scaleY;Z.push(m.replace({widget:new L9(K),block:!0,inclusive:!0,isBlockGap:!0}).range(J,Y))}if(!Q)break;J=Q.to+1}return m.set(Z)}updateDeco(){let Z=1,$=this.view.state.facet(g9).map((Q)=>{return(this.dynamicDecorationMap[Z++]=typeof Q=="function")?Q(this.view):Q}),J=!1,X=this.view.state.facet(aZ).map((Q,Y)=>{let K=typeof Q=="function";if(K)J=!0;return K?Q(this.view):Q});if(X.length)this.dynamicDecorationMap[Z++]=J,$.push(i.join(X));this.decorations=[this.editContextFormatting,...$,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];while(Z<this.decorations.length)this.dynamicDecorationMap[Z++]=!1;this.blockWrappers=this.view.state.facet(T3).map((Q)=>typeof Q=="function"?Q(this.view):Q)}scrollIntoView(Z){if(Z.isSnapshot){let q=this.view.viewState.lineBlockAt(Z.range.head);this.view.scrollDOM.scrollTop=q.top-Z.yMargin,this.view.scrollDOM.scrollLeft=Z.xMargin;return}for(let q of this.view.state.facet(E3))try{if(q(this.view,Z.range,Z))return!0}catch(G){S0(this.view.state,G,"scroll handler")}let{range:$}=Z,J=this.coordsAt($.head,$.empty?$.assoc:$.head>$.anchor?-1:1),X;if(!J)return;if(!$.empty&&(X=this.coordsAt($.anchor,$.anchor>$.head?-1:1)))J={left:Math.min(J.left,X.left),top:Math.min(J.top,X.top),right:Math.max(J.right,X.right),bottom:Math.max(J.bottom,X.bottom)};let Q=rZ(this.view),Y={left:J.left-Q.left,top:J.top-Q.top,right:J.right+Q.right,bottom:J.bottom+Q.bottom},{offsetWidth:K,offsetHeight:U}=this.view.scrollDOM;dY(this.view.scrollDOM,Y,$.head<$.anchor?-1:1,Z.x,Z.y,Math.max(Math.min(Z.xMargin,K),-K),Math.max(Math.min(Z.yMargin,U),-U),this.view.textDirection==Q0.LTR)}lineHasWidget(Z){let $=(J)=>J.isWidget()||J.children.some($);return $(this.tile.resolveBlock(Z,1).tile)}destroy(){CZ(this.tile)}}function CZ(Z,$){let J=$===null||$===void 0?void 0:$.get(Z);if(J!=1){if(J==null)Z.destroy();for(let X of Z.children)CZ(X,$)}}function WK(Z){return Z.node.nodeType==1&&Z.node.firstChild&&(Z.offset==0||Z.node.childNodes[Z.offset-1].contentEditable=="false")&&(Z.offset==Z.node.childNodes.length||Z.node.childNodes[Z.offset].contentEditable=="false")}function m3(Z,$){let J=Z.observer.selectionRange;if(!J.focusNode)return null;let X=j3(J.focusNode,J.focusOffset),Q=_3(J.focusNode,J.focusOffset),Y=X||Q;if(Q&&X&&Q.node!=X.node){let U=A0.get(Q.node);if(!U||U.isText()&&U.text!=Q.node.nodeValue)Y=Q;else if(Z.docView.lastCompositionAfterCursor){let q=A0.get(X.node);if(!(!q||q.isText()&&q.text!=X.node.nodeValue))Y=Q}}if(Z.docView.lastCompositionAfterCursor=Y!=X,!Y)return null;let K=$-Y.offset;return{from:K,to:K+Y.node.nodeValue.length,node:Y.node}}function jK(Z,$,J){let X=m3(Z,J);if(!X)return null;let{node:Q,from:Y,to:K}=X,U=Q.nodeValue;if(/[\n\r]/.test(U))return null;if(Z.state.doc.sliceString(X.from,X.to)!=U)return null;let q=$.invertedDesc;return{range:new $1(q.mapPos(Y),q.mapPos(K),Y,K),text:Q}}function _K(Z,$){if(Z.nodeType!=1)return 0;return($&&Z.childNodes[$-1].contentEditable=="false"?1:0)|($<Z.childNodes.length&&Z.childNodes[$].contentEditable=="false"?2:0)}var zK=class{constructor(){this.changes=[]}compareRange($,J){y7($,J,this.changes)}comparePoint($,J){y7($,J,this.changes)}boundChange($){y7($,$,this.changes)}};function OK(Z,$,J){let X=new zK;return i.compare(Z,$,J,X),X.changes}class f3{constructor(){this.changes=[]}compareRange(Z,$){y7(Z,$,this.changes)}comparePoint(){}boundChange(Z){y7(Z,Z,this.changes)}}function VK(Z,$,J){let X=new f3;return i.compare(Z,$,J,X),X.changes}function NK(Z,$){for(let J=Z;J&&J!=$;J=J.assignedSlot||J.parentNode)if(J.nodeType==1&&J.contentEditable=="false")return!0;return!1}function HK(Z,$){let J=!1;if($)Z.iterChangedRanges((X,Q)=>{if(X<$.to&&Q>$.from)J=!0});return J}class L9 extends r0{constructor(Z){super();this.height=Z}toDOM(){let Z=document.createElement("div");return Z.className="cm-gap",this.updateDOM(Z),Z}eq(Z){return Z.height==this.height}updateDOM(Z){return Z.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function IK(Z,$,J=1){let X=Z.charCategorizer($),Q=Z.doc.lineAt($),Y=$-Q.from;if(Q.length==0)return A.cursor($);if(Y==0)J=1;else if(Y==Q.length)J=-1;let K=Y,U=Y;if(J<0)K=H0(Q.text,Y,!1);else U=H0(Q.text,Y);let q=X(Q.text.slice(K,U));while(K>0){let G=H0(Q.text,K,!1);if(X(Q.text.slice(G,K))!=q)break;K=G}while(U<Q.length){let G=H0(Q.text,U);if(X(Q.text.slice(U,G))!=q)break;U=G}return A.range(K+Q.from,U+Q.from)}function RK(Z,$,J,X,Q){let Y=Math.round((X-$.left)*Z.defaultCharacterWidth);if(Z.lineWrapping&&J.height>Z.defaultLineHeight*1.5){let U=Z.viewState.heightOracle.textHeight,q=Math.floor((Q-J.top-(Z.defaultLineHeight-U)*0.5)/U);Y+=q*Z.viewState.heightOracle.lineLength}let K=Z.state.sliceDoc(J.from,J.to);return J.from+_9(K,Y,Z.state.tabSize)}function TZ(Z,$,J){let X=Z.lineBlockAt($);if(Array.isArray(X.type)){let Q;for(let Y of X.type){if(Y.from>$)break;if(Y.to<$)continue;if(Y.from<$&&Y.to>$)return Y;if(!Q||Y.type==b0.Text&&(Q.type!=Y.type||(J<0?Y.from<$:Y.to>$)))Q=Y}return Q||X}return X}function FK(Z,$,J,X){let Q=TZ(Z,$.head,$.assoc||-1),Y=!X||Q.type!=b0.Text||!(Z.lineWrapping||Q.widgetLineBreaks)?null:Z.coordsAtPos($.assoc<0&&$.head>Q.from?$.head-1:$.head);if(Y){let K=Z.dom.getBoundingClientRect(),U=Z.textDirectionAt(Q.from),q=Z.posAtCoords({x:J==(U==Q0.LTR)?K.right-1:K.left+1,y:(Y.top+Y.bottom)/2});if(q!=null)return A.cursor(q,J?-1:1)}return A.cursor(J?Q.to:Q.from,J?-1:1)}function T$(Z,$,J,X){let Q=Z.state.doc.lineAt($.head),Y=Z.bidiSpans(Q),K=Z.textDirectionAt(Q.from);for(let U=$,q=null;;){let G=$K(Q,Y,K,U,J),W=H3;if(!G){if(Q.number==(J?Z.state.doc.lines:1))return U;W=`
`,Q=Z.state.doc.line(Q.number+(J?1:-1)),Y=Z.bidiSpans(Q),G=Z.visualLineSide(Q,!J)}if(!q){if(!X)return G;q=X(W)}else if(!q(W))return U;U=G}}function DK(Z,$,J){let X=Z.state.charCategorizer($),Q=X(J);return(Y)=>{let K=X(Y);if(Q==Y0.Space)Q=K;return Q==K}}function AK(Z,$,J,X){let Q=$.head,Y=J?1:-1;if(Q==(J?Z.state.doc.length:0))return A.cursor(Q,$.assoc);let K=$.goalColumn,U,q=Z.contentDOM.getBoundingClientRect(),G=Z.coordsAtPos(Q,$.assoc||-1),W=Z.documentTop;if(G){if(K==null)K=G.left-q.left;U=Y<0?G.top:G.bottom}else{let V=Z.viewState.lineBlockAt(Q);if(K==null)K=Math.min(q.right-q.left,Z.defaultCharacterWidth*(Q-V.from));U=(Y<0?V.top:V.bottom)+W}let j=q.left+K,_=X!==null&&X!==void 0?X:Z.viewState.heightOracle.textHeight>>1,z=yZ(Z,{x:j,y:U+_*Y},!1,Y);return A.cursor(z.pos,z.assoc,void 0,K)}function H4(Z,$,J){for(;;){let X=0;for(let Q of Z)Q.between($-1,$+1,(Y,K,U)=>{if($>Y&&$<K){let q=X||J||($-Y<K-$?-1:1);$=q<0?Y:K,X=q}});if(!X)return $}}function g3(Z,$){let J=null;for(let X=0;X<$.ranges.length;X++){let Q=$.ranges[X],Y=null;if(Q.empty){let K=H4(Z,Q.from,0);if(K!=Q.from)Y=A.cursor(K,-1)}else{let K=H4(Z,Q.from,-1),U=H4(Z,Q.to,1);if(K!=Q.from||U!=Q.to)Y=A.range(Q.from==Q.anchor?K:U,Q.from==Q.head?K:U)}if(Y){if(!J)J=$.ranges.slice();J[X]=Y}}return J?A.create(J,$.mainIndex):$}function _Z(Z,$,J){let X=H4(Z.state.facet(B4).map((Q)=>Q(Z)),J.from,$.head>J.from?-1:1);return X==J.from?J:A.cursor(X,X<J.from?1:-1)}class N1{constructor(Z,$){this.pos=Z,this.assoc=$}}function yZ(Z,$,J,X){let Q=Z.contentDOM.getBoundingClientRect(),Y=Q.top+Z.viewState.paddingTop,{x:K,y:U}=$,q=U-Y,G;for(;;){if(q<0)return new N1(0,1);if(q>Z.viewState.docHeight)return new N1(Z.state.doc.length,-1);if(G=Z.elementAtHeight(q),X==null)break;if(G.type==b0.Text){let _=Z.docView.coordsAt(X<0?G.from:G.to,X);if(_&&(X<0?_.top<=q+Y:_.bottom>=q+Y))break}let j=Z.viewState.heightOracle.textHeight/2;q=X>0?G.bottom+j:G.top-j}if(Z.viewport.from>=G.to||Z.viewport.to<=G.from){if(J)return null;if(G.type==b0.Text){let j=RK(Z,Q,G,K,U);return new N1(j,j==G.from?1:-1)}}if(G.type!=b0.Text)return q<(G.top+G.bottom)/2?new N1(G.from,1):new N1(G.to,-1);let W=Z.docView.lineAt(G.from,2);if(!W||W.length!=G.length)W=Z.docView.lineAt(G.from,-2);return p3(Z,W,G.from,K,U)}function p3(Z,$,J,X,Q){let Y=-1,K=null,U=1e9,q=1e9,G=Q,W=Q,j=(_,z)=>{for(let V=0;V<_.length;V++){let O=_[V];if(O.top==O.bottom)continue;let H=O.left>X?O.left-X:O.right<X?X-O.right:0,R=O.top>Q?O.top-Q:O.bottom<Q?Q-O.bottom:0;if(O.top<=W&&O.bottom>=G)G=Math.min(O.top,G),W=Math.max(O.bottom,W),R=0;if(Y<0||(R-q||H-U)<0)if(Y>=0&&q&&U<H&&K.top<=W-2&&K.bottom>=G+2)q=0;else Y=z,U=H,q=R,K=O}};if($.isText()){for(let z=0;z<$.length;){let V=H0($.text,z);if(j(F4($.dom,z,V).getClientRects(),z),!U&&!q)break;z=V}return X>(K.left+K.right)/2==(y$(Z,Y+J)==Q0.LTR)?new N1(J+H0($.text,Y),-1):new N1(J+Y,1)}else{if(!$.length)return new N1(J,1);for(let O=0;O<$.children.length;O++){let H=$.children[O];if(H.flags&48)continue;let R=(H.dom.nodeType==1?H.dom:F4(H.dom,0,H.length)).getClientRects();if(j(R,O),!U&&!q)break}let _=$.children[Y],z=$.posBefore(_,J);if(_.isComposite()||_.isText())return p3(Z,_,z,Math.max(K.left,Math.min(K.right,X)),Q);return X>(K.left+K.right)/2==(y$(Z,Y+J)==Q0.LTR)?new N1(z+_.length,-1):new N1(z,1)}}function y$(Z,$){let J=Z.state.doc.lineAt($);return Z.bidiSpans(J)[C1.find(Z.bidiSpans(J),$-J.from,-1,1)].dir}var W4="￿";class l3{constructor(Z,$){this.points=Z,this.view=$,this.text="",this.lineSeparator=$.state.facet(n.lineSeparator)}append(Z){this.text+=Z}lineBreak(){this.text+=W4}readRange(Z,$){if(!Z)return this;let J=Z.parentNode;for(let X=Z;;){this.findPointBefore(J,X);let Q=this.text.length;this.readNode(X);let Y=A0.get(X),K=X.nextSibling;if(K==$){if((Y===null||Y===void 0?void 0:Y.breakAfter)&&!K&&J!=this.view.contentDOM)this.lineBreak();break}let U=A0.get(K);if((Y&&U?Y.breakAfter:(Y?Y.breakAfter:S9(X))||S9(K)&&(X.nodeName!="BR"||(Y===null||Y===void 0?void 0:Y.isWidget()))&&this.text.length>Q)&&!LK(K,$))this.lineBreak();X=K}return this.findPointBefore(J,$),this}readTextNode(Z){let $=Z.nodeValue;for(let J of this.points)if(J.node==Z)J.pos=this.text.length+Math.min(J.offset,$.length);for(let J=0,X=this.lineSeparator?null:/\r\n?|\n/g;;){let Q=-1,Y=1,K;if(this.lineSeparator)Q=$.indexOf(this.lineSeparator,J),Y=this.lineSeparator.length;else if(K=X.exec($))Q=K.index,Y=K[0].length;if(this.append($.slice(J,Q<0?$.length:Q)),Q<0)break;if(this.lineBreak(),Y>1){for(let U of this.points)if(U.node==Z&&U.pos>this.text.length)U.pos-=Y-1}J=Q+Y}}readNode(Z){let $=A0.get(Z),J=$&&$.overrideDOMText;if(J!=null){this.findPointInside(Z,J.length);for(let X=J.iter();!X.next().done;)if(X.lineBreak)this.lineBreak();else this.append(X.value)}else if(Z.nodeType==3)this.readTextNode(Z);else if(Z.nodeName=="BR"){if(Z.nextSibling)this.lineBreak()}else if(Z.nodeType==1)this.readRange(Z.firstChild,null)}findPointBefore(Z,$){for(let J of this.points)if(J.node==Z&&Z.childNodes[J.offset]==$)J.pos=this.text.length}findPointInside(Z,$){for(let J of this.points)if(Z.nodeType==3?J.node==Z:Z.contains(J.node))J.pos=this.text.length+(MK(Z,J.node,J.offset)?$:0)}}function MK(Z,$,J){for(;;){if(!$||J<v1($))return!1;if($==Z)return!0;J=d1($)+1,$=$.parentNode}}function LK(Z,$){let J;for(;;Z=Z.nextSibling){if(Z==$||!Z)break;let X=A0.get(Z);if(!(X===null||X===void 0?void 0:X.isWidget()))return!1;if(X)(J||(J=[])).push(X)}if(J)for(let X of J){let Q=X.overrideDOMText;if(Q===null||Q===void 0?void 0:Q.length)return!1}return!0}class kZ{constructor(Z,$){this.node=Z,this.offset=$,this.pos=-1}}class d3{constructor(Z,$,J,X){this.typeOver=X,this.bounds=null,this.text="",this.domChanged=$>-1;let{impreciseHead:Q,impreciseAnchor:Y}=Z.docView;if(Z.state.readOnly&&$>-1)this.newSel=null;else if($>-1&&(this.bounds=c3(Z.docView.tile,$,J,0))){let K=Q||Y?[]:EK(Z),U=new l3(K,Z);U.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=U.text,this.newSel=PK(K,this.bounds.from)}else{let K=Z.observer.selectionRange,U=Q&&Q.node==K.focusNode&&Q.offset==K.focusOffset||!AZ(Z.contentDOM,K.focusNode)?Z.state.selection.main.head:Z.docView.posFromDOM(K.focusNode,K.focusOffset),q=Y&&Y.node==K.anchorNode&&Y.offset==K.anchorOffset||!AZ(Z.contentDOM,K.anchorNode)?Z.state.selection.main.anchor:Z.docView.posFromDOM(K.anchorNode,K.anchorOffset),G=Z.viewport;if((x.ios||x.chrome)&&Z.state.selection.main.empty&&U!=q&&(G.from>0||G.to<Z.state.doc.length)){let W=Math.min(U,q),j=Math.max(U,q),_=G.from-W,z=G.to-j;if((_==0||_==1||W==0)&&(z==0||z==-1||j==Z.state.doc.length))U=0,q=Z.state.doc.length}if(Z.inputState.composing>-1&&Z.state.selection.ranges.length>1)this.newSel=Z.state.selection.replaceRange(A.range(q,U));else this.newSel=A.single(q,U)}}}function c3(Z,$,J,X){if(Z.isComposite()){let Q=-1,Y=-1,K=-1,U=-1;for(let q=0,G=X,W=X;q<Z.children.length;q++){let j=Z.children[q],_=G+j.length;if(G<$&&_>J)return c3(j,$,J,G);if(_>=$&&Q==-1)Q=q,Y=G;if(G>J&&j.dom.parentNode==Z.dom){K=q,U=W;break}W=_,G=_+j.breakAfter}return{from:Y,to:U<0?X+Z.length:U,startDOM:(Q?Z.children[Q-1].dom.nextSibling:null)||Z.dom.firstChild,endDOM:K<Z.children.length&&K>=0?Z.children[K].dom:null}}else if(Z.isText())return{from:X,to:X+Z.length,startDOM:Z.dom,endDOM:Z.dom.nextSibling};else return null}function s3(Z,$){let J,{newSel:X}=$,Q=Z.state.selection.main,Y=Z.inputState.lastKeyTime>Date.now()-100?Z.inputState.lastKeyCode:-1;if($.bounds){let{from:K,to:U}=$.bounds,q=Q.from,G=null;if(Y===8||x.android&&$.text.length<U-K)q=Q.to,G="end";let W=n3(Z.state.doc.sliceString(K,U,W4),$.text,q-K,G);if(W){if(x.chrome&&Y==13&&W.toB==W.from+2&&$.text.slice(W.from,W.toB)==W4+W4)W.toB--;J={from:K+W.from,to:K+W.toA,insert:e.of($.text.slice(W.from,W.toB).split(W4))}}}else if(X&&(!Z.hasFocus&&Z.state.facet(h1)||h9(X,Q)))X=null;if(!J&&!X)return!1;if(!J&&$.typeOver&&!Q.empty&&X&&X.main.empty)J={from:Q.from,to:Q.to,insert:Z.state.doc.slice(Q.from,Q.to)};else if((x.mac||x.android)&&J&&J.from==J.to&&J.from==Q.head-1&&/^\. ?$/.test(J.insert.toString())&&Z.contentDOM.getAttribute("autocorrect")=="off"){if(X&&J.insert.length==2)X=A.single(X.main.anchor-1,X.main.head-1);J={from:J.from,to:J.to,insert:e.of([J.insert.toString().replace("."," ")])}}else if(J&&J.from>=Q.from&&J.to<=Q.to&&(J.from!=Q.from||J.to!=Q.to)&&Q.to-Q.from-(J.to-J.from)<=4)J={from:Q.from,to:Q.to,insert:Z.state.doc.slice(Q.from,J.from).append(J.insert).append(Z.state.doc.slice(J.to,Q.to))};else if(Z.state.doc.lineAt(Q.from).to<Q.to&&Z.docView.lineHasWidget(Q.to)&&Z.inputState.insertingTextAt>Date.now()-50)J={from:Q.from,to:Q.to,insert:Z.state.toText(Z.inputState.insertingText)};else if(x.chrome&&J&&J.from==J.to&&J.from==Q.head&&J.insert.toString()==`
 `&&Z.lineWrapping){if(X)X=A.single(X.main.anchor-1,X.main.head-1);J={from:Q.from,to:Q.to,insert:e.of([" "])}}if(J)return oZ(Z,J,X,Y);else if(X&&!h9(X,Q)){let K=!1,U="select";if(Z.inputState.lastSelectionTime>Date.now()-50){if(Z.inputState.lastSelectionOrigin=="select")K=!0;if(U=Z.inputState.lastSelectionOrigin,U=="select.pointer")X=g3(Z.state.facet(B4).map((q)=>q(Z)),X)}return Z.dispatch({selection:X,scrollIntoView:K,userEvent:U}),!0}else return!1}function oZ(Z,$,J,X=-1){if(x.ios&&Z.inputState.flushIOSKey($))return!0;let Q=Z.state.selection.main;if(x.android&&($.to==Q.to&&($.from==Q.from||$.from==Q.from-1&&Z.state.sliceDoc($.from,Q.from)==" ")&&$.insert.length==1&&$.insert.lines==2&&k7(Z.contentDOM,"Enter",13)||($.from==Q.from-1&&$.to==Q.to&&$.insert.length==0||X==8&&$.insert.length<$.to-$.from&&$.to>Q.head)&&k7(Z.contentDOM,"Backspace",8)||$.from==Q.from&&$.to==Q.to+1&&$.insert.length==0&&k7(Z.contentDOM,"Delete",46)))return!0;let Y=$.insert.toString();if(Z.inputState.composing>=0)Z.inputState.composing++;let K,U=()=>K||(K=BK(Z,$,J));if(!Z.state.facet(A3).some((q)=>q(Z,$.from,$.to,Y,U)))Z.dispatch(U());return!0}function BK(Z,$,J){let X,Q=Z.state,Y=Q.selection.main,K=-1;if($.from==$.to&&$.from<Y.from||$.from>Y.to){let q=$.from<Y.from?-1:1,G=q<0?Y.from:Y.to,W=H4(Q.facet(B4).map((j)=>j(Z)),G,q);if($.from==W)K=W}if(K>-1)X={changes:$,selection:A.cursor($.from+$.insert.length,-1)};else if($.from>=Y.from&&$.to<=Y.to&&$.to-$.from>=(Y.to-Y.from)/3&&(!J||J.main.empty&&J.main.from==$.from+$.insert.length)&&Z.inputState.composing<0){let q=Y.from<$.from?Q.sliceDoc(Y.from,$.from):"",G=Y.to>$.to?Q.sliceDoc($.to,Y.to):"";X=Q.replaceSelection(Z.state.toText(q+$.insert.sliceString(0,void 0,Z.state.lineBreak)+G))}else{let q=Q.changes($),G=J&&J.main.to<=q.newLength?J.main:void 0;if(Q.selection.ranges.length>1&&(Z.inputState.composing>=0||Z.inputState.compositionPendingChange)&&$.to<=Y.to+10&&$.to>=Y.to-10){let W=Z.state.sliceDoc($.from,$.to),j,_=J&&m3(Z,J.main.head);if(_){let V=$.insert.length-($.to-$.from);j={from:_.from,to:_.to-V}}else j=Z.state.doc.lineAt(Y.head);let z=Y.to-$.to;X=Q.changeByRange((V)=>{if(V.from==Y.from&&V.to==Y.to)return{changes:q,range:G||V.map(q)};let O=V.to-z,H=O-W.length;if(Z.state.sliceDoc(H,O)!=W||O>=j.from&&H<=j.to)return{range:V};let R=Q.changes({from:H,to:O,insert:$.insert}),D=V.to-Y.to;return{changes:R,range:!G?V.map(R):A.range(Math.max(0,G.anchor+D),Math.max(0,G.head+D))}})}else X={changes:q,selection:G&&Q.selection.replaceRange(G)}}let U="input.type";if(Z.composing||Z.inputState.compositionPendingChange&&Z.inputState.compositionEndedAt>Date.now()-50){if(Z.inputState.compositionPendingChange=!1,U+=".compose",Z.inputState.compositionFirstChange)U+=".start",Z.inputState.compositionFirstChange=!1}return Q.update(X,{userEvent:U,scrollIntoView:!0})}function n3(Z,$,J,X){let Q=Math.min(Z.length,$.length),Y=0;while(Y<Q&&Z.charCodeAt(Y)==$.charCodeAt(Y))Y++;if(Y==Q&&Z.length==$.length)return null;let K=Z.length,U=$.length;while(K>0&&U>0&&Z.charCodeAt(K-1)==$.charCodeAt(U-1))K--,U--;if(X=="end"){let q=Math.max(0,Y-Math.min(K,U));J-=K+q-Y}if(K<Y&&Z.length<$.length){let q=J<=Y&&J>=K?Y-J:0;Y-=q,U=Y+(U-K),K=Y}else if(U<Y){let q=J<=Y&&J>=U?Y-J:0;Y-=q,K=Y+(K-U),U=Y}return{from:Y,toA:K,toB:U}}function EK(Z){let $=[];if(Z.root.activeElement!=Z.contentDOM)return $;let{anchorNode:J,anchorOffset:X,focusNode:Q,focusOffset:Y}=Z.observer.selectionRange;if(J){if($.push(new kZ(J,X)),Q!=J||Y!=X)$.push(new kZ(Q,Y))}return $}function PK(Z,$){if(Z.length==0)return null;let J=Z[0].pos,X=Z.length==2?Z[1].pos:J;return J>-1&&X>-1?A.single(J+$,X+$):null}function h9(Z,$){return $.head==Z.main.head&&$.anchor==Z.main.anchor}class i3{setSelectionOrigin(Z){this.lastSelectionOrigin=Z,this.lastSelectionTime=Date.now()}constructor(Z){if(this.view=Z,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=Z.hasFocus,x.safari)Z.contentDOM.addEventListener("input",()=>null);if(x.gecko)gK(Z.contentDOM.ownerDocument)}handleEvent(Z){if(!xK(this.view,Z)||this.ignoreDuringComposition(Z))return;if(Z.type=="keydown"&&this.keydown(Z))return;if(this.view.updateState!=0)Promise.resolve().then(()=>this.runHandlers(Z.type,Z));else this.runHandlers(Z.type,Z)}runHandlers(Z,$){let J=this.handlers[Z];if(J){for(let X of J.observers)X(this.view,$);for(let X of J.handlers){if($.defaultPrevented)break;if(X(this.view,$)){$.preventDefault();break}}}}ensureHandlers(Z){let $=CK(Z),J=this.handlers,X=this.view.contentDOM;for(let Q in $)if(Q!="scroll"){let Y=!$[Q].handlers.length,K=J[Q];if(K&&Y!=!K.handlers.length)X.removeEventListener(Q,this.handleEvent),K=null;if(!K)X.addEventListener(Q,this.handleEvent,{passive:Y})}for(let Q in J)if(Q!="scroll"&&!$[Q])X.removeEventListener(Q,this.handleEvent);this.handlers=$}keydown(Z){if(this.lastKeyCode=Z.keyCode,this.lastKeyTime=Date.now(),Z.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&Z.keyCode!=27&&r3.indexOf(Z.keyCode)<0)this.tabFocusMode=-1;if(x.android&&x.chrome&&!Z.synthetic&&(Z.keyCode==13||Z.keyCode==8))return this.view.observer.delayAndroidKey(Z.key,Z.keyCode),!0;let $;if(x.ios&&!Z.synthetic&&!Z.altKey&&!Z.metaKey&&(($=a3.find((J)=>J.keyCode==Z.keyCode))&&!Z.ctrlKey||TK.indexOf(Z.key)>-1&&Z.ctrlKey&&!Z.shiftKey))return this.pendingIOSKey=$||Z,setTimeout(()=>this.flushIOSKey(),250),!0;if(Z.keyCode!=229)this.view.observer.forceFlush();return!1}flushIOSKey(Z){let $=this.pendingIOSKey;if(!$)return!1;if($.key=="Enter"&&Z&&Z.from<Z.to&&/^\S+$/.test(Z.insert.toString()))return!1;return this.pendingIOSKey=void 0,k7(this.view.contentDOM,$.key,$.keyCode,$ instanceof KeyboardEvent?$:void 0)}ignoreDuringComposition(Z){if(!/^key/.test(Z.type)||Z.synthetic)return!1;if(this.composing>0)return!0;if(x.safari&&!x.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)return this.compositionPendingKey=!1,!0;return!1}startMouseSelection(Z){if(this.mouseSelection)this.mouseSelection.destroy();this.mouseSelection=Z}update(Z){if(this.view.observer.update(Z),this.mouseSelection)this.mouseSelection.update(Z);if(this.draggedContent&&Z.docChanged)this.draggedContent=this.draggedContent.map(Z.changes);if(Z.transactions.length)this.lastKeyCode=this.lastSelectionTime=0}destroy(){if(this.mouseSelection)this.mouseSelection.destroy()}}function k$(Z,$){return(J,X)=>{try{return $.call(Z,X,J)}catch(Q){S0(J.state,Q)}}}function CK(Z){let $=Object.create(null);function J(X){return $[X]||($[X]={observers:[],handlers:[]})}for(let X of Z){let Q=X.spec,Y=Q&&Q.plugin.domEventHandlers,K=Q&&Q.plugin.domEventObservers;if(Y)for(let U in Y){let q=Y[U];if(q)J(U).handlers.push(k$(X.value,q))}if(K)for(let U in K){let q=K[U];if(q)J(U).observers.push(k$(X.value,q))}}for(let X in R1)J(X).handlers.push(R1[X]);for(let X in J1)J(X).observers.push(J1[X]);return $}var a3=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],TK="dthko",r3=[16,17,18,20,91,92,224,225],O9=6;function V9(Z){return Math.max(0,Z)*0.7+8}function yK(Z,$){return Math.max(Math.abs(Z.clientX-$.clientX),Math.abs(Z.clientY-$.clientY))}class o3{constructor(Z,$,J,X){this.view=Z,this.startEvent=$,this.style=J,this.mustSelect=X,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=$,this.scrollParents=cY(Z.contentDOM),this.atoms=Z.state.facet(B4).map((Y)=>Y(Z));let Q=Z.contentDOM.ownerDocument;Q.addEventListener("mousemove",this.move=this.move.bind(this)),Q.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=$.shiftKey,this.multiple=Z.state.facet(n.allowMultipleSelections)&&kK(Z,$),this.dragging=bK(Z,$)&&ZJ($)==1?null:!1}start(Z){if(this.dragging===!1)this.select(Z)}move(Z){if(Z.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&yK(this.startEvent,Z)<10)return;this.select(this.lastEvent=Z);let $=0,J=0,X=0,Q=0,Y=this.view.win.innerWidth,K=this.view.win.innerHeight;if(this.scrollParents.x)({left:X,right:Y}=this.scrollParents.x.getBoundingClientRect());if(this.scrollParents.y)({top:Q,bottom:K}=this.scrollParents.y.getBoundingClientRect());let U=rZ(this.view);if(Z.clientX-U.left<=X+O9)$=-V9(X-Z.clientX);else if(Z.clientX+U.right>=Y-O9)$=V9(Z.clientX-Y);if(Z.clientY-U.top<=Q+O9)J=-V9(Q-Z.clientY);else if(Z.clientY+U.bottom>=K-O9)J=V9(Z.clientY-K);this.setScrollSpeed($,J)}up(Z){if(this.dragging==null)this.select(this.lastEvent);if(!this.dragging)Z.preventDefault();this.destroy()}destroy(){this.setScrollSpeed(0,0);let Z=this.view.contentDOM.ownerDocument;Z.removeEventListener("mousemove",this.move),Z.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(Z,$){if(this.scrollSpeed={x:Z,y:$},Z||$){if(this.scrolling<0)this.scrolling=setInterval(()=>this.scroll(),50)}else if(this.scrolling>-1)clearInterval(this.scrolling),this.scrolling=-1}scroll(){let{x:Z,y:$}=this.scrollSpeed;if(Z&&this.scrollParents.x)this.scrollParents.x.scrollLeft+=Z,Z=0;if($&&this.scrollParents.y)this.scrollParents.y.scrollTop+=$,$=0;if(Z||$)this.view.win.scrollBy(Z,$);if(this.dragging===!1)this.select(this.lastEvent)}select(Z){let{view:$}=this,J=g3(this.atoms,this.style.get(Z,this.extend,this.multiple));if(this.mustSelect||!J.eq($.state.selection,this.dragging===!1))this.view.dispatch({selection:J,userEvent:"select.pointer"});this.mustSelect=!1}update(Z){if(Z.transactions.some(($)=>$.isUserEvent("input.type")))this.destroy();else if(this.style.update(Z))setTimeout(()=>this.select(this.lastEvent),20)}}function kK(Z,$){let J=Z.state.facet(I3);return J.length?J[0]($):x.mac?$.metaKey:$.ctrlKey}function SK(Z,$){let J=Z.state.facet(R3);return J.length?J[0]($):x.mac?!$.altKey:!$.ctrlKey}function bK(Z,$){let{main:J}=Z.state.selection;if(J.empty)return!1;let X=b7(Z.root);if(!X||X.rangeCount==0)return!0;let Q=X.getRangeAt(0).getClientRects();for(let Y=0;Y<Q.length;Y++){let K=Q[Y];if(K.left<=$.clientX&&K.right>=$.clientX&&K.top<=$.clientY&&K.bottom>=$.clientY)return!0}return!1}function xK(Z,$){if(!$.bubbles)return!0;if($.defaultPrevented)return!1;for(let J=$.target,X;J!=Z.contentDOM;J=J.parentNode)if(!J||J.nodeType==11||(X=A0.get(J))&&X.isWidget()&&!X.isHidden&&X.widget.ignoreEvent($))return!1;return!0}var R1=Object.create(null),J1=Object.create(null),t3=x.ie&&x.ie_version<15||x.ios&&x.webkit_version<604;function wK(Z){let $=Z.dom.parentNode;if(!$)return;let J=$.appendChild(document.createElement("textarea"));J.style.cssText="position: fixed; left: -10000px; top: 10px",J.focus(),setTimeout(()=>{Z.focus(),J.remove(),e3(Z,J.value)},50)}function p9(Z,$,J){for(let X of Z.facet($))J=X(J,Z);return J}function e3(Z,$){$=p9(Z.state,sZ,$);let{state:J}=Z,X,Q=1,Y=J.toText($),K=Y.lines==J.selection.ranges.length;if(SZ!=null&&J.selection.ranges.every((q)=>q.empty)&&SZ==Y.toString()){let q=-1;X=J.changeByRange((G)=>{let W=J.doc.lineAt(G.from);if(W.from==q)return{range:G};q=W.from;let j=J.toText((K?Y.line(Q++).text:$)+J.lineBreak);return{changes:{from:W.from,insert:j},range:A.cursor(G.from+j.length)}})}else if(K)X=J.changeByRange((q)=>{let G=Y.line(Q++);return{changes:{from:q.from,to:q.to,insert:G.text},range:A.cursor(q.from+G.length)}});else X=J.replaceSelection(Y);Z.dispatch(X,{userEvent:"input.paste",scrollIntoView:!0})}J1.scroll=(Z)=>{Z.inputState.lastScrollTop=Z.scrollDOM.scrollTop,Z.inputState.lastScrollLeft=Z.scrollDOM.scrollLeft};R1.keydown=(Z,$)=>{if(Z.inputState.setSelectionOrigin("select"),$.keyCode==27&&Z.inputState.tabFocusMode!=0)Z.inputState.tabFocusMode=Date.now()+2000;return!1};J1.touchstart=(Z,$)=>{Z.inputState.lastTouchTime=Date.now(),Z.inputState.setSelectionOrigin("select.pointer")};J1.touchmove=(Z)=>{Z.inputState.setSelectionOrigin("select.pointer")};R1.mousedown=(Z,$)=>{if(Z.observer.flush(),Z.inputState.lastTouchTime>Date.now()-2000)return!1;let J=null;for(let X of Z.state.facet(F3))if(J=X(Z,$),J)break;if(!J&&$.button==0)J=vK(Z,$);if(J){let X=!Z.hasFocus;if(Z.inputState.startMouseSelection(new o3(Z,$,J,X)),X)Z.observer.ignore(()=>{G3(Z.contentDOM);let Y=Z.root.activeElement;if(Y&&!Y.contains(Z.contentDOM))Y.blur()});let Q=Z.inputState.mouseSelection;if(Q)return Q.start($),Q.dragging===!1}else Z.inputState.setSelectionOrigin("select.pointer");return!1};function S$(Z,$,J,X){if(X==1)return A.cursor($,J);else if(X==2)return IK(Z.state,$,J);else{let Q=Z.docView.lineAt($,J),Y=Z.state.doc.lineAt(Q?Q.posAtEnd:$),K=Q?Q.posAtStart:Y.from,U=Q?Q.posAtEnd:Y.to;if(U<Z.state.doc.length&&U==Y.to)U++;return A.range(K,U)}}var hK=x.ie&&x.ie_version<=11,b$=null,x$=0,w$=0;function ZJ(Z){if(!hK)return Z.detail;let $=b$,J=w$;return b$=Z,w$=Date.now(),x$=!$||J>Date.now()-400&&Math.abs($.clientX-Z.clientX)<2&&Math.abs($.clientY-Z.clientY)<2?(x$+1)%3:1}function vK(Z,$){let J=Z.posAndSideAtCoords({x:$.clientX,y:$.clientY},!1),X=ZJ($),Q=Z.state.selection;return{update(Y){if(Y.docChanged)J.pos=Y.changes.mapPos(J.pos),Q=Q.map(Y.changes)},get(Y,K,U){let q=Z.posAndSideAtCoords({x:Y.clientX,y:Y.clientY},!1),G,W=S$(Z,q.pos,q.assoc,X);if(J.pos!=q.pos&&!K){let j=S$(Z,J.pos,J.assoc,X),_=Math.min(j.from,W.from),z=Math.max(j.to,W.to);W=_<W.from?A.range(_,z):A.range(z,_)}if(K)return Q.replaceRange(Q.main.extend(W.from,W.to));else if(U&&X==1&&Q.ranges.length>1&&(G=uK(Q,q.pos)))return G;else if(U)return Q.addRange(W);else return A.create([W])}}}function uK(Z,$){for(let J=0;J<Z.ranges.length;J++){let{from:X,to:Q}=Z.ranges[J];if(X<=$&&Q>=$)return A.create(Z.ranges.slice(0,J).concat(Z.ranges.slice(J+1)),Z.mainIndex==J?0:Z.mainIndex-(Z.mainIndex>J?1:0))}return null}R1.dragstart=(Z,$)=>{let{selection:{main:J}}=Z.state;if($.target.draggable){let Q=Z.docView.tile.nearest($.target);if(Q&&Q.isWidget()){let Y=Q.posAtStart,K=Y+Q.length;if(Y>=J.to||K<=J.from)J=A.range(Y,K)}}let{inputState:X}=Z;if(X.mouseSelection)X.mouseSelection.dragging=!0;if(X.draggedContent=J,$.dataTransfer)$.dataTransfer.setData("Text",p9(Z.state,nZ,Z.state.sliceDoc(J.from,J.to))),$.dataTransfer.effectAllowed="copyMove";return!1};R1.dragend=(Z)=>{return Z.inputState.draggedContent=null,!1};function h$(Z,$,J,X){if(J=p9(Z.state,sZ,J),!J)return;let Q=Z.posAtCoords({x:$.clientX,y:$.clientY},!1),{draggedContent:Y}=Z.inputState,K=X&&Y&&SK(Z,$)?{from:Y.from,to:Y.to}:null,U={from:Q,insert:J},q=Z.state.changes(K?[K,U]:U);Z.focus(),Z.dispatch({changes:q,selection:{anchor:q.mapPos(Q,-1),head:q.mapPos(Q,1)},userEvent:K?"move.drop":"input.drop"}),Z.inputState.draggedContent=null}R1.drop=(Z,$)=>{if(!$.dataTransfer)return!1;if(Z.state.readOnly)return!0;let J=$.dataTransfer.files;if(J&&J.length){let X=Array(J.length),Q=0,Y=()=>{if(++Q==J.length)h$(Z,$,X.filter((K)=>K!=null).join(Z.state.lineBreak),!1)};for(let K=0;K<J.length;K++){let U=new FileReader;U.onerror=Y,U.onload=()=>{if(!/[\x00-\x08\x0e-\x1f]{2}/.test(U.result))X[K]=U.result;Y()},U.readAsText(J[K])}return!0}else{let X=$.dataTransfer.getData("Text");if(X)return h$(Z,$,X,!0),!0}return!1};R1.paste=(Z,$)=>{if(Z.state.readOnly)return!0;Z.observer.flush();let J=t3?null:$.clipboardData;if(J)return e3(Z,J.getData("text/plain")||J.getData("text/uri-list")),!0;else return wK(Z),!1};function mK(Z,$){let J=Z.dom.parentNode;if(!J)return;let X=J.appendChild(document.createElement("textarea"));X.style.cssText="position: fixed; left: -10000px; top: 10px",X.value=$,X.focus(),X.selectionEnd=$.length,X.selectionStart=0,setTimeout(()=>{X.remove(),Z.focus()},50)}function fK(Z){let $=[],J=[],X=!1;for(let Q of Z.selection.ranges)if(!Q.empty)$.push(Z.sliceDoc(Q.from,Q.to)),J.push(Q);if(!$.length){let Q=-1;for(let{from:Y}of Z.selection.ranges){let K=Z.doc.lineAt(Y);if(K.number>Q)$.push(K.text),J.push({from:K.from,to:Math.min(Z.doc.length,K.to+1)});Q=K.number}X=!0}return{text:p9(Z,nZ,$.join(Z.lineBreak)),ranges:J,linewise:X}}var SZ=null;R1.copy=R1.cut=(Z,$)=>{let J=b7(Z.root);if(J&&!V4(Z.contentDOM,J))return!1;let{text:X,ranges:Q,linewise:Y}=fK(Z.state);if(!X&&!Y)return!1;if(SZ=Y?X:null,$.type=="cut"&&!Z.state.readOnly)Z.dispatch({changes:Q,scrollIntoView:!0,userEvent:"delete.cut"});let K=t3?null:$.clipboardData;if(K)return K.clearData(),K.setData("text/plain",X),!0;else return mK(Z,X),!1};var $J=i0.define();function JJ(Z,$){let J=[];for(let X of Z.facet(M3)){let Q=X(Z,$);if(Q)J.push(Q)}return J.length?Z.update({effects:J,annotations:$J.of(!0)}):null}function XJ(Z){setTimeout(()=>{let $=Z.hasFocus;if($!=Z.inputState.notifiedFocused){let J=JJ(Z.state,$);if(J)Z.dispatch(J);else Z.update([])}},10)}J1.focus=(Z)=>{if(Z.inputState.lastFocusTime=Date.now(),!Z.scrollDOM.scrollTop&&(Z.inputState.lastScrollTop||Z.inputState.lastScrollLeft))Z.scrollDOM.scrollTop=Z.inputState.lastScrollTop,Z.scrollDOM.scrollLeft=Z.inputState.lastScrollLeft;XJ(Z)};J1.blur=(Z)=>{Z.observer.clearSelectionRange(),XJ(Z)};J1.compositionstart=J1.compositionupdate=(Z)=>{if(Z.observer.editContext)return;if(Z.inputState.compositionFirstChange==null)Z.inputState.compositionFirstChange=!0;if(Z.inputState.composing<0)Z.inputState.composing=0};J1.compositionend=(Z)=>{if(Z.observer.editContext)return;if(Z.inputState.composing=-1,Z.inputState.compositionEndedAt=Date.now(),Z.inputState.compositionPendingKey=!0,Z.inputState.compositionPendingChange=Z.observer.pendingRecords().length>0,Z.inputState.compositionFirstChange=null,x.chrome&&x.android)Z.observer.flushSoon();else if(Z.inputState.compositionPendingChange)Promise.resolve().then(()=>Z.observer.flush());else setTimeout(()=>{if(Z.inputState.composing<0&&Z.docView.hasComposition)Z.update([])},50)};J1.contextmenu=(Z)=>{Z.inputState.lastContextMenu=Date.now()};R1.beforeinput=(Z,$)=>{var J,X;if($.inputType=="insertText"||$.inputType=="insertCompositionText")Z.inputState.insertingText=$.data,Z.inputState.insertingTextAt=Date.now();if($.inputType=="insertReplacementText"&&Z.observer.editContext){let Y=(J=$.dataTransfer)===null||J===void 0?void 0:J.getData("text/plain"),K=$.getTargetRanges();if(Y&&K.length){let U=K[0],q=Z.posAtDOM(U.startContainer,U.startOffset),G=Z.posAtDOM(U.endContainer,U.endOffset);return oZ(Z,{from:q,to:G,insert:Z.state.toText(Y)},null),!0}}let Q;if(x.chrome&&x.android&&(Q=a3.find((Y)=>Y.inputType==$.inputType))){if(Z.observer.delayAndroidKey(Q.key,Q.keyCode),Q.key=="Backspace"||Q.key=="Delete"){let Y=((X=window.visualViewport)===null||X===void 0?void 0:X.height)||0;setTimeout(()=>{var K;if((((K=window.visualViewport)===null||K===void 0?void 0:K.height)||0)>Y+10&&Z.hasFocus)Z.contentDOM.blur(),Z.focus()},100)}}if(x.ios&&$.inputType=="deleteContentForward")Z.observer.flushSoon();if(x.safari&&$.inputType=="insertText"&&Z.inputState.composing>=0)setTimeout(()=>J1.compositionend(Z,$),20);return!1};var v$=new Set;function gK(Z){if(!v$.has(Z))v$.add(Z),Z.addEventListener("copy",()=>{}),Z.addEventListener("cut",()=>{})}var u$=["pre-wrap","normal","pre-line","break-spaces"],w7=!1;function m$(){w7=!1}class QJ{constructor(Z){this.lineWrapping=Z,this.doc=e.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(Z,$){let J=this.doc.lineAt($).number-this.doc.lineAt(Z).number+1;if(this.lineWrapping)J+=Math.max(0,Math.ceil(($-Z-J*this.lineLength*0.5)/this.lineLength));return this.lineHeight*J}heightForLine(Z){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((Z-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight}setDoc(Z){return this.doc=Z,this}mustRefreshForWrapping(Z){return u$.indexOf(Z)>-1!=this.lineWrapping}mustRefreshForHeights(Z){let $=!1;for(let J=0;J<Z.length;J++){let X=Z[J];if(X<0)J++;else if(!this.heightSamples[Math.floor(X*10)])$=!0,this.heightSamples[Math.floor(X*10)]=!0}return $}refresh(Z,$,J,X,Q,Y){let K=u$.indexOf(Z)>-1,U=Math.abs($-this.lineHeight)>0.3||this.lineWrapping!=K||Math.abs(J-this.charWidth)>0.1;if(this.lineWrapping=K,this.lineHeight=$,this.charWidth=J,this.textHeight=X,this.lineLength=Q,U){this.heightSamples={};for(let q=0;q<Y.length;q++){let G=Y[q];if(G<0)q++;else this.heightSamples[Math.floor(G*10)]=!0}}return U}}class YJ{constructor(Z,$){this.from=Z,this.heights=$,this.index=0}get more(){return this.index<this.heights.length}}class H1{constructor(Z,$,J,X,Q){this.from=Z,this.length=$,this.top=J,this.height=X,this._content=Q}get type(){return typeof this._content=="number"?b0.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof q7?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(Z){let $=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(Z._content)?Z._content:[Z]);return new H1(this.from,this.length+Z.length,this.top,this.height+Z.height,$)}}var q0=function(Z){return Z[Z.ByPos=0]="ByPos",Z[Z.ByHeight=1]="ByHeight",Z[Z.ByPosNoHeight=2]="ByPosNoHeight",Z}(q0||(q0={})),B9=0.001;class u0{constructor(Z,$,J=2){this.length=Z,this.height=$,this.flags=J}get outdated(){return(this.flags&2)>0}set outdated(Z){this.flags=(Z?2:0)|this.flags&-3}setHeight(Z){if(this.height!=Z){if(Math.abs(this.height-Z)>B9)w7=!0;this.height=Z}}replace(Z,$,J){return u0.of(J)}decomposeLeft(Z,$){$.push(this)}decomposeRight(Z,$){$.push(this)}applyChanges(Z,$,J,X){let Q=this,Y=J.doc;for(let K=X.length-1;K>=0;K--){let{fromA:U,toA:q,fromB:G,toB:W}=X[K],j=Q.lineAt(U,q0.ByPosNoHeight,J.setDoc($),0,0),_=j.to>=q?j:Q.lineAt(q,q0.ByPosNoHeight,J,0,0);W+=_.to-q,q=_.to;while(K>0&&j.from<=X[K-1].toA)if(U=X[K-1].fromA,G=X[K-1].fromB,K--,U<j.from)j=Q.lineAt(U,q0.ByPosNoHeight,J,0,0);G+=j.from-U,U=j.from;let z=eZ.build(J.setDoc(Y),Z,G,W);Q=v9(Q,Q.replace(U,q,z))}return Q.updateHeight(J,0)}static empty(){return new a0(0,0,0)}static of(Z){if(Z.length==1)return Z[0];let $=0,J=Z.length,X=0,Q=0;for(;;)if($==J)if(X>Q*2){let K=Z[$-1];if(K.break)Z.splice(--$,1,K.left,null,K.right);else Z.splice(--$,1,K.left,K.right);J+=1+K.break,X-=K.size}else if(Q>X*2){let K=Z[J];if(K.break)Z.splice(J,1,K.left,null,K.right);else Z.splice(J,1,K.left,K.right);J+=2+K.break,Q-=K.size}else break;else if(X<Q){let K=Z[$++];if(K)X+=K.size}else{let K=Z[--J];if(K)Q+=K.size}let Y=0;if(Z[$-1]==null)Y=1,$--;else if(Z[$]==null)Y=1,J++;return new KJ(u0.of(Z.slice(0,$)),Y,u0.of(Z.slice(J)))}}function v9(Z,$){if(Z==$)return Z;if(Z.constructor!=$.constructor)w7=!0;return $}u0.prototype.size=1;var pK=m.replace({});class tZ extends u0{constructor(Z,$,J){super(Z,$);this.deco=J,this.spaceAbove=0}mainBlock(Z,$){return new H1($,this.length,Z+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(Z,$,J,X){return this.spaceAbove&&Z<J+this.spaceAbove?new H1(X,0,J,this.spaceAbove,pK):this.mainBlock(J,X)}lineAt(Z,$,J,X,Q){let Y=this.mainBlock(X,Q);return this.spaceAbove?this.blockAt(0,J,X,Q).join(Y):Y}forEachLine(Z,$,J,X,Q,Y){if(Z<=Q+this.length&&$>=Q)Y(this.lineAt(0,q0.ByPos,J,X,Q))}setMeasuredHeight(Z){let $=Z.heights[Z.index++];if($<0)this.spaceAbove=-$,$=Z.heights[Z.index++];else this.spaceAbove=0;this.setHeight($)}updateHeight(Z,$=0,J=!1,X){if(X&&X.from<=$&&X.more)this.setMeasuredHeight(X);return this.outdated=!1,this}toString(){return`block(${this.length})`}}class a0 extends tZ{constructor(Z,$,J){super(Z,$,null);this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=J}mainBlock(Z,$){return new H1($,this.length,Z+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(Z,$,J){let X=J[0];if(J.length==1&&(X instanceof a0||X instanceof k0&&X.flags&4)&&Math.abs(this.length-X.length)<10){if(X instanceof k0)X=new a0(X.length,this.height,this.spaceAbove);else X.height=this.height;if(!this.outdated)X.outdated=!1;return X}else return u0.of(J)}updateHeight(Z,$=0,J=!1,X){if(X&&X.from<=$&&X.more)this.setMeasuredHeight(X);else if(J||this.outdated)this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,Z.heightForLine(this.length-this.collapsed))+this.breaks*Z.lineHeight);return this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class k0 extends u0{constructor(Z){super(Z,0)}heightMetrics(Z,$){let J=Z.doc.lineAt($).number,X=Z.doc.lineAt($+this.length).number,Q=X-J+1,Y,K=0;if(Z.lineWrapping){let U=Math.min(this.height,Z.lineHeight*Q);if(Y=U/Q,this.length>Q+1)K=(this.height-U)/(this.length-Q-1)}else Y=this.height/Q;return{firstLine:J,lastLine:X,perLine:Y,perChar:K}}blockAt(Z,$,J,X){let{firstLine:Q,lastLine:Y,perLine:K,perChar:U}=this.heightMetrics($,X);if($.lineWrapping){let q=X+(Z<$.lineHeight?0:Math.round(Math.max(0,Math.min(1,(Z-J)/this.height))*this.length)),G=$.doc.lineAt(q),W=K+G.length*U,j=Math.max(J,Z-W/2);return new H1(G.from,G.length,j,W,0)}else{let q=Math.max(0,Math.min(Y-Q,Math.floor((Z-J)/K))),{from:G,length:W}=$.doc.line(Q+q);return new H1(G,W,J+K*q,K,0)}}lineAt(Z,$,J,X,Q){if($==q0.ByHeight)return this.blockAt(Z,J,X,Q);if($==q0.ByPosNoHeight){let{from:_,to:z}=J.doc.lineAt(Z);return new H1(_,z-_,0,0,0)}let{firstLine:Y,perLine:K,perChar:U}=this.heightMetrics(J,Q),q=J.doc.lineAt(Z),G=K+q.length*U,W=q.number-Y,j=X+K*W+U*(q.from-Q-W);return new H1(q.from,q.length,Math.max(X,Math.min(j,X+this.height-G)),G,0)}forEachLine(Z,$,J,X,Q,Y){Z=Math.max(Z,Q),$=Math.min($,Q+this.length);let{firstLine:K,perLine:U,perChar:q}=this.heightMetrics(J,Q);for(let G=Z,W=X;G<=$;){let j=J.doc.lineAt(G);if(G==Z){let z=j.number-K;W+=U*z+q*(Z-Q-z)}let _=U+q*j.length;Y(new H1(j.from,j.length,W,_,0)),W+=_,G=j.to+1}}replace(Z,$,J){let X=this.length-$;if(X>0){let Q=J[J.length-1];if(Q instanceof k0)J[J.length-1]=new k0(Q.length+X);else J.push(null,new k0(X-1))}if(Z>0){let Q=J[0];if(Q instanceof k0)J[0]=new k0(Z+Q.length);else J.unshift(new k0(Z-1),null)}return u0.of(J)}decomposeLeft(Z,$){$.push(new k0(Z-1),null)}decomposeRight(Z,$){$.push(null,new k0(this.length-Z-1))}updateHeight(Z,$=0,J=!1,X){let Q=$+this.length;if(X&&X.from<=$+this.length&&X.more){let Y=[],K=Math.max($,X.from),U=-1;if(X.from>$)Y.push(new k0(X.from-$-1).updateHeight(Z,$));while(K<=Q&&X.more){let G=Z.doc.lineAt(K).length;if(Y.length)Y.push(null);let W=X.heights[X.index++],j=0;if(W<0)j=-W,W=X.heights[X.index++];if(U==-1)U=W;else if(Math.abs(W-U)>=B9)U=-2;let _=new a0(G,W,j);_.outdated=!1,Y.push(_),K+=G+1}if(K<=Q)Y.push(null,new k0(Q-K).updateHeight(Z,K));let q=u0.of(Y);if(U<0||Math.abs(q.height-this.height)>=B9||Math.abs(U-this.heightMetrics(Z,$).perLine)>=B9)w7=!0;return v9(this,q)}else if(J||this.outdated)this.setHeight(Z.heightForGap($,$+this.length)),this.outdated=!1;return this}toString(){return`gap(${this.length})`}}class KJ extends u0{constructor(Z,$,J){super(Z.length+$+J.length,Z.height+J.height,$|(Z.outdated||J.outdated?2:0));this.left=Z,this.right=J,this.size=Z.size+J.size}get break(){return this.flags&1}blockAt(Z,$,J,X){let Q=J+this.left.height;return Z<Q?this.left.blockAt(Z,$,J,X):this.right.blockAt(Z,$,Q,X+this.left.length+this.break)}lineAt(Z,$,J,X,Q){let Y=X+this.left.height,K=Q+this.left.length+this.break,U=$==q0.ByHeight?Z<Y:Z<K,q=U?this.left.lineAt(Z,$,J,X,Q):this.right.lineAt(Z,$,J,Y,K);if(this.break||(U?q.to<K:q.from>K))return q;let G=$==q0.ByPosNoHeight?q0.ByPosNoHeight:q0.ByPos;if(U)return q.join(this.right.lineAt(K,G,J,Y,K));else return this.left.lineAt(K,G,J,X,Q).join(q)}forEachLine(Z,$,J,X,Q,Y){let K=X+this.left.height,U=Q+this.left.length+this.break;if(this.break){if(Z<U)this.left.forEachLine(Z,$,J,X,Q,Y);if($>=U)this.right.forEachLine(Z,$,J,K,U,Y)}else{let q=this.lineAt(U,q0.ByPos,J,X,Q);if(Z<q.from)this.left.forEachLine(Z,q.from-1,J,X,Q,Y);if(q.to>=Z&&q.from<=$)Y(q);if($>q.to)this.right.forEachLine(q.to+1,$,J,K,U,Y)}}replace(Z,$,J){let X=this.left.length+this.break;if($<X)return this.balanced(this.left.replace(Z,$,J),this.right);if(Z>this.left.length)return this.balanced(this.left,this.right.replace(Z-X,$-X,J));let Q=[];if(Z>0)this.decomposeLeft(Z,Q);let Y=Q.length;for(let K of J)Q.push(K);if(Z>0)f$(Q,Y-1);if($<this.length){let K=Q.length;this.decomposeRight($,Q),f$(Q,K)}return u0.of(Q)}decomposeLeft(Z,$){let J=this.left.length;if(Z<=J)return this.left.decomposeLeft(Z,$);if($.push(this.left),this.break){if(J++,Z>=J)$.push(null)}if(Z>J)this.right.decomposeLeft(Z-J,$)}decomposeRight(Z,$){let J=this.left.length,X=J+this.break;if(Z>=X)return this.right.decomposeRight(Z-X,$);if(Z<J)this.left.decomposeRight(Z,$);if(this.break&&Z<X)$.push(null);$.push(this.right)}balanced(Z,$){if(Z.size>2*$.size||$.size>2*Z.size)return u0.of(this.break?[Z,null,$]:[Z,$]);return this.left=v9(this.left,Z),this.right=v9(this.right,$),this.setHeight(Z.height+$.height),this.outdated=Z.outdated||$.outdated,this.size=Z.size+$.size,this.length=Z.length+this.break+$.length,this}updateHeight(Z,$=0,J=!1,X){let{left:Q,right:Y}=this,K=$+Q.length+this.break,U=null;if(X&&X.from<=$+Q.length&&X.more)U=Q=Q.updateHeight(Z,$,J,X);else Q.updateHeight(Z,$,J);if(X&&X.from<=K+Y.length&&X.more)U=Y=Y.updateHeight(Z,K,J,X);else Y.updateHeight(Z,K,J);if(U)return this.balanced(Q,Y);return this.height=this.left.height+this.right.height,this.outdated=!1,this}toString(){return this.left+(this.break?" ":"-")+this.right}}function f$(Z,$){let J,X;if(Z[$]==null&&(J=Z[$-1])instanceof k0&&(X=Z[$+1])instanceof k0)Z.splice($-1,3,new k0(J.length+1+X.length))}var lK=5;class eZ{constructor(Z,$){this.pos=Z,this.oracle=$,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=Z}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(Z,$){if(this.lineStart>-1){let J=Math.min($,this.lineEnd),X=this.nodes[this.nodes.length-1];if(X instanceof a0)X.length+=J-this.pos;else if(J>this.pos||!this.isCovered)this.nodes.push(new a0(J-this.pos,-1,0));if(this.writtenTo=J,$>J)this.nodes.push(null),this.writtenTo++,this.lineStart=-1}this.pos=$}point(Z,$,J){if(Z<$||J.heightRelevant){let X=J.widget?J.widget.estimatedHeight:0,Q=J.widget?J.widget.lineBreaks:0;if(X<0)X=this.oracle.lineHeight;let Y=$-Z;if(J.block)this.addBlock(new tZ(Y,X,J));else if(Y||Q||X>=lK)this.addLineDeco(X,Q,Y)}else if($>Z)this.span(Z,$);if(this.lineEnd>-1&&this.lineEnd<this.pos)this.lineEnd=this.oracle.doc.lineAt(this.pos).to}enterLine(){if(this.lineStart>-1)return;let{from:Z,to:$}=this.oracle.doc.lineAt(this.pos);if(this.lineStart=Z,this.lineEnd=$,this.writtenTo<Z){if(this.writtenTo<Z-1||this.nodes[this.nodes.length-1]==null)this.nodes.push(this.blankContent(this.writtenTo,Z-1));this.nodes.push(null)}if(this.pos>Z)this.nodes.push(new a0(this.pos-Z,-1,0));this.writtenTo=this.pos}blankContent(Z,$){let J=new k0($-Z);if(this.oracle.doc.lineAt(Z).to==$)J.flags|=4;return J}ensureLine(){this.enterLine();let Z=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(Z instanceof a0)return Z;let $=new a0(0,-1,0);return this.nodes.push($),$}addBlock(Z){this.enterLine();let $=Z.deco;if($&&$.startSide>0&&!this.isCovered)this.ensureLine();if(this.nodes.push(Z),this.writtenTo=this.pos=this.pos+Z.length,$&&$.endSide>0)this.covering=Z}addLineDeco(Z,$,J){let X=this.ensureLine();X.length+=J,X.collapsed+=J,X.widgetHeight=Math.max(X.widgetHeight,Z),X.breaks+=$,this.writtenTo=this.pos=this.pos+J}finish(Z){let $=this.nodes.length==0?null:this.nodes[this.nodes.length-1];if(this.lineStart>-1&&!($ instanceof a0)&&!this.isCovered)this.nodes.push(new a0(0,-1,0));else if(this.writtenTo<this.pos||$==null)this.nodes.push(this.blankContent(this.writtenTo,this.pos));let J=Z;for(let X of this.nodes){if(X instanceof a0)X.updateHeight(this.oracle,J);J+=X?X.length:1}return this.nodes}static build(Z,$,J,X){let Q=new eZ(J,Z);return i.spans($,J,X,Q,0),Q.finish(J)}}function dK(Z,$,J){let X=new UJ;return i.compare(Z,$,J,X,0),X.changes}class UJ{constructor(){this.changes=[]}compareRange(){}comparePoint(Z,$,J,X){if(Z<$||J&&J.heightRelevant||X&&X.heightRelevant)y7(Z,$,this.changes,5)}}function cK(Z,$){let J=Z.getBoundingClientRect(),X=Z.ownerDocument,Q=X.defaultView||window,Y=Math.max(0,J.left),K=Math.min(Q.innerWidth,J.right),U=Math.max(0,J.top),q=Math.min(Q.innerHeight,J.bottom);for(let G=Z.parentNode;G&&G!=X.body;)if(G.nodeType==1){let W=G,j=window.getComputedStyle(W);if((W.scrollHeight>W.clientHeight||W.scrollWidth>W.clientWidth)&&j.overflow!="visible"){let _=W.getBoundingClientRect();Y=Math.max(Y,_.left),K=Math.min(K,_.right),U=Math.max(U,_.top),q=Math.min(G==Z.parentNode?Q.innerHeight:q,_.bottom)}G=j.position=="absolute"||j.position=="fixed"?W.offsetParent:W.parentNode}else if(G.nodeType==11)G=G.host;else break;return{left:Y-J.left,right:Math.max(Y,K)-J.left,top:U-(J.top+$),bottom:Math.max(U,q)-(J.top+$)}}function sK(Z){let $=Z.getBoundingClientRect(),J=Z.ownerDocument.defaultView||window;return $.left<J.innerWidth&&$.right>0&&$.top<J.innerHeight&&$.bottom>0}function nK(Z,$){let J=Z.getBoundingClientRect();return{left:0,right:J.right-J.left,top:$,bottom:J.bottom-(J.top+$)}}class E9{constructor(Z,$,J,X){this.from=Z,this.to=$,this.size=J,this.displaySize=X}static same(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++){let X=Z[J],Q=$[J];if(X.from!=Q.from||X.to!=Q.to||X.size!=Q.size)return!1}return!0}draw(Z,$){return m.replace({widget:new qJ(this.displaySize*($?Z.scaleY:Z.scaleX),$)}).range(this.from,this.to)}}class qJ extends r0{constructor(Z,$){super();this.size=Z,this.vertical=$}eq(Z){return Z.size==this.size&&Z.vertical==this.vertical}toDOM(){let Z=document.createElement("div");if(this.vertical)Z.style.height=this.size+"px";else Z.style.width=this.size+"px",Z.style.height="2px",Z.style.display="inline-block";return Z}get estimatedHeight(){return this.vertical?this.size:-1}}class bZ{constructor(Z){this.state=Z,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=g$,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Q0.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let $=Z.facet(iZ).some((J)=>typeof J!="function"&&J.class=="cm-lineWrapping");this.heightOracle=new QJ($),this.stateDeco=p$(Z),this.heightMap=u0.empty().applyChanges(this.stateDeco,e.empty,this.heightOracle.setDoc(Z.doc),[new $1(0,0,0,Z.doc.length)]);for(let J=0;J<2;J++)if(this.viewport=this.getViewport(0,null),!this.updateForViewport())break;this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=m.set(this.lineGaps.map((J)=>J.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let Z=[this.viewport],{main:$}=this.state.selection;for(let J=0;J<=1;J++){let X=J?$.head:$.anchor;if(!Z.some(({from:Q,to:Y})=>X>=Q&&X<=Y)){let{from:Q,to:Y}=this.lineBlockAt(X);Z.push(new j4(Q,Y))}}return this.viewports=Z.sort((J,X)=>J.from-X.from),this.updateScaler()}updateScaler(){let Z=this.scaler;return this.scaler=this.heightMap.height<=7000000?g$:new Z5(this.heightOracle,this.heightMap,this.viewports),Z.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(Z)=>{this.viewportLines.push(_4(Z,this.scaler))})}update(Z,$=null){this.state=Z.state;let J=this.stateDeco;this.stateDeco=p$(this.state);let X=Z.changedRanges,Q=$1.extendWithRanges(X,dK(J,this.stateDeco,Z?Z.changes:D0.empty(this.state.doc.length))),Y=this.heightMap.height,K=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);if(m$(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,Z.startState.doc,this.heightOracle.setDoc(this.state.doc),Q),this.heightMap.height!=Y||w7)Z.flags|=2;if(K)this.scrollAnchorPos=Z.changes.mapPos(K.from,-1),this.scrollAnchorHeight=K.top;else this.scrollAnchorPos=-1,this.scrollAnchorHeight=Y;let U=Q.length?this.mapViewport(this.viewport,Z.changes):this.viewport;if($&&($.range.head<U.from||$.range.head>U.to)||!this.viewportIsAppropriate(U))U=this.getViewport(0,$);let q=U.from!=this.viewport.from||U.to!=this.viewport.to;if(this.viewport=U,Z.flags|=this.updateForViewport(),q||!Z.changes.empty||Z.flags&2)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>4000)this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,Z.changes)));if(Z.flags|=this.computeVisibleRanges(Z.changes),$)this.scrollTarget=$;if(!this.mustEnforceCursorAssoc&&(Z.selectionSet||Z.focusChanged)&&Z.view.lineWrapping&&Z.state.selection.main.empty&&Z.state.selection.main.assoc&&!Z.state.facet(B3))this.mustEnforceCursorAssoc=!0}measure(Z){let $=Z.contentDOM,J=window.getComputedStyle($),X=this.heightOracle,Q=J.whiteSpace;this.defaultTextDirection=J.direction=="rtl"?Q0.RTL:Q0.LTR;let Y=this.heightOracle.mustRefreshForWrapping(Q)||this.mustMeasureContent,K=$.getBoundingClientRect(),U=Y||this.mustMeasureContent||this.contentDOMHeight!=K.height;this.contentDOMHeight=K.height,this.mustMeasureContent=!1;let q=0,G=0;if(K.width&&K.height){let{scaleX:M,scaleY:L}=U3($,K);if(M>0.005&&Math.abs(this.scaleX-M)>0.005||L>0.005&&Math.abs(this.scaleY-L)>0.005)this.scaleX=M,this.scaleY=L,q|=16,Y=U=!0}let W=(parseInt(J.paddingTop)||0)*this.scaleY,j=(parseInt(J.paddingBottom)||0)*this.scaleY;if(this.paddingTop!=W||this.paddingBottom!=j)this.paddingTop=W,this.paddingBottom=j,q|=18;if(this.editorWidth!=Z.scrollDOM.clientWidth){if(X.lineWrapping)U=!0;this.editorWidth=Z.scrollDOM.clientWidth,q|=16}let _=Z.scrollDOM.scrollTop*this.scaleY;if(this.scrollTop!=_)this.scrollAnchorHeight=-1,this.scrollTop=_;this.scrolledToBottom=W3(Z.scrollDOM);let z=(this.printing?nK:cK)($,this.paddingTop),V=z.top-this.pixelViewport.top,O=z.bottom-this.pixelViewport.bottom;this.pixelViewport=z;let H=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(H!=this.inView){if(this.inView=H,H)U=!0}if(!this.inView&&!this.scrollTarget&&!sK(Z.dom))return 0;let R=K.width;if(this.contentDOMWidth!=R||this.editorHeight!=Z.scrollDOM.clientHeight)this.contentDOMWidth=K.width,this.editorHeight=Z.scrollDOM.clientHeight,q|=16;if(U){let M=Z.docView.measureVisibleLineHeights(this.viewport);if(X.mustRefreshForHeights(M))Y=!0;if(Y||X.lineWrapping&&Math.abs(R-this.contentDOMWidth)>X.charWidth){let{lineHeight:L,charWidth:B,textHeight:w}=Z.docView.measureTextSize();if(Y=L>0&&X.refresh(Q,L,B,w,Math.max(5,R/B),M),Y)Z.docView.minWidth=0,q|=16}if(V>0&&O>0)G=Math.max(V,O);else if(V<0&&O<0)G=Math.min(V,O);m$();for(let L of this.viewports){let B=L.from==this.viewport.from?M:Z.docView.measureVisibleLineHeights(L);this.heightMap=(Y?u0.empty().applyChanges(this.stateDeco,e.empty,this.heightOracle,[new $1(0,0,0,Z.state.doc.length)]):this.heightMap).updateHeight(X,0,Y,new YJ(L.from,B))}if(w7)q|=2}let D=!this.viewportIsAppropriate(this.viewport,G)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);if(D){if(q&2)q|=this.updateScaler();this.viewport=this.getViewport(G,this.scrollTarget),q|=this.updateForViewport()}if(q&2||D)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>4000)this.updateLineGaps(this.ensureLineGaps(Y?[]:this.lineGaps,Z));if(q|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc)this.mustEnforceCursorAssoc=!1,Z.docView.enforceCursorAssoc();return q}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(Z,$){let J=0.5-Math.max(-0.5,Math.min(0.5,Z/1000/2)),X=this.heightMap,Q=this.heightOracle,{visibleTop:Y,visibleBottom:K}=this,U=new j4(X.lineAt(Y-J*1000,q0.ByHeight,Q,0,0).from,X.lineAt(K+(1-J)*1000,q0.ByHeight,Q,0,0).to);if($){let{head:q}=$.range;if(q<U.from||q>U.to){let G=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),W=X.lineAt(q,q0.ByPos,Q,0,0),j;if($.y=="center")j=(W.top+W.bottom)/2-G/2;else if($.y=="start"||$.y=="nearest"&&q<U.from)j=W.top;else j=W.bottom-G;U=new j4(X.lineAt(j-500,q0.ByHeight,Q,0,0).from,X.lineAt(j+G+500,q0.ByHeight,Q,0,0).to)}}return U}mapViewport(Z,$){let J=$.mapPos(Z.from,-1),X=$.mapPos(Z.to,1);return new j4(this.heightMap.lineAt(J,q0.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(X,q0.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:Z,to:$},J=0){if(!this.inView)return!0;let{top:X}=this.heightMap.lineAt(Z,q0.ByPos,this.heightOracle,0,0),{bottom:Q}=this.heightMap.lineAt($,q0.ByPos,this.heightOracle,0,0),{visibleTop:Y,visibleBottom:K}=this;return(Z==0||X<=Y-Math.max(10,Math.min(-J,250)))&&($==this.state.doc.length||Q>=K+Math.max(10,Math.min(J,250)))&&(X>Y-2000&&Q<K+2000)}mapLineGaps(Z,$){if(!Z.length||$.empty)return Z;let J=[];for(let X of Z)if(!$.touchesRange(X.from,X.to))J.push(new E9($.mapPos(X.from),$.mapPos(X.to),X.size,X.displaySize));return J}ensureLineGaps(Z,$){let J=this.heightOracle.lineWrapping,X=J?1e4:2000,Q=X>>1,Y=X<<1;if(this.defaultTextDirection!=Q0.LTR&&!J)return[];let K=[],U=(G,W,j,_)=>{if(W-G<Q)return;let z=this.state.selection.main,V=[z.from];if(!z.empty)V.push(z.to);for(let H of V)if(H>G&&H<W){U(G,H-10,j,_),U(H+10,W,j,_);return}let O=aK(Z,(H)=>H.from>=j.from&&H.to<=j.to&&Math.abs(H.from-G)<Q&&Math.abs(H.to-W)<Q&&!V.some((R)=>H.from<R&&H.to>R));if(!O){if(W<j.to&&$&&J&&$.visibleRanges.some((D)=>D.from<=W&&D.to>=W)){let D=$.moveToLineBoundary(A.cursor(W),!1,!0).head;if(D>G)W=D}let H=this.gapSize(j,G,W,_),R=J||H<2000000?H:2000000;O=new E9(G,W,H,R)}K.push(O)},q=(G)=>{if(G.length<Y||G.type!=b0.Text)return;let W=iK(G.from,G.to,this.stateDeco);if(W.total<Y)return;let j=this.scrollTarget?this.scrollTarget.range.head:null,_,z;if(J){let V=X/this.heightOracle.lineLength*this.heightOracle.lineHeight,O,H;if(j!=null){let R=H9(W,j),D=((this.visibleBottom-this.visibleTop)/2+V)/G.height;O=R-D,H=R+D}else O=(this.visibleTop-G.top-V)/G.height,H=(this.visibleBottom-G.top+V)/G.height;_=N9(W,O),z=N9(W,H)}else{let V=W.total*this.heightOracle.charWidth,O=X*this.heightOracle.charWidth,H=0;if(V>2000000){for(let B of Z)if(B.from>=G.from&&B.from<G.to&&B.size!=B.displaySize&&B.from*this.heightOracle.charWidth+H<this.pixelViewport.left)H=B.size-B.displaySize}let R=this.pixelViewport.left+H,D=this.pixelViewport.right+H,M,L;if(j!=null){let B=H9(W,j),w=((D-R)/2+O)/V;M=B-w,L=B+w}else M=(R-O)/V,L=(D+O)/V;_=N9(W,M),z=N9(W,L)}if(_>G.from)U(G.from,_,G,W);if(z<G.to)U(z,G.to,G,W)};for(let G of this.viewportLines)if(Array.isArray(G.type))G.type.forEach(q);else q(G);return K}gapSize(Z,$,J,X){let Q=H9(X,J)-H9(X,$);if(this.heightOracle.lineWrapping)return Z.height*Q;else return X.total*this.heightOracle.charWidth*Q}updateLineGaps(Z){if(!E9.same(Z,this.lineGaps))this.lineGaps=Z,this.lineGapDeco=m.set(Z.map(($)=>$.draw(this,this.heightOracle.lineWrapping)))}computeVisibleRanges(Z){let $=this.stateDeco;if(this.lineGaps.length)$=$.concat(this.lineGapDeco);let J=[];i.spans($,this.viewport.from,this.viewport.to,{span(Q,Y){J.push({from:Q,to:Y})},point(){}},20);let X=0;if(J.length!=this.visibleRanges.length)X=12;else for(let Q=0;Q<J.length&&!(X&8);Q++){let Y=this.visibleRanges[Q],K=J[Q];if(Y.from!=K.from||Y.to!=K.to){if(X|=4,!(Z&&Z.mapPos(Y.from,-1)==K.from&&Z.mapPos(Y.to,1)==K.to))X|=8}}return this.visibleRanges=J,X}lineBlockAt(Z){return Z>=this.viewport.from&&Z<=this.viewport.to&&this.viewportLines.find(($)=>$.from<=Z&&$.to>=Z)||_4(this.heightMap.lineAt(Z,q0.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(Z){return Z>=this.viewportLines[0].top&&Z<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(($)=>$.top<=Z&&$.bottom>=Z)||_4(this.heightMap.lineAt(this.scaler.fromDOM(Z),q0.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(Z){let $=this.lineBlockAtHeight(Z+8);return $.from>=this.viewport.from||this.viewportLines[0].top-Z>200?$:this.viewportLines[0]}elementAtHeight(Z){return _4(this.heightMap.blockAt(this.scaler.fromDOM(Z),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class j4{constructor(Z,$){this.from=Z,this.to=$}}function iK(Z,$,J){let X=[],Q=Z,Y=0;if(i.spans(J,Z,$,{span(){},point(K,U){if(K>Q)X.push({from:Q,to:K}),Y+=K-Q;Q=U}},20),Q<$)X.push({from:Q,to:$}),Y+=$-Q;return{total:Y,ranges:X}}function N9({total:Z,ranges:$},J){if(J<=0)return $[0].from;if(J>=1)return $[$.length-1].to;let X=Math.floor(Z*J);for(let Q=0;;Q++){let{from:Y,to:K}=$[Q],U=K-Y;if(X<=U)return Y+X;X-=U}}function H9(Z,$){let J=0;for(let{from:X,to:Q}of Z.ranges){if($<=Q){J+=$-X;break}J+=Q-X}return J/Z.total}function aK(Z,$){for(let J of Z)if($(J))return J;return}var g$={toDOM(Z){return Z},fromDOM(Z){return Z},scale:1,eq(Z){return Z==this}};function p$(Z){let $=Z.facet(g9).filter((X)=>typeof X!="function"),J=Z.facet(aZ).filter((X)=>typeof X!="function");if(J.length)$.push(i.join(J));return $}class Z5{constructor(Z,$,J){let X=0,Q=0,Y=0;this.viewports=J.map(({from:K,to:U})=>{let q=$.lineAt(K,q0.ByPos,Z,0,0).top,G=$.lineAt(U,q0.ByPos,Z,0,0).bottom;return X+=G-q,{from:K,to:U,top:q,bottom:G,domTop:0,domBottom:0}}),this.scale=(7000000-X)/($.height-X);for(let K of this.viewports)K.domTop=Y+(K.top-Q)*this.scale,Y=K.domBottom=K.domTop+(K.bottom-K.top),Q=K.bottom}toDOM(Z){for(let $=0,J=0,X=0;;$++){let Q=$<this.viewports.length?this.viewports[$]:null;if(!Q||Z<Q.top)return X+(Z-J)*this.scale;if(Z<=Q.bottom)return Q.domTop+(Z-Q.top);J=Q.bottom,X=Q.domBottom}}fromDOM(Z){for(let $=0,J=0,X=0;;$++){let Q=$<this.viewports.length?this.viewports[$]:null;if(!Q||Z<Q.domTop)return J+(Z-X)/this.scale;if(Z<=Q.domBottom)return Q.top+(Z-Q.domTop);J=Q.bottom,X=Q.domBottom}}eq(Z){if(!(Z instanceof Z5))return!1;return this.scale==Z.scale&&this.viewports.length==Z.viewports.length&&this.viewports.every(($,J)=>$.from==Z.viewports[J].from&&$.to==Z.viewports[J].to)}}function _4(Z,$){if($.scale==1)return Z;let J=$.toDOM(Z.top),X=$.toDOM(Z.bottom);return new H1(Z.from,Z.length,J,X-J,Array.isArray(Z._content)?Z._content.map((Q)=>_4(Q,$)):Z._content)}var I9=S.define({combine:(Z)=>Z.join(" ")}),xZ=S.define({combine:(Z)=>Z.indexOf(!0)>-1}),wZ=V1.newName(),GJ=V1.newName(),WJ=V1.newName(),jJ={"&light":"."+GJ,"&dark":"."+WJ};function hZ(Z,$,J){return new V1($,{finish(X){return/&/.test(X)?X.replace(/&\w*/,(Q)=>{if(Q=="&")return Z;if(!J||!J[Q])throw RangeError(`Unsupported selector: ${Q}`);return J[Q]}):Z+" "+X}})}var rK=hZ("."+wZ,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},jJ),oK={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},zZ=x.ie&&x.ie_version<=11;class _J{constructor(Z){if(this.view=Z,this.active=!1,this.editContext=null,this.selectionRange=new q3,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=Z.contentDOM,this.observer=new MutationObserver(($)=>{for(let J of $)this.queue.push(J);if((x.ie&&x.ie_version<=11||x.ios&&Z.composing)&&$.some((J)=>J.type=="childList"&&J.removedNodes.length||J.type=="characterData"&&J.oldValue.length>J.target.nodeValue.length))this.flushSoon();else this.flush()}),window.EditContext&&x.android&&Z.constructor.EDIT_CONTEXT!==!1&&!(x.chrome&&x.chrome_version<126)){if(this.editContext=new zJ(Z),Z.state.facet(h1))Z.contentDOM.editContext=this.editContext.editContext}if(zZ)this.onCharData=($)=>{this.queue.push({target:$.target,type:"characterData",oldValue:$.prevValue}),this.flushSoon()};if(this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia)this.printQuery=window.matchMedia("print");if(typeof ResizeObserver=="function")this.resizeScroll=new ResizeObserver(()=>{var $;if((($=this.view.docView)===null||$===void 0?void 0:$.lastUpdate)<Date.now()-75)this.onResize()}),this.resizeScroll.observe(Z.scrollDOM);if(this.addWindowListeners(this.win=Z.win),this.start(),typeof IntersectionObserver=="function")this.intersection=new IntersectionObserver(($)=>{if(this.parentCheck<0)this.parentCheck=setTimeout(this.listenForScroll.bind(this),1000);if($.length>0&&$[$.length-1].intersectionRatio>0!=this.intersecting){if(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView)this.onScrollChanged(document.createEvent("Event"))}},{threshold:[0,0.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(($)=>{if($.length>0&&$[$.length-1].intersectionRatio>0)this.onScrollChanged(document.createEvent("Event"))},{});this.listenForScroll(),this.readSelectionRange()}onScrollChanged(Z){if(this.view.inputState.runHandlers("scroll",Z),this.intersecting)this.view.measure()}onScroll(Z){if(this.intersecting)this.flush(!1);if(this.editContext)this.view.requestMeasure(this.editContext.measureReq);this.onScrollChanged(Z)}onResize(){if(this.resizeTimeout<0)this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50)}onPrint(Z){if((Z.type=="change"||!Z.type)&&!Z.matches)return;this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(Z){if(this.gapIntersection&&(Z.length!=this.gaps.length||this.gaps.some(($,J)=>$!=Z[J]))){this.gapIntersection.disconnect();for(let $ of Z)this.gapIntersection.observe($);this.gaps=Z}}onSelectionChange(Z){let $=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:J}=this,X=this.selectionRange;if(J.state.facet(h1)?J.root.activeElement!=this.dom:!V4(this.dom,X))return;let Q=X.anchorNode&&J.docView.tile.nearest(X.anchorNode);if(Q&&Q.isWidget()&&Q.widget.ignoreEvent(Z)){if(!$)this.selectionChanged=!1;return}if((x.ie&&x.ie_version<=11||x.android&&x.chrome)&&!J.state.selection.main.empty&&X.focusNode&&N4(X.focusNode,X.focusOffset,X.anchorNode,X.anchorOffset))this.flushSoon();else this.flush(!1)}readSelectionRange(){let{view:Z}=this,$=b7(Z.root);if(!$)return!1;let J=x.safari&&Z.root.nodeType==11&&Z.root.activeElement==this.dom&&tK(this.view,$)||$;if(!J||this.selectionRange.eq(J))return!1;let X=V4(this.dom,J);if(X&&!this.selectionChanged&&Z.inputState.lastFocusTime>Date.now()-200&&Z.inputState.lastTouchTime<Date.now()-300&&nY(this.dom,J))return this.view.inputState.lastFocusTime=0,Z.docView.updateSelection(),!1;if(this.selectionRange.setRange(J),X)this.selectionChanged=!0;return!0}setSelectionRange(Z,$){this.selectionRange.set(Z.node,Z.offset,$.node,$.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let Z=0,$=null;for(let J=this.dom;J;)if(J.nodeType==1){if(!$&&Z<this.scrollTargets.length&&this.scrollTargets[Z]==J)Z++;else if(!$)$=this.scrollTargets.slice(0,Z);if($)$.push(J);J=J.assignedSlot||J.parentNode}else if(J.nodeType==11)J=J.host;else break;if(Z<this.scrollTargets.length&&!$)$=this.scrollTargets.slice(0,Z);if($){for(let J of this.scrollTargets)J.removeEventListener("scroll",this.onScroll);for(let J of this.scrollTargets=$)J.addEventListener("scroll",this.onScroll)}}ignore(Z){if(!this.active)return Z();try{return this.stop(),Z()}finally{this.start(),this.clear()}}start(){if(this.active)return;if(this.observer.observe(this.dom,oK),zZ)this.dom.addEventListener("DOMCharacterDataModified",this.onCharData);this.active=!0}stop(){if(!this.active)return;if(this.active=!1,this.observer.disconnect(),zZ)this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData)}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(Z,$){var J;if(!this.delayedAndroidKey){let X=()=>{let Q=this.delayedAndroidKey;if(Q){if(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=Q.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&Q.force)k7(this.dom,Q.key,Q.keyCode)}};this.flushingAndroidKey=this.view.win.requestAnimationFrame(X)}if(!this.delayedAndroidKey||Z=="Enter")this.delayedAndroidKey={key:Z,keyCode:$,force:this.lastChange<Date.now()-50||!!((J=this.delayedAndroidKey)===null||J===void 0?void 0:J.force)}}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){if(this.delayedFlush<0)this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()})}forceFlush(){if(this.delayedFlush>=0)this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1;this.flush()}pendingRecords(){for(let Z of this.observer.takeRecords())this.queue.push(Z);return this.queue}processRecords(){let Z=this.pendingRecords();if(Z.length)this.queue=[];let $=-1,J=-1,X=!1;for(let Q of Z){let Y=this.readMutation(Q);if(!Y)continue;if(Y.typeOver)X=!0;if($==-1)({from:$,to:J}=Y);else $=Math.min(Y.from,$),J=Math.max(Y.to,J)}return{from:$,to:J,typeOver:X}}readChange(){let{from:Z,to:$,typeOver:J}=this.processRecords(),X=this.selectionChanged&&V4(this.dom,this.selectionRange);if(Z<0&&!X)return null;if(Z>-1)this.lastChange=Date.now();this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let Q=new d3(this.view,Z,$,J);return this.view.docView.domChanged={newSel:Q.newSel?Q.newSel.main:null},Q}flush(Z=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;if(Z)this.readSelectionRange();let $=this.readChange();if(!$)return this.view.requestMeasure(),!1;let J=this.view.state,X=s3(this.view,$);if(this.view.state==J&&($.domChanged||$.newSel&&!h9(this.view.state.selection,$.newSel.main)))this.view.update([]);return X}readMutation(Z){let $=this.view.docView.tile.nearest(Z.target);if(!$||$.isWidget())return null;if($.markDirty(Z.type=="attributes"),Z.type=="childList"){let J=l$($,Z.previousSibling||Z.target.previousSibling,-1),X=l$($,Z.nextSibling||Z.target.nextSibling,1);return{from:J?$.posAfter(J):$.posAtStart,to:X?$.posBefore(X):$.posAtEnd,typeOver:!1}}else if(Z.type=="characterData")return{from:$.posAtStart,to:$.posAtEnd,typeOver:Z.target.nodeValue==Z.oldValue};else return null}setWindow(Z){if(Z!=this.win)this.removeWindowListeners(this.win),this.win=Z,this.addWindowListeners(this.win)}addWindowListeners(Z){if(Z.addEventListener("resize",this.onResize),this.printQuery)if(this.printQuery.addEventListener)this.printQuery.addEventListener("change",this.onPrint);else this.printQuery.addListener(this.onPrint);else Z.addEventListener("beforeprint",this.onPrint);Z.addEventListener("scroll",this.onScroll),Z.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(Z){if(Z.removeEventListener("scroll",this.onScroll),Z.removeEventListener("resize",this.onResize),this.printQuery)if(this.printQuery.removeEventListener)this.printQuery.removeEventListener("change",this.onPrint);else this.printQuery.removeListener(this.onPrint);else Z.removeEventListener("beforeprint",this.onPrint);Z.document.removeEventListener("selectionchange",this.onSelectionChange)}update(Z){if(this.editContext){if(this.editContext.update(Z),Z.startState.facet(h1)!=Z.state.facet(h1))Z.view.contentDOM.editContext=Z.state.facet(h1)?this.editContext.editContext:null}}destroy(){var Z,$,J;this.stop(),(Z=this.intersection)===null||Z===void 0||Z.disconnect(),($=this.gapIntersection)===null||$===void 0||$.disconnect(),(J=this.resizeScroll)===null||J===void 0||J.disconnect();for(let X of this.scrollTargets)X.removeEventListener("scroll",this.onScroll);if(this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext)this.view.contentDOM.editContext=null,this.editContext.destroy()}}function l$(Z,$,J){while($){let X=A0.get($);if(X&&X.parent==Z)return X;let Q=$.parentNode;$=Q!=Z.dom?Q:J>0?$.nextSibling:$.previousSibling}return null}function d$(Z,$){let{startContainer:J,startOffset:X,endContainer:Q,endOffset:Y}=$,K=Z.docView.domAtPos(Z.state.selection.main.anchor,1);if(N4(K.node,K.offset,Q,Y))[J,X,Q,Y]=[Q,Y,J,X];return{anchorNode:J,anchorOffset:X,focusNode:Q,focusOffset:Y}}function tK(Z,$){if($.getComposedRanges){let Q=$.getComposedRanges(Z.root)[0];if(Q)return d$(Z,Q)}let J=null;function X(Q){Q.preventDefault(),Q.stopImmediatePropagation(),J=Q.getTargetRanges()[0]}return Z.contentDOM.addEventListener("beforeinput",X,!0),Z.dom.ownerDocument.execCommand("indent"),Z.contentDOM.removeEventListener("beforeinput",X,!0),J?d$(Z,J):null}class zJ{constructor(Z){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(Z.state);let $=this.editContext=new window.EditContext({text:Z.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,Z.state.selection.main.anchor))),selectionEnd:this.toContextPos(Z.state.selection.main.head)});this.handlers.textupdate=(J)=>{let X=Z.state.selection.main,{anchor:Q,head:Y}=X,K=this.toEditorPos(J.updateRangeStart),U=this.toEditorPos(J.updateRangeEnd);if(Z.inputState.composing>=0&&!this.composing)this.composing={contextBase:J.updateRangeStart,editorBase:K,drifted:!1};let q=U-K>J.text.length;if(K==this.from&&Q<this.from)K=Q;else if(U==this.to&&Q>this.to)U=Q;let G=n3(Z.state.sliceDoc(K,U),J.text,(q?X.from:X.to)-K,q?"end":null);if(!G){let j=A.single(this.toEditorPos(J.selectionStart),this.toEditorPos(J.selectionEnd));if(!h9(j,X))Z.dispatch({selection:j,userEvent:"select"});return}let W={from:G.from+K,to:G.toA+K,insert:e.of(J.text.slice(G.from,G.toB).split(`
`))};if((x.mac||x.android)&&W.from==Y-1&&/^\. ?$/.test(J.text)&&Z.contentDOM.getAttribute("autocorrect")=="off")W={from:K,to:U,insert:e.of([J.text.replace("."," ")])};if(this.pendingContextChange=W,!Z.state.readOnly){let j=this.to-this.from+(W.to-W.from+W.insert.length);oZ(Z,W,A.single(this.toEditorPos(J.selectionStart,j),this.toEditorPos(J.selectionEnd,j)))}if(this.pendingContextChange)this.revertPending(Z.state),this.setSelection(Z.state);if(W.from<W.to&&!W.insert.length&&Z.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test($.text.slice(Math.max(0,J.updateRangeStart-1),Math.min($.text.length,J.updateRangeStart+1))))this.handlers.compositionend(J)},this.handlers.characterboundsupdate=(J)=>{let X=[],Q=null;for(let Y=this.toEditorPos(J.rangeStart),K=this.toEditorPos(J.rangeEnd);Y<K;Y++){let U=Z.coordsForChar(Y);Q=U&&new DOMRect(U.left,U.top,U.right-U.left,U.bottom-U.top)||Q||new DOMRect,X.push(Q)}$.updateCharacterBounds(J.rangeStart,X)},this.handlers.textformatupdate=(J)=>{let X=[];for(let Q of J.getTextFormats()){let{underlineStyle:Y,underlineThickness:K}=Q;if(!/none/i.test(Y)&&!/none/i.test(K)){let U=this.toEditorPos(Q.rangeStart),q=this.toEditorPos(Q.rangeEnd);if(U<q){let G=`text-decoration: underline ${/^[a-z]/.test(Y)?Y+" ":Y=="Dashed"?"dashed ":Y=="Squiggle"?"wavy ":""}${/thin/i.test(K)?1:2}px`;X.push(m.mark({attributes:{style:G}}).range(U,q))}}}Z.dispatch({effects:P3.of(m.set(X))})},this.handlers.compositionstart=()=>{if(Z.inputState.composing<0)Z.inputState.composing=0,Z.inputState.compositionFirstChange=!0},this.handlers.compositionend=()=>{if(Z.inputState.composing=-1,Z.inputState.compositionFirstChange=null,this.composing){let{drifted:J}=this.composing;if(this.composing=null,J)this.reset(Z.state)}};for(let J in this.handlers)$.addEventListener(J,this.handlers[J]);this.measureReq={read:(J)=>{this.editContext.updateControlBounds(J.contentDOM.getBoundingClientRect());let X=b7(J.root);if(X&&X.rangeCount)this.editContext.updateSelectionBounds(X.getRangeAt(0).getBoundingClientRect())}}}applyEdits(Z){let $=0,J=!1,X=this.pendingContextChange;if(Z.changes.iterChanges((Q,Y,K,U,q)=>{if(J)return;let G=q.length-(Y-Q);if(X&&Y>=X.to)if(X.from==Q&&X.to==Y&&X.insert.eq(q)){X=this.pendingContextChange=null,$+=G,this.to+=G;return}else X=null,this.revertPending(Z.state);if(Q+=$,Y+=$,Y<=this.from)this.from+=G,this.to+=G;else if(Q<this.to){if(Q<this.from||Y>this.to||this.to-this.from+q.length>30000){J=!0;return}this.editContext.updateText(this.toContextPos(Q),this.toContextPos(Y),q.toString()),this.to+=G}$+=G}),X&&!J)this.revertPending(Z.state);return!J}update(Z){let $=this.pendingContextChange,J=Z.startState.selection.main;if(this.composing&&(this.composing.drifted||!Z.changes.touchesRange(J.from,J.to)&&Z.transactions.some((X)=>!X.isUserEvent("input.type")&&X.changes.touchesRange(this.from,this.to))))this.composing.drifted=!0,this.composing.editorBase=Z.changes.mapPos(this.composing.editorBase);else if(!this.applyEdits(Z)||!this.rangeIsValid(Z.state))this.pendingContextChange=null,this.reset(Z.state);else if(Z.docChanged||Z.selectionSet||$)this.setSelection(Z.state);if(Z.geometryChanged||Z.docChanged||Z.selectionSet)Z.view.requestMeasure(this.measureReq)}resetRange(Z){let{head:$}=Z.selection.main;this.from=Math.max(0,$-1e4),this.to=Math.min(Z.doc.length,$+1e4)}reset(Z){this.resetRange(Z),this.editContext.updateText(0,this.editContext.text.length,Z.doc.sliceString(this.from,this.to)),this.setSelection(Z)}revertPending(Z){let $=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos($.from),this.toContextPos($.from+$.insert.length),Z.doc.sliceString($.from,$.to))}setSelection(Z){let{main:$}=Z.selection,J=this.toContextPos(Math.max(this.from,Math.min(this.to,$.anchor))),X=this.toContextPos($.head);if(this.editContext.selectionStart!=J||this.editContext.selectionEnd!=X)this.editContext.updateSelection(J,X)}rangeIsValid(Z){let{head:$}=Z.selection.main;return!(this.from>0&&$-this.from<500||this.to<Z.doc.length&&this.to-$<500||this.to-this.from>30000)}toEditorPos(Z,$=this.to-this.from){Z=Math.min(Z,$);let J=this.composing;return J&&J.drifted?J.editorBase+(Z-J.contextBase):Z+this.from}toContextPos(Z){let $=this.composing;return $&&$.drifted?$.contextBase+(Z-$.editorBase):Z-this.from}destroy(){for(let Z in this.handlers)this.editContext.removeEventListener(Z,this.handlers[Z])}}class C{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(Z={}){var $;if(this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),Z.parent)Z.parent.appendChild(this.dom);let{dispatch:J}=Z;if(this.dispatchTransactions=Z.dispatchTransactions||J&&((X)=>X.forEach((Q)=>J(Q,this)))||((X)=>this.update(X)),this.dispatch=this.dispatch.bind(this),this._root=Z.root||sY(Z.parent)||document,this.viewState=new bZ(Z.state||n.create(Z)),Z.scrollTo&&Z.scrollTo.is(z9))this.viewState.scrollTarget=Z.scrollTo.value.clip(this.viewState.state);this.plugins=this.state.facet(C7).map((X)=>new M9(X));for(let X of this.plugins)X.update(this);if(this.observer=new _J(this),this.inputState=new i3(this),this.inputState.ensureHandlers(this.plugins),this.docView=new PZ(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),($=document.fonts)===null||$===void 0?void 0:$.ready)document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...Z){let $=Z.length==1&&Z[0]instanceof N0?Z:Z.length==1&&Array.isArray(Z[0])?Z[0]:[this.state.update(...Z)];this.dispatchTransactions($,this)}update(Z){if(this.updateState!=0)throw Error("Calls to EditorView.update are not allowed while an update is in progress");let $=!1,J=!1,X,Q=this.state;for(let j of Z){if(j.startState!=Q)throw RangeError("Trying to update state with a transaction that doesn't start from the previous state.");Q=j.state}if(this.destroyed){this.viewState.state=Q;return}let Y=this.hasFocus,K=0,U=null;if(Z.some((j)=>j.annotation($J)))this.inputState.notifiedFocused=Y,K=1;else if(Y!=this.inputState.notifiedFocused){if(this.inputState.notifiedFocused=Y,U=JJ(Q,Y),!U)K=1}let q=this.observer.delayedAndroidKey,G=null;if(q){if(this.observer.clearDelayedAndroidKey(),G=this.observer.readChange(),G&&!this.state.doc.eq(Q.doc)||!this.state.selection.eq(Q.selection))G=null}else this.observer.clear();if(Q.facet(n.phrases)!=this.state.facet(n.phrases))return this.setState(Q);X=x9.create(this,Q,Z),X.flags|=K;let W=this.viewState.scrollTarget;try{this.updateState=2;for(let j of Z){if(W)W=W.map(j.changes);if(j.scrollIntoView){let{main:_}=j.state.selection;W=new S7(_.empty?_:A.cursor(_.head,_.head>_.anchor?-1:1))}for(let _ of j.effects)if(_.is(z9))W=_.value.clip(this.state)}if(this.viewState.update(X,W),this.bidiCache=u9.update(this.bidiCache,X.changes),!X.empty)this.updatePlugins(X),this.inputState.update(X);if($=this.docView.update(X),this.state.facet(G4)!=this.styleModules)this.mountStyles();J=this.updateAttrs(),this.showAnnouncements(Z),this.docView.updateSelection($,Z.some((j)=>j.isUserEvent("select.pointer")))}finally{this.updateState=0}if(X.startState.facet(I9)!=X.state.facet(I9))this.viewState.mustMeasureContent=!0;if($||J||W||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)this.requestMeasure();if($)this.docViewUpdate();if(!X.empty)for(let j of this.state.facet(EZ))try{j(X)}catch(_){S0(this.state,_,"update listener")}if(U||G)Promise.resolve().then(()=>{if(U&&this.state==U.startState)this.dispatch(U);if(G){if(!s3(this,G)&&q.force)k7(this.contentDOM,q.key,q.keyCode)}})}setState(Z){if(this.updateState!=0)throw Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=Z;return}this.updateState=2;let $=this.hasFocus;try{for(let J of this.plugins)J.destroy(this);this.viewState=new bZ(Z),this.plugins=Z.facet(C7).map((J)=>new M9(J)),this.pluginMap.clear();for(let J of this.plugins)J.update(this);this.docView.destroy(),this.docView=new PZ(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}if($)this.focus();this.requestMeasure()}updatePlugins(Z){let $=Z.startState.facet(C7),J=Z.state.facet(C7);if($!=J){let X=[];for(let Q of J){let Y=$.indexOf(Q);if(Y<0)X.push(new M9(Q));else{let K=this.plugins[Y];K.mustUpdate=Z,X.push(K)}}for(let Q of this.plugins)if(Q.mustUpdate!=Z)Q.destroy(this);this.plugins=X,this.pluginMap.clear()}else for(let X of this.plugins)X.mustUpdate=Z;for(let X=0;X<this.plugins.length;X++)this.plugins[X].update(this);if($!=J)this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let Z of this.plugins){let $=Z.value;if($&&$.docViewUpdate)try{$.docViewUpdate(this)}catch(J){S0(this.state,J,"doc view update listener")}}}measure(Z=!0){if(this.destroyed)return;if(this.measureScheduled>-1)this.win.cancelAnimationFrame(this.measureScheduled);if(this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}if(this.measureScheduled=0,Z)this.observer.forceFlush();let $=null,J=this.scrollDOM,X=J.scrollTop*this.scaleY,{scrollAnchorPos:Q,scrollAnchorHeight:Y}=this.viewState;if(Math.abs(X-this.viewState.scrollTop)>1)Y=-1;this.viewState.scrollAnchorHeight=-1;try{for(let K=0;;K++){if(Y<0)if(W3(J))Q=-1,Y=this.viewState.heightMap.height;else{let _=this.viewState.scrollAnchorAt(X);Q=_.from,Y=_.top}this.updateState=1;let U=this.viewState.measure(this);if(!U&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(K>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let q=[];if(!(U&4))[this.measureRequests,q]=[q,this.measureRequests];let G=q.map((_)=>{try{return _.read(this)}catch(z){return S0(this.state,z),c$}}),W=x9.create(this,this.state,[]),j=!1;if(W.flags|=U,!$)$=W;else $.flags|=U;if(this.updateState=2,!W.empty){if(this.updatePlugins(W),this.inputState.update(W),this.updateAttrs(),j=this.docView.update(W),j)this.docViewUpdate()}for(let _=0;_<q.length;_++)if(G[_]!=c$)try{let z=q[_];if(z.write)z.write(G[_],this)}catch(z){S0(this.state,z)}if(j)this.docView.updateSelection(!0);if(!W.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,Y=-1;continue}else{let z=(Q<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(Q).top)-Y;if(z>1||z<-1){X=X+z,J.scrollTop=X/this.scaleY,Y=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if($&&!$.empty)for(let K of this.state.facet(EZ))K($)}get themeClasses(){return wZ+" "+(this.state.facet(xZ)?WJ:GJ)+" "+this.state.facet(I9)}updateAttrs(){let Z=s$(this,C3,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),$={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:!this.state.facet(h1)?"false":"true",class:"cm-content",style:`${x.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};if(this.state.readOnly)$["aria-readonly"]="true";s$(this,iZ,$);let J=this.observer.ignore(()=>{let X=M$(this.contentDOM,this.contentAttrs,$),Q=M$(this.dom,this.editorAttrs,Z);return X||Q});return this.editorAttrs=Z,this.contentAttrs=$,J}showAnnouncements(Z){let $=!0;for(let J of Z)for(let X of J.effects)if(X.is(C.announce)){if($)this.announceDOM.textContent="";$=!1;let Q=this.announceDOM.appendChild(document.createElement("div"));Q.textContent=X.value}}mountStyles(){this.styleModules=this.state.facet(G4);let Z=this.state.facet(C.cspNonce);V1.mount(this.root,this.styleModules.concat(rK).reverse(),Z?{nonce:Z}:void 0)}readMeasured(){if(this.updateState==2)throw Error("Reading the editor layout isn't allowed during an update");if(this.updateState==0&&this.measureScheduled>-1)this.measure(!1)}requestMeasure(Z){if(this.measureScheduled<0)this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure());if(Z){if(this.measureRequests.indexOf(Z)>-1)return;if(Z.key!=null){for(let $=0;$<this.measureRequests.length;$++)if(this.measureRequests[$].key===Z.key){this.measureRequests[$]=Z;return}}this.measureRequests.push(Z)}}plugin(Z){let $=this.pluginMap.get(Z);if($===void 0||$&&$.plugin!=Z)this.pluginMap.set(Z,$=this.plugins.find((J)=>J.plugin==Z)||null);return $&&$.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(Z){return this.readMeasured(),this.viewState.elementAtHeight(Z)}lineBlockAtHeight(Z){return this.readMeasured(),this.viewState.lineBlockAtHeight(Z)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(Z){return this.viewState.lineBlockAt(Z)}get contentHeight(){return this.viewState.contentHeight}moveByChar(Z,$,J){return _Z(this,Z,T$(this,Z,$,J))}moveByGroup(Z,$){return _Z(this,Z,T$(this,Z,$,(J)=>DK(this,Z.head,J)))}visualLineSide(Z,$){let J=this.bidiSpans(Z),X=this.textDirectionAt(Z.from),Q=J[$?J.length-1:0];return A.cursor(Q.side($,X)+Z.from,Q.forward(!$,X)?1:-1)}moveToLineBoundary(Z,$,J=!0){return FK(this,Z,$,J)}moveVertically(Z,$,J){return _Z(this,Z,AK(this,Z,$,J))}domAtPos(Z,$=1){return this.docView.domAtPos(Z,$)}posAtDOM(Z,$=0){return this.docView.posFromDOM(Z,$)}posAtCoords(Z,$=!0){this.readMeasured();let J=yZ(this,Z,$);return J&&J.pos}posAndSideAtCoords(Z,$=!0){return this.readMeasured(),yZ(this,Z,$)}coordsAtPos(Z,$=1){this.readMeasured();let J=this.docView.coordsAt(Z,$);if(!J||J.left==J.right)return J;let X=this.state.doc.lineAt(Z),Q=this.bidiSpans(X),Y=Q[C1.find(Q,Z-X.from,-1,$)];return b9(J,Y.dir==Q0.LTR==$>0)}coordsForChar(Z){return this.readMeasured(),this.docView.coordsForChar(Z)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(Z){if(!this.state.facet(L3)||Z<this.viewport.from||Z>this.viewport.to)return this.textDirection;return this.readMeasured(),this.docView.textDirectionAt(Z)}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(Z){if(Z.length>eK)return N3(Z.length);let $=this.textDirectionAt(Z.from),J;for(let Q of this.bidiCache)if(Q.from==Z.from&&Q.dir==$&&(Q.fresh||V3(Q.isolates,J=E$(this,Z))))return Q.order;if(!J)J=E$(this,Z);let X=ZK(Z.text,$,J);return this.bidiCache.push(new u9(Z.from,Z.to,$,J,!0,X)),X}get hasFocus(){var Z;return(this.dom.ownerDocument.hasFocus()||x.safari&&((Z=this.inputState)===null||Z===void 0?void 0:Z.lastContextMenu)>Date.now()-30000)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{G3(this.contentDOM),this.docView.updateSelection()})}setRoot(Z){if(this._root!=Z)this._root=Z,this.observer.setWindow((Z.nodeType==9?Z:Z.ownerDocument).defaultView||window),this.mountStyles()}destroy(){if(this.root.activeElement==this.contentDOM)this.contentDOM.blur();for(let Z of this.plugins)Z.destroy(this);if(this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1)this.win.cancelAnimationFrame(this.measureScheduled);this.destroyed=!0}static scrollIntoView(Z,$={}){return z9.of(new S7(typeof Z=="number"?A.cursor(Z):Z,$.y,$.x,$.yMargin,$.xMargin))}scrollSnapshot(){let{scrollTop:Z,scrollLeft:$}=this.scrollDOM,J=this.viewState.scrollAnchorAt(Z);return z9.of(new S7(A.cursor(J.from),"start","start",J.top-Z,$,!0))}setTabFocusMode(Z){if(Z==null)this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1;else if(typeof Z=="boolean")this.inputState.tabFocusMode=Z?0:-1;else if(this.inputState.tabFocusMode!=0)this.inputState.tabFocusMode=Date.now()+Z}static domEventHandlers(Z){return j0.define(()=>({}),{eventHandlers:Z})}static domEventObservers(Z){return j0.define(()=>({}),{eventObservers:Z})}static theme(Z,$){let J=V1.newName(),X=[I9.of(J),G4.of(hZ(`.${J}`,Z))];if($&&$.dark)X.push(xZ.of(!0));return X}static baseTheme(Z){return O1.lowest(G4.of(hZ("."+wZ,Z,jJ)))}static findFromDOM(Z){var $;let J=Z.querySelector(".cm-content"),X=J&&A0.get(J)||A0.get(Z);return(($=X===null||X===void 0?void 0:X.root)===null||$===void 0?void 0:$.view)||null}}C.styleModule=G4;C.inputHandler=A3;C.clipboardInputFilter=sZ;C.clipboardOutputFilter=nZ;C.scrollHandler=E3;C.focusChangeEffect=M3;C.perLineTextDirection=L3;C.exceptionSink=D3;C.updateListener=EZ;C.editable=h1;C.mouseSelectionStyle=F3;C.dragMovesSelection=R3;C.clickAddsSelectionRange=I3;C.decorations=g9;C.blockWrappers=T3;C.outerDecorations=aZ;C.atomicRanges=B4;C.bidiIsolatedRanges=y3;C.scrollMargins=k3;C.darkTheme=xZ;C.cspNonce=S.define({combine:(Z)=>Z.length?Z[0]:""});C.contentAttributes=iZ;C.editorAttributes=C3;C.lineWrapping=C.contentAttributes.of({class:"cm-lineWrapping"});C.announce=p.define();var eK=4096,c$={};class u9{constructor(Z,$,J,X,Q,Y){this.from=Z,this.to=$,this.dir=J,this.isolates=X,this.fresh=Q,this.order=Y}static update(Z,$){if($.empty&&!Z.some((Q)=>Q.fresh))return Z;let J=[],X=Z.length?Z[Z.length-1].dir:Q0.LTR;for(let Q=Math.max(0,Z.length-10);Q<Z.length;Q++){let Y=Z[Q];if(Y.dir==X&&!$.touchesRange(Y.from,Y.to))J.push(new u9($.mapPos(Y.from,1),$.mapPos(Y.to,-1),Y.dir,Y.isolates,!1,Y.order))}return J}}function s$(Z,$,J){for(let X=Z.state.facet($),Q=X.length-1;Q>=0;Q--){let Y=X[Q],K=typeof Y=="function"?Y(Z):Y;if(K)lZ(K,J)}return J}var ZU=x.mac?"mac":x.windows?"win":x.linux?"linux":"key";function $U(Z,$){let J=Z.split(/-(?!$)/),X=J[J.length-1];if(X=="Space")X=" ";let Q,Y,K,U;for(let q=0;q<J.length-1;++q){let G=J[q];if(/^(cmd|meta|m)$/i.test(G))U=!0;else if(/^a(lt)?$/i.test(G))Q=!0;else if(/^(c|ctrl|control)$/i.test(G))Y=!0;else if(/^s(hift)?$/i.test(G))K=!0;else if(/^mod$/i.test(G))if($=="mac")U=!0;else Y=!0;else throw Error("Unrecognized modifier name: "+G)}if(Q)X="Alt-"+X;if(Y)X="Ctrl-"+X;if(U)X="Meta-"+X;if(K)X="Shift-"+X;return X}function R9(Z,$,J){if($.altKey)Z="Alt-"+Z;if($.ctrlKey)Z="Ctrl-"+Z;if($.metaKey)Z="Meta-"+Z;if(J!==!1&&$.shiftKey)Z="Shift-"+Z;return Z}var JU=O1.default(C.domEventHandlers({keydown(Z,$){return NJ(OJ($.state),Z,$,"editor")}})),C4=S.define({enables:JU}),n$=new WeakMap;function OJ(Z){let $=Z.facet(C4),J=n$.get($);if(!J)n$.set($,J=QU($.reduce((X,Q)=>X.concat(Q),[])));return J}function VJ(Z,$,J){return NJ(OJ(Z.state),$,Z,J)}var p1=null,XU=4000;function QU(Z,$=ZU){let J=Object.create(null),X=Object.create(null),Q=(K,U)=>{let q=X[K];if(q==null)X[K]=U;else if(q!=U)throw Error("Key binding "+K+" is used both as a regular binding and as a multi-stroke prefix")},Y=(K,U,q,G,W)=>{var j,_;let z=J[K]||(J[K]=Object.create(null)),V=U.split(/ (?!$)/).map((R)=>$U(R,$));for(let R=1;R<V.length;R++){let D=V.slice(0,R).join(" ");if(Q(D,!0),!z[D])z[D]={preventDefault:!0,stopPropagation:!1,run:[(M)=>{let L=p1={view:M,prefix:D,scope:K};return setTimeout(()=>{if(p1==L)p1=null},XU),!0}]}}let O=V.join(" ");Q(O,!1);let H=z[O]||(z[O]={preventDefault:!1,stopPropagation:!1,run:((_=(j=z._any)===null||j===void 0?void 0:j.run)===null||_===void 0?void 0:_.slice())||[]});if(q)H.run.push(q);if(G)H.preventDefault=!0;if(W)H.stopPropagation=!0};for(let K of Z){let U=K.scope?K.scope.split(" "):["editor"];if(K.any)for(let G of U){let W=J[G]||(J[G]=Object.create(null));if(!W._any)W._any={preventDefault:!1,stopPropagation:!1,run:[]};let{any:j}=K;for(let _ in W)W[_].run.push((z)=>j(z,vZ))}let q=K[$]||K.key;if(!q)continue;for(let G of U)if(Y(G,q,K.run,K.preventDefault,K.stopPropagation),K.shift)Y(G,"Shift-"+q,K.shift,K.preventDefault,K.stopPropagation)}return J}var vZ=null;function NJ(Z,$,J,X){vZ=$;let Q=I$($),Y=y0(Q,0),K=n0(Y)==Q.length&&Q!=" ",U="",q=!1,G=!1,W=!1;if(p1&&p1.view==J&&p1.scope==X){if(U=p1.prefix+" ",r3.indexOf($.keyCode)<0)G=!0,p1=null}let j=new Set,_=(H)=>{if(H){for(let R of H.run)if(!j.has(R)){if(j.add(R),R(J)){if(H.stopPropagation)W=!0;return!0}}if(H.preventDefault){if(H.stopPropagation)W=!0;G=!0}}return!1},z=Z[X],V,O;if(z){if(_(z[U+R9(Q,$,!K)]))q=!0;else if(K&&($.altKey||$.metaKey||$.ctrlKey)&&!(x.windows&&$.ctrlKey&&$.altKey)&&!(x.mac&&$.altKey&&!($.ctrlKey||$.metaKey))&&(V=w1[$.keyCode])&&V!=Q){if(_(z[U+R9(V,$,!0)]))q=!0;else if($.shiftKey&&(O=P7[$.keyCode])!=Q&&O!=V&&_(z[U+R9(O,$,!1)]))q=!0}else if(K&&$.shiftKey&&_(z[U+R9(Q,$,!0)]))q=!0;if(!q&&_(z._any))q=!0}if(G)q=!0;if(q&&W)$.stopPropagation();return vZ=null,q}class T4{constructor(Z,$,J,X,Q){this.className=Z,this.left=$,this.top=J,this.width=X,this.height=Q}draw(){let Z=document.createElement("div");return Z.className=this.className,this.adjust(Z),Z}update(Z,$){if($.className!=this.className)return!1;return this.adjust(Z),!0}adjust(Z){if(Z.style.left=this.left+"px",Z.style.top=this.top+"px",this.width!=null)Z.style.width=this.width+"px";Z.style.height=this.height+"px"}eq(Z){return this.left==Z.left&&this.top==Z.top&&this.width==Z.width&&this.height==Z.height&&this.className==Z.className}static forRange(Z,$,J){if(J.empty){let X=Z.coordsAtPos(J.head,J.assoc||1);if(!X)return[];let Q=HJ(Z);return[new T4($,X.left-Q.left,X.top-Q.top,null,X.bottom-X.top)]}else return YU(Z,$,J)}}function HJ(Z){let $=Z.scrollDOM.getBoundingClientRect();return{left:(Z.textDirection==Q0.LTR?$.left:$.right-Z.scrollDOM.clientWidth*Z.scaleX)-Z.scrollDOM.scrollLeft*Z.scaleX,top:$.top-Z.scrollDOM.scrollTop*Z.scaleY}}function i$(Z,$,J,X){let Q=Z.coordsAtPos($,J*2);if(!Q)return X;let Y=Z.dom.getBoundingClientRect(),K=(Q.top+Q.bottom)/2,U=Z.posAtCoords({x:Y.left+1,y:K}),q=Z.posAtCoords({x:Y.right-1,y:K});if(U==null||q==null)return X;return{from:Math.max(X.from,Math.min(U,q)),to:Math.min(X.to,Math.max(U,q))}}function YU(Z,$,J){if(J.to<=Z.viewport.from||J.from>=Z.viewport.to)return[];let X=Math.max(J.from,Z.viewport.from),Q=Math.min(J.to,Z.viewport.to),Y=Z.textDirection==Q0.LTR,K=Z.contentDOM,U=K.getBoundingClientRect(),q=HJ(Z),G=K.querySelector(".cm-line"),W=G&&window.getComputedStyle(G),j=U.left+(W?parseInt(W.paddingLeft)+Math.min(0,parseInt(W.textIndent)):0),_=U.right-(W?parseInt(W.paddingRight):0),z=TZ(Z,X,1),V=TZ(Z,Q,-1),O=z.type==b0.Text?z:null,H=V.type==b0.Text?V:null;if(O&&(Z.lineWrapping||z.widgetLineBreaks))O=i$(Z,X,1,O);if(H&&(Z.lineWrapping||V.widgetLineBreaks))H=i$(Z,Q,-1,H);if(O&&H&&O.from==H.from&&O.to==H.to)return D(M(J.from,J.to,O));else{let B=O?M(J.from,null,O):L(z,!1),w=H?M(null,J.to,H):L(V,!0),b=[];if((O||z).to<(H||V).from-(O&&H?1:0)||z.widgetLineBreaks>1&&B.bottom+Z.defaultLineHeight/2<w.top)b.push(R(j,B.bottom,_,w.top));else if(B.bottom<w.top&&Z.elementAtHeight((B.bottom+w.top)/2).type==b0.Text)B.bottom=w.top=(B.bottom+w.top)/2;return D(B).concat(b).concat(D(w))}function R(B,w,b,d){return new T4($,B-q.left,w-q.top,b-B,d-w)}function D({top:B,bottom:w,horizontal:b}){let d=[];for(let a=0;a<b.length;a+=2)d.push(R(b[a],B,b[a+1],w));return d}function M(B,w,b){let d=1e9,a=-1e9,T=[];function P(f,o,R0,P0,Z1){let L0=Z.coordsAtPos(f,f==b.to?-2:2),I=Z.coordsAtPos(R0,R0==b.from?2:-2);if(!L0||!I)return;if(d=Math.min(L0.top,I.top,d),a=Math.max(L0.bottom,I.bottom,a),Z1==Q0.LTR)T.push(Y&&o?j:L0.left,Y&&P0?_:I.right);else T.push(!Y&&P0?j:I.left,!Y&&o?_:L0.right)}let E=B!==null&&B!==void 0?B:b.from,y=w!==null&&w!==void 0?w:b.to;for(let f of Z.visibleRanges)if(f.to>E&&f.from<y)for(let o=Math.max(f.from,E),R0=Math.min(f.to,y);;){let P0=Z.state.doc.lineAt(o);for(let Z1 of Z.bidiSpans(P0)){let L0=Z1.from+P0.from,I=Z1.to+P0.from;if(L0>=R0)break;if(I>o)P(Math.max(L0,o),B==null&&L0<=E,Math.min(I,R0),w==null&&I>=y,Z1.dir)}if(o=P0.to+1,o>=R0)break}if(T.length==0)P(E,B==null,y,w==null,Z.textDirection);return{top:d,bottom:a,horizontal:T}}function L(B,w){let b=U.top+(w?B.top:B.bottom);return{top:b,bottom:b,horizontal:[]}}}function KU(Z,$){return Z.constructor==$.constructor&&Z.eq($)}class IJ{constructor(Z,$){if(this.view=Z,this.layer=$,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=Z.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),$.above)this.dom.classList.add("cm-layer-above");if($.class)this.dom.classList.add($.class);if(this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(Z.state),Z.requestMeasure(this.measureReq),$.mount)$.mount(this.dom,Z)}update(Z){if(Z.startState.facet(P9)!=Z.state.facet(P9))this.setOrder(Z.state);if(this.layer.update(Z,this.dom)||Z.geometryChanged)this.scale(),Z.view.requestMeasure(this.measureReq)}docViewUpdate(Z){if(this.layer.updateOnDocViewUpdate!==!1)Z.requestMeasure(this.measureReq)}setOrder(Z){let $=0,J=Z.facet(P9);while($<J.length&&J[$]!=this.layer)$++;this.dom.style.zIndex=String((this.layer.above?150:-1)-$)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:Z,scaleY:$}=this.view;if(Z!=this.scaleX||$!=this.scaleY)this.scaleX=Z,this.scaleY=$,this.dom.style.transform=`scale(${1/Z}, ${1/$})`}draw(Z){if(Z.length!=this.drawn.length||Z.some(($,J)=>!KU($,this.drawn[J]))){let $=this.dom.firstChild,J=0;for(let X of Z)if(X.update&&$&&X.constructor&&this.drawn[J].constructor&&X.update($,this.drawn[J]))$=$.nextSibling,J++;else this.dom.insertBefore(X.draw(),$);while($){let X=$.nextSibling;$.remove(),$=X}if(this.drawn=Z,x.safari&&x.safari_version>=26)this.dom.style.display=this.dom.firstChild?"":"none"}}destroy(){if(this.layer.destroy)this.layer.destroy(this.dom,this.view);this.dom.remove()}}var P9=S.define();function RJ(Z){return[j0.define(($)=>new IJ($,Z)),P9.of(Z)]}var A4=S.define({combine(Z){return w0(Z,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:($,J)=>Math.min($,J),drawRangeCursor:($,J)=>$||J})}});function FJ(Z={}){return[A4.of(Z),UU,qU,GU,B3.of(!0)]}function DJ(Z){return Z.startState.facet(A4)!=Z.state.facet(A4)}var UU=RJ({above:!0,markers(Z){let{state:$}=Z,J=$.facet(A4),X=[];for(let Q of $.selection.ranges){let Y=Q==$.selection.main;if(Q.empty||J.drawRangeCursor){let K=Y?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",U=Q.empty?Q:A.cursor(Q.head,Q.head>Q.anchor?-1:1);for(let q of T4.forRange(Z,K,U))X.push(q)}}return X},update(Z,$){if(Z.transactions.some((X)=>X.selection))$.style.animationName=$.style.animationName=="cm-blink"?"cm-blink2":"cm-blink";let J=DJ(Z);if(J)a$(Z.state,$);return Z.docChanged||Z.selectionSet||J},mount(Z,$){a$($.state,Z)},class:"cm-cursorLayer"});function a$(Z,$){$.style.animationDuration=Z.facet(A4).cursorBlinkRate+"ms"}var qU=RJ({above:!1,markers(Z){return Z.state.selection.ranges.map(($)=>$.empty?[]:T4.forRange(Z,"cm-selectionBackground",$)).reduce(($,J)=>$.concat(J))},update(Z,$){return Z.docChanged||Z.selectionSet||Z.viewportChanged||DJ(Z)},class:"cm-selectionLayer"}),GU=O1.highest(C.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),AJ=p.define({map(Z,$){return Z==null?null:$.mapPos(Z)}}),z4=_0.define({create(){return null},update(Z,$){if(Z!=null)Z=$.changes.mapPos(Z);return $.effects.reduce((J,X)=>X.is(AJ)?X.value:J,Z)}}),WU=j0.fromClass(class{constructor(Z){this.view=Z,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(Z){var $;let J=Z.state.field(z4);if(J==null){if(this.cursor!=null)($=this.cursor)===null||$===void 0||$.remove(),this.cursor=null}else{if(!this.cursor)this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor";if(Z.startState.field(z4)!=J||Z.docChanged||Z.geometryChanged)this.view.requestMeasure(this.measureReq)}}readPos(){let{view:Z}=this,$=Z.state.field(z4),J=$!=null&&Z.coordsAtPos($);if(!J)return null;let X=Z.scrollDOM.getBoundingClientRect();return{left:J.left-X.left+Z.scrollDOM.scrollLeft*Z.scaleX,top:J.top-X.top+Z.scrollDOM.scrollTop*Z.scaleY,height:J.bottom-J.top}}drawCursor(Z){if(this.cursor){let{scaleX:$,scaleY:J}=this.view;if(Z)this.cursor.style.left=Z.left/$+"px",this.cursor.style.top=Z.top/J+"px",this.cursor.style.height=Z.height/J+"px";else this.cursor.style.left="-100000px"}}destroy(){if(this.cursor)this.cursor.remove()}setDropPos(Z){if(this.view.state.field(z4)!=Z)this.view.dispatch({effects:AJ.of(Z)})}},{eventObservers:{dragover(Z){this.setDropPos(this.view.posAtCoords({x:Z.clientX,y:Z.clientY}))},dragleave(Z){if(Z.target==this.view.contentDOM||!this.view.contentDOM.contains(Z.relatedTarget))this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function MJ(){return[z4,WU]}function r$(Z,$,J,X,Q){$.lastIndex=0;for(let Y=Z.iterRange(J,X),K=J,U;!Y.next().done;K+=Y.value.length)if(!Y.lineBreak)while(U=$.exec(Y.value))Q(K+U.index,U)}function jU(Z,$){let J=Z.visibleRanges;if(J.length==1&&J[0].from==Z.viewport.from&&J[0].to==Z.viewport.to)return J;let X=[];for(let{from:Q,to:Y}of J)if(Q=Math.max(Z.state.doc.lineAt(Q).from,Q-$),Y=Math.min(Z.state.doc.lineAt(Y).to,Y+$),X.length&&X[X.length-1].to>=Q)X[X.length-1].to=Y;else X.push({from:Q,to:Y});return X}class LJ{constructor(Z){let{regexp:$,decoration:J,decorate:X,boundary:Q,maxLength:Y=1000}=Z;if(!$.global)throw RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=$,X)this.addMatch=(K,U,q,G)=>X(G,q,q+K[0].length,K,U);else if(typeof J=="function")this.addMatch=(K,U,q,G)=>{let W=J(K,U,q);if(W)G(q,q+K[0].length,W)};else if(J)this.addMatch=(K,U,q,G)=>G(q,q+K[0].length,J);else throw RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=Q,this.maxLength=Y}createDeco(Z){let $=new s0,J=$.add.bind($);for(let{from:X,to:Q}of jU(Z,this.maxLength))r$(Z.state.doc,this.regexp,X,Q,(Y,K)=>this.addMatch(K,Z,Y,J));return $.finish()}updateDeco(Z,$){let J=1e9,X=-1;if(Z.docChanged)Z.changes.iterChanges((Q,Y,K,U)=>{if(U>=Z.view.viewport.from&&K<=Z.view.viewport.to)J=Math.min(K,J),X=Math.max(U,X)});if(Z.viewportMoved||X-J>1000)return this.createDeco(Z.view);if(X>-1)return this.updateRange(Z.view,$.map(Z.changes),J,X);return $}updateRange(Z,$,J,X){for(let Q of Z.visibleRanges){let Y=Math.max(Q.from,J),K=Math.min(Q.to,X);if(K>=Y){let U=Z.state.doc.lineAt(Y),q=U.to<K?Z.state.doc.lineAt(K):U,G=Math.max(Q.from,U.from),W=Math.min(Q.to,q.to);if(this.boundary){for(;Y>U.from;Y--)if(this.boundary.test(U.text[Y-1-U.from])){G=Y;break}for(;K<q.to;K++)if(this.boundary.test(q.text[K-q.from])){W=K;break}}let j=[],_,z=(V,O,H)=>j.push(H.range(V,O));if(U==q){this.regexp.lastIndex=G-U.from;while((_=this.regexp.exec(U.text))&&_.index<W-U.from)this.addMatch(_,Z,_.index+U.from,z)}else r$(Z.state.doc,this.regexp,G,W,(V,O)=>this.addMatch(O,Z,V,z));$=$.update({filterFrom:G,filterTo:W,filter:(V,O)=>V<G||O>W,add:j})}}return $}}var uZ=/x/.unicode!=null?"gu":"g",_U=new RegExp(`[\x00-\b
-\x1F-­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,uZ),zU={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},OZ=null;function OU(){var Z;if(OZ==null&&typeof document<"u"&&document.body){let $=document.body.style;OZ=((Z=$.tabSize)!==null&&Z!==void 0?Z:$.MozTabSize)!=null}return OZ||!1}var C9=S.define({combine(Z){let $=w0(Z,{render:null,specialChars:_U,addSpecialChars:null});if($.replaceTabs=!OU())$.specialChars=new RegExp("\t|"+$.specialChars.source,uZ);if($.addSpecialChars)$.specialChars=new RegExp($.specialChars.source+"|"+$.addSpecialChars.source,uZ);return $}});function BJ(Z={}){return[C9.of(Z),VU()]}var o$=null;function VU(){return o$||(o$=j0.fromClass(class{constructor(Z){this.view=Z,this.decorations=m.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(Z.state.facet(C9)),this.decorations=this.decorator.createDeco(Z)}makeDecorator(Z){return new LJ({regexp:Z.specialChars,decoration:($,J,X)=>{let{doc:Q}=J.state,Y=y0($[0],0);if(Y==9){let K=Q.lineAt(X),U=J.state.tabSize,q=x1(K.text,U,X-K.from);return m.replace({widget:new PJ((U-q%U)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[Y]||(this.decorationCache[Y]=m.replace({widget:new EJ(Z,Y)}))},boundary:Z.replaceTabs?void 0:/[^]/})}update(Z){let $=Z.state.facet(C9);if(Z.startState.facet(C9)!=$)this.decorator=this.makeDecorator($),this.decorations=this.decorator.createDeco(Z.view);else this.decorations=this.decorator.updateDeco(Z,this.decorations)}},{decorations:(Z)=>Z.decorations}))}var NU="•";function HU(Z){if(Z>=32)return NU;if(Z==10)return"␤";return String.fromCharCode(9216+Z)}class EJ extends r0{constructor(Z,$){super();this.options=Z,this.code=$}eq(Z){return Z.code==this.code}toDOM(Z){let $=HU(this.code),J=Z.state.phrase("Control character")+" "+(zU[this.code]||"0x"+this.code.toString(16)),X=this.options.render&&this.options.render(this.code,J,$);if(X)return X;let Q=document.createElement("span");return Q.textContent=$,Q.title=J,Q.setAttribute("aria-label",J),Q.className="cm-specialChar",Q}ignoreEvent(){return!1}}class PJ extends r0{constructor(Z){super();this.width=Z}eq(Z){return Z.width==this.width}toDOM(){let Z=document.createElement("span");return Z.textContent="\t",Z.className="cm-tab",Z.style.width=this.width+"px",Z}ignoreEvent(){return!1}}function CJ(){return RU}var IU=m.line({class:"cm-activeLine"}),RU=j0.fromClass(class{constructor(Z){this.decorations=this.getDeco(Z)}update(Z){if(Z.docChanged||Z.selectionSet)this.decorations=this.getDeco(Z.view)}getDeco(Z){let $=-1,J=[];for(let X of Z.state.selection.ranges){let Q=Z.lineBlockAt(X.head);if(Q.from>$)J.push(IU.range(Q.from)),$=Q.from}return m.set(J)}},{decorations:(Z)=>Z.decorations});var mZ=2000;function FU(Z,$,J){let X=Math.min($.line,J.line),Q=Math.max($.line,J.line),Y=[];if($.off>mZ||J.off>mZ||$.col<0||J.col<0){let K=Math.min($.off,J.off),U=Math.max($.off,J.off);for(let q=X;q<=Q;q++){let G=Z.doc.line(q);if(G.length<=U)Y.push(A.range(G.from+K,G.to+U))}}else{let K=Math.min($.col,J.col),U=Math.max($.col,J.col);for(let q=X;q<=Q;q++){let G=Z.doc.line(q),W=_9(G.text,K,Z.tabSize,!0);if(W<0)Y.push(A.cursor(G.to));else{let j=_9(G.text,U,Z.tabSize);Y.push(A.range(G.from+W,G.from+j))}}}return Y}function DU(Z,$){let J=Z.coordsAtPos(Z.viewport.from);return J?Math.round(Math.abs((J.left-$)/Z.defaultCharacterWidth)):-1}function t$(Z,$){let J=Z.posAtCoords({x:$.clientX,y:$.clientY},!1),X=Z.state.doc.lineAt(J),Q=J-X.from,Y=Q>mZ?-1:Q==X.length?DU(Z,$.clientX):x1(X.text,Z.state.tabSize,J-X.from);return{line:X.number,col:Y,off:Q}}function AU(Z,$){let J=t$(Z,$),X=Z.state.selection;if(!J)return null;return{update(Q){if(Q.docChanged){let Y=Q.changes.mapPos(Q.startState.doc.line(J.line).from),K=Q.state.doc.lineAt(Y);J={line:K.number,col:J.col,off:Math.min(J.off,K.length)},X=X.map(Q.changes)}},get(Q,Y,K){let U=t$(Z,Q);if(!U)return X;let q=FU(Z.state,J,U);if(!q.length)return X;if(K)return A.create(q.concat(X.ranges));else return A.create(q)}}}function TJ(Z){let $=(Z===null||Z===void 0?void 0:Z.eventFilter)||((J)=>J.altKey&&J.button==0);return C.mouseSelectionStyle.of((J,X)=>$(X)?AU(J,X):null)}var MU={Alt:[18,(Z)=>!!Z.altKey],Control:[17,(Z)=>!!Z.ctrlKey],Shift:[16,(Z)=>!!Z.shiftKey],Meta:[91,(Z)=>!!Z.metaKey]},LU={style:"cursor: crosshair"};function yJ(Z={}){let[$,J]=MU[Z.key||"Alt"],X=j0.fromClass(class{constructor(Q){this.view=Q,this.isDown=!1}set(Q){if(this.isDown!=Q)this.isDown=Q,this.view.update([])}},{eventObservers:{keydown(Q){this.set(Q.keyCode==$||J(Q))},keyup(Q){if(Q.keyCode==$||!J(Q))this.set(!1)},mousemove(Q){this.set(J(Q))}}});return[X,C.contentAttributes.of((Q)=>{var Y;return((Y=Q.plugin(X))===null||Y===void 0?void 0:Y.isDown)?LU:null})]}var F9="-10000px";class $5{constructor(Z,$,J,X){this.facet=$,this.createTooltipView=J,this.removeTooltipView=X,this.input=Z.state.facet($),this.tooltips=this.input.filter((Y)=>Y);let Q=null;this.tooltipViews=this.tooltips.map((Y)=>Q=J(Y,Q))}update(Z,$){var J;let X=Z.state.facet(this.facet),Q=X.filter((U)=>U);if(X===this.input){for(let U of this.tooltipViews)if(U.update)U.update(Z);return!1}let Y=[],K=$?[]:null;for(let U=0;U<Q.length;U++){let q=Q[U],G=-1;if(!q)continue;for(let W=0;W<this.tooltips.length;W++){let j=this.tooltips[W];if(j&&j.create==q.create)G=W}if(G<0){if(Y[U]=this.createTooltipView(q,U?Y[U-1]:null),K)K[U]=!!q.above}else{let W=Y[U]=this.tooltipViews[G];if(K)K[U]=$[G];if(W.update)W.update(Z)}}for(let U of this.tooltipViews)if(Y.indexOf(U)<0)this.removeTooltipView(U),(J=U.destroy)===null||J===void 0||J.call(U);if($)K.forEach((U,q)=>$[q]=U),$.length=K.length;return this.input=X,this.tooltips=Q,this.tooltipViews=Y,!0}}function BU(Z){let $=Z.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:$.clientHeight,right:$.clientWidth}}var VZ=S.define({combine:(Z)=>{var $,J,X;return{position:x.ios?"absolute":(($=Z.find((Q)=>Q.position))===null||$===void 0?void 0:$.position)||"fixed",parent:((J=Z.find((Q)=>Q.parent))===null||J===void 0?void 0:J.parent)||null,tooltipSpace:((X=Z.find((Q)=>Q.tooltipSpace))===null||X===void 0?void 0:X.tooltipSpace)||BU}}}),e$=new WeakMap,J5=j0.fromClass(class{constructor(Z){this.view=Z,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let $=Z.state.facet(VZ);this.position=$.position,this.parent=$.parent,this.classes=Z.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new $5(Z,y4,(J,X)=>this.createTooltip(J,X),(J)=>{if(this.resizeObserver)this.resizeObserver.unobserve(J.dom);J.dom.remove()}),this.above=this.manager.tooltips.map((J)=>!!J.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver((J)=>{if(Date.now()>this.lastTransaction-50&&J.length>0&&J[J.length-1].intersectionRatio<1)this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),Z.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){if(this.parent)this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container);else this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let Z of this.manager.tooltipViews)this.intersectionObserver.observe(Z.dom)}}measureSoon(){if(this.measureTimeout<0)this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50)}update(Z){if(Z.transactions.length)this.lastTransaction=Date.now();let $=this.manager.update(Z,this.above);if($)this.observeIntersection();let J=$||Z.geometryChanged,X=Z.state.facet(VZ);if(X.position!=this.position&&!this.madeAbsolute){this.position=X.position;for(let Q of this.manager.tooltipViews)Q.dom.style.position=this.position;J=!0}if(X.parent!=this.parent){if(this.parent)this.container.remove();this.parent=X.parent,this.createContainer();for(let Q of this.manager.tooltipViews)this.container.appendChild(Q.dom);J=!0}else if(this.parent&&this.view.themeClasses!=this.classes)this.classes=this.container.className=this.view.themeClasses;if(J)this.maybeMeasure()}createTooltip(Z,$){let J=Z.create(this.view),X=$?$.dom:null;if(J.dom.classList.add("cm-tooltip"),Z.arrow&&!J.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let Q=document.createElement("div");Q.className="cm-tooltip-arrow",J.dom.appendChild(Q)}if(J.dom.style.position=this.position,J.dom.style.top=F9,J.dom.style.left="0px",this.container.insertBefore(J.dom,X),J.mount)J.mount(this.view);if(this.resizeObserver)this.resizeObserver.observe(J.dom);return J}destroy(){var Z,$,J;this.view.win.removeEventListener("resize",this.measureSoon);for(let X of this.manager.tooltipViews)X.dom.remove(),(Z=X.destroy)===null||Z===void 0||Z.call(X);if(this.parent)this.container.remove();($=this.resizeObserver)===null||$===void 0||$.disconnect(),(J=this.intersectionObserver)===null||J===void 0||J.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let Z=1,$=1,J=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:Y}=this.manager.tooltipViews[0];if(x.safari){let K=Y.getBoundingClientRect();J=Math.abs(K.top+1e4)>1||Math.abs(K.left)>1}else J=!!Y.offsetParent&&Y.offsetParent!=this.container.ownerDocument.body}if(J||this.position=="absolute")if(this.parent){let Y=this.parent.getBoundingClientRect();if(Y.width&&Y.height)Z=Y.width/this.parent.offsetWidth,$=Y.height/this.parent.offsetHeight}else({scaleX:Z,scaleY:$}=this.view.viewState);let X=this.view.scrollDOM.getBoundingClientRect(),Q=rZ(this.view);return{visible:{left:X.left+Q.left,top:X.top+Q.top,right:X.right-Q.right,bottom:X.bottom-Q.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((Y,K)=>{let U=this.manager.tooltipViews[K];return U.getCoords?U.getCoords(Y.pos):this.view.coordsAtPos(Y.pos)}),size:this.manager.tooltipViews.map(({dom:Y})=>Y.getBoundingClientRect()),space:this.view.state.facet(VZ).tooltipSpace(this.view),scaleX:Z,scaleY:$,makeAbsolute:J}}writeMeasure(Z){var $;if(Z.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let U of this.manager.tooltipViews)U.dom.style.position="absolute"}let{visible:J,space:X,scaleX:Q,scaleY:Y}=Z,K=[];for(let U=0;U<this.manager.tooltips.length;U++){let q=this.manager.tooltips[U],G=this.manager.tooltipViews[U],{dom:W}=G,j=Z.pos[U],_=Z.size[U];if(!j||q.clip!==!1&&(j.bottom<=Math.max(J.top,X.top)||j.top>=Math.min(J.bottom,X.bottom)||j.right<Math.max(J.left,X.left)-0.1||j.left>Math.min(J.right,X.right)+0.1)){W.style.top=F9;continue}let z=q.arrow?G.dom.querySelector(".cm-tooltip-arrow"):null,V=z?7:0,O=_.right-_.left,H=($=e$.get(G))!==null&&$!==void 0?$:_.bottom-_.top,R=G.offset||PU,D=this.view.textDirection==Q0.LTR,M=_.width>X.right-X.left?D?X.left:X.right-_.width:D?Math.max(X.left,Math.min(j.left-(z?14:0)+R.x,X.right-O)):Math.min(Math.max(X.left,j.left-O+(z?14:0)-R.x),X.right-O),L=this.above[U];if(!q.strictSide&&(L?j.top-H-V-R.y<X.top:j.bottom+H+V+R.y>X.bottom)&&L==X.bottom-j.bottom>j.top-X.top)L=this.above[U]=!L;let B=(L?j.top-X.top:X.bottom-j.bottom)-V;if(B<H&&G.resize!==!1){if(B<this.view.defaultLineHeight){W.style.top=F9;continue}e$.set(G,H),W.style.height=(H=B)/Y+"px"}else if(W.style.height)W.style.height="";let w=L?j.top-H-V-R.y:j.bottom+V+R.y,b=M+O;if(G.overlap!==!0){for(let d of K)if(d.left<b&&d.right>M&&d.top<w+H&&d.bottom>w)w=L?d.top-H-2-V:d.bottom+V+2}if(this.position=="absolute")W.style.top=(w-Z.parent.top)/Y+"px",Z3(W,(M-Z.parent.left)/Q);else W.style.top=w/Y+"px",Z3(W,M/Q);if(z){let d=j.left+(D?R.x:-R.x)-(M+14-7);z.style.left=d/Q+"px"}if(G.overlap!==!0)K.push({left:M,top:w,right:b,bottom:w+H});if(W.classList.toggle("cm-tooltip-above",L),W.classList.toggle("cm-tooltip-below",!L),G.positioned)G.positioned(Z.space)}}maybeMeasure(){if(this.manager.tooltips.length){if(this.view.inView)this.view.requestMeasure(this.measureReq);if(this.inView!=this.view.inView){if(this.inView=this.view.inView,!this.inView)for(let Z of this.manager.tooltipViews)Z.dom.style.top=F9}}}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Z3(Z,$){let J=parseInt(Z.style.left,10);if(isNaN(J)||Math.abs($-J)>1)Z.style.left=$+"px"}var EU=C.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),PU={x:0,y:0},y4=S.define({enables:[J5,EU]}),m9=S.define({combine:(Z)=>Z.reduce(($,J)=>$.concat(J),[])});class l9{static create(Z){return new l9(Z)}constructor(Z){this.view=Z,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new $5(Z,m9,($,J)=>this.createHostedView($,J),($)=>$.dom.remove())}createHostedView(Z,$){let J=Z.create(this.view);if(J.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(J.dom,$?$.dom.nextSibling:this.dom.firstChild),this.mounted&&J.mount)J.mount(this.view);return J}mount(Z){for(let $ of this.manager.tooltipViews)if($.mount)$.mount(Z);this.mounted=!0}positioned(Z){for(let $ of this.manager.tooltipViews)if($.positioned)$.positioned(Z)}update(Z){this.manager.update(Z)}destroy(){var Z;for(let $ of this.manager.tooltipViews)(Z=$.destroy)===null||Z===void 0||Z.call($)}passProp(Z){let $=void 0;for(let J of this.manager.tooltipViews){let X=J[Z];if(X!==void 0){if($===void 0)$=X;else if($!==X)return}}return $}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}var CU=y4.compute([m9],(Z)=>{let $=Z.facet(m9);if($.length===0)return null;return{pos:Math.min(...$.map((J)=>J.pos)),end:Math.max(...$.map((J)=>{var X;return(X=J.end)!==null&&X!==void 0?X:J.pos})),create:l9.create,above:$[0].above,arrow:$.some((J)=>J.arrow)}});class kJ{constructor(Z,$,J,X,Q){this.view=Z,this.source=$,this.field=J,this.setHover=X,this.hoverTime=Q,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:Z.dom,time:0},this.checkHover=this.checkHover.bind(this),Z.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),Z.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){if(this.pending)this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20)}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let Z=Date.now()-this.lastMove.time;if(Z<this.hoverTime)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-Z);else this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:Z,lastMove:$}=this,J=Z.docView.tile.nearest($.target);if(!J)return;let X,Q=1;if(J.isWidget())X=J.posAtStart;else{if(X=Z.posAtCoords($),X==null)return;let K=Z.coordsAtPos(X);if(!K||$.y<K.top||$.y>K.bottom||$.x<K.left-Z.defaultCharacterWidth||$.x>K.right+Z.defaultCharacterWidth)return;let U=Z.bidiSpans(Z.state.doc.lineAt(X)).find((G)=>G.from<=X&&G.to>=X),q=U&&U.dir==Q0.RTL?-1:1;Q=$.x<K.left?-q:q}let Y=this.source(Z,X,Q);if(Y===null||Y===void 0?void 0:Y.then){let K=this.pending={pos:X};Y.then((U)=>{if(this.pending==K){if(this.pending=null,U&&!(Array.isArray(U)&&!U.length))Z.dispatch({effects:this.setHover.of(Array.isArray(U)?U:[U])})}},(U)=>S0(Z.state,U,"hover tooltip"))}else if(Y&&!(Array.isArray(Y)&&!Y.length))Z.dispatch({effects:this.setHover.of(Array.isArray(Y)?Y:[Y])})}get tooltip(){let Z=this.view.plugin(J5),$=Z?Z.manager.tooltips.findIndex((J)=>J.create==l9.create):-1;return $>-1?Z.manager.tooltipViews[$]:null}mousemove(Z){var $,J;if(this.lastMove={x:Z.clientX,y:Z.clientY,target:Z.target,time:Date.now()},this.hoverTimeout<0)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime);let{active:X,tooltip:Q}=this;if(X.length&&Q&&!TU(Q.dom,Z)||this.pending){let{pos:Y}=X[0]||this.pending,K=(J=($=X[0])===null||$===void 0?void 0:$.end)!==null&&J!==void 0?J:Y;if(Y==K?this.view.posAtCoords(this.lastMove)!=Y:!yU(this.view,Y,K,Z.clientX,Z.clientY))this.view.dispatch({effects:this.setHover.of([])}),this.pending=null}}mouseleave(Z){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:$}=this;if($.length){let{tooltip:J}=this;if(!(J&&J.dom.contains(Z.relatedTarget)))this.view.dispatch({effects:this.setHover.of([])});else this.watchTooltipLeave(J.dom)}}watchTooltipLeave(Z){let $=(J)=>{if(Z.removeEventListener("mouseleave",$),this.active.length&&!this.view.dom.contains(J.relatedTarget))this.view.dispatch({effects:this.setHover.of([])})};Z.addEventListener("mouseleave",$)}destroy(){clearTimeout(this.hoverTimeout),clearTimeout(this.restartTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}var D9=4;function TU(Z,$){let{left:J,right:X,top:Q,bottom:Y}=Z.getBoundingClientRect(),K;if(K=Z.querySelector(".cm-tooltip-arrow")){let U=K.getBoundingClientRect();Q=Math.min(U.top,Q),Y=Math.max(U.bottom,Y)}return $.clientX>=J-D9&&$.clientX<=X+D9&&$.clientY>=Q-D9&&$.clientY<=Y+D9}function yU(Z,$,J,X,Q,Y){let K=Z.scrollDOM.getBoundingClientRect(),U=Z.documentTop+Z.documentPadding.top+Z.contentHeight;if(K.left>X||K.right<X||K.top>Q||Math.min(K.bottom,U)<Q)return!1;let q=Z.posAtCoords({x:X,y:Q},!1);return q>=$&&q<=J}function SJ(Z,$={}){let J=p.define(),X=_0.define({create(){return[]},update(Q,Y){if(Q.length){if($.hideOnChange&&(Y.docChanged||Y.selection))Q=[];else if($.hideOn)Q=Q.filter((K)=>!$.hideOn(Y,K));if(Y.docChanged){let K=[];for(let U of Q){let q=Y.changes.mapPos(U.pos,-1,T0.TrackDel);if(q!=null){let G=Object.assign(Object.create(null),U);if(G.pos=q,G.end!=null)G.end=Y.changes.mapPos(G.end);K.push(G)}}Q=K}}for(let K of Y.effects){if(K.is(J))Q=K.value;if(K.is(kU))Q=[]}return Q},provide:(Q)=>m9.from(Q)});return{active:X,extension:[X,j0.define((Q)=>new kJ(Q,Z,X,J,$.hoverTime||300)),CU]}}function X5(Z,$){let J=Z.plugin(J5);if(!J)return null;let X=J.manager.tooltips.indexOf($);return X<0?null:J.manager.tooltipViews[X]}var kU=p.define();var $3=S.define({combine(Z){let $,J;for(let X of Z)$=$||X.topContainer,J=J||X.bottomContainer;return{topContainer:$,bottomContainer:J}}});function k4(Z,$){let J=Z.plugin(bJ),X=J?J.specs.indexOf($):-1;return X>-1?J.panels[X]:null}var bJ=j0.fromClass(class{constructor(Z){this.input=Z.state.facet(_7),this.specs=this.input.filter((J)=>J),this.panels=this.specs.map((J)=>J(Z));let $=Z.state.facet($3);this.top=new O4(Z,!0,$.topContainer),this.bottom=new O4(Z,!1,$.bottomContainer),this.top.sync(this.panels.filter((J)=>J.top)),this.bottom.sync(this.panels.filter((J)=>!J.top));for(let J of this.panels)if(J.dom.classList.add("cm-panel"),J.mount)J.mount()}update(Z){let $=Z.state.facet($3);if(this.top.container!=$.topContainer)this.top.sync([]),this.top=new O4(Z.view,!0,$.topContainer);if(this.bottom.container!=$.bottomContainer)this.bottom.sync([]),this.bottom=new O4(Z.view,!1,$.bottomContainer);this.top.syncClasses(),this.bottom.syncClasses();let J=Z.state.facet(_7);if(J!=this.input){let X=J.filter((q)=>q),Q=[],Y=[],K=[],U=[];for(let q of X){let G=this.specs.indexOf(q),W;if(G<0)W=q(Z.view),U.push(W);else if(W=this.panels[G],W.update)W.update(Z);Q.push(W),(W.top?Y:K).push(W)}this.specs=X,this.panels=Q,this.top.sync(Y),this.bottom.sync(K);for(let q of U)if(q.dom.classList.add("cm-panel"),q.mount)q.mount()}else for(let X of this.panels)if(X.update)X.update(Z)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:(Z)=>C.scrollMargins.of(($)=>{let J=$.plugin(Z);return J&&{top:J.top.scrollMargin(),bottom:J.bottom.scrollMargin()}})});class O4{constructor(Z,$,J){this.view=Z,this.top=$,this.container=J,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(Z){for(let $ of this.panels)if($.destroy&&Z.indexOf($)<0)$.destroy();this.panels=Z,this.syncDOM()}syncDOM(){if(this.panels.length==0){if(this.dom)this.dom.remove(),this.dom=void 0;return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let $=this.container||this.view.dom;$.insertBefore(this.dom,this.top?$.firstChild:null)}let Z=this.dom.firstChild;for(let $ of this.panels)if($.dom.parentNode==this.dom){while(Z!=$.dom)Z=J3(Z);Z=Z.nextSibling}else this.dom.insertBefore($.dom,Z);while(Z)Z=J3(Z)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!this.container||this.classes==this.view.themeClasses)return;for(let Z of this.classes.split(" "))if(Z)this.container.classList.remove(Z);for(let Z of(this.classes=this.view.themeClasses).split(" "))if(Z)this.container.classList.add(Z)}}function J3(Z){let $=Z.nextSibling;return Z.remove(),$}var _7=S.define({enables:bJ});function xJ(Z,$){let J,X=new Promise((K)=>J=K),Q=(K)=>SU(K,$,J);if(Z.state.field(NZ,!1))Z.dispatch({effects:wJ.of(Q)});else Z.dispatch({effects:p.appendConfig.of(NZ.init(()=>[Q]))});let Y=hJ.of(Q);return{close:Y,result:X.then((K)=>{return(Z.win.queueMicrotask||((q)=>Z.win.setTimeout(q,10)))(()=>{if(Z.state.field(NZ).indexOf(Q)>-1)Z.dispatch({effects:Y})}),K})}}var NZ=_0.define({create(){return[]},update(Z,$){for(let J of $.effects)if(J.is(wJ))Z=[J.value].concat(Z);else if(J.is(hJ))Z=Z.filter((X)=>X!=J.value);return Z},provide:(Z)=>_7.computeN([Z],($)=>$.field(Z))}),wJ=p.define(),hJ=p.define();function SU(Z,$,J){let X=$.content?$.content(Z,()=>K(null)):null;if(!X){if(X=$0("form"),$.input){let U=$0("input",$.input);if(/^(text|password|number|email|tel|url)$/.test(U.type))U.classList.add("cm-textfield");if(!U.name)U.name="input";X.appendChild($0("label",($.label||"")+": ",U))}else X.appendChild(document.createTextNode($.label||""));X.appendChild(document.createTextNode(" ")),X.appendChild($0("button",{class:"cm-button",type:"submit"},$.submitLabel||"OK"))}let Q=X.nodeName=="FORM"?[X]:X.querySelectorAll("form");for(let U=0;U<Q.length;U++){let q=Q[U];q.addEventListener("keydown",(G)=>{if(G.keyCode==27)G.preventDefault(),K(null);else if(G.keyCode==13)G.preventDefault(),K(q)}),q.addEventListener("submit",(G)=>{G.preventDefault(),K(q)})}let Y=$0("div",X,$0("button",{onclick:()=>K(null),"aria-label":Z.state.phrase("close"),class:"cm-dialog-close",type:"button"},["×"]));if($.class)Y.className=$.class;Y.classList.add("cm-dialog");function K(U){if(Y.contains(Y.ownerDocument.activeElement))Z.focus();J(U)}return{dom:Y,top:$.top,mount:()=>{if($.focus){let U;if(typeof $.focus=="string")U=X.querySelector($.focus);else U=X.querySelector("input")||X.querySelector("button");if(U&&"select"in U)U.select();else if(U&&"focus"in U)U.focus()}}}}class X1 extends z1{compare(Z){return this==Z||this.constructor==Z.constructor&&this.eq(Z)}eq(Z){return!1}destroy(Z){}}X1.prototype.elementClass="";X1.prototype.toDOM=void 0;X1.prototype.mapMode=T0.TrackBefore;X1.prototype.startSide=X1.prototype.endSide=-1;X1.prototype.point=!0;var T9=S.define(),bU=S.define(),xU={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>i.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},I4=S.define();function Q5(Z){return[vJ(),I4.of({...xU,...Z})]}var fZ=S.define({combine:(Z)=>Z.some(($)=>$)});function vJ(Z){let $=[wU];if(Z&&Z.fixed===!1)$.push(fZ.of(!0));return $}var wU=j0.fromClass(class{constructor(Z){this.view=Z,this.domAfter=null,this.prevViewport=Z.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=Z.state.facet(I4).map(($)=>new pZ(Z,$)),this.fixed=!Z.state.facet(fZ);for(let $ of this.gutters)if($.config.side=="after")this.getDOMAfter().appendChild($.dom);else this.dom.appendChild($.dom);if(this.fixed)this.dom.style.position="sticky";this.syncGutters(!1),Z.scrollDOM.insertBefore(this.dom,Z.contentDOM)}getDOMAfter(){if(!this.domAfter)this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter);return this.domAfter}update(Z){if(this.updateGutters(Z)){let $=this.prevViewport,J=Z.view.viewport,X=Math.min($.to,J.to)-Math.max($.from,J.from);this.syncGutters(X<(J.to-J.from)*0.8)}if(Z.geometryChanged){let $=this.view.contentHeight/this.view.scaleY+"px";if(this.dom.style.minHeight=$,this.domAfter)this.domAfter.style.minHeight=$}if(this.view.state.facet(fZ)!=!this.fixed){if(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter)this.domAfter.style.position=this.fixed?"sticky":""}this.prevViewport=Z.view.viewport}syncGutters(Z){let $=this.dom.nextSibling;if(Z){if(this.dom.remove(),this.domAfter)this.domAfter.remove()}let J=i.iter(this.view.state.facet(T9),this.view.viewport.from),X=[],Q=this.gutters.map((Y)=>new uJ(Y,this.view.viewport,-this.view.documentPadding.top));for(let Y of this.view.viewportLineBlocks){if(X.length)X=[];if(Array.isArray(Y.type)){let K=!0;for(let U of Y.type)if(U.type==b0.Text&&K){gZ(J,X,U.from);for(let q of Q)q.line(this.view,U,X);K=!1}else if(U.widget)for(let q of Q)q.widget(this.view,U)}else if(Y.type==b0.Text){gZ(J,X,Y.from);for(let K of Q)K.line(this.view,Y,X)}else if(Y.widget)for(let K of Q)K.widget(this.view,Y)}for(let Y of Q)Y.finish();if(Z){if(this.view.scrollDOM.insertBefore(this.dom,$),this.domAfter)this.view.scrollDOM.appendChild(this.domAfter)}}updateGutters(Z){let $=Z.startState.facet(I4),J=Z.state.facet(I4),X=Z.docChanged||Z.heightChanged||Z.viewportChanged||!i.eq(Z.startState.facet(T9),Z.state.facet(T9),Z.view.viewport.from,Z.view.viewport.to);if($==J){for(let Q of this.gutters)if(Q.update(Z))X=!0}else{X=!0;let Q=[];for(let Y of J){let K=$.indexOf(Y);if(K<0)Q.push(new pZ(this.view,Y));else this.gutters[K].update(Z),Q.push(this.gutters[K])}for(let Y of this.gutters)if(Y.dom.remove(),Q.indexOf(Y)<0)Y.destroy();for(let Y of Q)if(Y.config.side=="after")this.getDOMAfter().appendChild(Y.dom);else this.dom.appendChild(Y.dom);this.gutters=Q}return X}destroy(){for(let Z of this.gutters)Z.destroy();if(this.dom.remove(),this.domAfter)this.domAfter.remove()}},{provide:(Z)=>C.scrollMargins.of(($)=>{let J=$.plugin(Z);if(!J||J.gutters.length==0||!J.fixed)return null;let X=J.dom.offsetWidth*$.scaleX,Q=J.domAfter?J.domAfter.offsetWidth*$.scaleX:0;return $.textDirection==Q0.LTR?{left:X,right:Q}:{right:X,left:Q}})});function X3(Z){return Array.isArray(Z)?Z:[Z]}function gZ(Z,$,J){while(Z.value&&Z.from<=J){if(Z.from==J)$.push(Z.value);Z.next()}}class uJ{constructor(Z,$,J){this.gutter=Z,this.height=J,this.i=0,this.cursor=i.iter(Z.markers,$.from)}addElement(Z,$,J){let{gutter:X}=this,Q=($.top-this.height)/Z.scaleY,Y=$.height/Z.scaleY;if(this.i==X.elements.length){let K=new Y5(Z,Y,Q,J);X.elements.push(K),X.dom.appendChild(K.dom)}else X.elements[this.i].update(Z,Y,Q,J);this.height=$.bottom,this.i++}line(Z,$,J){let X=[];if(gZ(this.cursor,X,$.from),J.length)X=X.concat(J);let Q=this.gutter.config.lineMarker(Z,$,X);if(Q)X.unshift(Q);let Y=this.gutter;if(X.length==0&&!Y.config.renderEmptyElements)return;this.addElement(Z,$,X)}widget(Z,$){let J=this.gutter.config.widgetMarker(Z,$.widget,$),X=J?[J]:null;for(let Q of Z.state.facet(bU)){let Y=Q(Z,$.widget,$);if(Y)(X||(X=[])).push(Y)}if(X)this.addElement(Z,$,X)}finish(){let Z=this.gutter;while(Z.elements.length>this.i){let $=Z.elements.pop();Z.dom.removeChild($.dom),$.destroy()}}}class pZ{constructor(Z,$){this.view=Z,this.config=$,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let J in $.domEventHandlers)this.dom.addEventListener(J,(X)=>{let Q=X.target,Y;if(Q!=this.dom&&this.dom.contains(Q)){while(Q.parentNode!=this.dom)Q=Q.parentNode;let U=Q.getBoundingClientRect();Y=(U.top+U.bottom)/2}else Y=X.clientY;let K=Z.lineBlockAtHeight(Y-Z.documentTop);if($.domEventHandlers[J](Z,K,X))X.preventDefault()});if(this.markers=X3($.markers(Z)),$.initialSpacer)this.spacer=new Y5(Z,0,0,[$.initialSpacer(Z)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none"}update(Z){let $=this.markers;if(this.markers=X3(this.config.markers(Z.view)),this.spacer&&this.config.updateSpacer){let X=this.config.updateSpacer(this.spacer.markers[0],Z);if(X!=this.spacer.markers[0])this.spacer.update(Z.view,0,0,[X])}let J=Z.view.viewport;return!i.eq(this.markers,$,J.from,J.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(Z):!1)}destroy(){for(let Z of this.elements)Z.destroy()}}class Y5{constructor(Z,$,J,X){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(Z,$,J,X)}update(Z,$,J,X){if(this.height!=$)this.height=$,this.dom.style.height=$+"px";if(this.above!=J)this.dom.style.marginTop=(this.above=J)?J+"px":"";if(!hU(this.markers,X))this.setMarkers(Z,X)}setMarkers(Z,$){let J="cm-gutterElement",X=this.dom.firstChild;for(let Q=0,Y=0;;){let K=Y,U=Q<$.length?$[Q++]:null,q=!1;if(U){let G=U.elementClass;if(G)J+=" "+G;for(let W=Y;W<this.markers.length;W++)if(this.markers[W].compare(U)){K=W,q=!0;break}}else K=this.markers.length;while(Y<K){let G=this.markers[Y++];if(G.toDOM){G.destroy(X);let W=X.nextSibling;X.remove(),X=W}}if(!U)break;if(U.toDOM)if(q)X=X.nextSibling;else this.dom.insertBefore(U.toDOM(Z),X);if(q)Y++}this.dom.className=J,this.markers=$}destroy(){this.setMarkers(null,[])}}function hU(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++)if(!Z[J].compare($[J]))return!1;return!0}var vU=S.define(),uU=S.define(),T7=S.define({combine(Z){return w0(Z,{formatNumber:String,domEventHandlers:{}},{domEventHandlers($,J){let X=Object.assign({},$);for(let Q in J){let Y=X[Q],K=J[Q];X[Q]=Y?(U,q,G)=>Y(U,q,G)||K(U,q,G):K}return X}})}});class y9 extends X1{constructor(Z){super();this.number=Z}eq(Z){return this.number==Z.number}toDOM(){return document.createTextNode(this.number)}}function HZ(Z,$){return Z.state.facet(T7).formatNumber($,Z.state)}var mU=I4.compute([T7],(Z)=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers($){return $.state.facet(vU)},lineMarker($,J,X){if(X.some((Q)=>Q.toDOM))return null;return new y9(HZ($,$.state.doc.lineAt(J.from).number))},widgetMarker:($,J,X)=>{for(let Q of $.state.facet(uU)){let Y=Q($,J,X);if(Y)return Y}return null},lineMarkerChange:($)=>$.startState.facet(T7)!=$.state.facet(T7),initialSpacer($){return new y9(HZ($,Q3($.state.doc.lines)))},updateSpacer($,J){let X=HZ(J.view,Q3(J.view.state.doc.lines));return X==$.number?$:new y9(X)},domEventHandlers:Z.facet(T7).domEventHandlers,side:"before"}));function mJ(Z={}){return[T7.of(Z),vJ(),mU]}function Q3(Z){let $=9;while($<Z)$=$*10+9;return $}var fU=new class extends X1{constructor(){super(...arguments);this.elementClass="cm-activeLineGutter"}},gU=T9.compute(["selection"],(Z)=>{let $=[],J=-1;for(let X of Z.selection.ranges){let Q=Z.doc.lineAt(X.head).from;if(Q>J)J=Q,$.push(fU.range(Q))}return i.of($)});function fJ(){return gU}var pU=0;class c9{constructor(Z,$){this.from=Z,this.to=$}}class r{constructor(Z={}){this.id=pU++,this.perNode=!!Z.perNode,this.deserialize=Z.deserialize||(()=>{throw Error("This node type doesn't define a deserialize function")}),this.combine=Z.combine||null}add(Z){if(this.perNode)throw RangeError("Can't add per-node props to node types");if(typeof Z!="function")Z=m0.match(Z);return($)=>{let J=Z($);return J===void 0?null:[this,J]}}}r.closedBy=new r({deserialize:(Z)=>Z.split(" ")});r.openedBy=new r({deserialize:(Z)=>Z.split(" ")});r.group=new r({deserialize:(Z)=>Z.split(" ")});r.isolate=new r({deserialize:(Z)=>{if(Z&&Z!="rtl"&&Z!="ltr"&&Z!="auto")throw RangeError("Invalid value for isolate: "+Z);return Z||"auto"}});r.contextHash=new r({perNode:!0});r.lookAhead=new r({perNode:!0});r.mounted=new r({perNode:!0});class h7{constructor(Z,$,J,X=!1){this.tree=Z,this.overlay=$,this.parser=J,this.bracketed=X}static get(Z){return Z&&Z.props&&Z.props[r.mounted.id]}}var lU=Object.create(null);class m0{constructor(Z,$,J,X=0){this.name=Z,this.props=$,this.id=J,this.flags=X}static define(Z){let $=Z.props&&Z.props.length?Object.create(null):lU,J=(Z.top?1:0)|(Z.skipped?2:0)|(Z.error?4:0)|(Z.name==null?8:0),X=new m0(Z.name||"",$,Z.id,J);if(Z.props)for(let Q of Z.props){if(!Array.isArray(Q))Q=Q(X);if(Q){if(Q[0].perNode)throw RangeError("Can't store a per-node prop on a node type");$[Q[0].id]=Q[1]}}return X}prop(Z){return this.props[Z.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(Z){if(typeof Z=="string"){if(this.name==Z)return!0;let $=this.prop(r.group);return $?$.indexOf(Z)>-1:!1}return this.id==Z}static match(Z){let $=Object.create(null);for(let J in Z)for(let X of J.split(" "))$[X]=Z[J];return(J)=>{for(let X=J.prop(r.group),Q=-1;Q<(X?X.length:0);Q++){let Y=$[Q<0?J.name:X[Q]];if(Y)return Y}}}}m0.none=new m0("",Object.create(null),0,8);class i9{constructor(Z){this.types=Z;for(let $=0;$<Z.length;$++)if(Z[$].id!=$)throw RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...Z){let $=[];for(let J of this.types){let X=null;for(let Q of Z){let Y=Q(J);if(Y){if(!X)X=Object.assign({},J.props);let K=Y[1],U=Y[0];if(U.combine&&U.id in X)K=U.combine(X[U.id],K);X[U.id]=K}}$.push(X?new m0(J.name,X,J.id,J.flags):J)}return new i9($)}}var d9=new WeakMap,gJ=new WeakMap,I0;(function(Z){Z[Z.ExcludeBuffers=1]="ExcludeBuffers",Z[Z.IncludeAnonymous=2]="IncludeAnonymous",Z[Z.IgnoreMounts=4]="IgnoreMounts",Z[Z.IgnoreOverlays=8]="IgnoreOverlays",Z[Z.EnterBracketed=16]="EnterBracketed"})(I0||(I0={}));class W0{constructor(Z,$,J,X,Q){if(this.type=Z,this.children=$,this.positions=J,this.length=X,this.props=null,Q&&Q.length){this.props=Object.create(null);for(let[Y,K]of Q)this.props[typeof Y=="number"?Y:Y.id]=K}}toString(){let Z=h7.get(this);if(Z&&!Z.overlay)return Z.tree.toString();let $="";for(let J of this.children){let X=J.toString();if(X){if($)$+=",";$+=X}}return!this.type.name?$:(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+($.length?"("+$+")":"")}cursor(Z=0){return new n9(this.topNode,Z)}cursorAt(Z,$=0,J=0){let X=d9.get(this)||this.topNode,Q=new n9(X);return Q.moveTo(Z,$),d9.set(this,Q._tree),Q}get topNode(){return new Q1(this,0,0,null)}resolve(Z,$=0){let J=S4(d9.get(this)||this.topNode,Z,$,!1);return d9.set(this,J),J}resolveInner(Z,$=0){let J=S4(gJ.get(this)||this.topNode,Z,$,!0);return gJ.set(this,J),J}resolveStack(Z,$=0){return dU(this,Z,$)}iterate(Z){let{enter:$,leave:J,from:X=0,to:Q=this.length}=Z,Y=Z.mode||0,K=(Y&I0.IncludeAnonymous)>0;for(let U=this.cursor(Y|I0.IncludeAnonymous);;){let q=!1;if(U.from<=Q&&U.to>=X&&(!K&&U.type.isAnonymous||$(U)!==!1)){if(U.firstChild())continue;q=!0}for(;;){if(q&&J&&(K||!U.type.isAnonymous))J(U);if(U.nextSibling())break;if(!U.parent())return;q=!0}}}prop(Z){return!Z.perNode?this.type.prop(Z):this.props?this.props[Z.id]:void 0}get propValues(){let Z=[];if(this.props)for(let $ in this.props)Z.push([+$,this.props[$]]);return Z}balance(Z={}){return this.children.length<=8?this:W5(m0.none,this.children,this.positions,0,this.children.length,0,this.length,($,J,X)=>new W0(this.type,$,J,X,this.propValues),Z.makeTree||(($,J,X)=>new W0(m0.none,$,J,X)))}static build(Z){return cU(Z)}}W0.empty=new W0(m0.none,[],[],0);class U5{constructor(Z,$){this.buffer=Z,this.index=$}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new U5(this.buffer,this.index)}}class s1{constructor(Z,$,J){this.buffer=Z,this.length=$,this.set=J}get type(){return m0.none}toString(){let Z=[];for(let $=0;$<this.buffer.length;)Z.push(this.childString($)),$=this.buffer[$+3];return Z.join(",")}childString(Z){let $=this.buffer[Z],J=this.buffer[Z+3],X=this.set.types[$],Q=X.name;if(/\W/.test(Q)&&!X.isError)Q=JSON.stringify(Q);if(Z+=4,J==Z)return Q;let Y=[];while(Z<J)Y.push(this.childString(Z)),Z=this.buffer[Z+3];return Q+"("+Y.join(",")+")"}findChild(Z,$,J,X,Q){let{buffer:Y}=this,K=-1;for(let U=Z;U!=$;U=Y[U+3])if(dJ(Q,X,Y[U+1],Y[U+2])){if(K=U,J>0)break}return K}slice(Z,$,J){let X=this.buffer,Q=new Uint16Array($-Z),Y=0;for(let K=Z,U=0;K<$;){Q[U++]=X[K++],Q[U++]=X[K++]-J;let q=Q[U++]=X[K++]-J;Q[U++]=X[K++]-Z,Y=Math.max(Y,q)}return new s1(Q,Y,this.set)}}function dJ(Z,$,J,X){switch(Z){case-2:return J<$;case-1:return X>=$&&J<$;case 0:return J<$&&X>$;case 1:return J<=$&&X>$;case 2:return X>$;case 4:return!0}}function S4(Z,$,J,X){var Q;while(Z.from==Z.to||(J<1?Z.from>=$:Z.from>$)||(J>-1?Z.to<=$:Z.to<$)){let K=!X&&Z instanceof Q1&&Z.index<0?null:Z.parent;if(!K)return Z;Z=K}let Y=X?0:I0.IgnoreOverlays;if(X){for(let K=Z,U=K.parent;U;K=U,U=K.parent)if(K instanceof Q1&&K.index<0&&((Q=U.enter($,J,Y))===null||Q===void 0?void 0:Q.from)!=K.from)Z=U}for(;;){let K=Z.enter($,J,Y);if(!K)return Z;Z=K}}class q5{cursor(Z=0){return new n9(this,Z)}getChild(Z,$=null,J=null){let X=pJ(this,Z,$,J);return X.length?X[0]:null}getChildren(Z,$=null,J=null){return pJ(this,Z,$,J)}resolve(Z,$=0){return S4(this,Z,$,!1)}resolveInner(Z,$=0){return S4(this,Z,$,!0)}matchContext(Z){return K5(this.parent,Z)}enterUnfinishedNodesBefore(Z){let $=this.childBefore(Z),J=this;while($){let X=$.lastChild;if(!X||X.to!=$.to)break;if(X.type.isError&&X.from==X.to)J=$,$=X.prevSibling;else $=X}return J}get node(){return this}get next(){return this.parent}}class Q1 extends q5{constructor(Z,$,J,X){super();this._tree=Z,this.from=$,this.index=J,this._parent=X}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(Z,$,J,X,Q=0){var Y;for(let K=this;;){for(let{children:U,positions:q}=K._tree,G=$>0?U.length:-1;Z!=G;Z+=$){let W=U[Z],j=q[Z]+K.from;if(!(Q&I0.EnterBracketed&&W instanceof W0&&((Y=h7.get(W))===null||Y===void 0?void 0:Y.overlay)===null&&(j>=J||j+W.length<=J))&&!dJ(X,J,j,j+W.length))continue;if(W instanceof s1){if(Q&I0.ExcludeBuffers)continue;let _=W.findChild(0,W.buffer.length,$,J-j,X);if(_>-1)return new c1(new cJ(K,W,Z,j),null,_)}else if(Q&I0.IncludeAnonymous||(!W.type.isAnonymous||G5(W))){let _;if(!(Q&I0.IgnoreMounts)&&(_=h7.get(W))&&!_.overlay)return new Q1(_.tree,j,Z,K);let z=new Q1(W,j,Z,K);return Q&I0.IncludeAnonymous||!z.type.isAnonymous?z:z.nextChild($<0?W.children.length-1:0,$,J,X,Q)}}if(Q&I0.IncludeAnonymous||!K.type.isAnonymous)return null;if(K.index>=0)Z=K.index+$;else Z=$<0?-1:K._parent._tree.children.length;if(K=K._parent,!K)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(Z){return this.nextChild(0,1,Z,2)}childBefore(Z){return this.nextChild(this._tree.children.length-1,-1,Z,-2)}prop(Z){return this._tree.prop(Z)}enter(Z,$,J=0){let X;if(!(J&I0.IgnoreOverlays)&&(X=h7.get(this._tree))&&X.overlay){let Q=Z-this.from,Y=J&I0.EnterBracketed&&X.bracketed;for(let{from:K,to:U}of X.overlay)if(($>0||Y?K<=Q:K<Q)&&($<0||Y?U>=Q:U>Q))return new Q1(X.tree,X.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,Z,$,J)}nextSignificantParent(){let Z=this;while(Z.type.isAnonymous&&Z._parent)Z=Z._parent;return Z}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function pJ(Z,$,J,X){let Q=Z.cursor(),Y=[];if(!Q.firstChild())return Y;if(J!=null){for(let K=!1;!K;)if(K=Q.type.is(J),!Q.nextSibling())return Y}for(;;){if(X!=null&&Q.type.is(X))return Y;if(Q.type.is($))Y.push(Q.node);if(!Q.nextSibling())return X==null?Y:[]}}function K5(Z,$,J=$.length-1){for(let X=Z;J>=0;X=X.parent){if(!X)return!1;if(!X.type.isAnonymous){if($[J]&&$[J]!=X.name)return!1;J--}}return!0}class cJ{constructor(Z,$,J,X){this.parent=Z,this.buffer=$,this.index=J,this.start=X}}class c1 extends q5{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(Z,$,J){super();this.context=Z,this._parent=$,this.index=J,this.type=Z.buffer.set.types[Z.buffer.buffer[J]]}child(Z,$,J){let{buffer:X}=this.context,Q=X.findChild(this.index+4,X.buffer[this.index+3],Z,$-this.context.start,J);return Q<0?null:new c1(this.context,this,Q)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(Z){return this.child(1,Z,2)}childBefore(Z){return this.child(-1,Z,-2)}prop(Z){return this.type.prop(Z)}enter(Z,$,J=0){if(J&I0.ExcludeBuffers)return null;let{buffer:X}=this.context,Q=X.findChild(this.index+4,X.buffer[this.index+3],$>0?1:-1,Z-this.context.start,$);return Q<0?null:new c1(this.context,this,Q)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(Z){return this._parent?null:this.context.parent.nextChild(this.context.index+Z,Z,0,4)}get nextSibling(){let{buffer:Z}=this.context,$=Z.buffer[this.index+3];if($<(this._parent?Z.buffer[this._parent.index+3]:Z.buffer.length))return new c1(this.context,this._parent,$);return this.externalSibling(1)}get prevSibling(){let{buffer:Z}=this.context,$=this._parent?this._parent.index+4:0;if(this.index==$)return this.externalSibling(-1);return new c1(this.context,this._parent,Z.findChild($,this.index,-1,0,4))}get tree(){return null}toTree(){let Z=[],$=[],{buffer:J}=this.context,X=this.index+4,Q=J.buffer[this.index+3];if(Q>X){let Y=J.buffer[this.index+1];Z.push(J.slice(X,Q,Y)),$.push(0)}return new W0(this.type,Z,$,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function sJ(Z){if(!Z.length)return null;let $=0,J=Z[0];for(let Y=1;Y<Z.length;Y++){let K=Z[Y];if(K.from>J.from||K.to<J.to)J=K,$=Y}let X=J instanceof Q1&&J.index<0?null:J.parent,Q=Z.slice();if(X)Q[$]=X;else Q.splice($,1);return new nJ(Q,J)}class nJ{constructor(Z,$){this.heads=Z,this.node=$}get next(){return sJ(this.heads)}}function dU(Z,$,J){let X=Z.resolveInner($,J),Q=null;for(let Y=X instanceof Q1?X:X.context.parent;Y;Y=Y.parent)if(Y.index<0){let K=Y.parent;(Q||(Q=[X])).push(K.resolve($,J)),Y=K}else{let K=h7.get(Y.tree);if(K&&K.overlay&&K.overlay[0].from<=$&&K.overlay[K.overlay.length-1].to>=$){let U=new Q1(K.tree,K.overlay[0].from+Y.from,-1,Y);(Q||(Q=[X])).push(S4(U,$,J,!1))}}return Q?sJ(Q):X}class n9{get name(){return this.type.name}constructor(Z,$=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=$&~I0.EnterBracketed,Z instanceof Q1)this.yieldNode(Z);else{this._tree=Z.context.parent,this.buffer=Z.context;for(let J=Z._parent;J;J=J._parent)this.stack.unshift(J.index);this.bufferNode=Z,this.yieldBuf(Z.index)}}yieldNode(Z){if(!Z)return!1;return this._tree=Z,this.type=Z.type,this.from=Z.from,this.to=Z.to,!0}yieldBuf(Z,$){this.index=Z;let{start:J,buffer:X}=this.buffer;return this.type=$||X.set.types[X.buffer[Z]],this.from=J+X.buffer[Z+1],this.to=J+X.buffer[Z+2],!0}yield(Z){if(!Z)return!1;if(Z instanceof Q1)return this.buffer=null,this.yieldNode(Z);return this.buffer=Z.context,this.yieldBuf(Z.index,Z.type)}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(Z,$,J){if(!this.buffer)return this.yield(this._tree.nextChild(Z<0?this._tree._tree.children.length-1:0,Z,$,J,this.mode));let{buffer:X}=this.buffer,Q=X.findChild(this.index+4,X.buffer[this.index+3],Z,$-this.buffer.start,J);if(Q<0)return!1;return this.stack.push(this.index),this.yieldBuf(Q)}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(Z){return this.enterChild(1,Z,2)}childBefore(Z){return this.enterChild(-1,Z,-2)}enter(Z,$,J=this.mode){if(!this.buffer)return this.yield(this._tree.enter(Z,$,J));return J&I0.ExcludeBuffers?!1:this.enterChild(1,Z,$)}parent(){if(!this.buffer)return this.yieldNode(this.mode&I0.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let Z=this.mode&I0.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(Z)}sibling(Z){if(!this.buffer)return!this._tree._parent?!1:this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+Z,Z,0,4,this.mode));let{buffer:$}=this.buffer,J=this.stack.length-1;if(Z<0){let X=J<0?0:this.stack[J]+4;if(this.index!=X)return this.yieldBuf($.findChild(X,this.index,-1,0,4))}else{let X=$.buffer[this.index+3];if(X<(J<0?$.buffer.length:$.buffer[this.stack[J]+3]))return this.yieldBuf(X)}return J<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+Z,Z,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(Z){let $,J,{buffer:X}=this;if(X){if(Z>0){if(this.index<X.buffer.buffer.length)return!1}else for(let Q=0;Q<this.index;Q++)if(X.buffer.buffer[Q+3]<this.index)return!1;({index:$,parent:J}=X)}else({index:$,_parent:J}=this._tree);for(;J;{index:$,_parent:J}=J)if($>-1)for(let Q=$+Z,Y=Z<0?-1:J._tree.children.length;Q!=Y;Q+=Z){let K=J._tree.children[Q];if(this.mode&I0.IncludeAnonymous||K instanceof s1||!K.type.isAnonymous||G5(K))return!1}return!0}move(Z,$){if($&&this.enterChild(Z,0,4))return!0;for(;;){if(this.sibling(Z))return!0;if(this.atLastNode(Z)||!this.parent())return!1}}next(Z=!0){return this.move(1,Z)}prev(Z=!0){return this.move(-1,Z)}moveTo(Z,$=0){while(this.from==this.to||($<1?this.from>=Z:this.from>Z)||($>-1?this.to<=Z:this.to<Z))if(!this.parent())break;while(this.enterChild(1,Z,$));return this}get node(){if(!this.buffer)return this._tree;let Z=this.bufferNode,$=null,J=0;if(Z&&Z.context==this.buffer)Z:for(let X=this.index,Q=this.stack.length;Q>=0;){for(let Y=Z;Y;Y=Y._parent)if(Y.index==X){if(X==this.index)return Y;$=Y,J=Q+1;break Z}X=this.stack[--Q]}for(let X=J;X<this.stack.length;X++)$=new c1(this.buffer,$,this.stack[X]);return this.bufferNode=new c1(this.buffer,$,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(Z,$){for(let J=0;;){let X=!1;if(this.type.isAnonymous||Z(this)!==!1){if(this.firstChild()){J++;continue}if(!this.type.isAnonymous)X=!0}for(;;){if(X&&$)$(this);if(X=this.type.isAnonymous,!J)return;if(this.nextSibling())break;this.parent(),J--,X=!0}}}matchContext(Z){if(!this.buffer)return K5(this.node.parent,Z);let{buffer:$}=this.buffer,{types:J}=$.set;for(let X=Z.length-1,Q=this.stack.length-1;X>=0;Q--){if(Q<0)return K5(this._tree,Z,X);let Y=J[$.buffer[this.stack[Q]]];if(!Y.isAnonymous){if(Z[X]&&Z[X]!=Y.name)return!1;X--}}return!0}}function G5(Z){return Z.children.some(($)=>$ instanceof s1||!$.type.isAnonymous||G5($))}function cU(Z){var $;let{buffer:J,nodeSet:X,maxBufferLength:Q=1024,reused:Y=[],minRepeatType:K=X.types.length}=Z,U=Array.isArray(J)?new U5(J,J.length):J,q=X.types,G=0,W=0;function j(B,w,b,d,a,T){let{id:P,start:E,end:y,size:f}=U,o=W,R0=G;if(f<0)if(U.next(),f==-1){let N=Y[P];b.push(N),d.push(E-B);return}else if(f==-3){G=P;return}else if(f==-4){W=P;return}else throw RangeError(`Unrecognized record size: ${f}`);let P0=q[P],Z1,L0,I=E-B;if(y-E<=Q&&(L0=H(U.pos-w,a))){let N=new Uint16Array(L0.size-L0.skip),h=U.pos-L0.size,u=N.length;while(U.pos>h)u=R(L0.start,N,u);Z1=new s1(N,y-L0.start,X),I=L0.start-B}else{let N=U.pos-f;U.next();let h=[],u=[],l=P>=K?P:-1,c=0,s=y;while(U.pos>N)if(l>=0&&U.id==l&&U.size>=0){if(U.end<=s-Q)V(h,u,E,c,U.end,s,l,o,R0),c=h.length,s=U.end;U.next()}else if(T>2500)_(E,N,h,u);else j(E,N,h,u,l,T+1);if(l>=0&&c>0&&c<h.length)V(h,u,E,c,E,s,l,o,R0);if(h.reverse(),u.reverse(),l>-1&&c>0){let g=z(P0,R0);Z1=W5(P0,h,u,0,h.length,0,y-E,g,g)}else Z1=O(P0,h,u,y-E,o-y,R0)}b.push(Z1),d.push(I)}function _(B,w,b,d){let a=[],T=0,P=-1;while(U.pos>w){let{id:E,start:y,end:f,size:o}=U;if(o>4)U.next();else if(P>-1&&y<P)break;else{if(P<0)P=f-Q;a.push(E,y,f),T++,U.next()}}if(T){let E=new Uint16Array(T*4),y=a[a.length-2];for(let f=a.length-3,o=0;f>=0;f-=3)E[o++]=a[f],E[o++]=a[f+1]-y,E[o++]=a[f+2]-y,E[o++]=o;b.push(new s1(E,a[2]-y,X)),d.push(y-B)}}function z(B,w){return(b,d,a)=>{let T=0,P=b.length-1,E,y;if(P>=0&&(E=b[P])instanceof W0){if(!P&&E.type==B&&E.length==a)return E;if(y=E.prop(r.lookAhead))T=d[P]+E.length+y}return O(B,b,d,a,T,w)}}function V(B,w,b,d,a,T,P,E,y){let f=[],o=[];while(B.length>d)f.push(B.pop()),o.push(w.pop()+b-a);B.push(O(X.types[P],f,o,T-a,E-T,y)),w.push(a-b)}function O(B,w,b,d,a,T,P){if(T){let E=[r.contextHash,T];P=P?[E].concat(P):[E]}if(a>25){let E=[r.lookAhead,a];P=P?[E].concat(P):[E]}return new W0(B,w,b,d,P)}function H(B,w){let b=U.fork(),d=0,a=0,T=0,P=b.end-Q,E={size:0,start:0,skip:0};Z:for(let y=b.pos-B;b.pos>y;){let f=b.size;if(b.id==w&&f>=0){E.size=d,E.start=a,E.skip=T,T+=4,d+=4,b.next();continue}let o=b.pos-f;if(f<0||o<y||b.start<P)break;let R0=b.id>=K?4:0,P0=b.start;b.next();while(b.pos>o){if(b.size<0)if(b.size==-3||b.size==-4)R0+=4;else break Z;else if(b.id>=K)R0+=4;b.next()}a=P0,d+=f,T+=R0}if(w<0||d==B)E.size=d,E.start=a,E.skip=T;return E.size>4?E:void 0}function R(B,w,b){let{id:d,start:a,end:T,size:P}=U;if(U.next(),P>=0&&d<K){let E=b;if(P>4){let y=U.pos-(P-4);while(U.pos>y)b=R(B,w,b)}w[--b]=E,w[--b]=T-B,w[--b]=a-B,w[--b]=d}else if(P==-3)G=d;else if(P==-4)W=d;return b}let D=[],M=[];while(U.pos>0)j(Z.start||0,Z.bufferStart||0,D,M,-1,0);let L=($=Z.length)!==null&&$!==void 0?$:D.length?M[0]+D[0].length:0;return new W0(q[Z.topID],D.reverse(),M.reverse(),L)}var lJ=new WeakMap;function s9(Z,$){if(!Z.isAnonymous||$ instanceof s1||$.type!=Z)return 1;let J=lJ.get($);if(J==null){J=1;for(let X of $.children){if(X.type!=Z||!(X instanceof W0)){J=1;break}J+=s9(Z,X)}lJ.set($,J)}return J}function W5(Z,$,J,X,Q,Y,K,U,q){let G=0;for(let V=X;V<Q;V++)G+=s9(Z,$[V]);let W=Math.ceil(G*1.5/8),j=[],_=[];function z(V,O,H,R,D){for(let M=H;M<R;){let L=M,B=O[M],w=s9(Z,V[M]);M++;for(;M<R;M++){let b=s9(Z,V[M]);if(w+b>=W)break;w+=b}if(M==L+1){if(w>W){let b=V[L];z(b.children,b.positions,0,b.children.length,O[L]+D);continue}j.push(V[L])}else{let b=O[M-1]+V[M-1].length-B;j.push(W5(Z,V,O,L,M,B,b,null,q))}_.push(B+D-Y)}}return z($,J,X,Q,0),(U||q)(j,_,K)}class n1{constructor(Z,$,J,X,Q=!1,Y=!1){this.from=Z,this.to=$,this.tree=J,this.offset=X,this.open=(Q?1:0)|(Y?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(Z,$=[],J=!1){let X=[new n1(0,Z.length,Z,0,!1,J)];for(let Q of $)if(Q.to>Z.length)X.push(Q);return X}static applyChanges(Z,$,J=128){if(!$.length)return Z;let X=[],Q=1,Y=Z.length?Z[0]:null;for(let K=0,U=0,q=0;;K++){let G=K<$.length?$[K]:null,W=G?G.fromA:1e9;if(W-U>=J)while(Y&&Y.from<W){let j=Y;if(U>=j.from||W<=j.to||q){let _=Math.max(j.from,U)-q,z=Math.min(j.to,W)-q;j=_>=z?null:new n1(_,z,j.tree,j.offset+q,K>0,!!G)}if(j)X.push(j);if(Y.to>W)break;Y=Q<Z.length?Z[Q++]:null}if(!G)break;U=G.toA,q=G.toA-G.toB}return X}}class a9{startParse(Z,$,J){if(typeof Z=="string")Z=new iJ(Z);return J=!J?[new c9(0,Z.length)]:J.length?J.map((X)=>new c9(X.from,X.to)):[new c9(0,0)],this.createParse(Z,$||[],J)}parse(Z,$,J){let X=this.startParse(Z,$,J);for(;;){let Q=X.advance();if(Q)return Q}}}class iJ{constructor(Z){this.string=Z}get length(){return this.string.length}chunk(Z){return this.string.slice(Z)}get lineChunks(){return!1}read(Z,$){return this.string.slice(Z,$)}}var zz=new r({perNode:!0});var sU=0;class Y1{constructor(Z,$,J,X){this.name=Z,this.set=$,this.base=J,this.modified=X,this.id=sU++}toString(){let{name:Z}=this;for(let $ of this.modified)if($.name)Z=`${$.name}(${Z})`;return Z}static define(Z,$){let J=typeof Z=="string"?Z:"?";if(Z instanceof Y1)$=Z;if($===null||$===void 0?void 0:$.base)throw Error("Can not derive from a modified tag");let X=new Y1(J,[],null,[]);if(X.set.push(X),$)for(let Q of $.set)X.set.push(Q);return X}static defineModifier(Z){let $=new e9(Z);return(J)=>{if(J.modified.indexOf($)>-1)return J;return e9.get(J.base||J,J.modified.concat($).sort((X,Q)=>X.id-Q.id))}}}var nU=0;class e9{constructor(Z){this.name=Z,this.instances=[],this.id=nU++}static get(Z,$){if(!$.length)return Z;let J=$[0].instances.find((K)=>K.base==Z&&iU($,K.modified));if(J)return J;let X=[],Q=new Y1(Z.name,X,Z,$);for(let K of $)K.instances.push(Q);let Y=aU($);for(let K of Z.set)if(!K.modified.length)for(let U of Y)X.push(e9.get(K,U));return Q}}function iU(Z,$){return Z.length==$.length&&Z.every((J,X)=>J==$[X])}function aU(Z){let $=[[]];for(let J=0;J<Z.length;J++)for(let X=0,Q=$.length;X<Q;X++)$.push($[X].concat(Z[J]));return $.sort((J,X)=>X.length-J.length)}function oJ(Z){let $=Object.create(null);for(let J in Z){let X=Z[J];if(!Array.isArray(X))X=[X];for(let Q of J.split(" "))if(Q){let Y=[],K=2,U=Q;for(let j=0;;){if(U=="..."&&j>0&&j+3==Q.length){K=1;break}let _=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(U);if(!_)throw RangeError("Invalid path: "+Q);if(Y.push(_[0]=="*"?"":_[0][0]=='"'?JSON.parse(_[0]):_[0]),j+=_[0].length,j==Q.length)break;let z=Q[j++];if(j==Q.length&&z=="!"){K=0;break}if(z!="/")throw RangeError("Invalid path: "+Q);U=Q.slice(j)}let q=Y.length-1,G=Y[q];if(!G)throw RangeError("Invalid path: "+Q);let W=new v7(X,K,q>0?Y.slice(0,q):null);$[G]=W.sort($[G])}}return tJ.add($)}var tJ=new r({combine(Z,$){let J,X,Q;while(Z||$){if(!Z||$&&Z.depth>=$.depth)Q=$,$=$.next;else Q=Z,Z=Z.next;if(J&&J.mode==Q.mode&&!Q.context&&!J.context)continue;let Y=new v7(Q.tags,Q.mode,Q.context);if(J)J.next=Y;else X=Y;J=Y}return X}});class v7{constructor(Z,$,J,X){this.tags=Z,this.mode=$,this.context=J,this.next=X}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(Z){if(!Z||Z.depth<this.depth)return this.next=Z,this;return Z.next=this.sort(Z.next),Z}get depth(){return this.context?this.context.length:0}}v7.empty=new v7([],2,null);function z5(Z,$){let J=Object.create(null);for(let Y of Z)if(!Array.isArray(Y.tag))J[Y.tag.id]=Y.class;else for(let K of Y.tag)J[K.id]=Y.class;let{scope:X,all:Q=null}=$||{};return{style:(Y)=>{let K=Q;for(let U of Y)for(let q of U.set){let G=J[q.id];if(G){K=K?K+" "+G:G;break}}return K},scope:X}}function rU(Z,$){let J=null;for(let X of Z){let Q=X.style($);if(Q)J=J?J+" "+Q:Q}return J}function eJ(Z,$,J,X=0,Q=Z.length){let Y=new Z2(X,Array.isArray($)?$:[$],J);Y.highlightRange(Z.cursor(),X,Q,"",Y.highlighters),Y.flush(Q)}class Z2{constructor(Z,$,J){this.at=Z,this.highlighters=$,this.span=J,this.class=""}startSpan(Z,$){if($!=this.class){if(this.flush(Z),Z>this.at)this.at=Z;this.class=$}}flush(Z){if(Z>this.at&&this.class)this.span(this.at,Z,this.class)}highlightRange(Z,$,J,X,Q){let{type:Y,from:K,to:U}=Z;if(K>=J||U<=$)return;if(Y.isTop)Q=this.highlighters.filter((_)=>!_.scope||_.scope(Y));let q=X,G=oU(Z)||v7.empty,W=rU(Q,G.tags);if(W){if(q)q+=" ";if(q+=W,G.mode==1)X+=(X?" ":"")+W}if(this.startSpan(Math.max($,K),q),G.opaque)return;let j=Z.tree&&Z.tree.prop(r.mounted);if(j&&j.overlay){let _=Z.node.enter(j.overlay[0].from+K,1),z=this.highlighters.filter((O)=>!O.scope||O.scope(j.tree.type)),V=Z.firstChild();for(let O=0,H=K;;O++){let R=O<j.overlay.length?j.overlay[O]:null,D=R?R.from+K:U,M=Math.max($,H),L=Math.min(J,D);if(M<L&&V){while(Z.from<L)if(this.highlightRange(Z,M,L,X,Q),this.startSpan(Math.min(L,Z.to),q),Z.to>=D||!Z.nextSibling())break}if(!R||D>J)break;if(H=R.to+K,H>$)this.highlightRange(_.cursor(),Math.max($,R.from+K),Math.min(J,H),"",z),this.startSpan(Math.min(J,H),q)}if(V)Z.parent()}else if(Z.firstChild()){if(j)X="";do{if(Z.to<=$)continue;if(Z.from>=J)break;this.highlightRange(Z,$,J,X,Q),this.startSpan(Math.min(J,Z.to),q)}while(Z.nextSibling());Z.parent()}}}function oU(Z){let $=Z.type.prop(tJ);while($&&$.context&&!Z.matchContext($.context))$=$.next;return $||null}var k=Y1.define,r9=k(),i1=k(),aJ=k(i1),rJ=k(i1),a1=k(),o9=k(a1),j5=k(a1),k1=k(),z7=k(k1),T1=k(),y1=k(),_5=k(),b4=k(_5),t9=k(),F={comment:r9,lineComment:k(r9),blockComment:k(r9),docComment:k(r9),name:i1,variableName:k(i1),typeName:aJ,tagName:k(aJ),propertyName:rJ,attributeName:k(rJ),className:k(i1),labelName:k(i1),namespace:k(i1),macroName:k(i1),literal:a1,string:o9,docString:k(o9),character:k(o9),attributeValue:k(o9),number:j5,integer:k(j5),float:k(j5),bool:k(a1),regexp:k(a1),escape:k(a1),color:k(a1),url:k(a1),keyword:T1,self:k(T1),null:k(T1),atom:k(T1),unit:k(T1),modifier:k(T1),operatorKeyword:k(T1),controlKeyword:k(T1),definitionKeyword:k(T1),moduleKeyword:k(T1),operator:y1,derefOperator:k(y1),arithmeticOperator:k(y1),logicOperator:k(y1),bitwiseOperator:k(y1),compareOperator:k(y1),updateOperator:k(y1),definitionOperator:k(y1),typeOperator:k(y1),controlOperator:k(y1),punctuation:_5,separator:k(_5),bracket:b4,angleBracket:k(b4),squareBracket:k(b4),paren:k(b4),brace:k(b4),content:k1,heading:z7,heading1:k(z7),heading2:k(z7),heading3:k(z7),heading4:k(z7),heading5:k(z7),heading6:k(z7),contentSeparator:k(k1),list:k(k1),quote:k(k1),emphasis:k(k1),strong:k(k1),link:k(k1),monospace:k(k1),strikethrough:k(k1),inserted:k(),deleted:k(),changed:k(),invalid:k(),meta:t9,documentMeta:k(t9),annotation:k(t9),processingInstruction:k(t9),definition:Y1.defineModifier("definition"),constant:Y1.defineModifier("constant"),function:Y1.defineModifier("function"),standard:Y1.defineModifier("standard"),local:Y1.defineModifier("local"),special:Y1.defineModifier("special")};for(let Z in F){let $=F[Z];if($ instanceof Y1)$.name=Z}var Nz=z5([{tag:F.link,class:"tok-link"},{tag:F.heading,class:"tok-heading"},{tag:F.emphasis,class:"tok-emphasis"},{tag:F.strong,class:"tok-strong"},{tag:F.keyword,class:"tok-keyword"},{tag:F.atom,class:"tok-atom"},{tag:F.bool,class:"tok-bool"},{tag:F.url,class:"tok-url"},{tag:F.labelName,class:"tok-labelName"},{tag:F.inserted,class:"tok-inserted"},{tag:F.deleted,class:"tok-deleted"},{tag:F.literal,class:"tok-literal"},{tag:F.string,class:"tok-string"},{tag:F.number,class:"tok-number"},{tag:[F.regexp,F.escape,F.special(F.string)],class:"tok-string2"},{tag:F.variableName,class:"tok-variableName"},{tag:F.local(F.variableName),class:"tok-variableName tok-local"},{tag:F.definition(F.variableName),class:"tok-variableName tok-definition"},{tag:F.special(F.variableName),class:"tok-variableName2"},{tag:F.definition(F.propertyName),class:"tok-propertyName tok-definition"},{tag:F.typeName,class:"tok-typeName"},{tag:F.namespace,class:"tok-namespace"},{tag:F.className,class:"tok-className"},{tag:F.macroName,class:"tok-macroName"},{tag:F.propertyName,class:"tok-propertyName"},{tag:F.operator,class:"tok-operator"},{tag:F.comment,class:"tok-comment"},{tag:F.meta,class:"tok-meta"},{tag:F.invalid,class:"tok-invalid"},{tag:F.punctuation,class:"tok-punctuation"}]);var O5,u7=new r;function tU(Z){return S.define({combine:Z?($)=>$.concat(Z):void 0})}var eU=new r;class K1{constructor(Z,$,J=[],X=""){if(this.data=Z,this.name=X,!n.prototype.hasOwnProperty("tree"))Object.defineProperty(n.prototype,"tree",{get(){return B0(this)}});this.parser=$,this.extension=[r1.of(this),n.languageData.of((Q,Y,K)=>{let U=$2(Q,Y,K),q=U.type.prop(u7);if(!q)return[];let G=Q.facet(q),W=U.type.prop(eU);if(W){let j=U.resolve(Y-U.from,K);for(let _ of W)if(_.test(j,Q)){let z=Q.facet(_.facet);return _.type=="replace"?z:z.concat(G)}}return G})].concat(J)}isActiveAt(Z,$,J=-1){return $2(Z,$,J).type.prop(u7)==this.data}findRegions(Z){let $=Z.facet(r1);if(($===null||$===void 0?void 0:$.data)==this.data)return[{from:0,to:Z.doc.length}];if(!$||!$.allowsNesting)return[];let J=[],X=(Q,Y)=>{if(Q.prop(u7)==this.data){J.push({from:Y,to:Y+Q.length});return}let K=Q.prop(r.mounted);if(K){if(K.tree.prop(u7)==this.data){if(K.overlay)for(let U of K.overlay)J.push({from:U.from+Y,to:U.to+Y});else J.push({from:Y,to:Y+Q.length});return}else if(K.overlay){let U=J.length;if(X(K.tree,K.overlay[0].from+Y),J.length>U)return}}for(let U=0;U<Q.children.length;U++){let q=Q.children[U];if(q instanceof W0)X(q,Q.positions[U]+Y)}};return X(B0(Z),0),J}get allowsNesting(){return!0}}K1.setState=p.define();function $2(Z,$,J){let X=Z.facet(r1),Q=B0(Z).topNode;if(!X||X.allowsNesting){for(let Y=Q;Y;Y=Y.enter($,J,I0.ExcludeBuffers|I0.EnterBracketed))if(Y.type.isTop)Q=Y}return Q}function B0(Z){let $=Z.field(K1.state,!1);return $?$.tree:W0.empty}class G2{constructor(Z){this.doc=Z,this.cursorPos=0,this.string="",this.cursor=Z.iter()}get length(){return this.doc.length}syncTo(Z){return this.string=this.cursor.next(Z-this.cursorPos).value,this.cursorPos=Z+this.string.length,this.cursorPos-this.string.length}chunk(Z){return this.syncTo(Z),this.string}get lineChunks(){return!0}read(Z,$){let J=this.cursorPos-this.string.length;if(Z<J||$>=this.cursorPos)return this.doc.sliceString(Z,$);else return this.string.slice(Z-J,$-J)}}var x4=null;class m7{constructor(Z,$,J=[],X,Q,Y,K,U){this.parser=Z,this.state=$,this.fragments=J,this.tree=X,this.treeLen=Q,this.viewport=Y,this.skipped=K,this.scheduleOn=U,this.parse=null,this.tempSkipped=[]}static create(Z,$,J){return new m7(Z,$,[],W0.empty,0,J,[],null)}startParse(){return this.parser.startParse(new G2(this.state.doc),this.fragments)}work(Z,$){if($!=null&&$>=this.state.doc.length)$=void 0;if(this.tree!=W0.empty&&this.isDone($!==null&&$!==void 0?$:this.state.doc.length))return this.takeTree(),!0;return this.withContext(()=>{var J;if(typeof Z=="number"){let X=Date.now()+Z;Z=()=>Date.now()>X}if(!this.parse)this.parse=this.startParse();if($!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>$)&&$<this.state.doc.length)this.parse.stopAt($);for(;;){let X=this.parse.advance();if(X)if(this.fragments=this.withoutTempSkipped(n1.addTree(X,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(J=this.parse.stoppedAt)!==null&&J!==void 0?J:this.state.doc.length,this.tree=X,this.parse=null,this.treeLen<($!==null&&$!==void 0?$:this.state.doc.length))this.parse=this.startParse();else return!0;if(Z())return!1}})}takeTree(){let Z,$;if(this.parse&&(Z=this.parse.parsedPos)>=this.treeLen){if(this.parse.stoppedAt==null||this.parse.stoppedAt>Z)this.parse.stopAt(Z);this.withContext(()=>{while(!($=this.parse.advance()));}),this.treeLen=Z,this.tree=$,this.fragments=this.withoutTempSkipped(n1.addTree(this.tree,this.fragments,!0)),this.parse=null}}withContext(Z){let $=x4;x4=this;try{return Z()}finally{x4=$}}withoutTempSkipped(Z){for(let $;$=this.tempSkipped.pop();)Z=J2(Z,$.from,$.to);return Z}changes(Z,$){let{fragments:J,tree:X,treeLen:Q,viewport:Y,skipped:K}=this;if(this.takeTree(),!Z.empty){let U=[];if(Z.iterChangedRanges((q,G,W,j)=>U.push({fromA:q,toA:G,fromB:W,toB:j})),J=n1.applyChanges(J,U),X=W0.empty,Q=0,Y={from:Z.mapPos(Y.from,-1),to:Z.mapPos(Y.to,1)},this.skipped.length){K=[];for(let q of this.skipped){let G=Z.mapPos(q.from,1),W=Z.mapPos(q.to,-1);if(G<W)K.push({from:G,to:W})}}}return new m7(this.parser,$,J,X,Q,Y,K,this.scheduleOn)}updateViewport(Z){if(this.viewport.from==Z.from&&this.viewport.to==Z.to)return!1;this.viewport=Z;let $=this.skipped.length;for(let J=0;J<this.skipped.length;J++){let{from:X,to:Q}=this.skipped[J];if(X<Z.to&&Q>Z.from)this.fragments=J2(this.fragments,X,Q),this.skipped.splice(J--,1)}if(this.skipped.length>=$)return!1;return this.reset(),!0}reset(){if(this.parse)this.takeTree(),this.parse=null}skipUntilInView(Z,$){this.skipped.push({from:Z,to:$})}static getSkippingParser(Z){return new class extends a9{createParse($,J,X){let Q=X[0].from,Y=X[X.length-1].to;return{parsedPos:Q,advance(){let U=x4;if(U){for(let q of X)U.tempSkipped.push(q);if(Z)U.scheduleOn=U.scheduleOn?Promise.all([U.scheduleOn,Z]):Z}return this.parsedPos=Y,new W0(m0.none,[],[],Y-Q)},stoppedAt:null,stopAt(){}}}}}isDone(Z){Z=Math.min(Z,this.state.doc.length);let $=this.fragments;return this.treeLen>=Z&&$.length&&$[0].from==0&&$[0].to>=Z}static get(){return x4}}function J2(Z,$,J){return n1.applyChanges(Z,[{fromA:$,toA:J,fromB:$,toB:J}])}class f7{constructor(Z){this.context=Z,this.tree=Z.tree}apply(Z){if(!Z.docChanged&&this.tree==this.context.tree)return this;let $=this.context.changes(Z.changes,Z.state),J=this.context.treeLen==Z.startState.doc.length?void 0:Math.max(Z.changes.mapPos(this.context.treeLen),$.viewport.to);if(!$.work(20,J))$.takeTree();return new f7($)}static init(Z){let $=Math.min(3000,Z.doc.length),J=m7.create(Z.facet(r1).parser,Z,{from:0,to:$});if(!J.work(20,$))J.takeTree();return new f7(J)}}K1.state=_0.define({create:f7.init,update(Z,$){for(let J of $.effects)if(J.is(K1.setState))return J.value;if($.startState.facet(r1)!=$.state.facet(r1))return f7.init($.state);return Z.apply($)}});var W2=(Z)=>{let $=setTimeout(()=>Z(),500);return()=>clearTimeout($)};if(typeof requestIdleCallback<"u")W2=(Z)=>{let $=-1,J=setTimeout(()=>{$=requestIdleCallback(Z,{timeout:400})},100);return()=>$<0?clearTimeout(J):cancelIdleCallback($)};var V5=typeof navigator<"u"&&((O5=navigator.scheduling)===null||O5===void 0?void 0:O5.isInputPending)?()=>navigator.scheduling.isInputPending():null,Zq=j0.fromClass(class{constructor($){this.view=$,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update($){let J=this.view.state.field(K1.state).context;if(J.updateViewport($.view.viewport)||this.view.viewport.to>J.treeLen)this.scheduleWork();if($.docChanged||$.selectionSet){if(this.view.hasFocus)this.chunkBudget+=50;this.scheduleWork()}this.checkAsyncSchedule(J)}scheduleWork(){if(this.working)return;let{state:$}=this.view,J=$.field(K1.state);if(J.tree!=J.context.tree||!J.context.isDone($.doc.length))this.working=W2(this.work)}work($){this.working=null;let J=Date.now();if(this.chunkEnd<J&&(this.chunkEnd<0||this.view.hasFocus))this.chunkEnd=J+30000,this.chunkBudget=3000;if(this.chunkBudget<=0)return;let{state:X,viewport:{to:Q}}=this.view,Y=X.field(K1.state);if(Y.tree==Y.context.tree&&Y.context.isDone(Q+1e5))return;let K=Date.now()+Math.min(this.chunkBudget,100,$&&!V5?Math.max(25,$.timeRemaining()-5):1e9),U=Y.context.treeLen<Q&&X.doc.length>Q+1000,q=Y.context.work(()=>{return V5&&V5()||Date.now()>K},Q+(U?0:1e5));if(this.chunkBudget-=Date.now()-J,q||this.chunkBudget<=0)Y.context.takeTree(),this.view.dispatch({effects:K1.setState.of(new f7(Y.context))});if(this.chunkBudget>0&&!(q&&!U))this.scheduleWork();this.checkAsyncSchedule(Y.context)}checkAsyncSchedule($){if($.scheduleOn)this.workScheduled++,$.scheduleOn.then(()=>this.scheduleWork()).catch((J)=>S0(this.view.state,J)).then(()=>this.workScheduled--),$.scheduleOn=null}destroy(){if(this.working)this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),r1=S.define({combine(Z){return Z.length?Z[0]:null},enables:(Z)=>[K1.state,Zq,C.contentAttributes.compute([Z],($)=>{let J=$.facet(Z);return J&&J.name?{"data-language":J.name}:{}})]});var $q=S.define(),h4=S.define({combine:(Z)=>{if(!Z.length)return"  ";let $=Z[0];if(!$||/\S/.test($)||Array.from($).some((J)=>J!=$[0]))throw Error("Invalid indent unit: "+JSON.stringify(Z[0]));return $}});function o1(Z){let $=Z.facet(h4);return $.charCodeAt(0)==9?Z.tabSize*$.length:$.length}function g7(Z,$){let J="",X=Z.tabSize,Q=Z.facet(h4)[0];if(Q=="\t"){while($>=X)J+="\t",$-=X;Q=" "}for(let Y=0;Y<$;Y++)J+=Q;return J}function X8(Z,$){if(Z instanceof n)Z=new p7(Z);for(let X of Z.state.facet($q)){let Q=X(Z,$);if(Q!==void 0)return Q}let J=B0(Z.state);return J.length>=$?Jq(Z,J,$):null}class p7{constructor(Z,$={}){this.state=Z,this.options=$,this.unit=o1(Z)}lineAt(Z,$=1){let J=this.state.doc.lineAt(Z),{simulateBreak:X,simulateDoubleBreak:Q}=this.options;if(X!=null&&X>=J.from&&X<=J.to)if(Q&&X==Z)return{text:"",from:Z};else if($<0?X<Z:X<=Z)return{text:J.text.slice(X-J.from),from:X};else return{text:J.text.slice(0,X-J.from),from:J.from};return J}textAfterPos(Z,$=1){if(this.options.simulateDoubleBreak&&Z==this.options.simulateBreak)return"";let{text:J,from:X}=this.lineAt(Z,$);return J.slice(Z-X,Math.min(J.length,Z+100-X))}column(Z,$=1){let{text:J,from:X}=this.lineAt(Z,$),Q=this.countColumn(J,Z-X),Y=this.options.overrideIndentation?this.options.overrideIndentation(X):-1;if(Y>-1)Q+=Y-this.countColumn(J,J.search(/\S|$/));return Q}countColumn(Z,$=Z.length){return x1(Z,this.state.tabSize,$)}lineIndent(Z,$=1){let{text:J,from:X}=this.lineAt(Z,$),Q=this.options.overrideIndentation;if(Q){let Y=Q(X);if(Y>-1)return Y}return this.countColumn(J,J.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}var j2=new r;function Jq(Z,$,J){let X=$.resolveStack(J),Q=$.resolveInner(J,-1).resolve(J,0).enterUnfinishedNodesBefore(J);if(Q!=X.node){let Y=[];for(let K=Q;K&&!(K.from<X.node.from||K.to>X.node.to||K.from==X.node.from&&K.type==X.node.type);K=K.parent)Y.push(K);for(let K=Y.length-1;K>=0;K--)X={node:Y[K],next:X}}return _2(X,Z,J)}function _2(Z,$,J){for(let X=Z;X;X=X.next){let Q=Qq(X.node);if(Q)return Q(D5.create($,J,X))}return 0}function Xq(Z){return Z.pos==Z.options.simulateBreak&&Z.options.simulateDoubleBreak}function Qq(Z){let $=Z.type.prop(j2);if($)return $;let J=Z.firstChild,X;if(J&&(X=J.type.prop(r.closedBy))){let Q=Z.lastChild,Y=Q&&X.indexOf(Q.name)>-1;return(K)=>qq(K,!0,1,void 0,Y&&!Xq(K)?Q.from:void 0)}return Z.parent==null?Yq:null}function Yq(){return 0}class D5 extends p7{constructor(Z,$,J){super(Z.state,Z.options);this.base=Z,this.pos=$,this.context=J}get node(){return this.context.node}static create(Z,$,J){return new D5(Z,$,J)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(Z){let $=this.state.doc.lineAt(Z.from);for(;;){let J=Z.resolve($.from);while(J.parent&&J.parent.from==J.from)J=J.parent;if(Kq(J,Z))break;$=this.state.doc.lineAt(J.from)}return this.lineIndent($.from)}continue(){return _2(this.context.next,this.base,this.pos)}}function Kq(Z,$){for(let J=$;J;J=J.parent)if(Z==J)return!0;return!1}function Uq(Z){let $=Z.node,J=$.childAfter($.from),X=$.lastChild;if(!J)return null;let Q=Z.options.simulateBreak,Y=Z.state.doc.lineAt(J.from),K=Q==null||Q<=Y.from?Y.to:Math.min(Y.to,Q);for(let U=J.to;;){let q=$.childAfter(U);if(!q||q==X)return null;if(!q.type.isSkipped){if(q.from>=K)return null;let G=/^ */.exec(Y.text.slice(J.to-Y.from))[0].length;return{from:J.from,to:J.to+G}}U=q.to}}function qq(Z,$,J,X,Q){let Y=Z.textAfter,K=Y.match(/^\s*/)[0].length,U=X&&Y.slice(K,K+X.length)==X||Q==Z.pos+K,q=$?Uq(Z):null;if(q)return U?Z.column(q.from):Z.column(q.to);return Z.baseIndent+(U?0:Z.unit*J)}var Gq=200;function z2(){return n.transactionFilter.of((Z)=>{if(!Z.docChanged||!Z.isUserEvent("input.type")&&!Z.isUserEvent("input.complete"))return Z;let $=Z.startState.languageDataAt("indentOnInput",Z.startState.selection.main.head);if(!$.length)return Z;let J=Z.newDoc,{head:X}=Z.newSelection.main,Q=J.lineAt(X);if(X>Q.from+Gq)return Z;let Y=J.sliceString(Q.from,X);if(!$.some((G)=>G.test(Y)))return Z;let{state:K}=Z,U=-1,q=[];for(let{head:G}of K.selection.ranges){let W=K.doc.lineAt(G);if(W.from==U)continue;U=W.from;let j=X8(K,W.from);if(j==null)continue;let _=/^\s*/.exec(W.text)[0],z=g7(K,j);if(_!=z)q.push({from:W.from,to:W.from+_.length,insert:z})}return q.length?[Z,{changes:q,sequential:!0}]:Z})}var Wq=S.define(),jq=new r;function _q(Z,$,J){let X=B0(Z);if(X.length<J)return null;let Q=X.resolveStack(J,1),Y=null;for(let K=Q;K;K=K.next){let U=K.node;if(U.to<=J||U.from>J)continue;if(Y&&U.from<$)break;let q=U.type.prop(jq);if(q&&(U.to<X.length-50||X.length==Z.doc.length||!zq(U))){let G=q(U,Z);if(G&&G.from<=J&&G.from>=$&&G.to>J)Y=G}}return Y}function zq(Z){let $=Z.lastChild;return $&&$.to==Z.to&&$.type.isError}function $8(Z,$,J){for(let X of Z.facet(Wq)){let Q=X(Z,$,J);if(Q)return Q}return _q(Z,$,J)}function O2(Z,$){let J=$.mapPos(Z.from,1),X=$.mapPos(Z.to,-1);return J>=X?void 0:{from:J,to:X}}var Q8=p.define({map:O2}),v4=p.define({map:O2});function V2(Z){let $=[];for(let{head:J}of Z.state.selection.ranges){if($.some((X)=>X.from<=J&&X.to>=J))continue;$.push(Z.lineBlockAt(J))}return $}var O7=_0.define({create(){return m.none},update(Z,$){if($.isUserEvent("delete"))$.changes.iterChangedRanges((J,X)=>Z=X2(Z,J,X));Z=Z.map($.changes);for(let J of $.effects)if(J.is(Q8)&&!Oq(Z,J.value.from,J.value.to)){let{preparePlaceholder:X}=$.state.facet(A5),Q=!X?Q2:m.replace({widget:new D2(X($.state,J.value))});Z=Z.update({add:[Q.range(J.value.from,J.value.to)]})}else if(J.is(v4))Z=Z.update({filter:(X,Q)=>J.value.from!=X||J.value.to!=Q,filterFrom:J.value.from,filterTo:J.value.to});if($.selection)Z=X2(Z,$.selection.main.head);return Z},provide:(Z)=>C.decorations.from(Z),toJSON(Z,$){let J=[];return Z.between(0,$.doc.length,(X,Q)=>{J.push(X,Q)}),J},fromJSON(Z){if(!Array.isArray(Z)||Z.length%2)throw RangeError("Invalid JSON for fold state");let $=[];for(let J=0;J<Z.length;){let X=Z[J++],Q=Z[J++];if(typeof X!="number"||typeof Q!="number")throw RangeError("Invalid JSON for fold state");$.push(Q2.range(X,Q))}return m.set($,!0)}});function X2(Z,$,J=$){let X=!1;return Z.between($,J,(Q,Y)=>{if(Q<J&&Y>$)X=!0}),!X?Z:Z.update({filterFrom:$,filterTo:J,filter:(Q,Y)=>Q>=J||Y<=$})}function J8(Z,$,J){var X;let Q=null;return(X=Z.field(O7,!1))===null||X===void 0||X.between($,J,(Y,K)=>{if(!Q||Q.from>Y)Q={from:Y,to:K}}),Q}function Oq(Z,$,J){let X=!1;return Z.between($,$,(Q,Y)=>{if(Q==$&&Y==J)X=!0}),X}function N2(Z,$){return Z.field(O7,!1)?$:$.concat(p.appendConfig.of(R2()))}var Vq=(Z)=>{for(let $ of V2(Z)){let J=$8(Z.state,$.from,$.to);if(J)return Z.dispatch({effects:N2(Z.state,[Q8.of(J),H2(Z,J)])}),!0}return!1},Nq=(Z)=>{if(!Z.state.field(O7,!1))return!1;let $=[];for(let J of V2(Z)){let X=J8(Z.state,J.from,J.to);if(X)$.push(v4.of(X),H2(Z,X,!1))}if($.length)Z.dispatch({effects:$});return $.length>0};function H2(Z,$,J=!0){let X=Z.state.doc.lineAt($.from).number,Q=Z.state.doc.lineAt($.to).number;return C.announce.of(`${Z.state.phrase(J?"Folded lines":"Unfolded lines")} ${X} ${Z.state.phrase("to")} ${Q}.`)}var Hq=(Z)=>{let{state:$}=Z,J=[];for(let X=0;X<$.doc.length;){let Q=Z.lineBlockAt(X),Y=$8($,Q.from,Q.to);if(Y)J.push(Q8.of(Y));X=(Y?Z.lineBlockAt(Y.to):Q).to+1}if(J.length)Z.dispatch({effects:N2(Z.state,J)});return!!J.length},Iq=(Z)=>{let $=Z.state.field(O7,!1);if(!$||!$.size)return!1;let J=[];return $.between(0,Z.state.doc.length,(X,Q)=>{J.push(v4.of({from:X,to:Q}))}),Z.dispatch({effects:J}),!0};var I2=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Vq},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Nq},{key:"Ctrl-Alt-[",run:Hq},{key:"Ctrl-Alt-]",run:Iq}],Rq={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},A5=S.define({combine(Z){return w0(Z,Rq)}});function R2(Z){let $=[O7,Dq];if(Z)$.push(A5.of(Z));return $}function F2(Z,$){let{state:J}=Z,X=J.facet(A5),Q=(K)=>{let U=Z.lineBlockAt(Z.posAtDOM(K.target)),q=J8(Z.state,U.from,U.to);if(q)Z.dispatch({effects:v4.of(q)});K.preventDefault()};if(X.placeholderDOM)return X.placeholderDOM(Z,Q,$);let Y=document.createElement("span");return Y.textContent=X.placeholderText,Y.setAttribute("aria-label",J.phrase("folded code")),Y.title=J.phrase("unfold"),Y.className="cm-foldPlaceholder",Y.onclick=Q,Y}var Q2=m.replace({widget:new class extends r0{toDOM(Z){return F2(Z,null)}}});class D2 extends r0{constructor(Z){super();this.value=Z}eq(Z){return this.value==Z.value}toDOM(Z){return F2(Z,this.value)}}var Fq={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Z8 extends X1{constructor(Z,$){super();this.config=Z,this.open=$}eq(Z){return this.config==Z.config&&this.open==Z.open}toDOM(Z){if(this.config.markerDOM)return this.config.markerDOM(this.open);let $=document.createElement("span");return $.textContent=this.open?this.config.openText:this.config.closedText,$.title=Z.state.phrase(this.open?"Fold line":"Unfold line"),$}}function A2(Z={}){let $={...Fq,...Z},J=new Z8($,!0),X=new Z8($,!1),Q=j0.fromClass(class{constructor(K){this.from=K.viewport.from,this.markers=this.buildMarkers(K)}update(K){if(K.docChanged||K.viewportChanged||K.startState.facet(r1)!=K.state.facet(r1)||K.startState.field(O7,!1)!=K.state.field(O7,!1)||B0(K.startState)!=B0(K.state)||$.foldingChanged(K))this.markers=this.buildMarkers(K.view)}buildMarkers(K){let U=new s0;for(let q of K.viewportLineBlocks){let G=J8(K.state,q.from,q.to)?X:$8(K.state,q.from,q.to)?J:null;if(G)U.add(q.from,q.from,G)}return U.finish()}}),{domEventHandlers:Y}=$;return[Q,Q5({class:"cm-foldGutter",markers(K){var U;return((U=K.plugin(Q))===null||U===void 0?void 0:U.markers)||i.empty},initialSpacer(){return new Z8($,!1)},domEventHandlers:{...Y,click:(K,U,q)=>{if(Y.click&&Y.click(K,U,q))return!0;let G=J8(K.state,U.from,U.to);if(G)return K.dispatch({effects:v4.of(G)}),!0;let W=$8(K.state,U.from,U.to);if(W)return K.dispatch({effects:Q8.of(W)}),!0;return!1}}}),R2()]}var Dq=C.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class l7{constructor(Z,$){this.specs=Z;let J;function X(K){let U=V1.newName();return(J||(J=Object.create(null)))["."+U]=K,U}let Q=typeof $.all=="string"?$.all:$.all?X($.all):void 0,Y=$.scope;this.scope=Y instanceof K1?(K)=>K.prop(u7)==Y.data:Y?(K)=>K==Y:void 0,this.style=z5(Z.map((K)=>({tag:K.tag,class:K.class||X(Object.assign({},K,{tag:null}))})),{all:Q}).style,this.module=J?new V1(J):null,this.themeType=$.themeType}static define(Z,$){return new l7(Z,$||{})}}var I5=S.define(),M2=S.define({combine(Z){return Z.length?[Z[0]]:null}});function N5(Z){let $=Z.facet(I5);return $.length?$:Z.facet(M2)}function Y8(Z,$){let J=[Aq],X;if(Z instanceof l7){if(Z.module)J.push(C.styleModule.of(Z.module));X=Z.themeType}if($===null||$===void 0?void 0:$.fallback)J.push(M2.of(Z));else if(X)J.push(I5.computeN([C.darkTheme],(Q)=>{return Q.facet(C.darkTheme)==(X=="dark")?[Z]:[]}));else J.push(I5.of(Z));return J}class L2{constructor(Z){this.markCache=Object.create(null),this.tree=B0(Z.state),this.decorations=this.buildDeco(Z,N5(Z.state)),this.decoratedTo=Z.viewport.to}update(Z){let $=B0(Z.state),J=N5(Z.state),X=J!=N5(Z.startState),{viewport:Q}=Z.view,Y=Z.changes.mapPos(this.decoratedTo,1);if($.length<Q.to&&!X&&$.type==this.tree.type&&Y>=Q.to)this.decorations=this.decorations.map(Z.changes),this.decoratedTo=Y;else if($!=this.tree||Z.viewportChanged||X)this.tree=$,this.decorations=this.buildDeco(Z.view,J),this.decoratedTo=Q.to}buildDeco(Z,$){if(!$||!this.tree.length)return m.none;let J=new s0;for(let{from:X,to:Q}of Z.visibleRanges)eJ(this.tree,$,(Y,K,U)=>{J.add(Y,K,this.markCache[U]||(this.markCache[U]=m.mark({class:U})))},X,Q);return J.finish()}}var Aq=O1.high(j0.fromClass(L2,{decorations:(Z)=>Z.decorations})),B2=l7.define([{tag:F.meta,color:"#404740"},{tag:F.link,textDecoration:"underline"},{tag:F.heading,textDecoration:"underline",fontWeight:"bold"},{tag:F.emphasis,fontStyle:"italic"},{tag:F.strong,fontWeight:"bold"},{tag:F.strikethrough,textDecoration:"line-through"},{tag:F.keyword,color:"#708"},{tag:[F.atom,F.bool,F.url,F.contentSeparator,F.labelName],color:"#219"},{tag:[F.literal,F.inserted],color:"#164"},{tag:[F.string,F.deleted],color:"#a11"},{tag:[F.regexp,F.escape,F.special(F.string)],color:"#e40"},{tag:F.definition(F.variableName),color:"#00f"},{tag:F.local(F.variableName),color:"#30a"},{tag:[F.typeName,F.namespace],color:"#085"},{tag:F.className,color:"#167"},{tag:[F.special(F.variableName),F.macroName],color:"#256"},{tag:F.definition(F.propertyName),color:"#00c"},{tag:F.comment,color:"#940"},{tag:F.invalid,color:"#f00"}]),Mq=C.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),E2=1e4,P2="()[]{}",C2=S.define({combine(Z){return w0(Z,{afterCursor:!0,brackets:P2,maxScanDistance:E2,renderMatch:Eq})}}),Lq=m.mark({class:"cm-matchingBracket"}),Bq=m.mark({class:"cm-nonmatchingBracket"});function Eq(Z){let $=[],J=Z.matched?Lq:Bq;if($.push(J.range(Z.start.from,Z.start.to)),Z.end)$.push(J.range(Z.end.from,Z.end.to));return $}var Pq=_0.define({create(){return m.none},update(Z,$){if(!$.docChanged&&!$.selection)return Z;let J=[],X=$.state.facet(C2);for(let Q of $.state.selection.ranges){if(!Q.empty)continue;let Y=F1($.state,Q.head,-1,X)||Q.head>0&&F1($.state,Q.head-1,1,X)||X.afterCursor&&(F1($.state,Q.head,1,X)||Q.head<$.state.doc.length&&F1($.state,Q.head+1,-1,X));if(Y)J=J.concat(X.renderMatch(Y,$.state))}return m.set(J,!0)},provide:(Z)=>C.decorations.from(Z)}),Cq=[Pq,Mq];function T2(Z={}){return[C2.of(Z),Cq]}var Tq=new r;function R5(Z,$,J){let X=Z.prop($<0?r.openedBy:r.closedBy);if(X)return X;if(Z.name.length==1){let Q=J.indexOf(Z.name);if(Q>-1&&Q%2==($<0?1:0))return[J[Q+$]]}return null}function F5(Z){let $=Z.type.prop(Tq);return $?$(Z.node):Z}function F1(Z,$,J,X={}){let Q=X.maxScanDistance||E2,Y=X.brackets||P2,K=B0(Z),U=K.resolveInner($,J);for(let q=U;q;q=q.parent){let G=R5(q.type,J,Y);if(G&&q.from<q.to){let W=F5(q);if(W&&(J>0?$>=W.from&&$<W.to:$>W.from&&$<=W.to))return yq(Z,$,J,q,W,G,Y)}}return kq(Z,$,J,K,U.type,Q,Y)}function yq(Z,$,J,X,Q,Y,K){let U=X.parent,q={from:Q.from,to:Q.to},G=0,W=U===null||U===void 0?void 0:U.cursor();if(W&&(J<0?W.childBefore(X.from):W.childAfter(X.to)))do if(J<0?W.to<=X.from:W.from>=X.to){if(G==0&&Y.indexOf(W.type.name)>-1&&W.from<W.to){let j=F5(W);return{start:q,end:j?{from:j.from,to:j.to}:void 0,matched:!0}}else if(R5(W.type,J,K))G++;else if(R5(W.type,-J,K)){if(G==0){let j=F5(W);return{start:q,end:j&&j.from<j.to?{from:j.from,to:j.to}:void 0,matched:!1}}G--}}while(J<0?W.prevSibling():W.nextSibling());return{start:q,matched:!1}}function kq(Z,$,J,X,Q,Y,K){let U=J<0?Z.sliceDoc($-1,$):Z.sliceDoc($,$+1),q=K.indexOf(U);if(q<0||q%2==0!=J>0)return null;let G={from:J<0?$-1:$,to:J>0?$+1:$},W=Z.doc.iterRange($,J>0?Z.doc.length:0),j=0;for(let _=0;!W.next().done&&_<=Y;){let z=W.value;if(J<0)_+=z.length;let V=$+_*J;for(let O=J>0?0:z.length-1,H=J>0?z.length:-1;O!=H;O+=J){let R=K.indexOf(z[O]);if(R<0||X.resolveInner(V+O,1).type!=Q)continue;if(R%2==0==J>0)j++;else if(j==1)return{start:G,end:{from:V+O,to:V+O+1},matched:R>>1==q>>1};else j--}if(J>0)_+=z.length}return W.done?{start:G,matched:!1}:null}function Y2(Z,$,J,X=0,Q=0){if($==null){if($=Z.search(/[^\s\u00a0]/),$==-1)$=Z.length}let Y=Q;for(let K=X;K<$;K++)if(Z.charCodeAt(K)==9)Y+=J-Y%J;else Y++;return Y}class M5{constructor(Z,$,J,X){this.string=Z,this.tabSize=$,this.indentUnit=J,this.overrideIndent=X,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(Z){let $=this.string.charAt(this.pos),J;if(typeof Z=="string")J=$==Z;else J=$&&(Z instanceof RegExp?Z.test($):Z($));if(J)return++this.pos,$}eatWhile(Z){let $=this.pos;while(this.eat(Z));return this.pos>$}eatSpace(){let Z=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>Z}skipToEnd(){this.pos=this.string.length}skipTo(Z){let $=this.string.indexOf(Z,this.pos);if($>-1)return this.pos=$,!0}backUp(Z){this.pos-=Z}column(){if(this.lastColumnPos<this.start)this.lastColumnValue=Y2(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start;return this.lastColumnValue}indentation(){var Z;return(Z=this.overrideIndent)!==null&&Z!==void 0?Z:Y2(this.string,null,this.tabSize)}match(Z,$,J){if(typeof Z=="string"){let X=(Y)=>J?Y.toLowerCase():Y,Q=this.string.substr(this.pos,Z.length);if(X(Q)==X(Z)){if($!==!1)this.pos+=Z.length;return!0}else return null}else{let X=this.string.slice(this.pos).match(Z);if(X&&X.index>0)return null;if(X&&$!==!1)this.pos+=X[0].length;return X}}current(){return this.string.slice(this.start,this.pos)}}function Sq(Z){return{name:Z.name||"",token:Z.token,blankLine:Z.blankLine||(()=>{}),startState:Z.startState||(()=>!0),copyState:Z.copyState||bq,indent:Z.indent||(()=>null),languageData:Z.languageData||{},tokenTable:Z.tokenTable||B5,mergeTokens:Z.mergeTokens!==!1}}function bq(Z){if(typeof Z!="object")return Z;let $={};for(let J in Z){let X=Z[J];$[J]=X instanceof Array?X.slice():X}return $}var K2=new WeakMap;class V7 extends K1{constructor(Z){let $=tU(Z.languageData),J=Sq(Z),X,Q=new class extends a9{createParse(Y,K,U){return new k2(X,Y,K,U)}};super($,Q,[],Z.name);this.topNode=vq($,this),X=this,this.streamParser=J,this.stateAfter=new r({perNode:!0}),this.tokenTable=Z.tokenTable?new E5(J.tokenTable):hq}static define(Z){return new V7(Z)}getIndent(Z){let $=void 0,{overrideIndentation:J}=Z.options;if(J){if($=K2.get(Z.state),$!=null&&$<Z.pos-1e4)$=void 0}let X=L5(this,Z.node.tree,Z.node.from,Z.node.from,$!==null&&$!==void 0?$:Z.pos),Q,Y;if(X)Y=X.state,Q=X.pos+1;else Y=this.streamParser.startState(Z.unit),Q=Z.node.from;if(Z.pos-Q>1e4)return null;while(Q<Z.pos){let U=Z.state.doc.lineAt(Q),q=Math.min(Z.pos,U.to);if(U.length){let G=J?J(U.from):-1,W=new M5(U.text,Z.state.tabSize,Z.unit,G<0?void 0:G);while(W.pos<q-U.from)S2(this.streamParser.token,W,Y)}else this.streamParser.blankLine(Y,Z.unit);if(q==Z.pos)break;Q=U.to+1}let K=Z.lineAt(Z.pos);if(J&&$==null)K2.set(Z.state,K.from);return this.streamParser.indent(Y,/^\s*(.*)/.exec(K.text)[1],Z)}get allowsNesting(){return!1}}function L5(Z,$,J,X,Q){let Y=J>=X&&J+$.length<=Q&&$.prop(Z.stateAfter);if(Y)return{state:Z.streamParser.copyState(Y),pos:J+$.length};for(let K=$.children.length-1;K>=0;K--){let U=$.children[K],q=J+$.positions[K],G=U instanceof W0&&q<Q&&L5(Z,U,q,X,Q);if(G)return G}return null}function y2(Z,$,J,X,Q){if(Q&&J<=0&&X>=$.length)return $;if(!Q&&J==0&&$.type==Z.topNode)Q=!0;for(let Y=$.children.length-1;Y>=0;Y--){let K=$.positions[Y],U=$.children[Y],q;if(K<X&&U instanceof W0){if(!(q=y2(Z,U,J-K,X-K,Q)))break;return!Q?q:new W0($.type,$.children.slice(0,Y).concat(q),$.positions.slice(0,Y+1),K+q.length)}}return null}function xq(Z,$,J,X,Q){for(let Y of $){let K=Y.from+(Y.openStart?25:0),U=Y.to-(Y.openEnd?25:0),q=K<=J&&U>J&&L5(Z,Y.tree,0-Y.offset,J,U),G;if(q&&q.pos<=X&&(G=y2(Z,Y.tree,J+Y.offset,q.pos+Y.offset,!1)))return{state:q.state,tree:G}}return{state:Z.streamParser.startState(Q?o1(Q):4),tree:W0.empty}}class k2{constructor(Z,$,J,X){this.lang=Z,this.input=$,this.fragments=J,this.ranges=X,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=X[X.length-1].to;let Q=m7.get(),Y=X[0].from,{state:K,tree:U}=xq(Z,J,Y,this.to,Q===null||Q===void 0?void 0:Q.state);this.state=K,this.parsedPos=this.chunkStart=Y+U.length;for(let q=0;q<U.children.length;q++)this.chunks.push(U.children[q]),this.chunkPos.push(U.positions[q]);if(Q&&this.parsedPos<Q.viewport.from-1e5&&X.some((q)=>q.from<=Q.viewport.from&&q.to>=Q.viewport.from))this.state=this.lang.streamParser.startState(o1(Q.state)),Q.skipUntilInView(this.parsedPos,Q.viewport.from),this.parsedPos=Q.viewport.from;this.moveRangeIndex()}advance(){let Z=m7.get(),$=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),J=Math.min($,this.chunkStart+512);if(Z)J=Math.min(J,Z.viewport.to);while(this.parsedPos<J)this.parseLine(Z);if(this.chunkStart<this.parsedPos)this.finishChunk();if(this.parsedPos>=$)return this.finish();if(Z&&this.parsedPos>=Z.viewport.to)return Z.skipUntilInView(this.parsedPos,$),this.finish();return null}stopAt(Z){this.stoppedAt=Z}lineAfter(Z){let $=this.input.chunk(Z);if(!this.input.lineChunks){let J=$.indexOf(`
`);if(J>-1)$=$.slice(0,J)}else if($==`
`)$="";return Z+$.length<=this.to?$:$.slice(0,this.to-Z)}nextLine(){let Z=this.parsedPos,$=this.lineAfter(Z),J=Z+$.length;for(let X=this.rangeIndex;;){let Q=this.ranges[X].to;if(Q>=J)break;if($=$.slice(0,Q-(J-$.length)),X++,X==this.ranges.length)break;let Y=this.ranges[X].from,K=this.lineAfter(Y);$+=K,J=Y+K.length}return{line:$,end:J}}skipGapsTo(Z,$,J){for(;;){let X=this.ranges[this.rangeIndex].to,Q=Z+$;if(J>0?X>Q:X>=Q)break;let Y=this.ranges[++this.rangeIndex].from;$+=Y-X}return $}moveRangeIndex(){while(this.ranges[this.rangeIndex].to<this.parsedPos)this.rangeIndex++}emitToken(Z,$,J,X){let Q=4;if(this.ranges.length>1){X=this.skipGapsTo($,X,1),$+=X;let K=this.chunk.length;X=this.skipGapsTo(J,X,-1),J+=X,Q+=this.chunk.length-K}let Y=this.chunk.length-4;if(this.lang.streamParser.mergeTokens&&Q==4&&Y>=0&&this.chunk[Y]==Z&&this.chunk[Y+2]==$)this.chunk[Y+2]=J;else this.chunk.push(Z,$,J,Q);return X}parseLine(Z){let{line:$,end:J}=this.nextLine(),X=0,{streamParser:Q}=this.lang,Y=new M5($,Z?Z.state.tabSize:4,Z?o1(Z.state):2);if(Y.eol())Q.blankLine(this.state,Y.indentUnit);else while(!Y.eol()){let K=S2(Q.token,Y,this.state);if(K)X=this.emitToken(this.lang.tokenTable.resolve(K),this.parsedPos+Y.start,this.parsedPos+Y.pos,X);if(Y.start>1e4)break}if(this.parsedPos=J,this.moveRangeIndex(),this.parsedPos<this.to)this.parsedPos++}finishChunk(){let Z=W0.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:wq,topID:0,maxBufferLength:512,reused:this.chunkReused});Z=new W0(Z.type,Z.children,Z.positions,Z.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(Z),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new W0(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function S2(Z,$,J){$.start=$.pos;for(let X=0;X<10;X++){let Q=Z($,J);if($.pos>$.start)return Q}throw Error("Stream parser failed to advance stream.")}var B5=Object.create(null),w4=[m0.none],wq=new i9(w4),U2=[],q2=Object.create(null),b2=Object.create(null);for(let[Z,$]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])b2[Z]=x2(B5,$);class E5{constructor(Z){this.extra=Z,this.table=Object.assign(Object.create(null),b2)}resolve(Z){return!Z?0:this.table[Z]||(this.table[Z]=x2(this.extra,Z))}}var hq=new E5(B5);function H5(Z,$){if(U2.indexOf(Z)>-1)return;U2.push(Z),console.warn($)}function x2(Z,$){let J=[];for(let U of $.split(" ")){let q=[];for(let G of U.split(".")){let W=Z[G]||F[G];if(!W)H5(G,`Unknown highlighting tag ${G}`);else if(typeof W=="function")if(!q.length)H5(G,`Modifier ${G} used at start of tag`);else q=q.map(W);else if(q.length)H5(G,`Tag ${G} used as modifier`);else q=Array.isArray(W)?W:[W]}for(let G of q)J.push(G)}if(!J.length)return 0;let X=$.replace(/ /g,"_"),Q=X+" "+J.map((U)=>U.id),Y=q2[Q];if(Y)return Y.id;let K=q2[Q]=m0.define({id:w4.length,name:X,props:[oJ({[X]:J})]});return w4.push(K),K.id}function vq(Z,$){let J=m0.define({id:w4.length,name:"Document",props:[u7.add(()=>Z),j2.add(()=>(X)=>$.getIndent(X))],top:!0});return w4.push(J),J}var Mz={rtl:m.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:Q0.RTL}),ltr:m.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:Q0.LTR}),auto:m.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})};var uq=(Z)=>{let{state:$}=Z,J=$.doc.lineAt($.selection.main.from),X=b5(Z.state,J.from);return X.line?mq(Z):X.block?gq(Z):!1};function S5(Z,$){return({state:J,dispatch:X})=>{if(J.readOnly)return!1;let Q=Z($,J);if(!Q)return!1;return X(J.update(Q)),!0}}var mq=S5(dq,0);var fq=S5(l2,0);var gq=S5((Z,$)=>l2(Z,$,lq($)),0);function b5(Z,$){let J=Z.languageDataAt("commentTokens",$,1);return J.length?J[0]:{}}var u4=50;function pq(Z,{open:$,close:J},X,Q){let Y=Z.sliceDoc(X-u4,X),K=Z.sliceDoc(Q,Q+u4),U=/\s*$/.exec(Y)[0].length,q=/^\s*/.exec(K)[0].length,G=Y.length-U;if(Y.slice(G-$.length,G)==$&&K.slice(q,q+J.length)==J)return{open:{pos:X-U,margin:U&&1},close:{pos:Q+q,margin:q&&1}};let W,j;if(Q-X<=2*u4)W=j=Z.sliceDoc(X,Q);else W=Z.sliceDoc(X,X+u4),j=Z.sliceDoc(Q-u4,Q);let _=/^\s*/.exec(W)[0].length,z=/\s*$/.exec(j)[0].length,V=j.length-z-J.length;if(W.slice(_,_+$.length)==$&&j.slice(V,V+J.length)==J)return{open:{pos:X+_+$.length,margin:/\s/.test(W.charAt(_+$.length))?1:0},close:{pos:Q-z-J.length,margin:/\s/.test(j.charAt(V-1))?1:0}};return null}function lq(Z){let $=[];for(let J of Z.selection.ranges){let X=Z.doc.lineAt(J.from),Q=J.to<=X.to?X:Z.doc.lineAt(J.to);if(Q.from>X.from&&Q.from==J.to)Q=J.to==X.to+1?X:Z.doc.lineAt(J.to-1);let Y=$.length-1;if(Y>=0&&$[Y].to>X.from)$[Y].to=Q.to;else $.push({from:X.from+/^\s*/.exec(X.text)[0].length,to:Q.to})}return $}function l2(Z,$,J=$.selection.ranges){let X=J.map((Y)=>b5($,Y.from).block);if(!X.every((Y)=>Y))return null;let Q=J.map((Y,K)=>pq($,X[K],Y.from,Y.to));if(Z!=2&&!Q.every((Y)=>Y))return{changes:$.changes(J.map((Y,K)=>{if(Q[K])return[];return[{from:Y.from,insert:X[K].open+" "},{from:Y.to,insert:" "+X[K].close}]}))};else if(Z!=1&&Q.some((Y)=>Y)){let Y=[];for(let K=0,U;K<Q.length;K++)if(U=Q[K]){let q=X[K],{open:G,close:W}=U;Y.push({from:G.pos-q.open.length,to:G.pos+G.margin},{from:W.pos-W.margin,to:W.pos+q.close.length})}return{changes:Y}}return null}function dq(Z,$,J=$.selection.ranges){let X=[],Q=-1;for(let{from:Y,to:K}of J){let U=X.length,q=1e9,G=b5($,Y).line;if(!G)continue;for(let W=Y;W<=K;){let j=$.doc.lineAt(W);if(j.from>Q&&(Y==K||K>j.from)){Q=j.from;let _=/^\s*/.exec(j.text)[0].length,z=_==j.length,V=j.text.slice(_,_+G.length)==G?_:-1;if(_<j.text.length&&_<q)q=_;X.push({line:j,comment:V,token:G,indent:_,empty:z,single:!1})}W=j.to+1}if(q<1e9){for(let W=U;W<X.length;W++)if(X[W].indent<X[W].line.text.length)X[W].indent=q}if(X.length==U+1)X[U].single=!0}if(Z!=2&&X.some((Y)=>Y.comment<0&&(!Y.empty||Y.single))){let Y=[];for(let{line:U,token:q,indent:G,empty:W,single:j}of X)if(j||!W)Y.push({from:U.from+G,insert:q+" "});let K=$.changes(Y);return{changes:K,selection:$.selection.map(K,1)}}else if(Z!=1&&X.some((Y)=>Y.comment>=0)){let Y=[];for(let{line:K,comment:U,token:q}of X)if(U>=0){let G=K.from+U,W=G+q.length;if(K.text[W-K.from]==" ")W++;Y.push({from:G,to:W})}return{changes:Y}}return null}var C5=i0.define(),cq=i0.define(),sq=S.define(),d2=S.define({combine(Z){return w0(Z,{minDepth:100,newGroupDelay:500,joinToEvent:($,J)=>J},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:($,J)=>(X,Q)=>$(X,Q)||J(X,Q)})}}),c2=_0.define({create(){return S1.empty},update(Z,$){let J=$.state.facet(d2),X=$.annotation(C5);if(X){let q=l0.fromTransaction($,X.selection),G=X.side,W=G==0?Z.undone:Z.done;if(q)W=U8(W,W.length,J.minDepth,q);else W=a2(W,$.startState.selection);return new S1(G==0?X.rest:W,G==0?W:X.rest)}let Q=$.annotation(cq);if(Q=="full"||Q=="before")Z=Z.isolate();if($.annotation(N0.addToHistory)===!1)return!$.changes.empty?Z.addMapping($.changes.desc):Z;let Y=l0.fromTransaction($),K=$.annotation(N0.time),U=$.annotation(N0.userEvent);if(Y)Z=Z.addChanges(Y,K,U,J,$);else if($.selection)Z=Z.addSelection($.startState.selection,K,U,J.newGroupDelay);if(Q=="full"||Q=="after")Z=Z.isolate();return Z},toJSON(Z){return{done:Z.done.map(($)=>$.toJSON()),undone:Z.undone.map(($)=>$.toJSON())}},fromJSON(Z){return new S1(Z.done.map(l0.fromJSON),Z.undone.map(l0.fromJSON))}});function s2(Z={}){return[c2,d2.of(Z),C.domEventHandlers({beforeinput($,J){let X=$.inputType=="historyUndo"?n2:$.inputType=="historyRedo"?T5:null;if(!X)return!1;return $.preventDefault(),X(J)}})]}function q8(Z,$){return function({state:J,dispatch:X}){if(!$&&J.readOnly)return!1;let Q=J.field(c2,!1);if(!Q)return!1;let Y=Q.pop(Z,J,$);if(!Y)return!1;return X(Y),!0}}var n2=q8(0,!1),T5=q8(1,!1),nq=q8(0,!0),iq=q8(1,!0);class l0{constructor(Z,$,J,X,Q){this.changes=Z,this.effects=$,this.mapped=J,this.startSelection=X,this.selectionsAfter=Q}setSelAfter(Z){return new l0(this.changes,this.effects,this.mapped,this.startSelection,Z)}toJSON(){var Z,$,J;return{changes:(Z=this.changes)===null||Z===void 0?void 0:Z.toJSON(),mapped:($=this.mapped)===null||$===void 0?void 0:$.toJSON(),startSelection:(J=this.startSelection)===null||J===void 0?void 0:J.toJSON(),selectionsAfter:this.selectionsAfter.map((X)=>X.toJSON())}}static fromJSON(Z){return new l0(Z.changes&&D0.fromJSON(Z.changes),[],Z.mapped&&_1.fromJSON(Z.mapped),Z.startSelection&&A.fromJSON(Z.startSelection),Z.selectionsAfter.map(A.fromJSON))}static fromTransaction(Z,$){let J=U1;for(let X of Z.startState.facet(sq)){let Q=X(Z);if(Q.length)J=J.concat(Q)}if(!J.length&&Z.changes.empty)return null;return new l0(Z.changes.invert(Z.startState.doc),J,void 0,$||Z.startState.selection,U1)}static selection(Z){return new l0(void 0,U1,void 0,void 0,Z)}}function U8(Z,$,J,X){let Q=$+1>J+20?$-J-1:0,Y=Z.slice(Q,$);return Y.push(X),Y}function aq(Z,$){let J=[],X=!1;return Z.iterChangedRanges((Q,Y)=>J.push(Q,Y)),$.iterChangedRanges((Q,Y,K,U)=>{for(let q=0;q<J.length;){let G=J[q++],W=J[q++];if(U>=G&&K<=W)X=!0}}),X}function rq(Z,$){return Z.ranges.length==$.ranges.length&&Z.ranges.filter((J,X)=>J.empty!=$.ranges[X].empty).length===0}function i2(Z,$){return!Z.length?$:!$.length?Z:Z.concat($)}var U1=[],oq=200;function a2(Z,$){if(!Z.length)return[l0.selection([$])];else{let J=Z[Z.length-1],X=J.selectionsAfter.slice(Math.max(0,J.selectionsAfter.length-oq));if(X.length&&X[X.length-1].eq($))return Z;return X.push($),U8(Z,Z.length-1,1e9,J.setSelAfter(X))}}function tq(Z){let $=Z[Z.length-1],J=Z.slice();return J[Z.length-1]=$.setSelAfter($.selectionsAfter.slice(0,$.selectionsAfter.length-1)),J}function P5(Z,$){if(!Z.length)return Z;let J=Z.length,X=U1;while(J){let Q=eq(Z[J-1],$,X);if(Q.changes&&!Q.changes.empty||Q.effects.length){let Y=Z.slice(0,J);return Y[J-1]=Q,Y}else $=Q.mapped,J--,X=Q.selectionsAfter}return X.length?[l0.selection(X)]:U1}function eq(Z,$,J){let X=i2(Z.selectionsAfter.length?Z.selectionsAfter.map((U)=>U.map($)):U1,J);if(!Z.changes)return l0.selection(X);let Q=Z.changes.map($),Y=$.mapDesc(Z.changes,!0),K=Z.mapped?Z.mapped.composeDesc(Y):Y;return new l0(Q,p.mapEffects(Z.effects,$),K,Z.startSelection.map(Y),X)}var ZG=/^(input\.type|delete)($|\.)/;class S1{constructor(Z,$,J=0,X=void 0){this.done=Z,this.undone=$,this.prevTime=J,this.prevUserEvent=X}isolate(){return this.prevTime?new S1(this.done,this.undone):this}addChanges(Z,$,J,X,Q){let Y=this.done,K=Y[Y.length-1];if(K&&K.changes&&!K.changes.empty&&Z.changes&&(!J||ZG.test(J))&&(!K.selectionsAfter.length&&$-this.prevTime<X.newGroupDelay&&X.joinToEvent(Q,aq(K.changes,Z.changes))||J=="input.type.compose"))Y=U8(Y,Y.length-1,X.minDepth,new l0(Z.changes.compose(K.changes),i2(p.mapEffects(Z.effects,K.changes),K.effects),K.mapped,K.startSelection,U1));else Y=U8(Y,Y.length,X.minDepth,Z);return new S1(Y,U1,$,J)}addSelection(Z,$,J,X){let Q=this.done.length?this.done[this.done.length-1].selectionsAfter:U1;if(Q.length>0&&$-this.prevTime<X&&J==this.prevUserEvent&&J&&/^select($|\.)/.test(J)&&rq(Q[Q.length-1],Z))return this;return new S1(a2(this.done,Z),this.undone,$,J)}addMapping(Z){return new S1(P5(this.done,Z),P5(this.undone,Z),this.prevTime,this.prevUserEvent)}pop(Z,$,J){let X=Z==0?this.done:this.undone;if(X.length==0)return null;let Q=X[X.length-1],Y=Q.selectionsAfter[0]||$.selection;if(J&&Q.selectionsAfter.length)return $.update({selection:Q.selectionsAfter[Q.selectionsAfter.length-1],annotations:C5.of({side:Z,rest:tq(X),selection:Y}),userEvent:Z==0?"select.undo":"select.redo",scrollIntoView:!0});else if(!Q.changes)return null;else{let K=X.length==1?U1:X.slice(0,X.length-1);if(Q.mapped)K=P5(K,Q.mapped);return $.update({changes:Q.changes,selection:Q.startSelection,effects:Q.effects,annotations:C5.of({side:Z,rest:K,selection:Y}),filter:!1,userEvent:Z==0?"undo":"redo",scrollIntoView:!0})}}}S1.empty=new S1(U1,U1);var r2=[{key:"Mod-z",run:n2,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:T5,preventDefault:!0},{linux:"Ctrl-Shift-z",run:T5,preventDefault:!0},{key:"Mod-u",run:nq,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:iq,preventDefault:!0}];function d7(Z,$){return A.create(Z.ranges.map($),Z.mainIndex)}function D1(Z,$){return Z.update({selection:$,scrollIntoView:!0,userEvent:"select"})}function A1({state:Z,dispatch:$},J){let X=d7(Z.selection,J);if(X.eq(Z.selection,!0))return!1;return $(D1(Z,X)),!0}function G8(Z,$){return A.cursor($?Z.to:Z.from)}function o2(Z,$){return A1(Z,(J)=>J.empty?Z.moveByChar(J,$):G8(J,$))}function h0(Z){return Z.textDirectionAt(Z.state.selection.main.head)==Q0.LTR}var t2=(Z)=>o2(Z,!h0(Z)),e2=(Z)=>o2(Z,h0(Z));function ZX(Z,$){return A1(Z,(J)=>J.empty?Z.moveByGroup(J,$):G8(J,$))}var $G=(Z)=>ZX(Z,!h0(Z)),JG=(Z)=>ZX(Z,h0(Z));var bz=typeof Intl<"u"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function XG(Z,$,J){if($.type.prop(J))return!0;let X=$.to-$.from;return X&&(X>2||/[^\s,.;:]/.test(Z.sliceDoc($.from,$.to)))||$.firstChild}function W8(Z,$,J){let X=B0(Z).resolveInner($.head),Q=J?r.closedBy:r.openedBy;for(let q=$.head;;){let G=J?X.childAfter(q):X.childBefore(q);if(!G)break;if(XG(Z,G,Q))X=G;else q=J?G.to:G.from}let Y=X.type.prop(Q),K,U;if(Y&&(K=J?F1(Z,X.from,1):F1(Z,X.to,-1))&&K.matched)U=J?K.end.to:K.end.from;else U=J?X.to:X.from;return A.cursor(U,J?-1:1)}var QG=(Z)=>A1(Z,($)=>W8(Z.state,$,!h0(Z))),YG=(Z)=>A1(Z,($)=>W8(Z.state,$,h0(Z)));function $X(Z,$){return A1(Z,(J)=>{if(!J.empty)return G8(J,$);let X=Z.moveVertically(J,$);return X.head!=J.head?X:Z.moveToLineBoundary(J,$)})}var JX=(Z)=>$X(Z,!1),XX=(Z)=>$X(Z,!0);function QX(Z){let $=Z.scrollDOM.clientHeight<Z.scrollDOM.scrollHeight-2,J=0,X=0,Q;if($){for(let Y of Z.state.facet(C.scrollMargins)){let K=Y(Z);if(K===null||K===void 0?void 0:K.top)J=Math.max(K===null||K===void 0?void 0:K.top,J);if(K===null||K===void 0?void 0:K.bottom)X=Math.max(K===null||K===void 0?void 0:K.bottom,X)}Q=Z.scrollDOM.clientHeight-J-X}else Q=(Z.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:J,marginBottom:X,selfScroll:$,height:Math.max(Z.defaultLineHeight,Q-5)}}function YX(Z,$){let J=QX(Z),{state:X}=Z,Q=d7(X.selection,(K)=>{return K.empty?Z.moveVertically(K,$,J.height):G8(K,$)});if(Q.eq(X.selection))return!1;let Y;if(J.selfScroll){let K=Z.coordsAtPos(X.selection.main.head),U=Z.scrollDOM.getBoundingClientRect(),q=U.top+J.marginTop,G=U.bottom-J.marginBottom;if(K&&K.top>q&&K.bottom<G)Y=C.scrollIntoView(Q.main.head,{y:"start",yMargin:K.top-q})}return Z.dispatch(D1(X,Q),{effects:Y}),!0}var w2=(Z)=>YX(Z,!1),y5=(Z)=>YX(Z,!0);function t1(Z,$,J){let X=Z.lineBlockAt($.head),Q=Z.moveToLineBoundary($,J);if(Q.head==$.head&&Q.head!=(J?X.to:X.from))Q=Z.moveToLineBoundary($,J,!1);if(!J&&Q.head==X.from&&X.length){let Y=/^\s*/.exec(Z.state.sliceDoc(X.from,Math.min(X.from+100,X.to)))[0].length;if(Y&&$.head!=X.from+Y)Q=A.cursor(X.from+Y)}return Q}var KG=(Z)=>A1(Z,($)=>t1(Z,$,!0)),UG=(Z)=>A1(Z,($)=>t1(Z,$,!1)),qG=(Z)=>A1(Z,($)=>t1(Z,$,!h0(Z))),GG=(Z)=>A1(Z,($)=>t1(Z,$,h0(Z))),WG=(Z)=>A1(Z,($)=>A.cursor(Z.lineBlockAt($.head).from,1)),jG=(Z)=>A1(Z,($)=>A.cursor(Z.lineBlockAt($.head).to,-1));function _G(Z,$,J){let X=!1,Q=d7(Z.selection,(Y)=>{let K=F1(Z,Y.head,-1)||F1(Z,Y.head,1)||Y.head>0&&F1(Z,Y.head-1,1)||Y.head<Z.doc.length&&F1(Z,Y.head+1,-1);if(!K||!K.end)return Y;X=!0;let U=K.start.from==Y.head?K.end.to:K.end.from;return J?A.range(Y.anchor,U):A.cursor(U)});if(!X)return!1;return $(D1(Z,Q)),!0}var zG=({state:Z,dispatch:$})=>_G(Z,$,!1);function q1(Z,$){let J=d7(Z.state.selection,(X)=>{let Q=$(X);return A.range(X.anchor,Q.head,Q.goalColumn,Q.bidiLevel||void 0)});if(J.eq(Z.state.selection))return!1;return Z.dispatch(D1(Z.state,J)),!0}function KX(Z,$){return q1(Z,(J)=>Z.moveByChar(J,$))}var UX=(Z)=>KX(Z,!h0(Z)),qX=(Z)=>KX(Z,h0(Z));function GX(Z,$){return q1(Z,(J)=>Z.moveByGroup(J,$))}var OG=(Z)=>GX(Z,!h0(Z)),VG=(Z)=>GX(Z,h0(Z));var NG=(Z)=>q1(Z,($)=>W8(Z.state,$,!h0(Z))),HG=(Z)=>q1(Z,($)=>W8(Z.state,$,h0(Z)));function WX(Z,$){return q1(Z,(J)=>Z.moveVertically(J,$))}var jX=(Z)=>WX(Z,!1),_X=(Z)=>WX(Z,!0);function zX(Z,$){return q1(Z,(J)=>Z.moveVertically(J,$,QX(Z).height))}var h2=(Z)=>zX(Z,!1),v2=(Z)=>zX(Z,!0),IG=(Z)=>q1(Z,($)=>t1(Z,$,!0)),RG=(Z)=>q1(Z,($)=>t1(Z,$,!1)),FG=(Z)=>q1(Z,($)=>t1(Z,$,!h0(Z))),DG=(Z)=>q1(Z,($)=>t1(Z,$,h0(Z))),AG=(Z)=>q1(Z,($)=>A.cursor(Z.lineBlockAt($.head).from)),MG=(Z)=>q1(Z,($)=>A.cursor(Z.lineBlockAt($.head).to)),u2=({state:Z,dispatch:$})=>{return $(D1(Z,{anchor:0})),!0},m2=({state:Z,dispatch:$})=>{return $(D1(Z,{anchor:Z.doc.length})),!0},f2=({state:Z,dispatch:$})=>{return $(D1(Z,{anchor:Z.selection.main.anchor,head:0})),!0},g2=({state:Z,dispatch:$})=>{return $(D1(Z,{anchor:Z.selection.main.anchor,head:Z.doc.length})),!0},LG=({state:Z,dispatch:$})=>{return $(Z.update({selection:{anchor:0,head:Z.doc.length},userEvent:"select"})),!0},BG=({state:Z,dispatch:$})=>{let J=j8(Z).map(({from:X,to:Q})=>A.range(X,Math.min(Q+1,Z.doc.length)));return $(Z.update({selection:A.create(J),userEvent:"select"})),!0},EG=({state:Z,dispatch:$})=>{let J=d7(Z.selection,(X)=>{let Q=B0(Z),Y=Q.resolveStack(X.from,1);if(X.empty){let K=Q.resolveStack(X.from,-1);if(K.node.from>=Y.node.from&&K.node.to<=Y.node.to)Y=K}for(let K=Y;K;K=K.next){let{node:U}=K;if((U.from<X.from&&U.to>=X.to||U.to>X.to&&U.from<=X.from)&&K.next)return A.range(U.to,U.from)}return X});if(J.eq(Z.selection))return!1;return $(D1(Z,J)),!0};function OX(Z,$){let{state:J}=Z,X=J.selection,Q=J.selection.ranges.slice();for(let Y of J.selection.ranges){let K=J.doc.lineAt(Y.head);if($?K.to<Z.state.doc.length:K.from>0)for(let U=Y;;){let q=Z.moveVertically(U,$);if(q.head<K.from||q.head>K.to){if(!Q.some((G)=>G.head==q.head))Q.push(q);break}else if(q.head==U.head)break;else U=q}}if(Q.length==X.ranges.length)return!1;return Z.dispatch(D1(J,A.create(Q,Q.length-1))),!0}var PG=(Z)=>OX(Z,!1),CG=(Z)=>OX(Z,!0),TG=({state:Z,dispatch:$})=>{let J=Z.selection,X=null;if(J.ranges.length>1)X=A.create([J.main]);else if(!J.main.empty)X=A.create([A.cursor(J.main.head)]);if(!X)return!1;return $(D1(Z,X)),!0};function m4(Z,$){if(Z.state.readOnly)return!1;let J="delete.selection",{state:X}=Z,Q=X.changeByRange((Y)=>{let{from:K,to:U}=Y;if(K==U){let q=$(Y);if(q<K)J="delete.backward",q=K8(Z,q,!1);else if(q>K)J="delete.forward",q=K8(Z,q,!0);K=Math.min(K,q),U=Math.max(U,q)}else K=K8(Z,K,!1),U=K8(Z,U,!0);return K==U?{range:Y}:{changes:{from:K,to:U},range:A.cursor(K,K<Y.head?-1:1)}});if(Q.changes.empty)return!1;return Z.dispatch(X.update(Q,{scrollIntoView:!0,userEvent:J,effects:J=="delete.selection"?C.announce.of(X.phrase("Selection deleted")):void 0})),!0}function K8(Z,$,J){if(Z instanceof C)for(let X of Z.state.facet(C.atomicRanges).map((Q)=>Q(Z)))X.between($,$,(Q,Y)=>{if(Q<$&&Y>$)$=J?Y:Q});return $}var VX=(Z,$,J)=>m4(Z,(X)=>{let Q=X.from,{state:Y}=Z,K=Y.doc.lineAt(Q),U,q;if(J&&!$&&Q>K.from&&Q<K.from+200&&!/[^ \t]/.test(U=K.text.slice(0,Q-K.from))){if(U[U.length-1]=="\t")return Q-1;let G=x1(U,Y.tabSize),W=G%o1(Y)||o1(Y);for(let j=0;j<W&&U[U.length-1-j]==" ";j++)Q--;q=Q}else if(q=H0(K.text,Q-K.from,$,$)+K.from,q==Q&&K.number!=($?Y.doc.lines:1))q+=$?1:-1;else if(!$&&/[\ufe00-\ufe0f]/.test(K.text.slice(q-K.from,Q-K.from)))q=H0(K.text,q-K.from,!1,!1)+K.from;return q}),k5=(Z)=>VX(Z,!1,!0);var NX=(Z)=>VX(Z,!0,!1),HX=(Z,$)=>m4(Z,(J)=>{let X=J.head,{state:Q}=Z,Y=Q.doc.lineAt(X),K=Q.charCategorizer(X);for(let U=null;;){if(X==($?Y.to:Y.from)){if(X==J.head&&Y.number!=($?Q.doc.lines:1))X+=$?1:-1;break}let q=H0(Y.text,X-Y.from,$)+Y.from,G=Y.text.slice(Math.min(X,q)-Y.from,Math.max(X,q)-Y.from),W=K(G);if(U!=null&&W!=U)break;if(G!=" "||X!=J.head)U=W;X=q}return X}),IX=(Z)=>HX(Z,!1),yG=(Z)=>HX(Z,!0);var kG=(Z)=>m4(Z,($)=>{let J=Z.lineBlockAt($.head).to;return $.head<J?J:Math.min(Z.state.doc.length,$.head+1)});var SG=(Z)=>m4(Z,($)=>{let J=Z.moveToLineBoundary($,!1).head;return $.head>J?J:Math.max(0,$.head-1)}),bG=(Z)=>m4(Z,($)=>{let J=Z.moveToLineBoundary($,!0).head;return $.head<J?J:Math.min(Z.state.doc.length,$.head+1)});var xG=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let J=Z.changeByRange((X)=>{return{changes:{from:X.from,to:X.to,insert:e.of(["",""])},range:A.cursor(X.from)}});return $(Z.update(J,{scrollIntoView:!0,userEvent:"input"})),!0},wG=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let J=Z.changeByRange((X)=>{if(!X.empty||X.from==0||X.from==Z.doc.length)return{range:X};let Q=X.from,Y=Z.doc.lineAt(Q),K=Q==Y.from?Q-1:H0(Y.text,Q-Y.from,!1)+Y.from,U=Q==Y.to?Q+1:H0(Y.text,Q-Y.from,!0)+Y.from;return{changes:{from:K,to:U,insert:Z.doc.slice(Q,U).append(Z.doc.slice(K,Q))},range:A.cursor(U)}});if(J.changes.empty)return!1;return $(Z.update(J,{scrollIntoView:!0,userEvent:"move.character"})),!0};function j8(Z){let $=[],J=-1;for(let X of Z.selection.ranges){let Q=Z.doc.lineAt(X.from),Y=Z.doc.lineAt(X.to);if(!X.empty&&X.to==Y.from)Y=Z.doc.lineAt(X.to-1);if(J>=Q.number){let K=$[$.length-1];K.to=Y.to,K.ranges.push(X)}else $.push({from:Q.from,to:Y.to,ranges:[X]});J=Y.number+1}return $}function RX(Z,$,J){if(Z.readOnly)return!1;let X=[],Q=[];for(let Y of j8(Z)){if(J?Y.to==Z.doc.length:Y.from==0)continue;let K=Z.doc.lineAt(J?Y.to+1:Y.from-1),U=K.length+1;if(J){X.push({from:Y.to,to:K.to},{from:Y.from,insert:K.text+Z.lineBreak});for(let q of Y.ranges)Q.push(A.range(Math.min(Z.doc.length,q.anchor+U),Math.min(Z.doc.length,q.head+U)))}else{X.push({from:K.from,to:Y.from},{from:Y.to,insert:Z.lineBreak+K.text});for(let q of Y.ranges)Q.push(A.range(q.anchor-U,q.head-U))}}if(!X.length)return!1;return $(Z.update({changes:X,scrollIntoView:!0,selection:A.create(Q,Z.selection.mainIndex),userEvent:"move.line"})),!0}var hG=({state:Z,dispatch:$})=>RX(Z,$,!1),vG=({state:Z,dispatch:$})=>RX(Z,$,!0);function FX(Z,$,J){if(Z.readOnly)return!1;let X=[];for(let Y of j8(Z))if(J)X.push({from:Y.from,insert:Z.doc.slice(Y.from,Y.to)+Z.lineBreak});else X.push({from:Y.to,insert:Z.lineBreak+Z.doc.slice(Y.from,Y.to)});let Q=Z.changes(X);return $(Z.update({changes:Q,selection:Z.selection.map(Q,J?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}var uG=({state:Z,dispatch:$})=>FX(Z,$,!1),mG=({state:Z,dispatch:$})=>FX(Z,$,!0),fG=(Z)=>{if(Z.state.readOnly)return!1;let{state:$}=Z,J=$.changes(j8($).map(({from:Q,to:Y})=>{if(Q>0)Q--;else if(Y<$.doc.length)Y++;return{from:Q,to:Y}})),X=d7($.selection,(Q)=>{let Y=void 0;if(Z.lineWrapping){let K=Z.lineBlockAt(Q.head),U=Z.coordsAtPos(Q.head,Q.assoc||1);if(U)Y=K.bottom+Z.documentTop-U.bottom+Z.defaultLineHeight/2}return Z.moveVertically(Q,!0,Y)}).map(J);return Z.dispatch({changes:J,selection:X,scrollIntoView:!0,userEvent:"delete.line"}),!0};function gG(Z,$){if(/\(\)|\[\]|\{\}/.test(Z.sliceDoc($-1,$+1)))return{from:$,to:$};let J=B0(Z).resolveInner($),X=J.childBefore($),Q=J.childAfter($),Y;if(X&&Q&&X.to<=$&&Q.from>=$&&(Y=X.type.prop(r.closedBy))&&Y.indexOf(Q.name)>-1&&Z.doc.lineAt(X.to).from==Z.doc.lineAt(Q.from).from&&!/\S/.test(Z.sliceDoc(X.to,Q.from)))return{from:X.to,to:Q.from};return null}var p2=DX(!1),pG=DX(!0);function DX(Z){return({state:$,dispatch:J})=>{if($.readOnly)return!1;let X=$.changeByRange((Q)=>{let{from:Y,to:K}=Q,U=$.doc.lineAt(Y),q=!Z&&Y==K&&gG($,Y);if(Z)Y=K=(K<=U.to?U:$.doc.lineAt(K)).to;let G=new p7($,{simulateBreak:Y,simulateDoubleBreak:!!q}),W=X8(G,Y);if(W==null)W=x1(/^\s*/.exec($.doc.lineAt(Y).text)[0],$.tabSize);while(K<U.to&&/\s/.test(U.text[K-U.from]))K++;if(q)({from:Y,to:K}=q);else if(Y>U.from&&Y<U.from+100&&!/\S/.test(U.text.slice(0,Y)))Y=U.from;let j=["",g7($,W)];if(q)j.push(g7($,G.lineIndent(U.from,-1)));return{changes:{from:Y,to:K,insert:e.of(j)},range:A.cursor(Y+1+j[1].length)}});return J($.update(X,{scrollIntoView:!0,userEvent:"input"})),!0}}function x5(Z,$){let J=-1;return Z.changeByRange((X)=>{let Q=[];for(let K=X.from;K<=X.to;){let U=Z.doc.lineAt(K);if(U.number>J&&(X.empty||X.to>U.from))$(U,Q,X),J=U.number;K=U.to+1}let Y=Z.changes(Q);return{changes:Q,range:A.range(Y.mapPos(X.anchor,1),Y.mapPos(X.head,1))}})}var lG=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let J=Object.create(null),X=new p7(Z,{overrideIndentation:(Y)=>{let K=J[Y];return K==null?-1:K}}),Q=x5(Z,(Y,K,U)=>{let q=X8(X,Y.from);if(q==null)return;if(!/\S/.test(Y.text))q=0;let G=/^\s*/.exec(Y.text)[0],W=g7(Z,q);if(G!=W||U.from<Y.from+G.length)J[Y.from]=q,K.push({from:Y.from,to:Y.from+G.length,insert:W})});if(!Q.changes.empty)$(Z.update(Q,{userEvent:"indent"}));return!0},dG=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;return $(Z.update(x5(Z,(J,X)=>{X.push({from:J.from,insert:Z.facet(h4)})}),{userEvent:"input.indent"})),!0},cG=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;return $(Z.update(x5(Z,(J,X)=>{let Q=/^\s*/.exec(J.text)[0];if(!Q)return;let Y=x1(Q,Z.tabSize),K=0,U=g7(Z,Math.max(0,Y-o1(Z)));while(K<Q.length&&K<U.length&&Q.charCodeAt(K)==U.charCodeAt(K))K++;X.push({from:J.from+K,to:J.from+Q.length,insert:U.slice(K)})}),{userEvent:"delete.dedent"})),!0},sG=(Z)=>{return Z.setTabFocusMode(),!0};var nG=[{key:"Ctrl-b",run:t2,shift:UX,preventDefault:!0},{key:"Ctrl-f",run:e2,shift:qX},{key:"Ctrl-p",run:JX,shift:jX},{key:"Ctrl-n",run:XX,shift:_X},{key:"Ctrl-a",run:WG,shift:AG},{key:"Ctrl-e",run:jG,shift:MG},{key:"Ctrl-d",run:NX},{key:"Ctrl-h",run:k5},{key:"Ctrl-k",run:kG},{key:"Ctrl-Alt-h",run:IX},{key:"Ctrl-o",run:xG},{key:"Ctrl-t",run:wG},{key:"Ctrl-v",run:y5}],iG=[{key:"ArrowLeft",run:t2,shift:UX,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:$G,shift:OG,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:qG,shift:FG,preventDefault:!0},{key:"ArrowRight",run:e2,shift:qX,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:JG,shift:VG,preventDefault:!0},{mac:"Cmd-ArrowRight",run:GG,shift:DG,preventDefault:!0},{key:"ArrowUp",run:JX,shift:jX,preventDefault:!0},{mac:"Cmd-ArrowUp",run:u2,shift:f2},{mac:"Ctrl-ArrowUp",run:w2,shift:h2},{key:"ArrowDown",run:XX,shift:_X,preventDefault:!0},{mac:"Cmd-ArrowDown",run:m2,shift:g2},{mac:"Ctrl-ArrowDown",run:y5,shift:v2},{key:"PageUp",run:w2,shift:h2},{key:"PageDown",run:y5,shift:v2},{key:"Home",run:UG,shift:RG,preventDefault:!0},{key:"Mod-Home",run:u2,shift:f2},{key:"End",run:KG,shift:IG,preventDefault:!0},{key:"Mod-End",run:m2,shift:g2},{key:"Enter",run:p2,shift:p2},{key:"Mod-a",run:LG},{key:"Backspace",run:k5,shift:k5,preventDefault:!0},{key:"Delete",run:NX,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:IX,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:yG,preventDefault:!0},{mac:"Mod-Backspace",run:SG,preventDefault:!0},{mac:"Mod-Delete",run:bG,preventDefault:!0}].concat(nG.map((Z)=>({mac:Z.key,run:Z.run,shift:Z.shift}))),AX=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:QG,shift:NG},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:YG,shift:HG},{key:"Alt-ArrowUp",run:hG},{key:"Shift-Alt-ArrowUp",run:uG},{key:"Alt-ArrowDown",run:vG},{key:"Shift-Alt-ArrowDown",run:mG},{key:"Mod-Alt-ArrowUp",run:PG},{key:"Mod-Alt-ArrowDown",run:CG},{key:"Escape",run:TG},{key:"Mod-Enter",run:pG},{key:"Alt-l",mac:"Ctrl-l",run:BG},{key:"Mod-i",run:EG,preventDefault:!0},{key:"Mod-[",run:cG},{key:"Mod-]",run:dG},{key:"Mod-Alt-\\",run:lG},{key:"Shift-Mod-k",run:fG},{key:"Shift-Mod-\\",run:zG},{key:"Mod-/",run:uq},{key:"Alt-A",run:fq},{key:"Ctrl-m",mac:"Shift-Alt-m",run:sG}].concat(iG);var MX=typeof String.prototype.normalize=="function"?(Z)=>Z.normalize("NFKD"):(Z)=>Z;class N7{constructor(Z,$,J=0,X=Z.length,Q,Y){this.test=Y,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=Z.iterRange(J,X),this.bufferStart=J,this.normalize=Q?(K)=>Q(MX(K)):MX,this.query=this.normalize($)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return y0(this.buffer,this.bufferPos)}next(){while(this.matches.length)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let Z=this.peek();if(Z<0)return this.done=!0,this;let $=U4(Z),J=this.bufferStart+this.bufferPos;this.bufferPos+=n0(Z);let X=this.normalize($);if(X.length)for(let Q=0,Y=J;;Q++){let K=X.charCodeAt(Q),U=this.match(K,Y,this.bufferPos+this.bufferStart);if(Q==X.length-1){if(U)return this.value=U,this;break}if(Y==J&&Q<$.length&&$.charCodeAt(Q)==K)Y++}}}match(Z,$,J){let X=null;for(let Q=0;Q<this.matches.length;Q+=2){let Y=this.matches[Q],K=!1;if(this.query.charCodeAt(Y)==Z)if(Y==this.query.length-1)X={from:this.matches[Q+1],to:J};else this.matches[Q]++,K=!0;if(!K)this.matches.splice(Q,2),Q-=2}if(this.query.charCodeAt(0)==Z)if(this.query.length==1)X={from:$,to:J};else this.matches.push(1,$);if(X&&this.test&&!this.test(X.from,X.to,this.buffer,this.bufferStart))X=null;return X}}if(typeof Symbol<"u")N7.prototype[Symbol.iterator]=function(){return this};var EX={from:-1,to:-1,match:/.*/.exec("")},v5="gm"+(/x/.unicode==null?"":"u");class u5{constructor(Z,$,J,X=0,Q=Z.length){if(this.text=Z,this.to=Q,this.curLine="",this.done=!1,this.value=EX,/\\[sWDnr]|\n|\r|\[\^/.test($))return new m5(Z,$,J,X,Q);this.re=new RegExp($,v5+((J===null||J===void 0?void 0:J.ignoreCase)?"i":"")),this.test=J===null||J===void 0?void 0:J.test,this.iter=Z.iter();let Y=Z.lineAt(X);this.curLineStart=Y.from,this.matchPos=V8(Z,X),this.getLine(this.curLineStart)}getLine(Z){if(this.iter.next(Z),this.iter.lineBreak)this.curLine="";else{if(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to)this.curLine=this.curLine.slice(0,this.to-this.curLineStart);this.iter.next()}}nextLine(){if(this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to)this.curLine="";else this.getLine(0)}next(){for(let Z=this.matchPos-this.curLineStart;;){this.re.lastIndex=Z;let $=this.matchPos<=this.to&&this.re.exec(this.curLine);if($){let J=this.curLineStart+$.index,X=J+$[0].length;if(this.matchPos=V8(this.text,X+(J==X?1:0)),J==this.curLineStart+this.curLine.length)this.nextLine();if((J<X||J>this.value.to)&&(!this.test||this.test(J,X,$)))return this.value={from:J,to:X,match:$},this;Z=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),Z=0;else return this.done=!0,this}}}var w5=new WeakMap;class n7{constructor(Z,$){this.from=Z,this.text=$}get to(){return this.from+this.text.length}static get(Z,$,J){let X=w5.get(Z);if(!X||X.from>=J||X.to<=$){let K=new n7($,Z.sliceString($,J));return w5.set(Z,K),K}if(X.from==$&&X.to==J)return X;let{text:Q,from:Y}=X;if(Y>$)Q=Z.sliceString($,Y)+Q,Y=$;if(X.to<J)Q+=Z.sliceString(X.to,J);return w5.set(Z,new n7(Y,Q)),new n7($,Q.slice($-Y,J-Y))}}class m5{constructor(Z,$,J,X,Q){this.text=Z,this.to=Q,this.done=!1,this.value=EX,this.matchPos=V8(Z,X),this.re=new RegExp($,v5+((J===null||J===void 0?void 0:J.ignoreCase)?"i":"")),this.test=J===null||J===void 0?void 0:J.test,this.flat=n7.get(Z,X,this.chunkEnd(X+5000))}chunkEnd(Z){return Z>=this.to?this.to:this.text.lineAt(Z).to}next(){for(;;){let Z=this.re.lastIndex=this.matchPos-this.flat.from,$=this.re.exec(this.flat.text);if($&&!$[0]&&$.index==Z)this.re.lastIndex=Z+1,$=this.re.exec(this.flat.text);if($){let J=this.flat.from+$.index,X=J+$[0].length;if((this.flat.to>=this.to||$.index+$[0].length<=this.flat.text.length-10)&&(!this.test||this.test(J,X,$)))return this.value={from:J,to:X,match:$},this.matchPos=V8(this.text,X+(J==X?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=n7.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}if(typeof Symbol<"u")u5.prototype[Symbol.iterator]=m5.prototype[Symbol.iterator]=function(){return this};function aG(Z){try{return new RegExp(Z,v5),!0}catch($){return!1}}function V8(Z,$){if($>=Z.length)return $;let J=Z.lineAt($),X;while($<J.to&&(X=J.text.charCodeAt($-J.from))>=56320&&X<57344)$++;return $}var rG=(Z)=>{let{state:$}=Z,J=String($.doc.lineAt(Z.state.selection.main.head).number),{close:X,result:Q}=xJ(Z,{label:$.phrase("Go to line"),input:{type:"text",name:"line",value:J},focus:!0,submitLabel:$.phrase("go")});return Q.then((Y)=>{let K=Y&&/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(Y.elements.line.value);if(!K){Z.dispatch({effects:X});return}let U=$.doc.lineAt($.selection.main.head),[,q,G,W,j]=K,_=W?+W.slice(1):0,z=G?+G:U.number;if(G&&j){let H=z/100;if(q)H=H*(q=="-"?-1:1)+U.number/$.doc.lines;z=Math.round($.doc.lines*H)}else if(G&&q)z=z*(q=="-"?-1:1)+U.number;let V=$.doc.line(Math.max(1,Math.min($.doc.lines,z))),O=A.cursor(V.from+Math.max(0,Math.min(_,V.length)));Z.dispatch({effects:[X,C.scrollIntoView(O.from,{y:"center"})],selection:O})}),!0},oG={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},PX=S.define({combine(Z){return w0(Z,oG,{highlightWordAroundCursor:($,J)=>$||J,minSelectionLength:Math.min,maxMatches:Math.min})}});function CX(Z){let $=[JW,$W];if(Z)$.push(PX.of(Z));return $}var tG=m.mark({class:"cm-selectionMatch"}),eG=m.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function LX(Z,$,J,X){return(J==0||Z($.sliceDoc(J-1,J))!=Y0.Word)&&(X==$.doc.length||Z($.sliceDoc(X,X+1))!=Y0.Word)}function ZW(Z,$,J,X){return Z($.sliceDoc(J,J+1))==Y0.Word&&Z($.sliceDoc(X-1,X))==Y0.Word}var $W=j0.fromClass(class{constructor(Z){this.decorations=this.getDeco(Z)}update(Z){if(Z.selectionSet||Z.docChanged||Z.viewportChanged)this.decorations=this.getDeco(Z.view)}getDeco(Z){let $=Z.state.facet(PX),{state:J}=Z,X=J.selection;if(X.ranges.length>1)return m.none;let Q=X.main,Y,K=null;if(Q.empty){if(!$.highlightWordAroundCursor)return m.none;let q=J.wordAt(Q.head);if(!q)return m.none;K=J.charCategorizer(Q.head),Y=J.sliceDoc(q.from,q.to)}else{let q=Q.to-Q.from;if(q<$.minSelectionLength||q>200)return m.none;if($.wholeWords){if(Y=J.sliceDoc(Q.from,Q.to),K=J.charCategorizer(Q.head),!(LX(K,J,Q.from,Q.to)&&ZW(K,J,Q.from,Q.to)))return m.none}else if(Y=J.sliceDoc(Q.from,Q.to),!Y)return m.none}let U=[];for(let q of Z.visibleRanges){let G=new N7(J.doc,Y,q.from,q.to);while(!G.next().done){let{from:W,to:j}=G.value;if(!K||LX(K,J,W,j)){if(Q.empty&&W<=Q.from&&j>=Q.to)U.push(eG.range(W,j));else if(W>=Q.to||j<=Q.from)U.push(tG.range(W,j));if(U.length>$.maxMatches)return m.none}}}return m.set(U)}},{decorations:(Z)=>Z.decorations}),JW=C.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),XW=({state:Z,dispatch:$})=>{let{selection:J}=Z,X=A.create(J.ranges.map((Q)=>Z.wordAt(Q.head)||A.cursor(Q.head)),J.mainIndex);if(X.eq(J))return!1;return $(Z.update({selection:X})),!0};function QW(Z,$){let{main:J,ranges:X}=Z.selection,Q=Z.wordAt(J.head),Y=Q&&Q.from==J.from&&Q.to==J.to;for(let K=!1,U=new N7(Z.doc,$,X[X.length-1].to);;)if(U.next(),U.done){if(K)return null;U=new N7(Z.doc,$,0,Math.max(0,X[X.length-1].from-1)),K=!0}else{if(K&&X.some((q)=>q.from==U.value.from))continue;if(Y){let q=Z.wordAt(U.value.from);if(!q||q.from!=U.value.from||q.to!=U.value.to)continue}return U.value}}var YW=({state:Z,dispatch:$})=>{let{ranges:J}=Z.selection;if(J.some((Y)=>Y.from===Y.to))return XW({state:Z,dispatch:$});let X=Z.sliceDoc(J[0].from,J[0].to);if(Z.selection.ranges.some((Y)=>Z.sliceDoc(Y.from,Y.to)!=X))return!1;let Q=QW(Z,X);if(!Q)return!1;return $(Z.update({selection:Z.selection.addRange(A.range(Q.from,Q.to),!1),effects:C.scrollIntoView(Q.to)})),!0},i7=S.define({combine(Z){return w0(Z,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:($)=>new hX($),scrollToMatch:($)=>C.scrollIntoView($)})}});class f5{constructor(Z){this.search=Z.search,this.caseSensitive=!!Z.caseSensitive,this.literal=!!Z.literal,this.regexp=!!Z.regexp,this.replace=Z.replace||"",this.valid=!!this.search&&(!this.regexp||aG(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!Z.wholeWord,this.test=Z.test}unquote(Z){return this.literal?Z:Z.replace(/\\([nrt\\])/g,($,J)=>J=="n"?`
`:J=="r"?"\r":J=="t"?"\t":"\\")}eq(Z){return this.search==Z.search&&this.replace==Z.replace&&this.caseSensitive==Z.caseSensitive&&this.regexp==Z.regexp&&this.wholeWord==Z.wholeWord&&this.test==Z.test}create(){return this.regexp?new yX(this):new TX(this)}getCursor(Z,$=0,J){let X=Z.doc?Z:n.create({doc:Z});if(J==null)J=X.doc.length;return this.regexp?s7(this,X,$,J):c7(this,X,$,J)}}class g5{constructor(Z){this.spec=Z}}function KW(Z,$,J){return(X,Q,Y,K)=>{if(J&&!J(X,Q,Y,K))return!1;let U=X>=K&&Q<=K+Y.length?Y.slice(X-K,Q-K):$.doc.sliceString(X,Q);return Z(U,$,X,Q)}}function c7(Z,$,J,X){let Q;if(Z.wholeWord)Q=UW($.doc,$.charCategorizer($.selection.main.head));if(Z.test)Q=KW(Z.test,$,Q);return new N7($.doc,Z.unquoted,J,X,Z.caseSensitive?void 0:(Y)=>Y.toLowerCase(),Q)}function UW(Z,$){return(J,X,Q,Y)=>{if(Y>J||Y+Q.length<X)Y=Math.max(0,J-2),Q=Z.sliceString(Y,Math.min(Z.length,X+2));return($(N8(Q,J-Y))!=Y0.Word||$(H8(Q,J-Y))!=Y0.Word)&&($(H8(Q,X-Y))!=Y0.Word||$(N8(Q,X-Y))!=Y0.Word)}}class TX extends g5{constructor(Z){super(Z)}nextMatch(Z,$,J){let X=c7(this.spec,Z,J,Z.doc.length).nextOverlapping();if(X.done){let Q=Math.min(Z.doc.length,$+this.spec.unquoted.length);X=c7(this.spec,Z,0,Q).nextOverlapping()}return X.done||X.value.from==$&&X.value.to==J?null:X.value}prevMatchInRange(Z,$,J){for(let X=J;;){let Q=Math.max($,X-1e4-this.spec.unquoted.length),Y=c7(this.spec,Z,Q,X),K=null;while(!Y.nextOverlapping().done)K=Y.value;if(K)return K;if(Q==$)return null;X-=1e4}}prevMatch(Z,$,J){let X=this.prevMatchInRange(Z,0,$);if(!X)X=this.prevMatchInRange(Z,Math.max(0,J-this.spec.unquoted.length),Z.doc.length);return X&&(X.from!=$||X.to!=J)?X:null}getReplacement(Z){return this.spec.unquote(this.spec.replace)}matchAll(Z,$){let J=c7(this.spec,Z,0,Z.doc.length),X=[];while(!J.next().done){if(X.length>=$)return null;X.push(J.value)}return X}highlight(Z,$,J,X){let Q=c7(this.spec,Z,Math.max(0,$-this.spec.unquoted.length),Math.min(J+this.spec.unquoted.length,Z.doc.length));while(!Q.next().done)X(Q.value.from,Q.value.to)}}function qW(Z,$,J){return(X,Q,Y)=>{return(!J||J(X,Q,Y))&&Z(Y[0],$,X,Q)}}function s7(Z,$,J,X){let Q;if(Z.wholeWord)Q=GW($.charCategorizer($.selection.main.head));if(Z.test)Q=qW(Z.test,$,Q);return new u5($.doc,Z.search,{ignoreCase:!Z.caseSensitive,test:Q},J,X)}function N8(Z,$){return Z.slice(H0(Z,$,!1),$)}function H8(Z,$){return Z.slice($,H0(Z,$))}function GW(Z){return($,J,X)=>!X[0].length||(Z(N8(X.input,X.index))!=Y0.Word||Z(H8(X.input,X.index))!=Y0.Word)&&(Z(H8(X.input,X.index+X[0].length))!=Y0.Word||Z(N8(X.input,X.index+X[0].length))!=Y0.Word)}class yX extends g5{nextMatch(Z,$,J){let X=s7(this.spec,Z,J,Z.doc.length).next();if(X.done)X=s7(this.spec,Z,0,$).next();return X.done?null:X.value}prevMatchInRange(Z,$,J){for(let X=1;;X++){let Q=Math.max($,J-X*1e4),Y=s7(this.spec,Z,Q,J),K=null;while(!Y.next().done)K=Y.value;if(K&&(Q==$||K.from>Q+10))return K;if(Q==$)return null}}prevMatch(Z,$,J){return this.prevMatchInRange(Z,0,$)||this.prevMatchInRange(Z,J,Z.doc.length)}getReplacement(Z){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,($,J)=>{if(J=="&")return Z.match[0];if(J=="$")return"$";for(let X=J.length;X>0;X--){let Q=+J.slice(0,X);if(Q>0&&Q<Z.match.length)return Z.match[Q]+J.slice(X)}return $})}matchAll(Z,$){let J=s7(this.spec,Z,0,Z.doc.length),X=[];while(!J.next().done){if(X.length>=$)return null;X.push(J.value)}return X}highlight(Z,$,J,X){let Q=s7(this.spec,Z,Math.max(0,$-250),Math.min(J+250,Z.doc.length));while(!Q.next().done)X(Q.value.from,Q.value.to)}}var f4=p.define(),p5=p.define(),e1=_0.define({create(Z){return new O8(h5(Z).create(),null)},update(Z,$){for(let J of $.effects)if(J.is(f4))Z=new O8(J.value.create(),Z.panel);else if(J.is(p5))Z=new O8(Z.query,J.value?l5:null);return Z},provide:(Z)=>_7.from(Z,($)=>$.panel)});class O8{constructor(Z,$){this.query=Z,this.panel=$}}var WW=m.mark({class:"cm-searchMatch"}),jW=m.mark({class:"cm-searchMatch cm-searchMatch-selected"}),_W=j0.fromClass(class{constructor(Z){this.view=Z,this.decorations=this.highlight(Z.state.field(e1))}update(Z){let $=Z.state.field(e1);if($!=Z.startState.field(e1)||Z.docChanged||Z.selectionSet||Z.viewportChanged)this.decorations=this.highlight($)}highlight({query:Z,panel:$}){if(!$||!Z.spec.valid)return m.none;let{view:J}=this,X=new s0;for(let Q=0,Y=J.visibleRanges,K=Y.length;Q<K;Q++){let{from:U,to:q}=Y[Q];while(Q<K-1&&q>Y[Q+1].from-500)q=Y[++Q].to;Z.highlight(J.state,U,q,(G,W)=>{let j=J.state.selection.ranges.some((_)=>_.from==G&&_.to==W);X.add(G,W,j?jW:WW)})}return X.finish()}},{decorations:(Z)=>Z.decorations});function g4(Z){return($)=>{let J=$.state.field(e1,!1);return J&&J.query.spec.valid?Z($,J):bX($)}}var I8=g4((Z,{query:$})=>{let{to:J}=Z.state.selection.main,X=$.nextMatch(Z.state,J,J);if(!X)return!1;let Q=A.single(X.from,X.to),Y=Z.state.facet(i7);return Z.dispatch({selection:Q,effects:[d5(Z,X),Y.scrollToMatch(Q.main,Z)],userEvent:"select.search"}),SX(Z),!0}),R8=g4((Z,{query:$})=>{let{state:J}=Z,{from:X}=J.selection.main,Q=$.prevMatch(J,X,X);if(!Q)return!1;let Y=A.single(Q.from,Q.to),K=Z.state.facet(i7);return Z.dispatch({selection:Y,effects:[d5(Z,Q),K.scrollToMatch(Y.main,Z)],userEvent:"select.search"}),SX(Z),!0}),zW=g4((Z,{query:$})=>{let J=$.matchAll(Z.state,1000);if(!J||!J.length)return!1;return Z.dispatch({selection:A.create(J.map((X)=>A.range(X.from,X.to))),userEvent:"select.search.matches"}),!0}),OW=({state:Z,dispatch:$})=>{let J=Z.selection;if(J.ranges.length>1||J.main.empty)return!1;let{from:X,to:Q}=J.main,Y=[],K=0;for(let U=new N7(Z.doc,Z.sliceDoc(X,Q));!U.next().done;){if(Y.length>1000)return!1;if(U.value.from==X)K=Y.length;Y.push(A.range(U.value.from,U.value.to))}return $(Z.update({selection:A.create(Y,K),userEvent:"select.search.matches"})),!0},BX=g4((Z,{query:$})=>{let{state:J}=Z,{from:X,to:Q}=J.selection.main;if(J.readOnly)return!1;let Y=$.nextMatch(J,X,X);if(!Y)return!1;let K=Y,U=[],q,G,W=[];if(K.from==X&&K.to==Q)G=J.toText($.getReplacement(K)),U.push({from:K.from,to:K.to,insert:G}),K=$.nextMatch(J,K.from,K.to),W.push(C.announce.of(J.phrase("replaced match on line $",J.doc.lineAt(X).number)+"."));let j=Z.state.changes(U);if(K)q=A.single(K.from,K.to).map(j),W.push(d5(Z,K)),W.push(J.facet(i7).scrollToMatch(q.main,Z));return Z.dispatch({changes:j,selection:q,effects:W,userEvent:"input.replace"}),!0}),VW=g4((Z,{query:$})=>{if(Z.state.readOnly)return!1;let J=$.matchAll(Z.state,1e9).map((Q)=>{let{from:Y,to:K}=Q;return{from:Y,to:K,insert:$.getReplacement(Q)}});if(!J.length)return!1;let X=Z.state.phrase("replaced $ matches",J.length)+".";return Z.dispatch({changes:J,effects:C.announce.of(X),userEvent:"input.replace.all"}),!0});function l5(Z){return Z.state.facet(i7).createPanel(Z)}function h5(Z,$){var J,X,Q,Y,K;let U=Z.selection.main,q=U.empty||U.to>U.from+100?"":Z.sliceDoc(U.from,U.to);if($&&!q)return $;let G=Z.facet(i7);return new f5({search:((J=$===null||$===void 0?void 0:$.literal)!==null&&J!==void 0?J:G.literal)?q:q.replace(/\n/g,"\\n"),caseSensitive:(X=$===null||$===void 0?void 0:$.caseSensitive)!==null&&X!==void 0?X:G.caseSensitive,literal:(Q=$===null||$===void 0?void 0:$.literal)!==null&&Q!==void 0?Q:G.literal,regexp:(Y=$===null||$===void 0?void 0:$.regexp)!==null&&Y!==void 0?Y:G.regexp,wholeWord:(K=$===null||$===void 0?void 0:$.wholeWord)!==null&&K!==void 0?K:G.wholeWord})}function kX(Z){let $=k4(Z,l5);return $&&$.dom.querySelector("[main-field]")}function SX(Z){let $=kX(Z);if($&&$==Z.root.activeElement)$.select()}var bX=(Z)=>{let $=Z.state.field(e1,!1);if($&&$.panel){let J=kX(Z);if(J&&J!=Z.root.activeElement){let X=h5(Z.state,$.query.spec);if(X.valid)Z.dispatch({effects:f4.of(X)});J.focus(),J.select()}}else Z.dispatch({effects:[p5.of(!0),$?f4.of(h5(Z.state,$.query.spec)):p.appendConfig.of(HW)]});return!0},xX=(Z)=>{let $=Z.state.field(e1,!1);if(!$||!$.panel)return!1;let J=k4(Z,l5);if(J&&J.dom.contains(Z.root.activeElement))Z.focus();return Z.dispatch({effects:p5.of(!1)}),!0},wX=[{key:"Mod-f",run:bX,scope:"editor search-panel"},{key:"F3",run:I8,shift:R8,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:I8,shift:R8,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:xX,scope:"editor search-panel"},{key:"Mod-Shift-l",run:OW},{key:"Mod-Alt-g",run:rG},{key:"Mod-d",run:YW,preventDefault:!0}];class hX{constructor(Z){this.view=Z;let $=this.query=Z.state.field(e1).query.spec;this.commit=this.commit.bind(this),this.searchField=$0("input",{value:$.search,placeholder:o0(Z,"Find"),"aria-label":o0(Z,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=$0("input",{value:$.replace,placeholder:o0(Z,"Replace"),"aria-label":o0(Z,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=$0("input",{type:"checkbox",name:"case",form:"",checked:$.caseSensitive,onchange:this.commit}),this.reField=$0("input",{type:"checkbox",name:"re",form:"",checked:$.regexp,onchange:this.commit}),this.wordField=$0("input",{type:"checkbox",name:"word",form:"",checked:$.wholeWord,onchange:this.commit});function J(X,Q,Y){return $0("button",{class:"cm-button",name:X,onclick:Q,type:"button"},Y)}this.dom=$0("div",{onkeydown:(X)=>this.keydown(X),class:"cm-search"},[this.searchField,J("next",()=>I8(Z),[o0(Z,"next")]),J("prev",()=>R8(Z),[o0(Z,"previous")]),J("select",()=>zW(Z),[o0(Z,"all")]),$0("label",null,[this.caseField,o0(Z,"match case")]),$0("label",null,[this.reField,o0(Z,"regexp")]),$0("label",null,[this.wordField,o0(Z,"by word")]),...Z.state.readOnly?[]:[$0("br"),this.replaceField,J("replace",()=>BX(Z),[o0(Z,"replace")]),J("replaceAll",()=>VW(Z),[o0(Z,"replace all")])],$0("button",{name:"close",onclick:()=>xX(Z),"aria-label":o0(Z,"close"),type:"button"},["×"])])}commit(){let Z=new f5({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});if(!Z.eq(this.query))this.query=Z,this.view.dispatch({effects:f4.of(Z)})}keydown(Z){if(VJ(this.view,Z,"search-panel"))Z.preventDefault();else if(Z.keyCode==13&&Z.target==this.searchField)Z.preventDefault(),(Z.shiftKey?R8:I8)(this.view);else if(Z.keyCode==13&&Z.target==this.replaceField)Z.preventDefault(),BX(this.view)}update(Z){for(let $ of Z.transactions)for(let J of $.effects)if(J.is(f4)&&!J.value.eq(this.query))this.setQuery(J.value)}setQuery(Z){this.query=Z,this.searchField.value=Z.search,this.replaceField.value=Z.replace,this.caseField.checked=Z.caseSensitive,this.reField.checked=Z.regexp,this.wordField.checked=Z.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(i7).top}}function o0(Z,$){return Z.state.phrase($)}var _8=30,z8=/[\s\.,:;?!]/;function d5(Z,{from:$,to:J}){let X=Z.state.doc.lineAt($),Q=Z.state.doc.lineAt(J).to,Y=Math.max(X.from,$-_8),K=Math.min(Q,J+_8),U=Z.state.sliceDoc(Y,K);if(Y!=X.from){for(let q=0;q<_8;q++)if(!z8.test(U[q+1])&&z8.test(U[q])){U=U.slice(q);break}}if(K!=Q){for(let q=U.length-1;q>U.length-_8;q--)if(!z8.test(U[q-1])&&z8.test(U[q])){U=U.slice(0,q);break}}return C.announce.of(`${Z.state.phrase("current match")}. ${U} ${Z.state.phrase("on line")} ${X.number}.`)}var NW=C.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),HW=[e1,O1.low(_W),NW];class a5{constructor(Z,$,J,X){this.state=Z,this.pos=$,this.explicit=J,this.view=X,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(Z){let $=B0(this.state).resolveInner(this.pos,-1);while($&&Z.indexOf($.name)<0)$=$.parent;return $?{from:$.from,to:this.pos,text:this.state.sliceDoc($.from,this.pos),type:$.type}:null}matchBefore(Z){let $=this.state.doc.lineAt(this.pos),J=Math.max($.from,this.pos-250),X=$.text.slice(J-$.from,this.pos-$.from),Q=X.search(dX(Z,!1));return Q<0?null:{from:J+Q,to:this.pos,text:X.slice(Q)}}get aborted(){return this.abortListeners==null}addEventListener(Z,$,J){if(Z=="abort"&&this.abortListeners){if(this.abortListeners.push($),J&&J.onDocChange)this.abortOnDocChange=!0}}}function vX(Z){let $=Object.keys(Z).join(""),J=/\w/.test($);if(J)$=$.replace(/\w/g,"");return`[${J?"\\w":""}${$.replace(/[^\w\s]/g,"\\$&")}]`}function IW(Z){let $=Object.create(null),J=Object.create(null);for(let{label:Q}of Z){$[Q[0]]=!0;for(let Y=1;Y<Q.length;Y++)J[Q[Y]]=!0}let X=vX($)+vX(J)+"*$";return[new RegExp("^"+X),new RegExp(X)]}function RW(Z){let $=Z.map((Q)=>typeof Q=="string"?{label:Q}:Q),[J,X]=$.every((Q)=>/^\w+$/.test(Q.label))?[/\w*$/,/\w+$/]:IW($);return(Q)=>{let Y=Q.matchBefore(X);return Y||Q.explicit?{from:Y?Y.from:Q.pos,options:$,validFor:J}:null}}class i5{constructor(Z,$,J,X){this.completion=Z,this.source=$,this.match=J,this.score=X}}function I7(Z){return Z.selection.main.from}function dX(Z,$){var J;let{source:X}=Z,Q=$&&X[0]!="^",Y=X[X.length-1]!="$";if(!Q&&!Y)return Z;return new RegExp(`${Q?"^":""}(?:${X})${Y?"$":""}`,(J=Z.flags)!==null&&J!==void 0?J:Z.ignoreCase?"i":"")}var cX=i0.define();function FW(Z,$,J,X){let{main:Q}=Z.selection,Y=J-Q.from,K=X-Q.from;return{...Z.changeByRange((U)=>{if(U!=Q&&J!=X&&Z.sliceDoc(U.from+Y,U.from+K)!=Z.sliceDoc(J,X))return{range:U};let q=Z.toText($);return{changes:{from:U.from+Y,to:X==Q.from?U.to:U.from+K,insert:q},range:A.cursor(U.from+Y+q.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}var uX=new WeakMap;function DW(Z){if(!Array.isArray(Z))return Z;let $=uX.get(Z);if(!$)uX.set(Z,$=RW(Z));return $}var D8=p.define(),p4=p.define();class sX{constructor(Z){this.pattern=Z,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let $=0;$<Z.length;){let J=y0(Z,$),X=n0(J);this.chars.push(J);let Q=Z.slice($,$+X),Y=Q.toUpperCase();this.folded.push(y0(Y==Q?Q.toLowerCase():Y,0)),$+=X}this.astral=Z.length!=this.chars.length}ret(Z,$){return this.score=Z,this.matched=$,this}match(Z){if(this.pattern.length==0)return this.ret(-100,[]);if(Z.length<this.pattern.length)return null;let{chars:$,folded:J,any:X,precise:Q,byWord:Y}=this;if($.length==1){let R=y0(Z,0),D=n0(R),M=D==Z.length?0:-100;if(R==$[0]);else if(R==J[0])M+=-200;else return null;return this.ret(M,[0,D])}let K=Z.indexOf(this.pattern);if(K==0)return this.ret(Z.length==this.pattern.length?0:-100,[0,this.pattern.length]);let U=$.length,q=0;if(K<0){for(let R=0,D=Math.min(Z.length,200);R<D&&q<U;){let M=y0(Z,R);if(M==$[q]||M==J[q])X[q++]=R;R+=n0(M)}if(q<U)return null}let G=0,W=0,j=!1,_=0,z=-1,V=-1,O=/[a-z]/.test(Z),H=!0;for(let R=0,D=Math.min(Z.length,200),M=0;R<D&&W<U;){let L=y0(Z,R);if(K<0){if(G<U&&L==$[G])Q[G++]=R;if(_<U)if(L==$[_]||L==J[_]){if(_==0)z=R;V=R+1,_++}else _=0}let B,w=L<255?L>=48&&L<=57||L>=97&&L<=122?2:L>=65&&L<=90?1:0:(B=U4(L))!=B.toLowerCase()?1:B!=B.toUpperCase()?2:0;if(!R||w==1&&O||M==0&&w!=0){if($[W]==L||J[W]==L&&(j=!0))Y[W++]=R;else if(Y.length)H=!1}M=w,R+=n0(L)}if(W==U&&Y[0]==0&&H)return this.result(-100+(j?-200:0),Y,Z);if(_==U&&z==0)return this.ret(-200-Z.length+(V==Z.length?0:-100),[0,V]);if(K>-1)return this.ret(-700-Z.length,[K,K+this.pattern.length]);if(_==U)return this.ret(-900-Z.length,[z,V]);if(W==U)return this.result(-100+(j?-200:0)+-700+(H?0:-1100),Y,Z);return $.length==2?null:this.result((X[0]?-700:0)+-200+-1100,X,Z)}result(Z,$,J){let X=[],Q=0;for(let Y of $){let K=Y+(this.astral?n0(y0(J,Y)):1);if(Q&&X[Q-1]==Y)X[Q-1]=K;else X[Q++]=Y,X[Q++]=K}return this.ret(Z-J.length,X)}}class nX{constructor(Z){this.pattern=Z,this.matched=[],this.score=0,this.folded=Z.toLowerCase()}match(Z){if(Z.length<this.pattern.length)return null;let $=Z.slice(0,this.pattern.length),J=$==this.pattern?0:$.toLowerCase()==this.folded?-200:null;if(J==null)return null;return this.matched=[0,$.length],this.score=J+(Z.length==this.pattern.length?0:-100),this}}var E0=S.define({combine(Z){return w0(Z,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:AW,filterStrict:!1,compareCompletions:($,J)=>($.sortText||$.label).localeCompare(J.sortText||J.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:($,J)=>$&&J,closeOnBlur:($,J)=>$&&J,icons:($,J)=>$&&J,tooltipClass:($,J)=>(X)=>mX($(X),J(X)),optionClass:($,J)=>(X)=>mX($(X),J(X)),addToOptions:($,J)=>$.concat(J),filterStrict:($,J)=>$||J})}});function mX(Z,$){return Z?$?Z+" "+$:Z:$}function AW(Z,$,J,X,Q,Y){let K=Z.textDirection==Q0.RTL,U=K,q=!1,G="top",W,j,_=$.left-Q.left,z=Q.right-$.right,V=X.right-X.left,O=X.bottom-X.top;if(U&&_<Math.min(V,z))U=!1;else if(!U&&z<Math.min(V,_))U=!0;if(V<=(U?_:z))W=Math.max(Q.top,Math.min(J.top,Q.bottom-O))-$.top,j=Math.min(400,U?_:z);else{q=!0,j=Math.min(400,(K?$.right:Q.right-$.left)-30);let D=Q.bottom-$.bottom;if(D>=O||D>$.top)W=J.bottom-$.top;else G="bottom",W=$.bottom-J.top}let H=($.bottom-$.top)/Y.offsetHeight,R=($.right-$.left)/Y.offsetWidth;return{style:`${G}: ${W/H}px; max-width: ${j/R}px`,class:"cm-completionInfo-"+(q?K?"left-narrow":"right-narrow":U?"left":"right")}}function MW(Z){let $=Z.addToOptions.slice();if(Z.icons)$.push({render(J){let X=document.createElement("div");if(X.classList.add("cm-completionIcon"),J.type)X.classList.add(...J.type.split(/\s+/g).map((Q)=>"cm-completionIcon-"+Q));return X.setAttribute("aria-hidden","true"),X},position:20});return $.push({render(J,X,Q,Y){let K=document.createElement("span");K.className="cm-completionLabel";let U=J.displayLabel||J.label,q=0;for(let G=0;G<Y.length;){let W=Y[G++],j=Y[G++];if(W>q)K.appendChild(document.createTextNode(U.slice(q,W)));let _=K.appendChild(document.createElement("span"));_.appendChild(document.createTextNode(U.slice(W,j))),_.className="cm-completionMatchedText",q=j}if(q<U.length)K.appendChild(document.createTextNode(U.slice(q)));return K},position:50},{render(J){if(!J.detail)return null;let X=document.createElement("span");return X.className="cm-completionDetail",X.textContent=J.detail,X},position:80}),$.sort((J,X)=>J.position-X.position).map((J)=>J.render)}function c5(Z,$,J){if(Z<=J)return{from:0,to:Z};if($<0)$=0;if($<=Z>>1){let Q=Math.floor($/J);return{from:Q*J,to:(Q+1)*J}}let X=Math.floor((Z-$)/J);return{from:Z-(X+1)*J,to:Z-X*J}}class iX{constructor(Z,$,J){this.view=Z,this.stateField=$,this.applyCompletion=J,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:(U)=>this.placeInfo(U),key:this},this.space=null,this.currentClass="";let X=Z.state.field($),{options:Q,selected:Y}=X.open,K=Z.state.facet(E0);this.optionContent=MW(K),this.optionClass=K.optionClass,this.tooltipClass=K.tooltipClass,this.range=c5(Q.length,Y,K.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(Z.state),this.dom.addEventListener("mousedown",(U)=>{let{options:q}=Z.state.field($).open;for(let G=U.target,W;G&&G!=this.dom;G=G.parentNode)if(G.nodeName=="LI"&&(W=/-(\d+)$/.exec(G.id))&&+W[1]<q.length){this.applyCompletion(Z,q[+W[1]]),U.preventDefault();return}}),this.dom.addEventListener("focusout",(U)=>{let q=Z.state.field(this.stateField,!1);if(q&&q.tooltip&&Z.state.facet(E0).closeOnBlur&&U.relatedTarget!=Z.contentDOM)Z.dispatch({effects:p4.of(null)})}),this.showOptions(Q,X.id)}mount(){this.updateSel()}showOptions(Z,$){if(this.list)this.list.remove();this.list=this.dom.appendChild(this.createListBox(Z,$,this.range)),this.list.addEventListener("scroll",()=>{if(this.info)this.view.requestMeasure(this.placeInfoReq)})}update(Z){var $;let J=Z.state.field(this.stateField),X=Z.startState.field(this.stateField);if(this.updateTooltipClass(Z.state),J!=X){let{options:Q,selected:Y,disabled:K}=J.open;if(!X.open||X.open.options!=Q)this.range=c5(Q.length,Y,Z.state.facet(E0).maxRenderedOptions),this.showOptions(Q,J.id);if(this.updateSel(),K!=(($=X.open)===null||$===void 0?void 0:$.disabled))this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!K)}}updateTooltipClass(Z){let $=this.tooltipClass(Z);if($!=this.currentClass){for(let J of this.currentClass.split(" "))if(J)this.dom.classList.remove(J);for(let J of $.split(" "))if(J)this.dom.classList.add(J);this.currentClass=$}}positioned(Z){if(this.space=Z,this.info)this.view.requestMeasure(this.placeInfoReq)}updateSel(){let Z=this.view.state.field(this.stateField),$=Z.open;if($.selected>-1&&$.selected<this.range.from||$.selected>=this.range.to)this.range=c5($.options.length,$.selected,this.view.state.facet(E0).maxRenderedOptions),this.showOptions($.options,Z.id);let J=this.updateSelectedOption($.selected);if(J){this.destroyInfo();let{completion:X}=$.options[$.selected],{info:Q}=X;if(!Q)return;let Y=typeof Q==="string"?document.createTextNode(Q):Q(X);if(!Y)return;if("then"in Y)Y.then((K)=>{if(K&&this.view.state.field(this.stateField,!1)==Z)this.addInfoPane(K,X)}).catch((K)=>S0(this.view.state,K,"completion info"));else this.addInfoPane(Y,X),J.setAttribute("aria-describedby",this.info.id)}}addInfoPane(Z,$){this.destroyInfo();let J=this.info=document.createElement("div");if(J.className="cm-tooltip cm-completionInfo",J.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),Z.nodeType!=null)J.appendChild(Z),this.infoDestroy=null;else{let{dom:X,destroy:Q}=Z;J.appendChild(X),this.infoDestroy=Q||null}this.dom.appendChild(J),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(Z){let $=null;for(let J=this.list.firstChild,X=this.range.from;J;J=J.nextSibling,X++)if(J.nodeName!="LI"||!J.id)X--;else if(X==Z){if(!J.hasAttribute("aria-selected"))J.setAttribute("aria-selected","true"),$=J}else if(J.hasAttribute("aria-selected"))J.removeAttribute("aria-selected"),J.removeAttribute("aria-describedby");if($)BW(this.list,$);return $}measureInfo(){let Z=this.dom.querySelector("[aria-selected]");if(!Z||!this.info)return null;let $=this.dom.getBoundingClientRect(),J=this.info.getBoundingClientRect(),X=Z.getBoundingClientRect(),Q=this.space;if(!Q){let Y=this.dom.ownerDocument.documentElement;Q={left:0,top:0,right:Y.clientWidth,bottom:Y.clientHeight}}if(X.top>Math.min(Q.bottom,$.bottom)-10||X.bottom<Math.max(Q.top,$.top)+10)return null;return this.view.state.facet(E0).positionInfo(this.view,$,X,J,Q,this.dom)}placeInfo(Z){if(this.info)if(Z){if(Z.style)this.info.style.cssText=Z.style;this.info.className="cm-tooltip cm-completionInfo "+(Z.class||"")}else this.info.style.cssText="top: -1e6px"}createListBox(Z,$,J){let X=document.createElement("ul");X.id=$,X.setAttribute("role","listbox"),X.setAttribute("aria-expanded","true"),X.setAttribute("aria-label",this.view.state.phrase("Completions")),X.addEventListener("mousedown",(Y)=>{if(Y.target==X)Y.preventDefault()});let Q=null;for(let Y=J.from;Y<J.to;Y++){let{completion:K,match:U}=Z[Y],{section:q}=K;if(q){let j=typeof q=="string"?q:q.name;if(j!=Q&&(Y>J.from||J.from==0))if(Q=j,typeof q!="string"&&q.header)X.appendChild(q.header(q));else{let _=X.appendChild(document.createElement("completion-section"));_.textContent=j}}let G=X.appendChild(document.createElement("li"));G.id=$+"-"+Y,G.setAttribute("role","option");let W=this.optionClass(K);if(W)G.className=W;for(let j of this.optionContent){let _=j(K,this.view.state,this.view,U);if(_)G.appendChild(_)}}if(J.from)X.classList.add("cm-completionListIncompleteTop");if(J.to<Z.length)X.classList.add("cm-completionListIncompleteBottom");return X}destroyInfo(){if(this.info){if(this.infoDestroy)this.infoDestroy();this.info.remove(),this.info=null}}destroy(){this.destroyInfo()}}function LW(Z,$){return(J)=>new iX(J,Z,$)}function BW(Z,$){let J=Z.getBoundingClientRect(),X=$.getBoundingClientRect(),Q=J.height/Z.offsetHeight;if(X.top<J.top)Z.scrollTop-=(J.top-X.top)/Q;else if(X.bottom>J.bottom)Z.scrollTop+=(X.bottom-J.bottom)/Q}function fX(Z){return(Z.boost||0)*100+(Z.apply?10:0)+(Z.info?5:0)+(Z.type?1:0)}function EW(Z,$){let J=[],X=null,Q=null,Y=(W)=>{J.push(W);let{section:j}=W.completion;if(j){if(!X)X=[];let _=typeof j=="string"?j:j.name;if(!X.some((z)=>z.name==_))X.push(typeof j=="string"?{name:_}:j)}},K=$.facet(E0);for(let W of Z)if(W.hasResult()){let j=W.result.getMatch;if(W.result.filter===!1)for(let _ of W.result.options)Y(new i5(_,W.source,j?j(_):[],1e9-J.length));else{let _=$.sliceDoc(W.from,W.to),z,V=K.filterStrict?new nX(_):new sX(_);for(let O of W.result.options)if(z=V.match(O.label)){let H=!O.displayLabel?z.matched:j?j(O,z.matched):[],R=z.score+(O.boost||0);if(Y(new i5(O,W.source,H,R)),typeof O.section=="object"&&O.section.rank==="dynamic"){let{name:D}=O.section;if(!Q)Q=Object.create(null);Q[D]=Math.max(R,Q[D]||-1e9)}}}}if(X){let W=Object.create(null),j=0,_=(z,V)=>{return(z.rank==="dynamic"&&V.rank==="dynamic"?Q[V.name]-Q[z.name]:0)||(typeof z.rank=="number"?z.rank:1e9)-(typeof V.rank=="number"?V.rank:1e9)||(z.name<V.name?-1:1)};for(let z of X.sort(_))j-=1e5,W[z.name]=j;for(let z of J){let{section:V}=z.completion;if(V)z.score+=W[typeof V=="string"?V:V.name]}}let U=[],q=null,G=K.compareCompletions;for(let W of J.sort((j,_)=>_.score-j.score||G(j.completion,_.completion))){let j=W.completion;if(!q||q.label!=j.label||q.detail!=j.detail||q.type!=null&&j.type!=null&&q.type!=j.type||q.apply!=j.apply||q.boost!=j.boost)U.push(W);else if(fX(W.completion)>fX(q))U[U.length-1]=W;q=W.completion}return U}class a7{constructor(Z,$,J,X,Q,Y){this.options=Z,this.attrs=$,this.tooltip=J,this.timestamp=X,this.selected=Q,this.disabled=Y}setSelected(Z,$){return Z==this.selected||Z>=this.options.length?this:new a7(this.options,gX($,Z),this.tooltip,this.timestamp,Z,this.disabled)}static build(Z,$,J,X,Q,Y){if(X&&!Y&&Z.some((q)=>q.isPending))return X.setDisabled();let K=EW(Z,$);if(!K.length)return X&&Z.some((q)=>q.isPending)?X.setDisabled():null;let U=$.facet(E0).selectOnOpen?0:-1;if(X&&X.selected!=U&&X.selected!=-1){let q=X.options[X.selected].completion;for(let G=0;G<K.length;G++)if(K[G].completion==q){U=G;break}}return new a7(K,gX(J,U),{pos:Z.reduce((q,G)=>G.hasResult()?Math.min(q,G.from):q,1e8),create:SW,above:Q.aboveCursor},X?X.timestamp:Date.now(),U,!1)}map(Z){return new a7(this.options,this.attrs,{...this.tooltip,pos:Z.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new a7(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class A8{constructor(Z,$,J){this.active=Z,this.id=$,this.open=J}static start(){return new A8(yW,"cm-ac-"+Math.floor(Math.random()*2000000).toString(36),null)}update(Z){let{state:$}=Z,J=$.facet(E0),Q=(J.override||$.languageDataAt("autocomplete",I7($)).map(DW)).map((U)=>{return(this.active.find((G)=>G.source==U)||new G1(U,this.active.some((G)=>G.state!=0)?1:0)).update(Z,J)});if(Q.length==this.active.length&&Q.every((U,q)=>U==this.active[q]))Q=this.active;let Y=this.open,K=Z.effects.some((U)=>U.is(r5));if(Y&&Z.docChanged)Y=Y.map(Z.changes);if(Z.selection||Q.some((U)=>U.hasResult()&&Z.changes.touchesRange(U.from,U.to))||!PW(Q,this.active)||K)Y=a7.build(Q,$,this.id,Y,J,K);else if(Y&&Y.disabled&&!Q.some((U)=>U.isPending))Y=null;if(!Y&&Q.every((U)=>!U.isPending)&&Q.some((U)=>U.hasResult()))Q=Q.map((U)=>U.hasResult()?new G1(U.source,0):U);for(let U of Z.effects)if(U.is(rX))Y=Y&&Y.setSelected(U.value,this.id);return Q==this.active&&Y==this.open?this:new A8(Q,this.id,Y)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?CW:TW}}function PW(Z,$){if(Z==$)return!0;for(let J=0,X=0;;){while(J<Z.length&&!Z[J].hasResult())J++;while(X<$.length&&!$[X].hasResult())X++;let Q=J==Z.length,Y=X==$.length;if(Q||Y)return Q==Y;if(Z[J++].result!=$[X++].result)return!1}}var CW={"aria-autocomplete":"list"},TW={};function gX(Z,$){let J={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":Z};if($>-1)J["aria-activedescendant"]=Z+"-"+$;return J}var yW=[];function aX(Z,$){if(Z.isUserEvent("input.complete")){let X=Z.annotation(cX);if(X&&$.activateOnCompletion(X))return 12}let J=Z.isUserEvent("input.type");return J&&$.activateOnTyping?5:J?1:Z.isUserEvent("delete.backward")?2:Z.selection?8:Z.docChanged?16:0}class G1{constructor(Z,$,J=!1){this.source=Z,this.state=$,this.explicit=J}hasResult(){return!1}get isPending(){return this.state==1}update(Z,$){let J=aX(Z,$),X=this;if(J&8||J&16&&this.touches(Z))X=new G1(X.source,0);if(J&4&&X.state==0)X=new G1(this.source,1);X=X.updateFor(Z,J);for(let Q of Z.effects)if(Q.is(D8))X=new G1(X.source,1,Q.value);else if(Q.is(p4))X=new G1(X.source,0);else if(Q.is(r5)){for(let Y of Q.value)if(Y.source==X.source)X=Y}return X}updateFor(Z,$){return this.map(Z.changes)}map(Z){return this}touches(Z){return Z.changes.touchesRange(I7(Z.state))}}class r7 extends G1{constructor(Z,$,J,X,Q,Y){super(Z,3,$);this.limit=J,this.result=X,this.from=Q,this.to=Y}hasResult(){return!0}updateFor(Z,$){var J;if(!($&3))return this.map(Z.changes);let X=this.result;if(X.map&&!Z.changes.empty)X=X.map(X,Z.changes);let Q=Z.changes.mapPos(this.from),Y=Z.changes.mapPos(this.to,1),K=I7(Z.state);if(K>Y||!X||$&2&&(I7(Z.startState)==this.from||K<this.limit))return new G1(this.source,$&4?1:0);let U=Z.changes.mapPos(this.limit);if(kW(X.validFor,Z.state,Q,Y))return new r7(this.source,this.explicit,U,X,Q,Y);if(X.update&&(X=X.update(X,Q,Y,new a5(Z.state,K,!1))))return new r7(this.source,this.explicit,U,X,X.from,(J=X.to)!==null&&J!==void 0?J:I7(Z.state));return new G1(this.source,1,this.explicit)}map(Z){if(Z.empty)return this;if(!(this.result.map?this.result.map(this.result,Z):this.result))return new G1(this.source,0);return new r7(this.source,this.explicit,Z.mapPos(this.limit),this.result,Z.mapPos(this.from),Z.mapPos(this.to,1))}touches(Z){return Z.changes.touchesRange(this.from,this.to)}}function kW(Z,$,J,X){if(!Z)return!1;let Q=$.sliceDoc(J,X);return typeof Z=="function"?Z(Q,J,X,$):dX(Z,!0).test(Q)}var r5=p.define({map(Z,$){return Z.map((J)=>J.map($))}}),rX=p.define(),d0=_0.define({create(){return A8.start()},update(Z,$){return Z.update($)},provide:(Z)=>[y4.from(Z,($)=>$.tooltip),C.contentAttributes.from(Z,($)=>$.attrs)]});function o5(Z,$){let J=$.completion.apply||$.completion.label,X=Z.state.field(d0).active.find((Q)=>Q.source==$.source);if(!(X instanceof r7))return!1;if(typeof J=="string")Z.dispatch({...FW(Z.state,J,X.from,X.to),annotations:cX.of($.completion)});else J(Z,$.completion,X.from,X.to);return!0}var SW=LW(d0,o5);function F8(Z,$="option"){return(J)=>{let X=J.state.field(d0,!1);if(!X||!X.open||X.open.disabled||Date.now()-X.open.timestamp<J.state.facet(E0).interactionDelay)return!1;let Q=1,Y;if($=="page"&&(Y=X5(J,X.open.tooltip)))Q=Math.max(2,Math.floor(Y.dom.offsetHeight/Y.dom.querySelector("li").offsetHeight)-1);let{length:K}=X.open.options,U=X.open.selected>-1?X.open.selected+Q*(Z?1:-1):Z?0:K-1;if(U<0)U=$=="page"?0:K-1;else if(U>=K)U=$=="page"?K-1:0;return J.dispatch({effects:rX.of(U)}),!0}}var bW=(Z)=>{let $=Z.state.field(d0,!1);if(Z.state.readOnly||!$||!$.open||$.open.selected<0||$.open.disabled||Date.now()-$.open.timestamp<Z.state.facet(E0).interactionDelay)return!1;return o5(Z,$.open.options[$.open.selected])},s5=(Z)=>{if(!Z.state.field(d0,!1))return!1;return Z.dispatch({effects:D8.of(!0)}),!0},xW=(Z)=>{let $=Z.state.field(d0,!1);if(!$||!$.active.some((J)=>J.state!=0))return!1;return Z.dispatch({effects:p4.of(null)}),!0};class oX{constructor(Z,$){this.active=Z,this.context=$,this.time=Date.now(),this.updates=[],this.done=void 0}}var wW=50,hW=1000,vW=j0.fromClass(class{constructor(Z){this.view=Z,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let $ of Z.state.field(d0).active)if($.isPending)this.startQuery($)}update(Z){let $=Z.state.field(d0),J=Z.state.facet(E0);if(!Z.selectionSet&&!Z.docChanged&&Z.startState.field(d0)==$)return;let X=Z.transactions.some((Y)=>{let K=aX(Y,J);return K&8||(Y.selection||Y.docChanged)&&!(K&3)});for(let Y=0;Y<this.running.length;Y++){let K=this.running[Y];if(X||K.context.abortOnDocChange&&Z.docChanged||K.updates.length+Z.transactions.length>wW&&Date.now()-K.time>hW){for(let U of K.context.abortListeners)try{U()}catch(q){S0(this.view.state,q)}K.context.abortListeners=null,this.running.splice(Y--,1)}else K.updates.push(...Z.transactions)}if(this.debounceUpdate>-1)clearTimeout(this.debounceUpdate);if(Z.transactions.some((Y)=>Y.effects.some((K)=>K.is(D8))))this.pendingStart=!0;let Q=this.pendingStart?50:J.activateOnTypingDelay;if(this.debounceUpdate=$.active.some((Y)=>Y.isPending&&!this.running.some((K)=>K.active.source==Y.source))?setTimeout(()=>this.startUpdate(),Q):-1,this.composing!=0){for(let Y of Z.transactions)if(Y.isUserEvent("input.type"))this.composing=2;else if(this.composing==2&&Y.selection)this.composing=3}}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:Z}=this.view,$=Z.field(d0);for(let J of $.active)if(J.isPending&&!this.running.some((X)=>X.active.source==J.source))this.startQuery(J);if(this.running.length&&$.open&&$.open.disabled)this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(E0).updateSyncTime)}startQuery(Z){let{state:$}=this.view,J=I7($),X=new a5($,J,Z.explicit,this.view),Q=new oX(Z,X);this.running.push(Q),Promise.resolve(Z.source(X)).then((Y)=>{if(!Q.context.aborted)Q.done=Y||null,this.scheduleAccept()},(Y)=>{this.view.dispatch({effects:p4.of(null)}),S0(this.view.state,Y)})}scheduleAccept(){if(this.running.every((Z)=>Z.done!==void 0))this.accept();else if(this.debounceAccept<0)this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(E0).updateSyncTime)}accept(){var Z;if(this.debounceAccept>-1)clearTimeout(this.debounceAccept);this.debounceAccept=-1;let $=[],J=this.view.state.facet(E0),X=this.view.state.field(d0);for(let Q=0;Q<this.running.length;Q++){let Y=this.running[Q];if(Y.done===void 0)continue;if(this.running.splice(Q--,1),Y.done){let U=I7(Y.updates.length?Y.updates[0].startState:this.view.state),q=Math.min(U,Y.done.from+(Y.active.explicit?0:1)),G=new r7(Y.active.source,Y.active.explicit,q,Y.done,Y.done.from,(Z=Y.done.to)!==null&&Z!==void 0?Z:U);for(let W of Y.updates)G=G.update(W,J);if(G.hasResult()){$.push(G);continue}}let K=X.active.find((U)=>U.source==Y.active.source);if(K&&K.isPending)if(Y.done==null){let U=new G1(Y.active.source,0);for(let q of Y.updates)U=U.update(q,J);if(!U.isPending)$.push(U)}else this.startQuery(K)}if($.length||X.open&&X.open.disabled)this.view.dispatch({effects:r5.of($)})}},{eventHandlers:{blur(Z){let $=this.view.state.field(d0,!1);if($&&$.tooltip&&this.view.state.facet(E0).closeOnBlur){let J=$.open&&X5(this.view,$.open.tooltip);if(!J||!J.dom.contains(Z.relatedTarget))setTimeout(()=>this.view.dispatch({effects:p4.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){if(this.composing==3)setTimeout(()=>this.view.dispatch({effects:D8.of(!1)}),20);this.composing=0}}}),uW=typeof navigator=="object"&&/Win/.test(navigator.platform),mW=O1.highest(C.domEventHandlers({keydown(Z,$){let J=$.state.field(d0,!1);if(!J||!J.open||J.open.disabled||J.open.selected<0||Z.key.length>1||Z.ctrlKey&&!(uW&&Z.altKey)||Z.metaKey)return!1;let X=J.open.options[J.open.selected],Q=J.active.find((K)=>K.source==X.source),Y=X.completion.commitCharacters||Q.result.commitCharacters;if(Y&&Y.indexOf(Z.key)>-1)o5($,X);return!1}})),fW=C.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:0.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:0.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'\uD835\uDC65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\uD835\uDC36'"}},".cm-completionIcon-type":{"&:after":{content:"'\uD835\uDC61'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\uD83D\uDD11︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});var l4={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},H7=p.define({map(Z,$){let J=$.mapPos(Z,-1,T0.TrackAfter);return J==null?void 0:J}}),t5=new class extends z1{};t5.startSide=1;t5.endSide=-1;var tX=_0.define({create(){return i.empty},update(Z,$){if(Z=Z.map($.changes),$.selection){let J=$.state.doc.lineAt($.selection.main.head);Z=Z.update({filter:(X)=>X>=J.from&&X<=J.to})}for(let J of $.effects)if(J.is(H7))Z=Z.update({add:[t5.range(J.value,J.value+1)]});return Z}});function eX(){return[pW,tX]}var n5="()[]{}<>«»»«［］｛｝";function ZQ(Z){for(let $=0;$<n5.length;$+=2)if(n5.charCodeAt($)==Z)return n5.charAt($+1);return U4(Z<128?Z:Z+1)}function $Q(Z,$){return Z.languageDataAt("closeBrackets",$)[0]||l4}var gW=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),pW=C.inputHandler.of((Z,$,J,X)=>{if((gW?Z.composing:Z.compositionStarted)||Z.state.readOnly)return!1;let Q=Z.state.selection.main;if(X.length>2||X.length==2&&n0(y0(X,0))==1||$!=Q.from||J!=Q.to)return!1;let Y=dW(Z.state,X);if(!Y)return!1;return Z.dispatch(Y),!0}),lW=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let X=$Q(Z,Z.selection.main.head).brackets||l4.brackets,Q=null,Y=Z.changeByRange((K)=>{if(K.empty){let U=cW(Z.doc,K.head);for(let q of X)if(q==U&&M8(Z.doc,K.head)==ZQ(y0(q,0)))return{changes:{from:K.head-q.length,to:K.head+q.length},range:A.cursor(K.head-q.length)}}return{range:Q=K}});if(!Q)$(Z.update(Y,{scrollIntoView:!0,userEvent:"delete.backward"}));return!Q},JQ=[{key:"Backspace",run:lW}];function dW(Z,$){let J=$Q(Z,Z.selection.main.head),X=J.brackets||l4.brackets;for(let Q of X){let Y=ZQ(y0(Q,0));if($==Q)return Y==Q?iW(Z,Q,X.indexOf(Q+Q+Q)>-1,J):sW(Z,Q,Y,J.before||l4.before);if($==Y&&XQ(Z,Z.selection.main.from))return nW(Z,Q,Y)}return null}function XQ(Z,$){let J=!1;return Z.field(tX).between(0,Z.doc.length,(X)=>{if(X==$)J=!0}),J}function M8(Z,$){let J=Z.sliceString($,$+2);return J.slice(0,n0(y0(J,0)))}function cW(Z,$){let J=Z.sliceString($-2,$);return n0(y0(J,0))==J.length?J:J.slice(1)}function sW(Z,$,J,X){let Q=null,Y=Z.changeByRange((K)=>{if(!K.empty)return{changes:[{insert:$,from:K.from},{insert:J,from:K.to}],effects:H7.of(K.to+$.length),range:A.range(K.anchor+$.length,K.head+$.length)};let U=M8(Z.doc,K.head);if(!U||/\s/.test(U)||X.indexOf(U)>-1)return{changes:{insert:$+J,from:K.head},effects:H7.of(K.head+$.length),range:A.cursor(K.head+$.length)};return{range:Q=K}});return Q?null:Z.update(Y,{scrollIntoView:!0,userEvent:"input.type"})}function nW(Z,$,J){let X=null,Q=Z.changeByRange((Y)=>{if(Y.empty&&M8(Z.doc,Y.head)==J)return{changes:{from:Y.head,to:Y.head+J.length,insert:J},range:A.cursor(Y.head+J.length)};return X={range:Y}});return X?null:Z.update(Q,{scrollIntoView:!0,userEvent:"input.type"})}function iW(Z,$,J,X){let Q=X.stringPrefixes||l4.stringPrefixes,Y=null,K=Z.changeByRange((U)=>{if(!U.empty)return{changes:[{insert:$,from:U.from},{insert:$,from:U.to}],effects:H7.of(U.to+$.length),range:A.range(U.anchor+$.length,U.head+$.length)};let q=U.head,G=M8(Z.doc,q),W;if(G==$){if(pX(Z,q))return{changes:{insert:$+$,from:q},effects:H7.of(q+$.length),range:A.cursor(q+$.length)};else if(XQ(Z,q)){let _=J&&Z.sliceDoc(q,q+$.length*3)==$+$+$?$+$+$:$;return{changes:{from:q,to:q+_.length,insert:_},range:A.cursor(q+_.length)}}}else if(J&&Z.sliceDoc(q-2*$.length,q)==$+$&&(W=lX(Z,q-2*$.length,Q))>-1&&pX(Z,W))return{changes:{insert:$+$+$+$,from:q},effects:H7.of(q+$.length),range:A.cursor(q+$.length)};else if(Z.charCategorizer(q)(G)!=Y0.Word){if(lX(Z,q,Q)>-1&&!aW(Z,q,$,Q))return{changes:{insert:$+$,from:q},effects:H7.of(q+$.length),range:A.cursor(q+$.length)}}return{range:Y=U}});return Y?null:Z.update(K,{scrollIntoView:!0,userEvent:"input.type"})}function pX(Z,$){let J=B0(Z).resolveInner($+1);return J.parent&&J.from==$}function aW(Z,$,J,X){let Q=B0(Z).resolveInner($,-1),Y=X.reduce((K,U)=>Math.max(K,U.length),0);for(let K=0;K<5;K++){let U=Z.sliceDoc(Q.from,Math.min(Q.to,Q.from+J.length+Y)),q=U.indexOf(J);if(!q||q>-1&&X.indexOf(U.slice(0,q))>-1){let W=Q.firstChild;while(W&&W.from==Q.from&&W.to-W.from>J.length+q){if(Z.sliceDoc(W.to-J.length,W.to)==J)return!1;W=W.firstChild}return!0}let G=Q.to==$&&Q.parent;if(!G)break;Q=G}return!1}function lX(Z,$,J){let X=Z.charCategorizer($);if(X(Z.sliceDoc($-1,$))!=Y0.Word)return $;for(let Q of J){let Y=$-Q.length;if(Z.sliceDoc(Y,$)==Q&&X(Z.sliceDoc(Y-1,Y))!=Y0.Word)return Y}return-1}function QQ(Z={}){return[mW,d0,E0.of(Z),vW,rW,fW]}var e5=[{key:"Ctrl-Space",run:s5},{mac:"Alt-`",run:s5},{mac:"Alt-i",run:s5},{key:"Escape",run:xW},{key:"ArrowDown",run:F8(!0)},{key:"ArrowUp",run:F8(!1)},{key:"PageDown",run:F8(!0,"page")},{key:"PageUp",run:F8(!1,"page")},{key:"Enter",run:bW}],rW=O1.highest(C4.computeN([E0],(Z)=>Z.facet(E0).defaultKeymap?[e5]:[]));class Z6{constructor(Z,$,J){this.from=Z,this.to=$,this.diagnostic=J}}class R7{constructor(Z,$,J){this.diagnostics=Z,this.panel=$,this.selected=J}static init(Z,$,J){let X=J.facet(d4).markerFilter;if(X)Z=X(Z,J);let Q=Z.slice().sort((_,z)=>_.from-z.from||_.to-z.to),Y=new s0,K=[],U=0,q=J.doc.iter(),G=0,W=J.doc.length;for(let _=0;;){let z=_==Q.length?null:Q[_];if(!z&&!K.length)break;let V,O;if(K.length)V=U,O=K.reduce((D,M)=>Math.min(D,M.to),z&&z.from>V?z.from:1e8);else{if(V=z.from,V>W)break;O=z.to,K.push(z),_++}while(_<Q.length){let D=Q[_];if(D.from==V&&(D.to>D.from||D.to==V))K.push(D),_++,O=Math.min(D.to,O);else{O=Math.min(D.from,O);break}}O=Math.min(O,W);let H=!1;if(K.some((D)=>D.from==V&&(D.to==O||O==W))){if(H=V==O,!H&&O-V<10){let D=V-(G+q.value.length);if(D>0)q.next(D),G=V;for(let M=V;;){if(M>=O){H=!0;break}if(!q.lineBreak&&G+q.value.length>M)break;M=G+q.value.length,G+=q.value.length,q.next()}}}let R=Uj(K);if(H)Y.add(V,V,m.widget({widget:new _Q(R),diagnostics:K.slice()}));else{let D=K.reduce((M,L)=>L.markClass?M+" "+L.markClass:M,"");Y.add(V,O,m.mark({class:"cm-lintRange cm-lintRange-"+R+D,diagnostics:K.slice(),inclusiveEnd:K.some((M)=>M.to>O)}))}if(U=O,U==W)break;for(let D=0;D<K.length;D++)if(K[D].to<=U)K.splice(D--,1)}let j=Y.finish();return new R7(j,$,o7(j))}}function o7(Z,$=null,J=0){let X=null;return Z.between(J,1e9,(Q,Y,{spec:K})=>{if($&&K.diagnostics.indexOf($)<0)return;if(!X)X=new Z6(Q,Y,$||K.diagnostics[0]);else if(K.diagnostics.indexOf(X.diagnostic)<0)return!1;else X=new Z6(X.from,Y,X.diagnostic)}),X}function oW(Z,$){let J=$.pos,X=$.end||J,Q=Z.state.facet(d4).hideOn(Z,J,X);if(Q!=null)return Q;let Y=Z.startState.doc.lineAt($.pos);return!!(Z.effects.some((K)=>K.is(UQ))||Z.changes.touchesRange(Y.from,Math.max(Y.to,X)))}function tW(Z,$){return Z.field(t0,!1)?$:$.concat(p.appendConfig.of(qj))}var UQ=p.define(),J6=p.define(),qQ=p.define(),t0=_0.define({create(){return new R7(m.none,null,null)},update(Z,$){if($.docChanged&&Z.diagnostics.size){let J=Z.diagnostics.map($.changes),X=null,Q=Z.panel;if(Z.selected){let Y=$.changes.mapPos(Z.selected.from,1);X=o7(J,Z.selected.diagnostic,Y)||o7(J,null,Y)}if(!J.size&&Q&&$.state.facet(d4).autoPanel)Q=null;Z=new R7(J,Q,X)}for(let J of $.effects)if(J.is(UQ)){let X=!$.state.facet(d4).autoPanel?Z.panel:J.value.length?c4.open:null;Z=R7.init(J.value,X,$.state)}else if(J.is(J6))Z=new R7(Z.diagnostics,J.value?c4.open:null,Z.selected);else if(J.is(qQ))Z=new R7(Z.diagnostics,Z.panel,J.value);return Z},provide:(Z)=>[_7.from(Z,($)=>$.panel),C.decorations.from(Z,($)=>$.diagnostics)]});var eW=m.mark({class:"cm-lintRange cm-lintRange-active"});function Zj(Z,$,J){let{diagnostics:X}=Z.state.field(t0),Q,Y=-1,K=-1;X.between($-(J<0?1:0),$+(J>0?1:0),(q,G,{spec:W})=>{if($>=q&&$<=G&&(q==G||($>q||J>0)&&($<G||J<0)))return Q=W.diagnostics,Y=q,K=G,!1});let U=Z.state.facet(d4).tooltipFilter;if(Q&&U)Q=U(Q,Z.state);if(!Q)return null;return{pos:Y,end:K,above:Z.state.doc.lineAt(Y).to<K,create(){return{dom:$j(Z,Q)}}}}function $j(Z,$){return $0("ul",{class:"cm-tooltip-lint"},$.map((J)=>jQ(Z,J,!1)))}var Jj=(Z)=>{let $=Z.state.field(t0,!1);if(!$||!$.panel)Z.dispatch({effects:tW(Z.state,[J6.of(!0)])});let J=k4(Z,c4.open);if(J)J.dom.querySelector(".cm-panel-lint ul").focus();return!0},YQ=(Z)=>{let $=Z.state.field(t0,!1);if(!$||!$.panel)return!1;return Z.dispatch({effects:J6.of(!1)}),!0},Xj=(Z)=>{let $=Z.state.field(t0,!1);if(!$)return!1;let J=Z.state.selection.main,X=$.diagnostics.iter(J.to+1);if(!X.value){if(X=$.diagnostics.iter(0),!X.value||X.from==J.from&&X.to==J.to)return!1}return Z.dispatch({selection:{anchor:X.from,head:X.to},scrollIntoView:!0}),!0};var GQ=[{key:"Mod-Shift-m",run:Jj,preventDefault:!0},{key:"F8",run:Xj}];var d4=S.define({combine(Z){return{sources:Z.map(($)=>$.source).filter(($)=>$!=null),...w0(Z.map(($)=>$.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:KQ,tooltipFilter:KQ,needsRefresh:($,J)=>!$?J:!J?$:(X)=>$(X)||J(X),hideOn:($,J)=>!$?J:!J?$:(X,Q,Y)=>$(X,Q,Y)||J(X,Q,Y),autoPanel:($,J)=>$||J})}}});function KQ(Z,$){return!Z?$:!$?Z:(J,X)=>$(Z(J,X),X)}function WQ(Z){let $=[];if(Z)Z:for(let{name:J}of Z){for(let X=0;X<J.length;X++){let Q=J[X];if(/[a-zA-Z]/.test(Q)&&!$.some((Y)=>Y.toLowerCase()==Q.toLowerCase())){$.push(Q);continue Z}}$.push("")}return $}function jQ(Z,$,J){var X;let Q=J?WQ($.actions):[];return $0("li",{class:"cm-diagnostic cm-diagnostic-"+$.severity},$0("span",{class:"cm-diagnosticText"},$.renderMessage?$.renderMessage(Z):$.message),(X=$.actions)===null||X===void 0?void 0:X.map((Y,K)=>{let U=!1,q=(z)=>{if(z.preventDefault(),U)return;U=!0;let V=o7(Z.state.field(t0).diagnostics,$);if(V)Y.apply(Z,V.from,V.to)},{name:G}=Y,W=Q[K]?G.indexOf(Q[K]):-1,j=W<0?G:[G.slice(0,W),$0("u",G.slice(W,W+1)),G.slice(W+1)],_=Y.markClass?" "+Y.markClass:"";return $0("button",{type:"button",class:"cm-diagnosticAction"+_,onclick:q,onmousedown:q,"aria-label":` Action: ${G}${W<0?"":` (access key "${Q[K]})"`}.`},j)}),$.source&&$0("div",{class:"cm-diagnosticSource"},$.source))}class _Q extends r0{constructor(Z){super();this.sev=Z}eq(Z){return Z.sev==this.sev}toDOM(){return $0("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class $6{constructor(Z,$){this.diagnostic=$,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=jQ(Z,$,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class c4{constructor(Z){this.view=Z,this.items=[];let $=(X)=>{if(X.ctrlKey||X.altKey||X.metaKey)return;if(X.keyCode==27)YQ(this.view),this.view.focus();else if(X.keyCode==38||X.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(X.keyCode==40||X.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(X.keyCode==36)this.moveSelection(0);else if(X.keyCode==35)this.moveSelection(this.items.length-1);else if(X.keyCode==13)this.view.focus();else if(X.keyCode>=65&&X.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:Q}=this.items[this.selectedIndex],Y=WQ(Q.actions);for(let K=0;K<Y.length;K++)if(Y[K].toUpperCase().charCodeAt(0)==X.keyCode){let U=o7(this.view.state.field(t0).diagnostics,Q);if(U)Q.actions[K].apply(Z,U.from,U.to)}}else return;X.preventDefault()},J=(X)=>{for(let Q=0;Q<this.items.length;Q++)if(this.items[Q].dom.contains(X.target))this.moveSelection(Q)};this.list=$0("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:$,onclick:J}),this.dom=$0("div",{class:"cm-panel-lint"},this.list,$0("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>YQ(this.view)},"×")),this.update()}get selectedIndex(){let Z=this.view.state.field(t0).selected;if(!Z)return-1;for(let $=0;$<this.items.length;$++)if(this.items[$].diagnostic==Z.diagnostic)return $;return-1}update(){let{diagnostics:Z,selected:$}=this.view.state.field(t0),J=0,X=!1,Q=null,Y=new Set;Z.between(0,this.view.state.doc.length,(K,U,{spec:q})=>{for(let G of q.diagnostics){if(Y.has(G))continue;Y.add(G);let W=-1,j;for(let _=J;_<this.items.length;_++)if(this.items[_].diagnostic==G){W=_;break}if(W<0)j=new $6(this.view,G),this.items.splice(J,0,j),X=!0;else if(j=this.items[W],W>J)this.items.splice(J,W-J),X=!0;if($&&j.diagnostic==$.diagnostic){if(!j.dom.hasAttribute("aria-selected"))j.dom.setAttribute("aria-selected","true"),Q=j}else if(j.dom.hasAttribute("aria-selected"))j.dom.removeAttribute("aria-selected");J++}});while(J<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0))X=!0,this.items.pop();if(this.items.length==0)this.items.push(new $6(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),X=!0;if(Q)this.list.setAttribute("aria-activedescendant",Q.id),this.view.requestMeasure({key:this,read:()=>({sel:Q.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:K,panel:U})=>{let q=U.height/this.list.offsetHeight;if(K.top<U.top)this.list.scrollTop-=(U.top-K.top)/q;else if(K.bottom>U.bottom)this.list.scrollTop+=(K.bottom-U.bottom)/q}});else if(this.selectedIndex<0)this.list.removeAttribute("aria-activedescendant");if(X)this.sync()}sync(){let Z=this.list.firstChild;function $(){let J=Z;Z=J.nextSibling,J.remove()}for(let J of this.items)if(J.dom.parentNode==this.list){while(Z!=J.dom)$();Z=J.dom.nextSibling}else this.list.insertBefore(J.dom,Z);while(Z)$()}moveSelection(Z){if(this.selectedIndex<0)return;let $=this.view.state.field(t0),J=o7($.diagnostics,this.items[Z].diagnostic);if(!J)return;this.view.dispatch({selection:{anchor:J.from,head:J.to},scrollIntoView:!0,effects:qQ.of(J)})}static open(Z){return new c4(Z)}}function Qj(Z,$='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${$}>${encodeURIComponent(Z)}</svg>')`}function L8(Z){return Qj(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${Z}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}var Yj=C.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:0.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:L8("#d11")},".cm-lintRange-warning":{backgroundImage:L8("orange")},".cm-lintRange-info":{backgroundImage:L8("#999")},".cm-lintRange-hint":{backgroundImage:L8("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function Kj(Z){return Z=="error"?4:Z=="warning"?3:Z=="info"?2:1}function Uj(Z){let $="hint",J=1;for(let X of Z){let Q=Kj(X.severity);if(Q>J)J=Q,$=X.severity}return $}var qj=[t0,C.decorations.compute([t0],(Z)=>{let{selected:$,panel:J}=Z.field(t0);return!$||!J||$.from==$.to?m.none:m.set([eW.range($.from,$.to)])}),SJ(Zj,{hideOn:oW}),Yj];var zQ=(()=>[mJ(),fJ(),BJ(),s2(),A2(),FJ(),MJ(),n.allowMultipleSelections.of(!0),z2(),Y8(B2,{fallback:!0}),T2(),eX(),QQ(),TJ(),yJ(),CJ(),CX(),C4.of([...JQ,...AX,...wX,...r2,...I2,...e5,...GQ])])();function X6(Z){var $={as:"keyword",do:"keyword",else:"keyword",end:"keyword",exception:"keyword",fun:"keyword",functor:"keyword",if:"keyword",in:"keyword",include:"keyword",let:"keyword",of:"keyword",open:"keyword",rec:"keyword",struct:"keyword",then:"keyword",type:"keyword",val:"keyword",while:"keyword",with:"keyword"},J=Z.extraWords||{};for(var X in J)if(J.hasOwnProperty(X))$[X]=Z.extraWords[X];var Q=[];for(var Y in $)Q.push(Y);function K(W,j){var _=W.next();if(_==='"')return j.tokenize=U,j.tokenize(W,j);if(_==="{"){if(W.eat("|"))return j.longString=!0,j.tokenize=G,j.tokenize(W,j)}if(_==="("){if(W.match(/^\*(?!\))/))return j.commentLevel++,j.tokenize=q,j.tokenize(W,j)}if(_==="~"||_==="?")return W.eatWhile(/\w/),"variableName.special";if(_==="`")return W.eatWhile(/\w/),"quote";if(_==="/"&&Z.slashComments&&W.eat("/"))return W.skipToEnd(),"comment";if(/\d/.test(_)){if(_==="0"&&W.eat(/[bB]/))W.eatWhile(/[01]/);if(_==="0"&&W.eat(/[xX]/))W.eatWhile(/[0-9a-fA-F]/);if(_==="0"&&W.eat(/[oO]/))W.eatWhile(/[0-7]/);else{if(W.eatWhile(/[\d_]/),W.eat("."))W.eatWhile(/[\d]/);if(W.eat(/[eE]/))W.eatWhile(/[\d\-+]/)}return"number"}if(/[+\-*&%=<>!?|@\.~:]/.test(_))return"operator";if(/[\w\xa1-\uffff]/.test(_)){W.eatWhile(/[\w\xa1-\uffff]/);var z=W.current();return $.hasOwnProperty(z)?$[z]:"variable"}return null}function U(W,j){var _,z=!1,V=!1;while((_=W.next())!=null){if(_==='"'&&!V){z=!0;break}V=!V&&_==="\\"}if(z&&!V)j.tokenize=K;return"string"}function q(W,j){var _,z;while(j.commentLevel>0&&(z=W.next())!=null){if(_==="("&&z==="*")j.commentLevel++;if(_==="*"&&z===")")j.commentLevel--;_=z}if(j.commentLevel<=0)j.tokenize=K;return"comment"}function G(W,j){var _,z;while(j.longString&&(z=W.next())!=null){if(_==="|"&&z==="}")j.longString=!1;_=z}if(!j.longString)j.tokenize=K;return"string"}return{startState:function(){return{tokenize:K,commentLevel:0,longString:!1}},token:function(W,j){if(W.eatSpace())return null;return j.tokenize(W,j)},languageData:{autocomplete:Q,commentTokens:{line:Z.slashComments?"//":void 0,block:{open:"(*",close:"*)"}}}}}var B8=X6({name:"ocaml",extraWords:{and:"keyword",assert:"keyword",begin:"keyword",class:"keyword",constraint:"keyword",done:"keyword",downto:"keyword",external:"keyword",function:"keyword",initializer:"keyword",lazy:"keyword",match:"keyword",method:"keyword",module:"keyword",mutable:"keyword",new:"keyword",nonrec:"keyword",object:"keyword",private:"keyword",sig:"keyword",to:"keyword",try:"keyword",value:"keyword",virtual:"keyword",when:"keyword",raise:"builtin",failwith:"builtin",true:"builtin",false:"builtin",asr:"builtin",land:"builtin",lor:"builtin",lsl:"builtin",lsr:"builtin",lxor:"builtin",mod:"builtin",or:"builtin",raise_notrace:"builtin",trace:"builtin",exit:"builtin",print_string:"builtin",print_endline:"builtin",int:"type",float:"type",bool:"type",char:"type",string:"type",unit:"type",List:"builtin"}}),KO=X6({name:"fsharp",extraWords:{abstract:"keyword",assert:"keyword",base:"keyword",begin:"keyword",class:"keyword",default:"keyword",delegate:"keyword","do!":"keyword",done:"keyword",downcast:"keyword",downto:"keyword",elif:"keyword",extern:"keyword",finally:"keyword",for:"keyword",function:"keyword",global:"keyword",inherit:"keyword",inline:"keyword",interface:"keyword",internal:"keyword",lazy:"keyword","let!":"keyword",match:"keyword",member:"keyword",module:"keyword",mutable:"keyword",namespace:"keyword",new:"keyword",null:"keyword",override:"keyword",private:"keyword",public:"keyword","return!":"keyword",return:"keyword",select:"keyword",static:"keyword",to:"keyword",try:"keyword",upcast:"keyword","use!":"keyword",use:"keyword",void:"keyword",when:"keyword","yield!":"keyword",yield:"keyword",atomic:"keyword",break:"keyword",checked:"keyword",component:"keyword",const:"keyword",constraint:"keyword",constructor:"keyword",continue:"keyword",eager:"keyword",event:"keyword",external:"keyword",fixed:"keyword",method:"keyword",mixin:"keyword",object:"keyword",parallel:"keyword",process:"keyword",protected:"keyword",pure:"keyword",sealed:"keyword",tailcall:"keyword",trait:"keyword",virtual:"keyword",volatile:"keyword",List:"builtin",Seq:"builtin",Map:"builtin",Set:"builtin",Option:"builtin",int:"builtin",string:"builtin",not:"builtin",true:"builtin",false:"builtin",raise:"builtin",failwith:"builtin"},slashComments:!0}),UO=X6({name:"sml",extraWords:{abstype:"keyword",and:"keyword",andalso:"keyword",case:"keyword",datatype:"keyword",fn:"keyword",handle:"keyword",infix:"keyword",infixr:"keyword",local:"keyword",nonfix:"keyword",op:"keyword",orelse:"keyword",raise:"keyword",withtype:"keyword",eqtype:"keyword",sharing:"keyword",sig:"keyword",signature:"keyword",structure:"keyword",where:"keyword",true:"keyword",false:"keyword",int:"builtin",real:"builtin",string:"builtin",char:"builtin",bool:"builtin"},slashComments:!0});var Gj="#e5c07b",OQ="#e06c75",Wj="#56b6c2",jj="#ffffff",E8="#abb2bf",Y6="#7d8799",_j="#61afef",zj="#98c379",VQ="#d19a66",Oj="#c678dd",Vj="#21252b",NQ="#2c313a",HQ="#282c34",Q6="#353a42",Nj="#3E4451",IQ="#528bff";var Hj=C.theme({"&":{color:E8,backgroundColor:HQ},".cm-content":{caretColor:IQ},".cm-cursor, .cm-dropCursor":{borderLeftColor:IQ},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Nj},".cm-panels":{backgroundColor:Vj,color:E8},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:HQ,color:Y6,border:"none"},".cm-activeLineGutter":{backgroundColor:NQ},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Q6},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Q6,borderBottomColor:Q6},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:NQ,color:E8}}},{dark:!0}),Ij=l7.define([{tag:F.keyword,color:Oj},{tag:[F.name,F.deleted,F.character,F.propertyName,F.macroName],color:OQ},{tag:[F.function(F.variableName),F.labelName],color:_j},{tag:[F.color,F.constant(F.name),F.standard(F.name)],color:VQ},{tag:[F.definition(F.name),F.separator],color:E8},{tag:[F.typeName,F.className,F.number,F.changed,F.annotation,F.modifier,F.self,F.namespace],color:Gj},{tag:[F.operator,F.operatorKeyword,F.url,F.escape,F.regexp,F.link,F.special(F.string)],color:Wj},{tag:[F.meta,F.comment],color:Y6},{tag:F.strong,fontWeight:"bold"},{tag:F.emphasis,fontStyle:"italic"},{tag:F.strikethrough,textDecoration:"line-through"},{tag:F.link,color:Y6,textDecoration:"underline"},{tag:F.heading,fontWeight:"bold",color:OQ},{tag:[F.atom,F.bool,F.special(F.variableName)],color:VQ},{tag:[F.processingInstruction,F.string,F.inserted],color:zj},{tag:F.invalid,color:jj}]),P8=[Hj,Y8(Ij)];var t7=null;function RQ(Z){let $=document.getElementById("editor");if(!$)return;if(!t7){let J=n.create({doc:Z,extensions:[zQ,V7.define(B8),P8,C.theme({"&":{height:"100%",backgroundColor:"#1e1e1e",outline:"none !important"},".cm-scroller":{overflow:"auto",fontFamily:"var(--font-mono)"},".cm-content":{padding:"24px 16px",whiteSpace:"pre",flexShrink:"0"},".cm-gutters":{backgroundColor:"#1e1e1e",borderRight:"1px solid #334155"},".cm-gutterElement":{padding:"0 8px"}})]});t7=new C({state:J,parent:$})}else{let J=t7.state.doc.toString();if(J!==Z)t7.dispatch({changes:{from:0,to:J.length,insert:Z}})}}function FQ(){return t7?t7.state.doc.toString():""}function K6(){return!!(window.ocaml&&window.ocaml.run)}async function DQ(Z){if(!window.ocaml||!window.ocaml.run)throw Error("Compiler not ready yet.");return window.ocaml.run(Z)}function q6(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var D7=q6();function CQ(Z){D7=Z}var a4={exec:()=>null};function J0(Z,$=""){let J=typeof Z=="string"?Z:Z.source,X={replace:(Q,Y)=>{let K=typeof Y=="string"?Y:Y.source;return K=K.replace(f0.caret,"$1"),J=J.replace(Q,K),X},getRegex:()=>new RegExp(J,$)};return X}var Rj=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),f0={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:(Z)=>new RegExp(`^( {0,3}${Z})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}#`),htmlBeginRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}<(?:[a-z].*>|!--)`,"i")},Fj=/^(?:[ \t]*(?:\n|$))+/,Dj=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Aj=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,r4=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Mj=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,G6=/(?:[*+-]|\d{1,9}[.)])/,TQ=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,yQ=J0(TQ).replace(/bull/g,G6).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Lj=J0(TQ).replace(/bull/g,G6).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),W6=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Bj=/^[^\n]+/,j6=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Ej=J0(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",j6).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Pj=J0(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,G6).getRegex(),S8="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_6=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Cj=J0("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",_6).replace("tag",S8).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),kQ=J0(W6).replace("hr",r4).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",S8).getRegex(),Tj=J0(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",kQ).getRegex(),z6={blockquote:Tj,code:Dj,def:Ej,fences:Aj,heading:Mj,hr:r4,html:Cj,lheading:yQ,list:Pj,newline:Fj,paragraph:kQ,table:a4,text:Bj},AQ=J0("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",r4).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",S8).getRegex(),yj={...z6,lheading:Lj,table:AQ,paragraph:J0(W6).replace("hr",r4).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",AQ).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",S8).getRegex()},kj={...z6,html:J0(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",_6).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:a4,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:J0(W6).replace("hr",r4).replace("heading",` *#{1,6} *[^
]`).replace("lheading",yQ).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Sj=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,bj=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,SQ=/^( {2,}|\\)\n(?!\s*$)/,xj=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,b8=/[\p{P}\p{S}]/u,O6=/[\s\p{P}\p{S}]/u,bQ=/[^\s\p{P}\p{S}]/u,wj=J0(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,O6).getRegex(),xQ=/(?!~)[\p{P}\p{S}]/u,hj=/(?!~)[\s\p{P}\p{S}]/u,vj=/(?:[^\s\p{P}\p{S}]|~)/u,uj=J0(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Rj?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),wQ=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,mj=J0(wQ,"u").replace(/punct/g,b8).getRegex(),fj=J0(wQ,"u").replace(/punct/g,xQ).getRegex(),hQ="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",gj=J0(hQ,"gu").replace(/notPunctSpace/g,bQ).replace(/punctSpace/g,O6).replace(/punct/g,b8).getRegex(),pj=J0(hQ,"gu").replace(/notPunctSpace/g,vj).replace(/punctSpace/g,hj).replace(/punct/g,xQ).getRegex(),lj=J0("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,bQ).replace(/punctSpace/g,O6).replace(/punct/g,b8).getRegex(),dj=J0(/\\(punct)/,"gu").replace(/punct/g,b8).getRegex(),cj=J0(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),sj=J0(_6).replace("(?:-->|$)","-->").getRegex(),nj=J0("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",sj).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),T8=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,ij=J0(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",T8).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),vQ=J0(/^!?\[(label)\]\[(ref)\]/).replace("label",T8).replace("ref",j6).getRegex(),uQ=J0(/^!?\[(ref)\](?:\[\])?/).replace("ref",j6).getRegex(),aj=J0("reflink|nolink(?!\\()","g").replace("reflink",vQ).replace("nolink",uQ).getRegex(),MQ=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,V6={_backpedal:a4,anyPunctuation:dj,autolink:cj,blockSkip:uj,br:SQ,code:bj,del:a4,emStrongLDelim:mj,emStrongRDelimAst:gj,emStrongRDelimUnd:lj,escape:Sj,link:ij,nolink:uQ,punctuation:wj,reflink:vQ,reflinkSearch:aj,tag:nj,text:xj,url:a4},rj={...V6,link:J0(/^!?\[(label)\]\((.*?)\)/).replace("label",T8).getRegex(),reflink:J0(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",T8).getRegex()},U6={...V6,emStrongRDelimAst:pj,emStrongLDelim:fj,url:J0(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",MQ).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:J0(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",MQ).getRegex()},oj={...U6,br:J0(SQ).replace("{2,}","*").getRegex(),text:J0(U6.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},C8={normal:z6,gfm:yj,pedantic:kj},s4={normal:V6,gfm:U6,breaks:oj,pedantic:rj},tj={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},LQ=(Z)=>tj[Z];function u1(Z,$){if($){if(f0.escapeTest.test(Z))return Z.replace(f0.escapeReplace,LQ)}else if(f0.escapeTestNoEncode.test(Z))return Z.replace(f0.escapeReplaceNoEncode,LQ);return Z}function BQ(Z){try{Z=encodeURI(Z).replace(f0.percentDecode,"%")}catch{return null}return Z}function EQ(Z,$){let J=Z.replace(f0.findPipe,(Y,K,U)=>{let q=!1,G=K;for(;--G>=0&&U[G]==="\\";)q=!q;return q?"|":" |"}),X=J.split(f0.splitPipe),Q=0;if(X[0].trim()||X.shift(),X.length>0&&!X.at(-1)?.trim()&&X.pop(),$)if(X.length>$)X.splice($);else for(;X.length<$;)X.push("");for(;Q<X.length;Q++)X[Q]=X[Q].trim().replace(f0.slashPipe,"|");return X}function n4(Z,$,J){let X=Z.length;if(X===0)return"";let Q=0;for(;Q<X;){let Y=Z.charAt(X-Q-1);if(Y===$&&!J)Q++;else if(Y!==$&&J)Q++;else break}return Z.slice(0,X-Q)}function ej(Z,$){if(Z.indexOf($[1])===-1)return-1;let J=0;for(let X=0;X<Z.length;X++)if(Z[X]==="\\")X++;else if(Z[X]===$[0])J++;else if(Z[X]===$[1]&&(J--,J<0))return X;return J>0?-2:-1}function PQ(Z,$,J,X,Q){let Y=$.href,K=$.title||null,U=Z[1].replace(Q.other.outputLinkReplace,"$1");X.state.inLink=!0;let q={type:Z[0].charAt(0)==="!"?"image":"link",raw:J,href:Y,title:K,text:U,tokens:X.inlineTokens(U)};return X.state.inLink=!1,q}function Z_(Z,$,J){let X=Z.match(J.other.indentCodeCompensation);if(X===null)return $;let Q=X[1];return $.split(`
`).map((Y)=>{let K=Y.match(J.other.beginningSpace);if(K===null)return Y;let[U]=K;return U.length>=Q.length?Y.slice(Q.length):Y}).join(`
`)}var y8=class{options;rules;lexer;constructor(Z){this.options=Z||D7}space(Z){let $=this.rules.block.newline.exec(Z);if($&&$[0].length>0)return{type:"space",raw:$[0]}}code(Z){let $=this.rules.block.code.exec(Z);if($){let J=$[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:$[0],codeBlockStyle:"indented",text:this.options.pedantic?J:n4(J,`
`)}}}fences(Z){let $=this.rules.block.fences.exec(Z);if($){let J=$[0],X=Z_(J,$[3]||"",this.rules);return{type:"code",raw:J,lang:$[2]?$[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):$[2],text:X}}}heading(Z){let $=this.rules.block.heading.exec(Z);if($){let J=$[2].trim();if(this.rules.other.endingHash.test(J)){let X=n4(J,"#");(this.options.pedantic||!X||this.rules.other.endingSpaceChar.test(X))&&(J=X.trim())}return{type:"heading",raw:$[0],depth:$[1].length,text:J,tokens:this.lexer.inline(J)}}}hr(Z){let $=this.rules.block.hr.exec(Z);if($)return{type:"hr",raw:n4($[0],`
`)}}blockquote(Z){let $=this.rules.block.blockquote.exec(Z);if($){let J=n4($[0],`
`).split(`
`),X="",Q="",Y=[];for(;J.length>0;){let K=!1,U=[],q;for(q=0;q<J.length;q++)if(this.rules.other.blockquoteStart.test(J[q]))U.push(J[q]),K=!0;else if(!K)U.push(J[q]);else break;J=J.slice(q);let G=U.join(`
`),W=G.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");X=X?`${X}
${G}`:G,Q=Q?`${Q}
${W}`:W;let j=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(W,Y,!0),this.lexer.state.top=j,J.length===0)break;let _=Y.at(-1);if(_?.type==="code")break;if(_?.type==="blockquote"){let z=_,V=z.raw+`
`+J.join(`
`),O=this.blockquote(V);Y[Y.length-1]=O,X=X.substring(0,X.length-z.raw.length)+O.raw,Q=Q.substring(0,Q.length-z.text.length)+O.text;break}else if(_?.type==="list"){let z=_,V=z.raw+`
`+J.join(`
`),O=this.list(V);Y[Y.length-1]=O,X=X.substring(0,X.length-_.raw.length)+O.raw,Q=Q.substring(0,Q.length-z.raw.length)+O.raw,J=V.substring(Y.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:X,tokens:Y,text:Q}}}list(Z){let $=this.rules.block.list.exec(Z);if($){let J=$[1].trim(),X=J.length>1,Q={type:"list",raw:"",ordered:X,start:X?+J.slice(0,-1):"",loose:!1,items:[]};J=X?`\\d{1,9}\\${J.slice(-1)}`:`\\${J}`,this.options.pedantic&&(J=X?J:"[*+-]");let Y=this.rules.other.listItemRegex(J),K=!1;for(;Z;){let q=!1,G="",W="";if(!($=Y.exec(Z))||this.rules.block.hr.test(Z))break;G=$[0],Z=Z.substring(G.length);let j=$[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,(O)=>" ".repeat(3*O.length)),_=Z.split(`
`,1)[0],z=!j.trim(),V=0;if(this.options.pedantic?(V=2,W=j.trimStart()):z?V=$[1].length+1:(V=$[2].search(this.rules.other.nonSpaceChar),V=V>4?1:V,W=j.slice(V),V+=$[1].length),z&&this.rules.other.blankLine.test(_)&&(G+=_+`
`,Z=Z.substring(_.length+1),q=!0),!q){let O=this.rules.other.nextBulletRegex(V),H=this.rules.other.hrRegex(V),R=this.rules.other.fencesBeginRegex(V),D=this.rules.other.headingBeginRegex(V),M=this.rules.other.htmlBeginRegex(V);for(;Z;){let L=Z.split(`
`,1)[0],B;if(_=L,this.options.pedantic?(_=_.replace(this.rules.other.listReplaceNesting,"  "),B=_):B=_.replace(this.rules.other.tabCharGlobal,"    "),R.test(_)||D.test(_)||M.test(_)||O.test(_)||H.test(_))break;if(B.search(this.rules.other.nonSpaceChar)>=V||!_.trim())W+=`
`+B.slice(V);else{if(z||j.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||R.test(j)||D.test(j)||H.test(j))break;W+=`
`+_}!z&&!_.trim()&&(z=!0),G+=L+`
`,Z=Z.substring(L.length+1),j=B.slice(V)}}Q.loose||(K?Q.loose=!0:this.rules.other.doubleBlankLine.test(G)&&(K=!0)),Q.items.push({type:"list_item",raw:G,task:!!this.options.gfm&&this.rules.other.listIsTask.test(W),loose:!1,text:W,tokens:[]}),Q.raw+=G}let U=Q.items.at(-1);if(U)U.raw=U.raw.trimEnd(),U.text=U.text.trimEnd();else return;Q.raw=Q.raw.trimEnd();for(let q of Q.items){if(this.lexer.state.top=!1,q.tokens=this.lexer.blockTokens(q.text,[]),q.task){if(q.text=q.text.replace(this.rules.other.listReplaceTask,""),q.tokens[0]?.type==="text"||q.tokens[0]?.type==="paragraph"){q.tokens[0].raw=q.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),q.tokens[0].text=q.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let W=this.lexer.inlineQueue.length-1;W>=0;W--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[W].src)){this.lexer.inlineQueue[W].src=this.lexer.inlineQueue[W].src.replace(this.rules.other.listReplaceTask,"");break}}let G=this.rules.other.listTaskCheckbox.exec(q.raw);if(G){let W={type:"checkbox",raw:G[0]+" ",checked:G[0]!=="[ ]"};q.checked=W.checked,Q.loose?q.tokens[0]&&["paragraph","text"].includes(q.tokens[0].type)&&"tokens"in q.tokens[0]&&q.tokens[0].tokens?(q.tokens[0].raw=W.raw+q.tokens[0].raw,q.tokens[0].text=W.raw+q.tokens[0].text,q.tokens[0].tokens.unshift(W)):q.tokens.unshift({type:"paragraph",raw:W.raw,text:W.raw,tokens:[W]}):q.tokens.unshift(W)}}if(!Q.loose){let G=q.tokens.filter((j)=>j.type==="space"),W=G.length>0&&G.some((j)=>this.rules.other.anyLine.test(j.raw));Q.loose=W}}if(Q.loose)for(let q of Q.items){q.loose=!0;for(let G of q.tokens)G.type==="text"&&(G.type="paragraph")}return Q}}html(Z){let $=this.rules.block.html.exec(Z);if($)return{type:"html",block:!0,raw:$[0],pre:$[1]==="pre"||$[1]==="script"||$[1]==="style",text:$[0]}}def(Z){let $=this.rules.block.def.exec(Z);if($){let J=$[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),X=$[2]?$[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",Q=$[3]?$[3].substring(1,$[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):$[3];return{type:"def",tag:J,raw:$[0],href:X,title:Q}}}table(Z){let $=this.rules.block.table.exec(Z);if(!$||!this.rules.other.tableDelimiter.test($[2]))return;let J=EQ($[1]),X=$[2].replace(this.rules.other.tableAlignChars,"").split("|"),Q=$[3]?.trim()?$[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],Y={type:"table",raw:$[0],header:[],align:[],rows:[]};if(J.length===X.length){for(let K of X)this.rules.other.tableAlignRight.test(K)?Y.align.push("right"):this.rules.other.tableAlignCenter.test(K)?Y.align.push("center"):this.rules.other.tableAlignLeft.test(K)?Y.align.push("left"):Y.align.push(null);for(let K=0;K<J.length;K++)Y.header.push({text:J[K],tokens:this.lexer.inline(J[K]),header:!0,align:Y.align[K]});for(let K of Q)Y.rows.push(EQ(K,Y.header.length).map((U,q)=>({text:U,tokens:this.lexer.inline(U),header:!1,align:Y.align[q]})));return Y}}lheading(Z){let $=this.rules.block.lheading.exec(Z);if($)return{type:"heading",raw:$[0],depth:$[2].charAt(0)==="="?1:2,text:$[1],tokens:this.lexer.inline($[1])}}paragraph(Z){let $=this.rules.block.paragraph.exec(Z);if($){let J=$[1].charAt($[1].length-1)===`
`?$[1].slice(0,-1):$[1];return{type:"paragraph",raw:$[0],text:J,tokens:this.lexer.inline(J)}}}text(Z){let $=this.rules.block.text.exec(Z);if($)return{type:"text",raw:$[0],text:$[0],tokens:this.lexer.inline($[0])}}escape(Z){let $=this.rules.inline.escape.exec(Z);if($)return{type:"escape",raw:$[0],text:$[1]}}tag(Z){let $=this.rules.inline.tag.exec(Z);if($)return!this.lexer.state.inLink&&this.rules.other.startATag.test($[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test($[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test($[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test($[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:$[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:$[0]}}link(Z){let $=this.rules.inline.link.exec(Z);if($){let J=$[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(J)){if(!this.rules.other.endAngleBracket.test(J))return;let Y=n4(J.slice(0,-1),"\\");if((J.length-Y.length)%2===0)return}else{let Y=ej($[2],"()");if(Y===-2)return;if(Y>-1){let K=($[0].indexOf("!")===0?5:4)+$[1].length+Y;$[2]=$[2].substring(0,Y),$[0]=$[0].substring(0,K).trim(),$[3]=""}}let X=$[2],Q="";if(this.options.pedantic){let Y=this.rules.other.pedanticHrefTitle.exec(X);Y&&(X=Y[1],Q=Y[3])}else Q=$[3]?$[3].slice(1,-1):"";return X=X.trim(),this.rules.other.startAngleBracket.test(X)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(J)?X=X.slice(1):X=X.slice(1,-1)),PQ($,{href:X&&X.replace(this.rules.inline.anyPunctuation,"$1"),title:Q&&Q.replace(this.rules.inline.anyPunctuation,"$1")},$[0],this.lexer,this.rules)}}reflink(Z,$){let J;if((J=this.rules.inline.reflink.exec(Z))||(J=this.rules.inline.nolink.exec(Z))){let X=(J[2]||J[1]).replace(this.rules.other.multipleSpaceGlobal," "),Q=$[X.toLowerCase()];if(!Q){let Y=J[0].charAt(0);return{type:"text",raw:Y,text:Y}}return PQ(J,Q,J[0],this.lexer,this.rules)}}emStrong(Z,$,J=""){let X=this.rules.inline.emStrongLDelim.exec(Z);if(!X||X[3]&&J.match(this.rules.other.unicodeAlphaNumeric))return;if(!(X[1]||X[2])||!J||this.rules.inline.punctuation.exec(J)){let Q=[...X[0]].length-1,Y,K,U=Q,q=0,G=X[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(G.lastIndex=0,$=$.slice(-1*Z.length+Q);(X=G.exec($))!=null;){if(Y=X[1]||X[2]||X[3]||X[4]||X[5]||X[6],!Y)continue;if(K=[...Y].length,X[3]||X[4]){U+=K;continue}else if((X[5]||X[6])&&Q%3&&!((Q+K)%3)){q+=K;continue}if(U-=K,U>0)continue;K=Math.min(K,K+U+q);let W=[...X[0]][0].length,j=Z.slice(0,Q+X.index+W+K);if(Math.min(Q,K)%2){let z=j.slice(1,-1);return{type:"em",raw:j,text:z,tokens:this.lexer.inlineTokens(z)}}let _=j.slice(2,-2);return{type:"strong",raw:j,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(Z){let $=this.rules.inline.code.exec(Z);if($){let J=$[2].replace(this.rules.other.newLineCharGlobal," "),X=this.rules.other.nonSpaceChar.test(J),Q=this.rules.other.startingSpaceChar.test(J)&&this.rules.other.endingSpaceChar.test(J);return X&&Q&&(J=J.substring(1,J.length-1)),{type:"codespan",raw:$[0],text:J}}}br(Z){let $=this.rules.inline.br.exec(Z);if($)return{type:"br",raw:$[0]}}del(Z){let $=this.rules.inline.del.exec(Z);if($)return{type:"del",raw:$[0],text:$[2],tokens:this.lexer.inlineTokens($[2])}}autolink(Z){let $=this.rules.inline.autolink.exec(Z);if($){let J,X;return $[2]==="@"?(J=$[1],X="mailto:"+J):(J=$[1],X=J),{type:"link",raw:$[0],text:J,href:X,tokens:[{type:"text",raw:J,text:J}]}}}url(Z){let $;if($=this.rules.inline.url.exec(Z)){let J,X;if($[2]==="@")J=$[0],X="mailto:"+J;else{let Q;do Q=$[0],$[0]=this.rules.inline._backpedal.exec($[0])?.[0]??"";while(Q!==$[0]);J=$[0],$[1]==="www."?X="http://"+$[0]:X=$[0]}return{type:"link",raw:$[0],text:J,href:X,tokens:[{type:"text",raw:J,text:J}]}}}inlineText(Z){let $=this.rules.inline.text.exec(Z);if($){let J=this.lexer.state.inRawBlock;return{type:"text",raw:$[0],text:$[0],escaped:J}}}},M1=class Z{tokens;options;state;inlineQueue;tokenizer;constructor($){this.tokens=[],this.tokens.links=Object.create(null),this.options=$||D7,this.options.tokenizer=this.options.tokenizer||new y8,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let J={other:f0,block:C8.normal,inline:s4.normal};this.options.pedantic?(J.block=C8.pedantic,J.inline=s4.pedantic):this.options.gfm&&(J.block=C8.gfm,this.options.breaks?J.inline=s4.breaks:J.inline=s4.gfm),this.tokenizer.rules=J}static get rules(){return{block:C8,inline:s4}}static lex($,J){return new Z(J).lex($)}static lexInline($,J){return new Z(J).inlineTokens($)}lex($){$=$.replace(f0.carriageReturn,`
`),this.blockTokens($,this.tokens);for(let J=0;J<this.inlineQueue.length;J++){let X=this.inlineQueue[J];this.inlineTokens(X.src,X.tokens)}return this.inlineQueue=[],this.tokens}blockTokens($,J=[],X=!1){for(this.options.pedantic&&($=$.replace(f0.tabCharGlobal,"    ").replace(f0.spaceLine,""));$;){let Q;if(this.options.extensions?.block?.some((K)=>(Q=K.call({lexer:this},$,J))?($=$.substring(Q.raw.length),J.push(Q),!0):!1))continue;if(Q=this.tokenizer.space($)){$=$.substring(Q.raw.length);let K=J.at(-1);Q.raw.length===1&&K!==void 0?K.raw+=`
`:J.push(Q);continue}if(Q=this.tokenizer.code($)){$=$.substring(Q.raw.length);let K=J.at(-1);K?.type==="paragraph"||K?.type==="text"?(K.raw+=(K.raw.endsWith(`
`)?"":`
`)+Q.raw,K.text+=`
`+Q.text,this.inlineQueue.at(-1).src=K.text):J.push(Q);continue}if(Q=this.tokenizer.fences($)){$=$.substring(Q.raw.length),J.push(Q);continue}if(Q=this.tokenizer.heading($)){$=$.substring(Q.raw.length),J.push(Q);continue}if(Q=this.tokenizer.hr($)){$=$.substring(Q.raw.length),J.push(Q);continue}if(Q=this.tokenizer.blockquote($)){$=$.substring(Q.raw.length),J.push(Q);continue}if(Q=this.tokenizer.list($)){$=$.substring(Q.raw.length),J.push(Q);continue}if(Q=this.tokenizer.html($)){$=$.substring(Q.raw.length),J.push(Q);continue}if(Q=this.tokenizer.def($)){$=$.substring(Q.raw.length);let K=J.at(-1);K?.type==="paragraph"||K?.type==="text"?(K.raw+=(K.raw.endsWith(`
`)?"":`
`)+Q.raw,K.text+=`
`+Q.raw,this.inlineQueue.at(-1).src=K.text):this.tokens.links[Q.tag]||(this.tokens.links[Q.tag]={href:Q.href,title:Q.title},J.push(Q));continue}if(Q=this.tokenizer.table($)){$=$.substring(Q.raw.length),J.push(Q);continue}if(Q=this.tokenizer.lheading($)){$=$.substring(Q.raw.length),J.push(Q);continue}let Y=$;if(this.options.extensions?.startBlock){let K=1/0,U=$.slice(1),q;this.options.extensions.startBlock.forEach((G)=>{q=G.call({lexer:this},U),typeof q=="number"&&q>=0&&(K=Math.min(K,q))}),K<1/0&&K>=0&&(Y=$.substring(0,K+1))}if(this.state.top&&(Q=this.tokenizer.paragraph(Y))){let K=J.at(-1);X&&K?.type==="paragraph"?(K.raw+=(K.raw.endsWith(`
`)?"":`
`)+Q.raw,K.text+=`
`+Q.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=K.text):J.push(Q),X=Y.length!==$.length,$=$.substring(Q.raw.length);continue}if(Q=this.tokenizer.text($)){$=$.substring(Q.raw.length);let K=J.at(-1);K?.type==="text"?(K.raw+=(K.raw.endsWith(`
`)?"":`
`)+Q.raw,K.text+=`
`+Q.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=K.text):J.push(Q);continue}if($){let K="Infinite loop on byte: "+$.charCodeAt(0);if(this.options.silent){console.error(K);break}else throw Error(K)}}return this.state.top=!0,J}inline($,J=[]){return this.inlineQueue.push({src:$,tokens:J}),J}inlineTokens($,J=[]){let X=$,Q=null;if(this.tokens.links){let q=Object.keys(this.tokens.links);if(q.length>0)for(;(Q=this.tokenizer.rules.inline.reflinkSearch.exec(X))!=null;)q.includes(Q[0].slice(Q[0].lastIndexOf("[")+1,-1))&&(X=X.slice(0,Q.index)+"["+"a".repeat(Q[0].length-2)+"]"+X.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(Q=this.tokenizer.rules.inline.anyPunctuation.exec(X))!=null;)X=X.slice(0,Q.index)+"++"+X.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let Y;for(;(Q=this.tokenizer.rules.inline.blockSkip.exec(X))!=null;)Y=Q[2]?Q[2].length:0,X=X.slice(0,Q.index+Y)+"["+"a".repeat(Q[0].length-Y-2)+"]"+X.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);X=this.options.hooks?.emStrongMask?.call({lexer:this},X)??X;let K=!1,U="";for(;$;){K||(U=""),K=!1;let q;if(this.options.extensions?.inline?.some((W)=>(q=W.call({lexer:this},$,J))?($=$.substring(q.raw.length),J.push(q),!0):!1))continue;if(q=this.tokenizer.escape($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.tag($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.link($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.reflink($,this.tokens.links)){$=$.substring(q.raw.length);let W=J.at(-1);q.type==="text"&&W?.type==="text"?(W.raw+=q.raw,W.text+=q.text):J.push(q);continue}if(q=this.tokenizer.emStrong($,X,U)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.codespan($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.br($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.del($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.autolink($)){$=$.substring(q.raw.length),J.push(q);continue}if(!this.state.inLink&&(q=this.tokenizer.url($))){$=$.substring(q.raw.length),J.push(q);continue}let G=$;if(this.options.extensions?.startInline){let W=1/0,j=$.slice(1),_;this.options.extensions.startInline.forEach((z)=>{_=z.call({lexer:this},j),typeof _=="number"&&_>=0&&(W=Math.min(W,_))}),W<1/0&&W>=0&&(G=$.substring(0,W+1))}if(q=this.tokenizer.inlineText(G)){$=$.substring(q.raw.length),q.raw.slice(-1)!=="_"&&(U=q.raw.slice(-1)),K=!0;let W=J.at(-1);W?.type==="text"?(W.raw+=q.raw,W.text+=q.text):J.push(q);continue}if($){let W="Infinite loop on byte: "+$.charCodeAt(0);if(this.options.silent){console.error(W);break}else throw Error(W)}}return J}},k8=class{options;parser;constructor(Z){this.options=Z||D7}space(Z){return""}code({text:Z,lang:$,escaped:J}){let X=($||"").match(f0.notSpaceStart)?.[0],Q=Z.replace(f0.endingNewline,"")+`
`;return X?'<pre><code class="language-'+u1(X)+'">'+(J?Q:u1(Q,!0))+`</code></pre>
`:"<pre><code>"+(J?Q:u1(Q,!0))+`</code></pre>
`}blockquote({tokens:Z}){return`<blockquote>
${this.parser.parse(Z)}</blockquote>
`}html({text:Z}){return Z}def(Z){return""}heading({tokens:Z,depth:$}){return`<h${$}>${this.parser.parseInline(Z)}</h${$}>
`}hr(Z){return`<hr>
`}list(Z){let{ordered:$,start:J}=Z,X="";for(let K=0;K<Z.items.length;K++){let U=Z.items[K];X+=this.listitem(U)}let Q=$?"ol":"ul",Y=$&&J!==1?' start="'+J+'"':"";return"<"+Q+Y+`>
`+X+"</"+Q+`>
`}listitem(Z){return`<li>${this.parser.parse(Z.tokens)}</li>
`}checkbox({checked:Z}){return"<input "+(Z?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:Z}){return`<p>${this.parser.parseInline(Z)}</p>
`}table(Z){let $="",J="";for(let Q=0;Q<Z.header.length;Q++)J+=this.tablecell(Z.header[Q]);$+=this.tablerow({text:J});let X="";for(let Q=0;Q<Z.rows.length;Q++){let Y=Z.rows[Q];J="";for(let K=0;K<Y.length;K++)J+=this.tablecell(Y[K]);X+=this.tablerow({text:J})}return X&&(X=`<tbody>${X}</tbody>`),`<table>
<thead>
`+$+`</thead>
`+X+`</table>
`}tablerow({text:Z}){return`<tr>
${Z}</tr>
`}tablecell(Z){let $=this.parser.parseInline(Z.tokens),J=Z.header?"th":"td";return(Z.align?`<${J} align="${Z.align}">`:`<${J}>`)+$+`</${J}>
`}strong({tokens:Z}){return`<strong>${this.parser.parseInline(Z)}</strong>`}em({tokens:Z}){return`<em>${this.parser.parseInline(Z)}</em>`}codespan({text:Z}){return`<code>${u1(Z,!0)}</code>`}br(Z){return"<br>"}del({tokens:Z}){return`<del>${this.parser.parseInline(Z)}</del>`}link({href:Z,title:$,tokens:J}){let X=this.parser.parseInline(J),Q=BQ(Z);if(Q===null)return X;Z=Q;let Y='<a href="'+Z+'"';return $&&(Y+=' title="'+u1($)+'"'),Y+=">"+X+"</a>",Y}image({href:Z,title:$,text:J,tokens:X}){X&&(J=this.parser.parseInline(X,this.parser.textRenderer));let Q=BQ(Z);if(Q===null)return u1(J);Z=Q;let Y=`<img src="${Z}" alt="${J}"`;return $&&(Y+=` title="${u1($)}"`),Y+=">",Y}text(Z){return"tokens"in Z&&Z.tokens?this.parser.parseInline(Z.tokens):("escaped"in Z)&&Z.escaped?Z.text:u1(Z.text)}},N6=class{strong({text:Z}){return Z}em({text:Z}){return Z}codespan({text:Z}){return Z}del({text:Z}){return Z}html({text:Z}){return Z}text({text:Z}){return Z}link({text:Z}){return""+Z}image({text:Z}){return""+Z}br(){return""}checkbox({raw:Z}){return Z}},L1=class Z{options;renderer;textRenderer;constructor($){this.options=$||D7,this.options.renderer=this.options.renderer||new k8,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new N6}static parse($,J){return new Z(J).parse($)}static parseInline($,J){return new Z(J).parseInline($)}parse($){let J="";for(let X=0;X<$.length;X++){let Q=$[X];if(this.options.extensions?.renderers?.[Q.type]){let K=Q,U=this.options.extensions.renderers[K.type].call({parser:this},K);if(U!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(K.type)){J+=U||"";continue}}let Y=Q;switch(Y.type){case"space":{J+=this.renderer.space(Y);break}case"hr":{J+=this.renderer.hr(Y);break}case"heading":{J+=this.renderer.heading(Y);break}case"code":{J+=this.renderer.code(Y);break}case"table":{J+=this.renderer.table(Y);break}case"blockquote":{J+=this.renderer.blockquote(Y);break}case"list":{J+=this.renderer.list(Y);break}case"checkbox":{J+=this.renderer.checkbox(Y);break}case"html":{J+=this.renderer.html(Y);break}case"def":{J+=this.renderer.def(Y);break}case"paragraph":{J+=this.renderer.paragraph(Y);break}case"text":{J+=this.renderer.text(Y);break}default:{let K='Token with "'+Y.type+'" type was not found.';if(this.options.silent)return console.error(K),"";throw Error(K)}}}return J}parseInline($,J=this.renderer){let X="";for(let Q=0;Q<$.length;Q++){let Y=$[Q];if(this.options.extensions?.renderers?.[Y.type]){let U=this.options.extensions.renderers[Y.type].call({parser:this},Y);if(U!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Y.type)){X+=U||"";continue}}let K=Y;switch(K.type){case"escape":{X+=J.text(K);break}case"html":{X+=J.html(K);break}case"link":{X+=J.link(K);break}case"image":{X+=J.image(K);break}case"checkbox":{X+=J.checkbox(K);break}case"strong":{X+=J.strong(K);break}case"em":{X+=J.em(K);break}case"codespan":{X+=J.codespan(K);break}case"br":{X+=J.br(K);break}case"del":{X+=J.del(K);break}case"text":{X+=J.text(K);break}default:{let U='Token with "'+K.type+'" type was not found.';if(this.options.silent)return console.error(U),"";throw Error(U)}}}return X}},i4=class{options;block;constructor(Z){this.options=Z||D7}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(Z){return Z}postprocess(Z){return Z}processAllTokens(Z){return Z}emStrongMask(Z){return Z}provideLexer(){return this.block?M1.lex:M1.lexInline}provideParser(){return this.block?L1.parse:L1.parseInline}},$_=class{defaults=q6();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=L1;Renderer=k8;TextRenderer=N6;Lexer=M1;Tokenizer=y8;Hooks=i4;constructor(...Z){this.use(...Z)}walkTokens(Z,$){let J=[];for(let X of Z)switch(J=J.concat($.call(this,X)),X.type){case"table":{let Q=X;for(let Y of Q.header)J=J.concat(this.walkTokens(Y.tokens,$));for(let Y of Q.rows)for(let K of Y)J=J.concat(this.walkTokens(K.tokens,$));break}case"list":{let Q=X;J=J.concat(this.walkTokens(Q.items,$));break}default:{let Q=X;this.defaults.extensions?.childTokens?.[Q.type]?this.defaults.extensions.childTokens[Q.type].forEach((Y)=>{let K=Q[Y].flat(1/0);J=J.concat(this.walkTokens(K,$))}):Q.tokens&&(J=J.concat(this.walkTokens(Q.tokens,$)))}}return J}use(...Z){let $=this.defaults.extensions||{renderers:{},childTokens:{}};return Z.forEach((J)=>{let X={...J};if(X.async=this.defaults.async||X.async||!1,J.extensions&&(J.extensions.forEach((Q)=>{if(!Q.name)throw Error("extension name required");if("renderer"in Q){let Y=$.renderers[Q.name];Y?$.renderers[Q.name]=function(...K){let U=Q.renderer.apply(this,K);return U===!1&&(U=Y.apply(this,K)),U}:$.renderers[Q.name]=Q.renderer}if("tokenizer"in Q){if(!Q.level||Q.level!=="block"&&Q.level!=="inline")throw Error("extension level must be 'block' or 'inline'");let Y=$[Q.level];Y?Y.unshift(Q.tokenizer):$[Q.level]=[Q.tokenizer],Q.start&&(Q.level==="block"?$.startBlock?$.startBlock.push(Q.start):$.startBlock=[Q.start]:Q.level==="inline"&&($.startInline?$.startInline.push(Q.start):$.startInline=[Q.start]))}"childTokens"in Q&&Q.childTokens&&($.childTokens[Q.name]=Q.childTokens)}),X.extensions=$),J.renderer){let Q=this.defaults.renderer||new k8(this.defaults);for(let Y in J.renderer){if(!(Y in Q))throw Error(`renderer '${Y}' does not exist`);if(["options","parser"].includes(Y))continue;let K=Y,U=J.renderer[K],q=Q[K];Q[K]=(...G)=>{let W=U.apply(Q,G);return W===!1&&(W=q.apply(Q,G)),W||""}}X.renderer=Q}if(J.tokenizer){let Q=this.defaults.tokenizer||new y8(this.defaults);for(let Y in J.tokenizer){if(!(Y in Q))throw Error(`tokenizer '${Y}' does not exist`);if(["options","rules","lexer"].includes(Y))continue;let K=Y,U=J.tokenizer[K],q=Q[K];Q[K]=(...G)=>{let W=U.apply(Q,G);return W===!1&&(W=q.apply(Q,G)),W}}X.tokenizer=Q}if(J.hooks){let Q=this.defaults.hooks||new i4;for(let Y in J.hooks){if(!(Y in Q))throw Error(`hook '${Y}' does not exist`);if(["options","block"].includes(Y))continue;let K=Y,U=J.hooks[K],q=Q[K];i4.passThroughHooks.has(Y)?Q[K]=(G)=>{if(this.defaults.async&&i4.passThroughHooksRespectAsync.has(Y))return(async()=>{let j=await U.call(Q,G);return q.call(Q,j)})();let W=U.call(Q,G);return q.call(Q,W)}:Q[K]=(...G)=>{if(this.defaults.async)return(async()=>{let j=await U.apply(Q,G);return j===!1&&(j=await q.apply(Q,G)),j})();let W=U.apply(Q,G);return W===!1&&(W=q.apply(Q,G)),W}}X.hooks=Q}if(J.walkTokens){let Q=this.defaults.walkTokens,Y=J.walkTokens;X.walkTokens=function(K){let U=[];return U.push(Y.call(this,K)),Q&&(U=U.concat(Q.call(this,K))),U}}this.defaults={...this.defaults,...X}}),this}setOptions(Z){return this.defaults={...this.defaults,...Z},this}lexer(Z,$){return M1.lex(Z,$??this.defaults)}parser(Z,$){return L1.parse(Z,$??this.defaults)}parseMarkdown(Z){return($,J)=>{let X={...J},Q={...this.defaults,...X},Y=this.onError(!!Q.silent,!!Q.async);if(this.defaults.async===!0&&X.async===!1)return Y(Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof $>"u"||$===null)return Y(Error("marked(): input parameter is undefined or null"));if(typeof $!="string")return Y(Error("marked(): input parameter is of type "+Object.prototype.toString.call($)+", string expected"));if(Q.hooks&&(Q.hooks.options=Q,Q.hooks.block=Z),Q.async)return(async()=>{let K=Q.hooks?await Q.hooks.preprocess($):$,U=await(Q.hooks?await Q.hooks.provideLexer():Z?M1.lex:M1.lexInline)(K,Q),q=Q.hooks?await Q.hooks.processAllTokens(U):U;Q.walkTokens&&await Promise.all(this.walkTokens(q,Q.walkTokens));let G=await(Q.hooks?await Q.hooks.provideParser():Z?L1.parse:L1.parseInline)(q,Q);return Q.hooks?await Q.hooks.postprocess(G):G})().catch(Y);try{Q.hooks&&($=Q.hooks.preprocess($));let K=(Q.hooks?Q.hooks.provideLexer():Z?M1.lex:M1.lexInline)($,Q);Q.hooks&&(K=Q.hooks.processAllTokens(K)),Q.walkTokens&&this.walkTokens(K,Q.walkTokens);let U=(Q.hooks?Q.hooks.provideParser():Z?L1.parse:L1.parseInline)(K,Q);return Q.hooks&&(U=Q.hooks.postprocess(U)),U}catch(K){return Y(K)}}}onError(Z,$){return(J)=>{if(J.message+=`
Please report this to https://github.com/markedjs/marked.`,Z){let X="<p>An error occurred:</p><pre>"+u1(J.message+"",!0)+"</pre>";return $?Promise.resolve(X):X}if($)return Promise.reject(J);throw J}}},F7=new $_;function X0(Z,$){return F7.parse(Z,$)}X0.options=X0.setOptions=function(Z){return F7.setOptions(Z),X0.defaults=F7.defaults,CQ(X0.defaults),X0};X0.getDefaults=q6;X0.defaults=D7;X0.use=function(...Z){return F7.use(...Z),X0.defaults=F7.defaults,CQ(X0.defaults),X0};X0.walkTokens=function(Z,$){return F7.walkTokens(Z,$)};X0.parseInline=F7.parseInline;X0.Parser=L1;X0.parser=L1.parse;X0.Renderer=k8;X0.TextRenderer=N6;X0.Lexer=M1;X0.lexer=M1.lex;X0.Tokenizer=y8;X0.Hooks=i4;X0.parse=X0;var{options:FO,setOptions:DO,use:AO,walkTokens:MO,parseInline:LO}=X0;var BO=L1.parse,EO=M1.lex;var H6={};(function Z($,J,X,Q){var Y=!!($.Worker&&$.Blob&&$.Promise&&$.OffscreenCanvas&&$.OffscreenCanvasRenderingContext2D&&$.HTMLCanvasElement&&$.HTMLCanvasElement.prototype.transferControlToOffscreen&&$.URL&&$.URL.createObjectURL),K=typeof Path2D==="function"&&typeof DOMMatrix==="function",U=function(){if(!$.OffscreenCanvas)return!1;try{var I=new OffscreenCanvas(1,1),N=I.getContext("2d");N.fillRect(0,0,1,1);var h=I.transferToImageBitmap();N.createPattern(h,"no-repeat")}catch(u){return!1}return!0}();function q(){}function G(I){var N=J.exports.Promise,h=N!==void 0?N:$.Promise;if(typeof h==="function")return new h(I);return I(q,q),null}var W=function(I,N){return{transform:function(h){if(I)return h;if(N.has(h))return N.get(h);var u=new OffscreenCanvas(h.width,h.height),l=u.getContext("2d");return l.drawImage(h,0,0),N.set(h,u),u},clear:function(){N.clear()}}}(U,new Map),j=function(){var I=Math.floor(16.666666666666668),N,h,u={},l=0;if(typeof requestAnimationFrame==="function"&&typeof cancelAnimationFrame==="function")N=function(c){var s=Math.random();return u[s]=requestAnimationFrame(function g(t){if(l===t||l+I-1<t)l=t,delete u[s],c();else u[s]=requestAnimationFrame(g)}),s},h=function(c){if(u[c])cancelAnimationFrame(u[c])};else N=function(c){return setTimeout(c,I)},h=function(c){return clearTimeout(c)};return{frame:N,cancel:h}}(),_=function(){var I,N,h={};function u(l){function c(s,g){l.postMessage({options:s||{},callback:g})}l.init=function(g){var t=g.transferControlToOffscreen();l.postMessage({canvas:t},[t])},l.fire=function(g,t,U0){if(N)return c(g,null),N;var O0=Math.random().toString(36).slice(2);return N=G(function(G0){function V0(C0){if(C0.data.callback!==O0)return;delete h[O0],l.removeEventListener("message",V0),N=null,W.clear(),U0(),G0()}l.addEventListener("message",V0),c(g,O0),h[O0]=V0.bind(null,{data:{callback:O0}})}),N},l.reset=function(){l.postMessage({reset:!0});for(var g in h)h[g](),delete h[g]}}return function(){if(I)return I;if(!X&&Y){var l=["var CONFETTI, SIZE = {}, module = {};","("+Z.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{I=new Worker(URL.createObjectURL(new Blob([l])))}catch(c){return typeof console<"u"&&typeof console.warn==="function"&&console.warn("\uD83C\uDF8A Could not load worker",c),null}u(I)}return I}}(),z={particleCount:50,angle:90,spread:45,startVelocity:45,decay:0.9,gravity:1,drift:0,ticks:200,x:0.5,y:0.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function V(I,N){return N?N(I):I}function O(I){return!(I===null||I===void 0)}function H(I,N,h){return V(I&&O(I[N])?I[N]:z[N],h)}function R(I){return I<0?0:Math.floor(I)}function D(I,N){return Math.floor(Math.random()*(N-I))+I}function M(I){return parseInt(I,16)}function L(I){return I.map(B)}function B(I){var N=String(I).replace(/[^0-9a-f]/gi,"");if(N.length<6)N=N[0]+N[0]+N[1]+N[1]+N[2]+N[2];return{r:M(N.substring(0,2)),g:M(N.substring(2,4)),b:M(N.substring(4,6))}}function w(I){var N=H(I,"origin",Object);return N.x=H(N,"x",Number),N.y=H(N,"y",Number),N}function b(I){I.width=document.documentElement.clientWidth,I.height=document.documentElement.clientHeight}function d(I){var N=I.getBoundingClientRect();I.width=N.width,I.height=N.height}function a(I){var N=document.createElement("canvas");return N.style.position="fixed",N.style.top="0px",N.style.left="0px",N.style.pointerEvents="none",N.style.zIndex=I,N}function T(I,N,h,u,l,c,s,g,t){I.save(),I.translate(N,h),I.rotate(c),I.scale(u,l),I.arc(0,0,1,s,g,t),I.restore()}function P(I){var N=I.angle*(Math.PI/180),h=I.spread*(Math.PI/180);return{x:I.x,y:I.y,wobble:Math.random()*10,wobbleSpeed:Math.min(0.11,Math.random()*0.1+0.05),velocity:I.startVelocity*0.5+Math.random()*I.startVelocity,angle2D:-N+(0.5*h-Math.random()*h),tiltAngle:(Math.random()*0.5+0.25)*Math.PI,color:I.color,shape:I.shape,tick:0,totalTicks:I.ticks,decay:I.decay,drift:I.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:I.gravity*3,ovalScalar:0.6,scalar:I.scalar,flat:I.flat}}function E(I,N){if(N.x+=Math.cos(N.angle2D)*N.velocity+N.drift,N.y+=Math.sin(N.angle2D)*N.velocity+N.gravity,N.velocity*=N.decay,N.flat)N.wobble=0,N.wobbleX=N.x+10*N.scalar,N.wobbleY=N.y+10*N.scalar,N.tiltSin=0,N.tiltCos=0,N.random=1;else N.wobble+=N.wobbleSpeed,N.wobbleX=N.x+10*N.scalar*Math.cos(N.wobble),N.wobbleY=N.y+10*N.scalar*Math.sin(N.wobble),N.tiltAngle+=0.1,N.tiltSin=Math.sin(N.tiltAngle),N.tiltCos=Math.cos(N.tiltAngle),N.random=Math.random()+2;var h=N.tick++/N.totalTicks,u=N.x+N.random*N.tiltCos,l=N.y+N.random*N.tiltSin,c=N.wobbleX+N.random*N.tiltCos,s=N.wobbleY+N.random*N.tiltSin;if(I.fillStyle="rgba("+N.color.r+", "+N.color.g+", "+N.color.b+", "+(1-h)+")",I.beginPath(),K&&N.shape.type==="path"&&typeof N.shape.path==="string"&&Array.isArray(N.shape.matrix))I.fill(P0(N.shape.path,N.shape.matrix,N.x,N.y,Math.abs(c-u)*0.1,Math.abs(s-l)*0.1,Math.PI/10*N.wobble));else if(N.shape.type==="bitmap"){var g=Math.PI/10*N.wobble,t=Math.abs(c-u)*0.1,U0=Math.abs(s-l)*0.1,O0=N.shape.bitmap.width*N.scalar,G0=N.shape.bitmap.height*N.scalar,V0=new DOMMatrix([Math.cos(g)*t,Math.sin(g)*t,-Math.sin(g)*U0,Math.cos(g)*U0,N.x,N.y]);V0.multiplySelf(new DOMMatrix(N.shape.matrix));var C0=I.createPattern(W.transform(N.shape.bitmap),"no-repeat");C0.setTransform(V0),I.globalAlpha=1-h,I.fillStyle=C0,I.fillRect(N.x-O0/2,N.y-G0/2,O0,G0),I.globalAlpha=1}else if(N.shape==="circle")I.ellipse?I.ellipse(N.x,N.y,Math.abs(c-u)*N.ovalScalar,Math.abs(s-l)*N.ovalScalar,Math.PI/10*N.wobble,0,2*Math.PI):T(I,N.x,N.y,Math.abs(c-u)*N.ovalScalar,Math.abs(s-l)*N.ovalScalar,Math.PI/10*N.wobble,0,2*Math.PI);else if(N.shape==="star"){var Z0=Math.PI/2*3,g0=4*N.scalar,W1=8*N.scalar,j1=N.x,b1=N.y,J7=5,B1=Math.PI/J7;while(J7--)j1=N.x+Math.cos(Z0)*W1,b1=N.y+Math.sin(Z0)*W1,I.lineTo(j1,b1),Z0+=B1,j1=N.x+Math.cos(Z0)*g0,b1=N.y+Math.sin(Z0)*g0,I.lineTo(j1,b1),Z0+=B1}else I.moveTo(Math.floor(N.x),Math.floor(N.y)),I.lineTo(Math.floor(N.wobbleX),Math.floor(l)),I.lineTo(Math.floor(c),Math.floor(s)),I.lineTo(Math.floor(u),Math.floor(N.wobbleY));return I.closePath(),I.fill(),N.tick<N.totalTicks}function y(I,N,h,u,l){var c=N.slice(),s=I.getContext("2d"),g,t,U0=G(function(O0){function G0(){g=t=null,s.clearRect(0,0,u.width,u.height),W.clear(),l(),O0()}function V0(){if(X&&!(u.width===Q.width&&u.height===Q.height))u.width=I.width=Q.width,u.height=I.height=Q.height;if(!u.width&&!u.height)h(I),u.width=I.width,u.height=I.height;if(s.clearRect(0,0,u.width,u.height),c=c.filter(function(C0){return E(s,C0)}),c.length)g=j.frame(V0);else G0()}g=j.frame(V0),t=G0});return{addFettis:function(O0){return c=c.concat(O0),U0},canvas:I,promise:U0,reset:function(){if(g)j.cancel(g);if(t)t()}}}function f(I,N){var h=!I,u=!!H(N||{},"resize"),l=!1,c=H(N,"disableForReducedMotion",Boolean),s=Y&&!!H(N||{},"useWorker"),g=s?_():null,t=h?b:d,U0=I&&g?!!I.__confetti_initialized:!1,O0=typeof matchMedia==="function"&&matchMedia("(prefers-reduced-motion)").matches,G0;function V0(Z0,g0,W1){var j1=H(Z0,"particleCount",R),b1=H(Z0,"angle",Number),J7=H(Z0,"spread",Number),B1=H(Z0,"startVelocity",Number),$Y=H(Z0,"decay",Number),JY=H(Z0,"gravity",Number),XY=H(Z0,"drift",Number),M6=H(Z0,"colors",L),QY=H(Z0,"ticks",Number),L6=H(Z0,"shapes"),YY=H(Z0,"scalar"),KY=!!H(Z0,"flat"),B6=w(Z0),E6=j1,f8=[],UY=I.width*B6.x,qY=I.height*B6.y;while(E6--)f8.push(P({x:UY,y:qY,angle:b1,spread:J7,startVelocity:B1,color:M6[E6%M6.length],shape:L6[D(0,L6.length)],ticks:QY,decay:$Y,gravity:JY,drift:XY,scalar:YY,flat:KY}));if(G0)return G0.addFettis(f8);return G0=y(I,f8,t,g0,W1),G0.promise}function C0(Z0){var g0=c||H(Z0,"disableForReducedMotion",Boolean),W1=H(Z0,"zIndex",Number);if(g0&&O0)return G(function(B1){B1()});if(h&&G0)I=G0.canvas;else if(h&&!I)I=a(W1),document.body.appendChild(I);if(u&&!U0)t(I);var j1={width:I.width,height:I.height};if(g&&!U0)g.init(I);if(U0=!0,g)I.__confetti_initialized=!0;function b1(){if(g){var B1={getBoundingClientRect:function(){if(!h)return I.getBoundingClientRect()}};t(B1),g.postMessage({resize:{width:B1.width,height:B1.height}});return}j1.width=j1.height=null}function J7(){if(G0=null,u)l=!1,$.removeEventListener("resize",b1);if(h&&I){if(document.body.contains(I))document.body.removeChild(I);I=null,U0=!1}}if(u&&!l)l=!0,$.addEventListener("resize",b1,!1);if(g)return g.fire(Z0,j1,J7);return V0(Z0,j1,J7)}return C0.reset=function(){if(g)g.reset();if(G0)G0.reset()},C0}var o;function R0(){if(!o)o=f(null,{useWorker:!0,resize:!0});return o}function P0(I,N,h,u,l,c,s){var g=new Path2D(I),t=new Path2D;t.addPath(g,new DOMMatrix(N));var U0=new Path2D;return U0.addPath(t,new DOMMatrix([Math.cos(s)*l,Math.sin(s)*l,-Math.sin(s)*c,Math.cos(s)*c,h,u])),U0}function Z1(I){if(!K)throw Error("path confetti are not supported in this browser");var N,h;if(typeof I==="string")N=I;else N=I.path,h=I.matrix;var u=new Path2D(N),l=document.createElement("canvas"),c=l.getContext("2d");if(!h){var s=1000,g=s,t=s,U0=0,O0=0,G0,V0;for(var C0=0;C0<s;C0+=2)for(var Z0=0;Z0<s;Z0+=2)if(c.isPointInPath(u,C0,Z0,"nonzero"))g=Math.min(g,C0),t=Math.min(t,Z0),U0=Math.max(U0,C0),O0=Math.max(O0,Z0);G0=U0-g,V0=O0-t;var g0=10,W1=Math.min(g0/G0,g0/V0);h=[W1,0,0,W1,-Math.round(G0/2+g)*W1,-Math.round(V0/2+t)*W1]}return{type:"path",path:N,matrix:h}}function L0(I){var N,h=1,u="#000000",l='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';if(typeof I==="string")N=I;else N=I.text,h="scalar"in I?I.scalar:h,l="fontFamily"in I?I.fontFamily:l,u="color"in I?I.color:u;var c=10*h,s=""+c+"px "+l,g=new OffscreenCanvas(c,c),t=g.getContext("2d");t.font=s;var U0=t.measureText(N),O0=Math.ceil(U0.actualBoundingBoxRight+U0.actualBoundingBoxLeft),G0=Math.ceil(U0.actualBoundingBoxAscent+U0.actualBoundingBoxDescent),V0=2,C0=U0.actualBoundingBoxLeft+V0,Z0=U0.actualBoundingBoxAscent+V0;O0+=V0+V0,G0+=V0+V0,g=new OffscreenCanvas(O0,G0),t=g.getContext("2d"),t.font=s,t.fillStyle=u,t.fillText(N,C0,Z0);var g0=1/h;return{type:"bitmap",bitmap:g.transferToImageBitmap(),matrix:[g0,0,0,g0,-O0*g0/2,-G0*g0/2]}}J.exports=function(){return R0().apply(this,arguments)},J.exports.reset=function(){R0().reset()},J.exports.create=f,J.exports.shapeFromPath=Z1,J.exports.shapeFromText=L0})(function(){if(typeof window<"u")return window;if(typeof self<"u")return self;return this||{}}(),H6,!1);var mQ=H6.exports,bO=H6.exports.create;function F6(Z,$,J,X,Q,Y){this.indented=Z,this.column=$,this.type=J,this.info=X,this.align=Q,this.prev=Y}function x8(Z,$,J,X){var Q=Z.indented;if(Z.context&&Z.context.type=="statement"&&J!="statement")Q=Z.context.indented;return Z.context=new F6(Q,$,J,X,null,Z.context)}function o4(Z){var $=Z.context.type;if($==")"||$=="]"||$=="}")Z.indented=Z.context.indented;return Z.context=Z.context.prev}function fQ(Z,$,J){if($.prevToken=="variable"||$.prevToken=="type")return!0;if(/\S(?:[^- ]>|[*\]])\s*$|\*$/.test(Z.string.slice(0,J)))return!0;if($.typeAtEndOfLine&&Z.column()==Z.indentation())return!0}function I6(Z){for(;;){if(!Z||Z.type=="top")return!0;if(Z.type=="}"&&Z.prev.info!="namespace")return!1;Z=Z.prev}}function e0(Z){var{statementIndentUnit:$,dontAlignCalls:J}=Z,X=Z.keywords||{},Q=Z.types||{},Y=Z.builtin||{},K=Z.blockKeywords||{},U=Z.defKeywords||{},q=Z.atoms||{},G=Z.hooks||{},W=Z.multiLineStrings,j=Z.indentStatements!==!1,_=Z.indentSwitch!==!1,z=Z.namespaceSeparator,V=Z.isPunctuationChar||/[\[\]{}\(\),;\:\.]/,O=Z.numberStart||/[\d\.]/,H=Z.number||/^(?:0x[a-f\d]+|0b[01]+|(?:\d+\.?\d*|\.\d+)(?:e[-+]?\d+)?)(u|ll?|l|f)?/i,R=Z.isOperatorChar||/[+\-*&%=<>!?|\/]/,D=Z.isIdentifierChar||/[\w\$_\xa1-\uffff]/,M=Z.isReservedIdentifier||!1,L,B;function w(T,P){var E=T.next();if(G[E]){var y=G[E](T,P);if(y!==!1)return y}if(E=='"'||E=="'")return P.tokenize=b(E),P.tokenize(T,P);if(O.test(E)){if(T.backUp(1),T.match(H))return"number";T.next()}if(V.test(E))return L=E,null;if(E=="/"){if(T.eat("*"))return P.tokenize=d,d(T,P);if(T.eat("/"))return T.skipToEnd(),"comment"}if(R.test(E)){while(!T.match(/^\/[\/*]/,!1)&&T.eat(R));return"operator"}if(T.eatWhile(D),z)while(T.match(z))T.eatWhile(D);var f=T.current();if(m1(X,f)){if(m1(K,f))L="newstatement";if(m1(U,f))B=!0;return"keyword"}if(m1(Q,f))return"type";if(m1(Y,f)||M&&M(f)){if(m1(K,f))L="newstatement";return"builtin"}if(m1(q,f))return"atom";return"variable"}function b(T){return function(P,E){var y=!1,f,o=!1;while((f=P.next())!=null){if(f==T&&!y){o=!0;break}y=!y&&f=="\\"}if(o||!(y||W))E.tokenize=null;return"string"}}function d(T,P){var E=!1,y;while(y=T.next()){if(y=="/"&&E){P.tokenize=null;break}E=y=="*"}return"comment"}function a(T,P){if(Z.typeFirstDefinitions&&T.eol()&&I6(P.context))P.typeAtEndOfLine=fQ(T,P,T.pos)}return{name:Z.name,startState:function(T){return{tokenize:null,context:new F6(-T,0,"top",null,!1),indented:0,startOfLine:!0,prevToken:null}},token:function(T,P){var E=P.context;if(T.sol()){if(E.align==null)E.align=!1;P.indented=T.indentation(),P.startOfLine=!0}if(T.eatSpace())return a(T,P),null;L=B=null;var y=(P.tokenize||w)(T,P);if(y=="comment"||y=="meta")return y;if(E.align==null)E.align=!0;if(L==";"||L==":"||L==","&&T.match(/^\s*(?:\/\/.*)?$/,!1))while(P.context.type=="statement")o4(P);else if(L=="{")x8(P,T.column(),"}");else if(L=="[")x8(P,T.column(),"]");else if(L=="(")x8(P,T.column(),")");else if(L=="}"){while(E.type=="statement")E=o4(P);if(E.type=="}")E=o4(P);while(E.type=="statement")E=o4(P)}else if(L==E.type)o4(P);else if(j&&((E.type=="}"||E.type=="top")&&L!=";"||E.type=="statement"&&L=="newstatement"))x8(P,T.column(),"statement",T.current());if(y=="variable"&&(P.prevToken=="def"||Z.typeFirstDefinitions&&fQ(T,P,T.start)&&I6(P.context)&&T.match(/^\s*\(/,!1)))y="def";if(G.token){var f=G.token(T,P,y);if(f!==void 0)y=f}if(y=="def"&&Z.styleDefs===!1)y="variable";return P.startOfLine=!1,P.prevToken=B?"def":y||L,a(T,P),y},indent:function(T,P,E){if(T.tokenize!=w&&T.tokenize!=null||T.typeAtEndOfLine&&I6(T.context))return null;var y=T.context,f=P&&P.charAt(0),o=f==y.type;if(y.type=="statement"&&f=="}")y=y.prev;if(Z.dontIndentStatements)while(y.type=="statement"&&Z.dontIndentStatements.test(y.info))y=y.prev;if(G.indent){var R0=G.indent(T,y,P,E.unit);if(typeof R0=="number")return R0}var P0=y.prev&&y.prev.info=="switch";if(Z.allmanIndentation&&/[{(]/.test(f)){while(y.type!="top"&&y.type!="}")y=y.prev;return y.indented}if(y.type=="statement")return y.indented+(f=="{"?0:$||E.unit);if(y.align&&(!J||y.type!=")"))return y.column+(o?0:1);if(y.type==")"&&!o)return y.indented+($||E.unit);return y.indented+(o?0:E.unit)+(!o&&P0&&!/^(?:case|default)\b/.test(P)?E.unit:0)},languageData:{indentOnInput:_?/^\s*(?:case .*?:|default:|\{\}?|\})$/:/^\s*[{}]$/,commentTokens:{line:"//",block:{open:"/*",close:"*/"}},autocomplete:Object.keys(X).concat(Object.keys(Q)).concat(Object.keys(Y)).concat(Object.keys(q)),...Z.languageData}}}function v(Z){var $={},J=Z.split(" ");for(var X=0;X<J.length;++X)$[J[X]]=!0;return $}function m1(Z,$){if(typeof Z==="function")return Z($);else return Z.propertyIsEnumerable($)}var e4="auto if break case register continue return default do sizeof static else struct switch extern typedef union for goto while enum const volatile inline restrict asm fortran",lQ="alignas alignof and and_eq audit axiom bitand bitor catch class compl concept constexpr const_cast decltype delete dynamic_cast explicit export final friend import module mutable namespace new noexcept not not_eq operator or or_eq override private protected public reinterpret_cast requires static_assert static_cast template this thread_local throw try typeid typename using virtual xor xor_eq",dQ="bycopy byref in inout oneway out self super atomic nonatomic retain copy readwrite readonly strong weak assign typeof nullable nonnull null_resettable _cmd @interface @implementation @end @protocol @encode @property @synthesize @dynamic @class @public @package @private @protected @required @optional @try @catch @finally @import @selector @encode @defs @synchronized @autoreleasepool @compatibility_alias @available",cQ="FOUNDATION_EXPORT FOUNDATION_EXTERN NS_INLINE NS_FORMAT_FUNCTION  NS_RETURNS_RETAINEDNS_ERROR_ENUM NS_RETURNS_NOT_RETAINED NS_RETURNS_INNER_POINTER NS_DESIGNATED_INITIALIZER NS_ENUM NS_OPTIONS NS_REQUIRES_NIL_TERMINATION NS_ASSUME_NONNULL_BEGIN NS_ASSUME_NONNULL_END NS_SWIFT_NAME NS_REFINED_FOR_SWIFT",J_=v("int long char short double float unsigned signed void bool"),X_=v("SEL instancetype id Class Protocol BOOL");function Z9(Z){return m1(J_,Z)||/.+_t$/.test(Z)}function sQ(Z){return Z9(Z)||m1(X_,Z)}var $9="case do else for if switch while struct enum union",h8="struct enum union";function $7(Z,$){if(!$.startOfLine)return!1;for(var J,X=null;J=Z.peek();){if(J=="\\"&&Z.match(/^.$/)){X=$7;break}else if(J=="/"&&Z.match(/^\/[\/\*]/,!1))break;Z.next()}return $.tokenize=X,"meta"}function v8(Z,$){if($.prevToken=="type")return"type";return!1}function u8(Z){if(!Z||Z.length<2)return!1;if(Z[0]!="_")return!1;return Z[1]=="_"||Z[1]!==Z[1].toLowerCase()}function M0(Z){return Z.eatWhile(/[\w\.']/),"number"}function Z7(Z,$){if(Z.backUp(1),Z.match(/^(?:R|u8R|uR|UR|LR)/)){var J=Z.match(/^"([^\s\\()]{0,16})\(/);if(!J)return!1;return $.cpp11RawStringDelim=J[1],$.tokenize=pQ,pQ(Z,$)}if(Z.match(/^(?:u8|u|U|L)/)){if(Z.match(/^["']/,!1))return"string";return!1}return Z.next(),!1}function nQ(Z){var $=/(\w+)::~?(\w+)$/.exec(Z);return $&&$[1]==$[2]}function gQ(Z,$){var J;while((J=Z.next())!=null)if(J=='"'&&!Z.eat('"')){$.tokenize=null;break}return"string"}function pQ(Z,$){var J=$.cpp11RawStringDelim.replace(/[^\w\s]/g,"\\$&"),X=Z.match(new RegExp(".*?\\)"+J+'"'));if(X)$.tokenize=null;else Z.skipToEnd();return"string"}var iQ=e0({name:"c",keywords:v(e4),types:Z9,blockKeywords:v($9),defKeywords:v(h8),typeFirstDefinitions:!0,atoms:v("NULL true false"),isReservedIdentifier:u8,hooks:{"#":$7,"*":v8}}),wO=e0({name:"cpp",keywords:v(e4+" "+lQ),types:Z9,blockKeywords:v($9+" class try catch"),defKeywords:v(h8+" class namespace"),typeFirstDefinitions:!0,atoms:v("true false NULL nullptr"),dontIndentStatements:/^template$/,isIdentifierChar:/[\w\$_~\xa1-\uffff]/,isReservedIdentifier:u8,hooks:{"#":$7,"*":v8,u:Z7,U:Z7,L:Z7,R:Z7,"0":M0,"1":M0,"2":M0,"3":M0,"4":M0,"5":M0,"6":M0,"7":M0,"8":M0,"9":M0,token:function(Z,$,J){if(J=="variable"&&Z.peek()=="("&&($.prevToken==";"||$.prevToken==null||$.prevToken=="}")&&nQ(Z.current()))return"def"}},namespaceSeparator:"::"}),hO=e0({name:"java",keywords:v("abstract assert break case catch class const continue default do else enum extends final finally for goto if implements import instanceof interface native new package private protected public return static strictfp super switch synchronized this throw throws transient try volatile while @interface"),types:v("var byte short int long float double boolean char void Boolean Byte Character Double Float Integer Long Number Object Short String StringBuffer StringBuilder Void"),blockKeywords:v("catch class do else finally for if switch try while"),defKeywords:v("class interface enum @interface"),typeFirstDefinitions:!0,atoms:v("true false null"),number:/^(?:0x[a-f\d_]+|0b[01_]+|(?:[\d_]+\.?\d*|\.\d+)(?:e[-+]?[\d_]+)?)(u|ll?|l|f)?/i,hooks:{"@":function(Z){if(Z.match("interface",!1))return!1;return Z.eatWhile(/[\w\$_]/),"meta"},'"':function(Z,$){if(!Z.match(/""$/))return!1;return $.tokenize=aQ,$.tokenize(Z,$)}}}),vO=e0({name:"csharp",keywords:v("abstract as async await base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in init interface internal is lock namespace new operator out override params private protected public readonly record ref required return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),types:v("Action Boolean Byte Char DateTime DateTimeOffset Decimal Double Func Guid Int16 Int32 Int64 Object SByte Single String Task TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),blockKeywords:v("catch class do else finally for foreach if struct switch try while"),defKeywords:v("class interface namespace record struct var"),typeFirstDefinitions:!0,atoms:v("true false null"),hooks:{"@":function(Z,$){if(Z.eat('"'))return $.tokenize=gQ,gQ(Z,$);return Z.eatWhile(/[\w\$_]/),"meta"}}});function aQ(Z,$){var J=!1;while(!Z.eol()){if(!J&&Z.match('"""')){$.tokenize=null;break}J=Z.next()=="\\"&&!J}return"string"}function t4(Z){return function($,J){var X;while(X=$.next())if(X=="*"&&$.eat("/"))if(Z==1){J.tokenize=null;break}else return J.tokenize=t4(Z-1),J.tokenize($,J);else if(X=="/"&&$.eat("*"))return J.tokenize=t4(Z+1),J.tokenize($,J);return"comment"}}var uO=e0({name:"scala",keywords:v("abstract case catch class def do else extends final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try type val var while with yield _ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble"),types:v("AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Int Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),multiLineStrings:!0,blockKeywords:v("catch class enum do else finally for forSome if match switch try while"),defKeywords:v("class enum def object package trait type val var"),atoms:v("true false null"),indentStatements:!1,indentSwitch:!1,isOperatorChar:/[+\-*&%=<>!?|\/#:@]/,hooks:{"@":function(Z){return Z.eatWhile(/[\w\$_]/),"meta"},'"':function(Z,$){if(!Z.match('""'))return!1;return $.tokenize=aQ,$.tokenize(Z,$)},"'":function(Z){if(Z.match(/^(\\[^'\s]+|[^\\'])'/))return"character";return Z.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},"=":function(Z,$){var J=$.context;if(J.type=="}"&&J.align&&Z.eat(">"))return $.context=new F6(J.indented,J.column,J.type,J.info,null,J.prev),"operator";else return!1},"/":function(Z,$){if(!Z.eat("*"))return!1;return $.tokenize=t4(1),$.tokenize(Z,$)}},languageData:{closeBrackets:{brackets:["(","[","{","'",'"','"""']}}});function Q_(Z){return function($,J){var X=!1,Q,Y=!1;while(!$.eol()){if(!Z&&!X&&$.match('"')){Y=!0;break}if(Z&&$.match('"""')){Y=!0;break}if(Q=$.next(),!X&&Q=="$"&&$.match("{"))$.skipTo("}");X=!X&&Q=="\\"&&!Z}if(Y||!Z)J.tokenize=null;return"string"}}var mO=e0({name:"kotlin",keywords:v("package as typealias class interface this super val operator var fun for is in This throw return annotation break continue object if else while do try when !in !is as? file import where by get set abstract enum open inner override private public internal protected catch finally out final vararg reified dynamic companion constructor init sealed field property receiver param sparam lateinit data inline noinline tailrec external annotation crossinline const operator infix suspend actual expect setparam"),types:v("Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void Annotation Any BooleanArray ByteArray Char CharArray DeprecationLevel DoubleArray Enum FloatArray Function Int IntArray Lazy LazyThreadSafetyMode LongArray Nothing ShortArray Unit"),intendSwitch:!1,indentStatements:!1,multiLineStrings:!0,number:/^(?:0x[a-f\d_]+|0b[01_]+|(?:[\d_]+(\.\d+)?|\.\d+)(?:e[-+]?[\d_]+)?)(ul?|l|f)?/i,blockKeywords:v("catch class do else finally for if where try while enum"),defKeywords:v("class val var object interface fun"),atoms:v("true false null this"),hooks:{"@":function(Z){return Z.eatWhile(/[\w\$_]/),"meta"},"*":function(Z,$){return $.prevToken=="."?"variable":"operator"},'"':function(Z,$){return $.tokenize=Q_(Z.match('""')),$.tokenize(Z,$)},"/":function(Z,$){if(!Z.eat("*"))return!1;return $.tokenize=t4(1),$.tokenize(Z,$)},indent:function(Z,$,J,X){var Q=J&&J.charAt(0);if((Z.prevToken=="}"||Z.prevToken==")")&&J=="")return Z.indented;if(Z.prevToken=="operator"&&J!="}"&&Z.context.type!="}"||Z.prevToken=="variable"&&Q=="."||(Z.prevToken=="}"||Z.prevToken==")")&&Q==".")return X*2+$.indented;if($.align&&$.type=="}")return $.indented+(Z.context.type==(J||"").charAt(0)?0:X)}},languageData:{closeBrackets:{brackets:["(","[","{","'",'"','"""']}}}),fO=e0({name:"shader",keywords:v("sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow const attribute uniform varying break continue discard return for while do if else struct in out inout"),types:v("float int bool void vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 mat2 mat3 mat4"),blockKeywords:v("for while do if else struct"),builtin:v("radians degrees sin cos tan asin acos atan pow exp log exp2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize ftransform faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not texture1D texture1DProj texture1DLod texture1DProjLod texture2D texture2DProj texture2DLod texture2DProjLod texture3D texture3DProj texture3DLod texture3DProjLod textureCube textureCubeLod shadow1D shadow2D shadow1DProj shadow2DProj shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod dFdx dFdy fwidth noise1 noise2 noise3 noise4"),atoms:v("true false gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_FogCoord gl_PointCoord gl_Position gl_PointSize gl_ClipVertex gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord gl_FragCoord gl_FrontFacing gl_FragData gl_FragDepth gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse gl_TextureMatrixTranspose gl_ModelViewMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixInverseTranspose gl_TextureMatrixInverseTranspose gl_NormalScale gl_DepthRange gl_ClipPlane gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel gl_FrontLightModelProduct gl_BackLightModelProduct gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ gl_FogParameters gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits gl_MaxDrawBuffers"),indentSwitch:!1,hooks:{"#":$7}}),gO=e0({name:"nesc",keywords:v(e4+" as atomic async call command component components configuration event generic implementation includes interface module new norace nx_struct nx_union post provides signal task uses abstract extends"),types:Z9,blockKeywords:v($9),atoms:v("null true false"),hooks:{"#":$7}}),pO=e0({name:"objectivec",keywords:v(e4+" "+dQ),types:sQ,builtin:v(cQ),blockKeywords:v($9+" @synthesize @try @catch @finally @autoreleasepool @synchronized"),defKeywords:v(h8+" @interface @implementation @protocol @class"),dontIndentStatements:/^@.*$/,typeFirstDefinitions:!0,atoms:v("YES NO NULL Nil nil true false nullptr"),isReservedIdentifier:u8,hooks:{"#":$7,"*":v8}}),lO=e0({name:"objectivecpp",keywords:v(e4+" "+dQ+" "+lQ),types:sQ,builtin:v(cQ),blockKeywords:v($9+" @synthesize @try @catch @finally @autoreleasepool @synchronized class try catch"),defKeywords:v(h8+" @interface @implementation @protocol @class class namespace"),dontIndentStatements:/^@.*$|^template$/,typeFirstDefinitions:!0,atoms:v("YES NO NULL Nil nil true false nullptr"),isReservedIdentifier:u8,hooks:{"#":$7,"*":v8,u:Z7,U:Z7,L:Z7,R:Z7,"0":M0,"1":M0,"2":M0,"3":M0,"4":M0,"5":M0,"6":M0,"7":M0,"8":M0,"9":M0,token:function(Z,$,J){if(J=="variable"&&Z.peek()=="("&&($.prevToken==";"||$.prevToken==null||$.prevToken=="}")&&nQ(Z.current()))return"def"}},namespaceSeparator:"::"}),dO=e0({name:"squirrel",keywords:v("base break clone continue const default delete enum extends function in class foreach local resume return this throw typeof yield constructor instanceof static"),types:Z9,blockKeywords:v("case catch class else for foreach if switch try while"),defKeywords:v("function local class"),typeFirstDefinitions:!0,atoms:v("true false null"),hooks:{"#":$7}}),w8=null;function rQ(Z){return function($,J){var X=!1,Q,Y=!1;while(!$.eol()){if(!X&&$.match('"')&&(Z=="single"||$.match('""'))){Y=!0;break}if(!X&&$.match("``")){w8=rQ(Z),Y=!0;break}Q=$.next(),X=Z=="single"&&!X&&Q=="\\"}if(Y)J.tokenize=null;return"string"}}var cO=e0({name:"ceylon",keywords:v("abstracts alias assembly assert assign break case catch class continue dynamic else exists extends finally for function given if import in interface is let module new nonempty object of out outer package return satisfies super switch then this throw try value void while"),types:function(Z){var $=Z.charAt(0);return $===$.toUpperCase()&&$!==$.toLowerCase()},blockKeywords:v("case catch class dynamic else finally for function if interface module new object switch try while"),defKeywords:v("class dynamic function interface module object package value"),builtin:v("abstract actual aliased annotation by default deprecated doc final formal late license native optional sealed see serializable shared suppressWarnings tagged throws variable"),isPunctuationChar:/[\[\]{}\(\),;\:\.`]/,isOperatorChar:/[+\-*&%=<>!?|^~:\/]/,numberStart:/[\d#$]/,number:/^(?:#[\da-fA-F_]+|\$[01_]+|[\d_]+[kMGTPmunpf]?|[\d_]+\.[\d_]+(?:[eE][-+]?\d+|[kMGTPmunpf]|)|)/i,multiLineStrings:!0,typeFirstDefinitions:!0,atoms:v("true false null larger smaller equal empty finished"),indentSwitch:!1,styleDefs:!1,hooks:{"@":function(Z){return Z.eatWhile(/[\w\$_]/),"meta"},'"':function(Z,$){return $.tokenize=rQ(Z.match('""')?"triple":"single"),$.tokenize(Z,$)},"`":function(Z,$){if(!w8||!Z.match("`"))return!1;return $.tokenize=w8,w8=null,$.tokenize(Z,$)},"'":function(Z){if(Z.match(/^(\\[^'\s]+|[^\\'])'/))return"string.special";return Z.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},token:function(Z,$,J){if((J=="variable"||J=="type")&&$.prevToken==".")return"variableName.special"}},languageData:{closeBrackets:{brackets:["(","[","{","'",'"','"""']}}});function Y_(Z){(Z.interpolationStack||(Z.interpolationStack=[])).push(Z.tokenize)}function oQ(Z){return(Z.interpolationStack||(Z.interpolationStack=[])).pop()}function K_(Z){return Z.interpolationStack?Z.interpolationStack.length:0}function R6(Z,$,J,X){var Q=!1;if($.eat(Z))if($.eat(Z))Q=!0;else return"string";function Y(K,U){var q=!1;while(!K.eol()){if(!X&&!q&&K.peek()=="$")return Y_(U),U.tokenize=U_,"string";var G=K.next();if(G==Z&&!q&&(!Q||K.match(Z+Z))){U.tokenize=null;break}q=!X&&!q&&G=="\\"}return"string"}return J.tokenize=Y,Y($,J)}function U_(Z,$){if(Z.eat("$"),Z.eat("{"))$.tokenize=null;else $.tokenize=q_;return null}function q_(Z,$){return Z.eatWhile(/[\w_]/),$.tokenize=oQ($),"variable"}var sO=e0({name:"dart",keywords:v("this super static final const abstract class extends external factory implements mixin get native set typedef with enum throw rethrow assert break case continue default in return new deferred async await covariant try catch finally do else for if switch while import library export part of show hide is as extension on yield late required sealed base interface when inline"),blockKeywords:v("try catch finally do else for if switch while"),builtin:v("void bool num int double dynamic var String Null Never"),atoms:v("true false null"),number:/^(?:0x[a-f\d_]+|(?:[\d_]+\.?[\d_]*|\.[\d_]+)(?:e[-+]?[\d_]+)?)/i,hooks:{"@":function(Z){return Z.eatWhile(/[\w\$_\.]/),"meta"},"'":function(Z,$){return R6("'",Z,$,!1)},'"':function(Z,$){return R6('"',Z,$,!1)},r:function(Z,$){var J=Z.peek();if(J=="'"||J=='"')return R6(Z.next(),Z,$,!0);return!1},"}":function(Z,$){if(K_($)>0)return $.tokenize=oQ($),null;return!1},"/":function(Z,$){if(!Z.eat("*"))return!1;return $.tokenize=t4(1),$.tokenize(Z,$)},token:function(Z,$,J){if(J=="variable"){var X=RegExp("^[_$]*[A-Z][a-zA-Z0-9_$]*$","g");if(X.test(Z.current()))return"type"}}}});var tQ={CHECK:`<svg xmlns="http://www.w3.org/2000/svg"
    width="14" height="14" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"
    class="text-green-500">
    <polyline points="20 6 9 17 4 12"></polyline></svg>`};var D6=document.getElementById("ex-desc"),G_=document.getElementById("sidebar-list"),X9=document.getElementById("run-btn"),c0=document.getElementById("status"),e7=document.getElementById("console-output"),eQ=document.getElementById("sidebar-toggle"),J9=document.getElementById("sidebar-nav"),Z4=document.getElementById("tab-problem"),$4=document.getElementById("tab-code"),m8=document.getElementById("code-pane");function ZY(Z){if(Z==="problem")D6.classList.remove("hidden"),m8.classList.add("hidden"),m8.classList.remove("flex"),Z4.classList.add("text-white","border-brand-500"),Z4.classList.remove("text-slate-500","border-transparent"),$4.classList.add("text-slate-500","border-transparent"),$4.classList.remove("text-white","border-brand-500");else D6.classList.add("hidden"),m8.classList.remove("hidden"),m8.classList.add("flex"),$4.classList.add("text-white","border-brand-500"),$4.classList.remove("text-slate-500","border-transparent"),Z4.classList.add("text-slate-500","border-transparent"),Z4.classList.remove("text-white","border-brand-500")}if(Z4&&$4)Z4.addEventListener("click",()=>ZY("problem")),$4.addEventListener("click",()=>ZY("code"));var W_={code({text:Z,lang:$}){return`<div class="cm-static-code mb-4" data-lang="${$||""}">${Z}</div>`}};X0.use({renderer:W_});var j_=(Z)=>{return X0.parse(Z)};function __(){document.querySelectorAll(".cm-static-code").forEach(($)=>{let J=$.textContent||"",X=$.getAttribute("data-lang");$.textContent="",new C({state:n.create({doc:J,extensions:[n.readOnly.of(!0),C.editable.of(!1),P8,X==="ocaml"||!X?V7.define(B8):X==="c"||X==="clike"?V7.define(iQ):[],C.lineWrapping,C.theme({"&":{borderRadius:"4px",overflow:"hidden"},".cm-scroller":{overflow:"visible"}})]}),parent:$})})}function A6(){let{currentExerciseId:Z,completedIds:$}=X7.getState(),J=f1.find((Q)=>Q.id===Z);if(!J)return;let X=`<h1 class="text-3xl font-bold mb-6 text-white">${J.id} ${J.title}</h1>`;D6.innerHTML=X+`<div class="markdown-body">${j_(J.description)}</div>`,__(),G_.innerHTML=f1.map((Q)=>{let Y=$.includes(Q.id);return`<div class="nav-item cursor-pointer p-3 text-sm flex justify-between items-center transition-colors ${Q.id===Z?"bg-slate-800 text-white border-l-2 border-yellow-500":"text-slate-400 hover:text-slate-300"} ${Y?"opacity-40":""}"
                    onclick="location.hash='#${Q.id}'">
                  <span>${Q.id} ${Q.title}</span>
                  ${Y?tQ.CHECK:""}
                </div>`}).join(""),RQ(J.initialCode),e7.textContent="// Ready..."}async function z_(){if(!K6()){alert("Compiler is still loading... please wait.");return}let{currentExerciseId:Z}=X7.getState(),$=f1.find((X)=>X.id===Z);if(!$)return;c0.textContent="Running...",c0.className="text-yellow-500 text-xs font-mono animate-pulse",X9.disabled=!0,e7.textContent="";let J="";try{let X=FQ(),Q=X+`
`+($.testCode||""),Y=await DQ(Q);if(!Y.success){c0.textContent="FAILED",c0.className="text-red-500 font-bold text-xs",e7.textContent=Y.err||"Compilation/Runtime Error";return}if(J=Y.out,e7.textContent=J,J.includes("Test failed")||J.includes("Failure")){c0.textContent="FAILED",c0.className="text-red-500 font-bold text-xs";return}let K=$.validate(X,Y.out);if(K!==!0){c0.textContent="FAILED",c0.className="text-red-500 font-bold text-xs",e7.textContent+=`

${K}`;return}c0.textContent="PASSED",c0.className="text-green-500 font-bold text-xs",X7.getState().markComplete($.id),mQ({particleCount:100,spread:70,origin:{y:0.6}}),A6()}catch(X){c0.textContent="ERROR",c0.className="text-red-600 font-bold text-xs",e7.textContent="Runtime Error: "+X.message}finally{X9.disabled=!1}}function O_(){let Z=setInterval(()=>{if(K6())clearInterval(Z),c0.textContent="Compiler Ready",c0.className="text-green-600 text-xs font-mono",X9.classList.remove("opacity-50","cursor-not-allowed"),X9.disabled=!1},500)}X7.subscribe(A6);X9.addEventListener("click",z_);if(eQ&&J9)eQ.addEventListener("click",()=>{J9.classList.toggle("hidden"),J9.classList.toggle("flex"),J9.classList.toggle("lg:hidden"),J9.classList.toggle("lg:flex")});window.addEventListener("hashchange",()=>{let Z=window.location.hash.slice(1);if(f1.find(($)=>$.id===Z))X7.getState().setCurrent(Z)});O_();var V_=window.location.hash.slice(1)||f1[0].id;X7.getState().setCurrent(V_);A6();
