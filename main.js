var v8=(Z)=>{let $,J=new Set,Y=(G,W)=>{let j=typeof G==="function"?G($):G;if(!Object.is(j,$)){let _=$;$=(W!=null?W:typeof j!=="object"||j===null)?j:Object.assign({},$,j),J.forEach((z)=>z($,_))}},X=()=>$,U={setState:Y,getState:X,getInitialState:()=>q,subscribe:(G)=>{return J.add(G),()=>J.delete(G)}},q=$=Z(Y,X,U);return U},u8=(Z)=>Z?v8(Z):v8;function gQ(Z,$){let J;try{J=Z()}catch(X){return}return{getItem:(X)=>{var Q;let K=(q)=>{if(q===null)return null;return JSON.parse(q,$==null?void 0:$.reviver)},U=(Q=J.getItem(X))!=null?Q:null;if(U instanceof Promise)return U.then(K);return K(U)},setItem:(X,Q)=>J.setItem(X,JSON.stringify(Q,$==null?void 0:$.replacer)),removeItem:(X)=>J.removeItem(X)}}var r9=(Z)=>($)=>{try{let J=Z($);if(J instanceof Promise)return J;return{then(Y){return r9(Y)(J)},catch(Y){return this}}}catch(J){return{then(Y){return this},catch(Y){return r9(Y)(J)}}}},fQ=(Z,$)=>(J,Y,X)=>{let Q={storage:gQ(()=>localStorage),partialize:(O)=>O,version:0,merge:(O,H)=>({...H,...O}),...$},K=!1,U=new Set,q=new Set,G=Q.storage;if(!G)return Z((...O)=>{console.warn(`[zustand persist middleware] Unable to update item '${Q.name}', the given storage is currently unavailable.`),J(...O)},Y,X);let W=()=>{let O=Q.partialize({...Y()});return G.setItem(Q.name,{state:O,version:Q.version})},j=X.setState;X.setState=(O,H)=>{return j(O,H),W()};let _=Z((...O)=>{return J(...O),W()},Y,X);X.getInitialState=()=>_;let z,V=()=>{var O,H;if(!G)return;K=!1,U.forEach((D)=>{var M;return D((M=Y())!=null?M:_)});let F=((H=Q.onRehydrateStorage)==null?void 0:H.call(Q,(O=Y())!=null?O:_))||void 0;return r9(G.getItem.bind(G))(Q.name).then((D)=>{if(D)if(typeof D.version==="number"&&D.version!==Q.version){if(Q.migrate){let M=Q.migrate(D.state,D.version);if(M instanceof Promise)return M.then((A)=>[!0,A]);return[!0,M]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,D.state];return[!1,void 0]}).then((D)=>{var M;let[A,B]=D;if(z=Q.merge(B,(M=Y())!=null?M:_),J(z,!0),A)return W()}).then(()=>{F==null||F(z,void 0),z=Y(),K=!0,q.forEach((D)=>D(z))}).catch((D)=>{F==null||F(void 0,D)})};if(X.persist={setOptions:(O)=>{if(Q={...Q,...O},O.storage)G=O.storage},clearStorage:()=>{G==null||G.removeItem(Q.name)},getOptions:()=>Q,rehydrate:()=>V(),hasHydrated:()=>K,onHydrate:(O)=>{return U.add(O),()=>{U.delete(O)}},onFinishHydration:(O)=>{return q.add(O),()=>{q.delete(O)}}},!Q.skipHydration)V();return z||_},m8=fQ;var g8=`This series of exercises takes you through the basic syntax and concepts of OCaml. All exercies can be run right here in your browser.

We start with the basics and build up to the more advanced concepts. The objective is to write a (very simple) clone of FFTW in OCaml.

(Fun fact, while FFTW is a C library, the core \`genfft\` part is written in OCaml)

If you're coming from C-styled languages, the functional style might take some time to get used to. But no worries, we'll get there. For now, let's start with the classic "Hello World" program.

In OCaml, the \`print_endline\` function is used to print to the console. So, to print a message you would use something like:

\`\`\`ocaml
print_endline "some message";;
\`\`\`
Now, when writing code in an OCaml script, you generally use a single semicolon (;) to sequence commands or simply rely on the compiler's structure.

However, in the in-browser environment (like we're using here), you must use double semicolons (;;) to signal to the interpreter that you have finished your expression and want it evaluated.

Now, check if the code in the exercise window looks alright and fix it if needed. Then, you can user the \`Run\` button to run the code.

# Problem Statement

Use \`print_endline\` to print out "Hello, world!"

`;var f8=`print_endline "some message";;
`;var p8=`(* no tests needed here *)
`;var cQ={id:"1.1",title:"Hello World",description:g8,initialCode:f8,testCode:p8,validate:(Z,$)=>{let J=$.toLowerCase();if(J.includes("hello")&&J.includes("world"))return!0;return"Expected output to contain: hello and world"}},l8=cQ;var d8="Like most (good) languages, OCaml is a statically typed language. This means the compiler checks for type errors before your code ever runs. But unlike C or Java, instead of manually declaring the type of each variable, in OCaml, you can let the compiler infer the type of the variable for you.\n\n## Integers vs. Floats\n\nOcaml does this by a smart use of operators. For example, if you were adding two integers, you would use the standard operator:\n\n```ocaml\n1 + 2;;\n```\nBut, if you were adding an two floating point numbers, you would use the floating point operator:\n\n```ocaml\n1. +. 2.;;\n```\nNotice the `.` after the `+` operator. It tells the compiler that the operation is a floating point operation. f you try to use + with floats, or +. with ints, the compiler will complain.\n\nNow, to assign the result of such operation to a variable, we would use the let keyword. For example:\n\n```ocaml\nlet x = 1 + 2;;\n```\nSo think of the right hand side to be be an expression or a function that is evalauted and the result is then assigned to the variable on the left hand side (x in this case).\n\n## Functions\n\nThe `let` keyword can also be used to define functions. Typically in C-style languages you would define a function like this:\n\n```c\nfloat sum(float a, float b) {\n    return a + b;\n}\n```\nBut in OCaml, you could define a function like this:\n\n```ocaml\nlet sum a b = a +. b;;\n```\nHere `let` is the keyword that defines a function. Then, `sum` is the name of the function. Right after that, we have the arguments of the function i.e. `a` and `b` here.\n\nSo one way to read the function would be, the function `sum` takes two arguments `a` and `b` and the expression used to calculate the result is the one to the right of the `=` sign.\n\nOnce we define the function, we can use it like this:\n\n```ocaml\nlet x = sum 1. 2.;;\n```\nSo here, what we're doing is evaluate the function sum, which takes two arguments `1.` and `2.` and assigns the result to the variable `x`.\n\n# Problem Statement\n\nImplement a function average that takes two floating-point numbers and returns their average as a float.";var c8=`(* use the same function name and signature but fix the implementation *)

let average a b = (a + b);;

(* do not edit below this line *)

let x = average 1. 2.;;`;var s8=`let () =
  Tests.string_check string_of_float "average 2. 5. = 3.5" 3.5 (average 2. 5.);;`;var rQ={id:"1.2",title:"Integers and Floats",description:d8,initialCode:c8,testCode:s8,validate:()=>{return!0}},n8=rQ;var i8=`We looked a little bit at functions earlier. If you had been following along closely in the console window, you may have noticed the functions signatures being displayed.

Things like:

\`\`\`ocaml
val average : float -> float -> float
\`\`\`

In a C-style languages, the function signatures might look like this:

\`\`\`c
float average(float a, float b);
\`\`\`

So we know for sure that the function takes two inputs and returns a single output. But the same function when represented in OCaml has just a bunch of arrows pointing outwards. Why? This brings us to how OCaml, and broadly how functional programming languages view functions.

In OCaml, functions are first class citizens. This means that functions can be treated as values. So you can pass a function into another function or return a function from a function. We will get back to this idea in detail in the coming lessons.

# Problem Statement

You're given a \`square\` function. Your task is to complete the \`sum_of_squares\` function that reuses the square function to calculate the sum of the squares of two numbers.

(Don't forget to use the dot operator \`.\`)
`;var r8=`let square x = x *. x

(* do not edit above this line *)


let sum_of_squares a b = 


(* do not edit below this line *)

let hypotenuse a b = sqrt (sum_of_squares a b)`;var a8=`let () =
  Tests.string_check string_of_float "hypotenuse 3. 4. = 5." 5.0 (hypotenuse 3. 4.);;`;var eQ={id:"1.3",title:"Functions",description:i8,initialCode:r8,testCode:a8,validate:()=>{return!0}},o8=eQ;var t8="Conditionals are a standard control structure where we want a `if...then...else` like behaviour.\n\nThe Ocaml syntax for this is as follows:\n\n```ocaml\nif (condition) then  (expression_if_true) else (expression_if_false)\n```\n\nAlso, as with most things in OCaml, the `if...then...else` is an expression, not a statement. This means it evaluates to a value.\n\nFor example:\n\n```ocaml\nlet is_even x = if x mod 2 = 0 then true else false\n```\n\nThe `is_even` function here is evaluating the expression so if its result is assigned to a new variable with `let` it would be  `true` or `false`. So `is_even` will have a function signature of `int -> bool`.\n\n(Note: In OCaml, `mod` is the modulo operator. It is used to find the remainder of a division. You may have encountered it as the `%` operator in some other languages.)\n\n# Problem Statement\n\nWrite a function `abs_int` that takes an integer `x` and returns `-x` if `x` is negative and `x` otherwise.\n";var e8=`(* complete this function using conditionals *)

let abs_int x = 


(* do not edit below this line *)

let y = abs_int (-5);;`;var Z5=`let () =
  Tests.string_check string_of_int "abs_int (-25) = 25" 25 (abs_int (-25));;`;var YK={id:"1.4",title:"Conditionals",description:t8,initialCode:e8,testCode:Z5,validate:()=>{return!0}},$5=YK;var J5=`We looked at function signatures before like:

\`\`\`ocaml
float -> float -> float
\`\`\`
and how functions could be passed to other functions. Let's look under the hood to see how OCaml puts together functions.

In OCaml, when you write something like:

\`\`\`ocaml
let sum x y = x + y;;
\`\`\`
Here, technically, \`sum\` is not a function that takes two arguments. It builds up like this: When you call \`sum 1 2\`, what actually happens is, \`sum 1\` returns a new function that adds 1 to its argument.

Now, that new function is immediately called with \`2\` as its argument which gives the result \`3\`.

This is called currying (named after Haskell Curry) and what this means is technically, every function in Ocaml takes exactly one argument. So multi-argument functions are essentially just syntactic sugar.

But why do this? What benefits does this give us?

## Partial Application

Since multi-argument functions are built up via currying, if we provide fewer argumnets than a function expects, we get a perfectly usable function back.

Again, we can compare this with C-styled languages. If we had a multi-argument function, we would need all argumnets to call it.

Well, this idea, called partial application can be useful in creating specialised functions without wrappers as we saw earlier.

If we already had \`add\` and \`multiply\` functions, we could we could create specialised functions by partail application like this:

\`\`\`ocaml
let add x y = x + y;;
let multiply x y = x * y;;

(* now we can create specialized functions *)
let add_five = add 5;;
let multiply_by_two = multiply 2;;
\`\`\`
Notice how although \`add\` requires two arguments, we can define \`add_five\` as a derived function of add but it just adds 5 to its input.

While this example is a bit silly, the point was to intoduce the way in which currying and partial application work.

# Problem Statement

Given two functions, \`add\` and \`multiply\`, create a function \`add_thirteen\` and a function \`multiply_by_17\`
`;var Y5=`let add x y = x + y;;
let multiply x y = x * y;;

(* do not edit above *)


(* ?? your code goes in here *)


(* do not edit below *)

let num1 = add_thirteen 13;;
let num2 =  multiply_by_17 17;;
`;var X5=`let () =
  Tests.string_check string_of_int "add_thirteen 7 = 20" 20 (add_thirteen 7);
  Tests.string_check string_of_int "multiply_by_17 2 = 34" 34 (multiply_by_17 2);;
`;var UK={id:"2.1",title:"Currying",description:J5,initialCode:Y5,testCode:X5,validate:()=>!0},Q5=UK;var W6=[{id:"basics",title:"Basics",exercises:[l8,n8,o8,$5]},{id:"keyConcepts",title:"Key Concepts",exercises:[Q5]}],b0=W6.flatMap((Z)=>Z.exercises);var i0=u8()(m8((Z,$)=>({currentExerciseId:b0[0]?.id||"1.1",completedIds:[],userCode:{},markComplete:(J)=>{let{completedIds:Y}=$();if(!Y.includes(J))Z({completedIds:[...Y,J]})},setCurrent:(J)=>Z({currentExerciseId:J}),saveUserCode:(J,Y)=>Z({userCode:{...$().userCode,[J]:Y}})}),{name:"sowar-storage"}));var o9=[],G5=[];(()=>{let Z="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(($)=>$?parseInt($,36):1);for(let $=0,J=0;$<Z.length;$++)($%2?G5:o9).push(J=J+Z[$])})();function qK(Z){if(Z<768)return!1;for(let $=0,J=o9.length;;){let Y=$+J>>1;if(Z<o9[Y])J=Y;else if(Z>=G5[Y])$=Y+1;else return!0;if($==J)return!1}}function K5(Z){return Z>=127462&&Z<=127487}var U5=8205;function W5(Z,$,J=!0,Y=!0){return(J?j5:GK)(Z,$,Y)}function j5(Z,$,J){if($==Z.length)return $;if($&&_5(Z.charCodeAt($))&&z5(Z.charCodeAt($-1)))$--;let Y=a9(Z,$);$+=q5(Y);while($<Z.length){let X=a9(Z,$);if(Y==U5||X==U5||J&&qK(X))$+=q5(X),Y=X;else if(K5(X)){let Q=0,K=$-2;while(K>=0&&K5(a9(Z,K)))Q++,K-=2;if(Q%2==0)break;else $+=2}else break}return $}function GK(Z,$,J){while($>0){let Y=j5(Z,$-2,J);if(Y<$)return Y;$--}return 0}function a9(Z,$){let J=Z.charCodeAt($);if(!z5(J)||$+1==Z.length)return J;let Y=Z.charCodeAt($+1);if(!_5(Y))return J;return(J-55296<<10)+(Y-56320)+65536}function _5(Z){return Z>=56320&&Z<57344}function z5(Z){return Z>=55296&&Z<56320}function q5(Z){return Z<65536?1:2}class Z0{lineAt(Z){if(Z<0||Z>this.length)throw RangeError(`Invalid position ${Z} in document of length ${this.length}`);return this.lineInner(Z,!1,1,0)}line(Z){if(Z<1||Z>this.lines)throw RangeError(`Invalid line number ${Z} in ${this.lines}-line document`);return this.lineInner(Z,!0,1,0)}replace(Z,$,J){[Z,$]=y2(this,Z,$);let Y=[];if(this.decompose(0,Z,Y,2),J.length)J.decompose(0,J.length,Y,3);return this.decompose($,this.length,Y,1),y1.from(Y,this.length-($-Z)+J.length)}append(Z){return this.replace(this.length,this.length,Z)}slice(Z,$=this.length){[Z,$]=y2(this,Z,$);let J=[];return this.decompose(Z,$,J,0),y1.from(J,$-Z)}eq(Z){if(Z==this)return!0;if(Z.length!=this.length||Z.lines!=this.lines)return!1;let $=this.scanIdentical(Z,1),J=this.length-this.scanIdentical(Z,-1),Y=new C2(this),X=new C2(Z);for(let Q=$,K=$;;){if(Y.next(Q),X.next(Q),Q=0,Y.lineBreak!=X.lineBreak||Y.done!=X.done||Y.value!=X.value)return!1;if(K+=Y.value.length,Y.done||K>=J)return!0}}iter(Z=1){return new C2(this,Z)}iterRange(Z,$=this.length){return new q7(this,Z,$)}iterLines(Z,$){let J;if(Z==null)J=this.iter();else{if($==null)$=this.lines+1;let Y=this.line(Z).from;J=this.iterRange(Y,Math.max(Y,$==this.lines+1?this.length:$<=1?0:this.line($-1).to))}return new G7(J)}toString(){return this.sliceString(0)}toJSON(){let Z=[];return this.flatten(Z),Z}constructor(){}static of(Z){if(Z.length==0)throw RangeError("A document must have at least one line");if(Z.length==1&&!Z[0])return Z0.empty;return Z.length<=32?new D0(Z):y1.from(D0.split(Z,[]))}}class D0 extends Z0{constructor(Z,$=WK(Z)){super();this.text=Z,this.length=$}get lines(){return this.text.length}get children(){return null}lineInner(Z,$,J,Y){for(let X=0;;X++){let Q=this.text[X],K=Y+Q.length;if(($?J:K)>=Z)return new F5(Y,K,J,Q);Y=K+1,J++}}decompose(Z,$,J,Y){let X=Z<=0&&$>=this.length?this:new D0(O5(this.text,Z,$),Math.min($,this.length)-Math.max(0,Z));if(Y&1){let Q=J.pop(),K=O6(X.text,Q.text.slice(),0,X.length);if(K.length<=32)J.push(new D0(K,Q.length+X.length));else{let U=K.length>>1;J.push(new D0(K.slice(0,U)),new D0(K.slice(U)))}}else J.push(X)}replace(Z,$,J){if(!(J instanceof D0))return super.replace(Z,$,J);[Z,$]=y2(this,Z,$);let Y=O6(this.text,O6(J.text,O5(this.text,0,Z)),$),X=this.length+J.length-($-Z);if(Y.length<=32)return new D0(Y,X);return y1.from(D0.split(Y,[]),X)}sliceString(Z,$=this.length,J=`
`){[Z,$]=y2(this,Z,$);let Y="";for(let X=0,Q=0;X<=$&&Q<this.text.length;Q++){let K=this.text[Q],U=X+K.length;if(X>Z&&Q)Y+=J;if(Z<U&&$>X)Y+=K.slice(Math.max(0,Z-X),$-X);X=U+1}return Y}flatten(Z){for(let $ of this.text)Z.push($)}scanIdentical(){return 0}static split(Z,$){let J=[],Y=-1;for(let X of Z)if(J.push(X),Y+=X.length+1,J.length==32)$.push(new D0(J,Y)),J=[],Y=-1;if(Y>-1)$.push(new D0(J,Y));return $}}class y1 extends Z0{constructor(Z,$){super();this.children=Z,this.length=$,this.lines=0;for(let J of Z)this.lines+=J.lines}lineInner(Z,$,J,Y){for(let X=0;;X++){let Q=this.children[X],K=Y+Q.length,U=J+Q.lines-1;if(($?U:K)>=Z)return Q.lineInner(Z,$,J,Y);Y=K+1,J=U+1}}decompose(Z,$,J,Y){for(let X=0,Q=0;Q<=$&&X<this.children.length;X++){let K=this.children[X],U=Q+K.length;if(Z<=U&&$>=Q){let q=Y&((Q<=Z?1:0)|(U>=$?2:0));if(Q>=Z&&U<=$&&!q)J.push(K);else K.decompose(Z-Q,$-Q,J,q)}Q=U+1}}replace(Z,$,J){if([Z,$]=y2(this,Z,$),J.lines<this.lines)for(let Y=0,X=0;Y<this.children.length;Y++){let Q=this.children[Y],K=X+Q.length;if(Z>=X&&$<=K){let U=Q.replace(Z-X,$-X,J),q=this.lines-Q.lines+U.lines;if(U.lines<q>>4&&U.lines>q>>6){let G=this.children.slice();return G[Y]=U,new y1(G,this.length-($-Z)+J.length)}return super.replace(X,K,U)}X=K+1}return super.replace(Z,$,J)}sliceString(Z,$=this.length,J=`
`){[Z,$]=y2(this,Z,$);let Y="";for(let X=0,Q=0;X<this.children.length&&Q<=$;X++){let K=this.children[X],U=Q+K.length;if(Q>Z&&X)Y+=J;if(Z<U&&$>Q)Y+=K.sliceString(Z-Q,$-Q,J);Q=U+1}return Y}flatten(Z){for(let $ of this.children)$.flatten(Z)}scanIdentical(Z,$){if(!(Z instanceof y1))return 0;let J=0,[Y,X,Q,K]=$>0?[0,0,this.children.length,Z.children.length]:[this.children.length-1,Z.children.length-1,-1,-1];for(;;Y+=$,X+=$){if(Y==Q||X==K)return J;let U=this.children[Y],q=Z.children[X];if(U!=q)return J+U.scanIdentical(q,$);J+=U.length+1}}static from(Z,$=Z.reduce((J,Y)=>J+Y.length+1,-1)){let J=0;for(let _ of Z)J+=_.lines;if(J<32){let _=[];for(let z of Z)z.flatten(_);return new D0(_,$)}let Y=Math.max(32,J>>5),X=Y<<1,Q=Y>>1,K=[],U=0,q=-1,G=[];function W(_){let z;if(_.lines>X&&_ instanceof y1)for(let V of _.children)W(V);else if(_.lines>Q&&(U>Q||!U))j(),K.push(_);else if(_ instanceof D0&&U&&(z=G[G.length-1])instanceof D0&&_.lines+z.lines<=32)U+=_.lines,q+=_.length+1,G[G.length-1]=new D0(z.text.concat(_.text),z.length+1+_.length);else{if(U+_.lines>Y)j();U+=_.lines,q+=_.length+1,G.push(_)}}function j(){if(U==0)return;K.push(G.length==1?G[0]:y1.from(G,q)),q=-1,U=G.length=0}for(let _ of Z)W(_);return j(),K.length==1?K[0]:new y1(K,$)}}Z0.empty=new D0([""],0);function WK(Z){let $=-1;for(let J of Z)$+=J.length+1;return $}function O6(Z,$,J=0,Y=1e9){for(let X=0,Q=0,K=!0;Q<Z.length&&X<=Y;Q++){let U=Z[Q],q=X+U.length;if(q>=J){if(q>Y)U=U.slice(0,Y-X);if(X<J)U=U.slice(J-X);if(K)$[$.length-1]+=U,K=!1;else $.push(U)}X=q+1}return $}function O5(Z,$,J){return O6(Z,[""],$,J)}class C2{constructor(Z,$=1){this.dir=$,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[Z],this.offsets=[$>0?1:(Z instanceof D0?Z.text.length:Z.children.length)<<1]}nextInner(Z,$){this.done=this.lineBreak=!1;for(;;){let J=this.nodes.length-1,Y=this.nodes[J],X=this.offsets[J],Q=X>>1,K=Y instanceof D0?Y.text.length:Y.children.length;if(Q==($>0?K:0)){if(J==0)return this.done=!0,this.value="",this;if($>0)this.offsets[J-1]++;this.nodes.pop(),this.offsets.pop()}else if((X&1)==($>0?0:1)){if(this.offsets[J]+=$,Z==0)return this.lineBreak=!0,this.value=`
`,this;Z--}else if(Y instanceof D0){let U=Y.text[Q+($<0?-1:0)];if(this.offsets[J]+=$,U.length>Math.max(0,Z))return this.value=Z==0?U:$>0?U.slice(Z):U.slice(0,U.length-Z),this;Z-=U.length}else{let U=Y.children[Q+($<0?-1:0)];if(Z>U.length)Z-=U.length,this.offsets[J]+=$;else{if($<0)this.offsets[J]--;this.nodes.push(U),this.offsets.push($>0?1:(U instanceof D0?U.text.length:U.children.length)<<1)}}}}next(Z=0){if(Z<0)this.nextInner(-Z,-this.dir),Z=this.value.length;return this.nextInner(Z,this.dir)}}class q7{constructor(Z,$,J){this.value="",this.done=!1,this.cursor=new C2(Z,$>J?-1:1),this.pos=$>J?Z.length:0,this.from=Math.min($,J),this.to=Math.max($,J)}nextInner(Z,$){if($<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;Z+=Math.max(0,$<0?this.pos-this.to:this.from-this.pos);let J=$<0?this.pos-this.from:this.to-this.pos;if(Z>J)Z=J;J-=Z;let{value:Y}=this.cursor.next(Z);return this.pos+=(Y.length+Z)*$,this.value=Y.length<=J?Y:$<0?Y.slice(Y.length-J):Y.slice(0,J),this.done=!this.value,this}next(Z=0){if(Z<0)Z=Math.max(Z,this.from-this.pos);else if(Z>0)Z=Math.min(Z,this.to-this.pos);return this.nextInner(Z,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class G7{constructor(Z){this.inner=Z,this.afterBreak=!0,this.value="",this.done=!1}next(Z=0){let{done:$,lineBreak:J,value:Y}=this.inner.next(Z);if($&&this.afterBreak)this.value="",this.afterBreak=!1;else if($)this.done=!0,this.value="";else if(J)if(this.afterBreak)this.value="";else this.afterBreak=!0,this.next();else this.value=Y,this.afterBreak=!1;return this}get lineBreak(){return!1}}if(typeof Symbol<"u")Z0.prototype[Symbol.iterator]=function(){return this.iter()},C2.prototype[Symbol.iterator]=q7.prototype[Symbol.iterator]=G7.prototype[Symbol.iterator]=function(){return this};class F5{constructor(Z,$,J,Y){this.from=Z,this.to=$,this.number=J,this.text=Y}get length(){return this.to-this.from}}function y2(Z,$,J){return $=Math.max(0,Math.min(Z.length,$)),[$,Math.max($,Math.min(Z.length,J))]}function R0(Z,$,J=!0,Y=!0){return W5(Z,$,J,Y)}function jK(Z){return Z>=56320&&Z<57344}function _K(Z){return Z>=55296&&Z<56320}function S0(Z,$){let J=Z.charCodeAt($);if(!_K(J)||$+1==Z.length)return J;let Y=Z.charCodeAt($+1);if(!jK(Y))return J;return(J-55296<<10)+(Y-56320)+65536}function _3(Z){if(Z<=65535)return String.fromCharCode(Z);return Z-=65536,String.fromCharCode((Z>>10)+55296,(Z&1023)+56320)}function a0(Z){return Z<65536?1:2}var e9=/\r\n?|\n/,k0=function(Z){return Z[Z.Simple=0]="Simple",Z[Z.TrackDel=1]="TrackDel",Z[Z.TrackBefore=2]="TrackBefore",Z[Z.TrackAfter=3]="TrackAfter",Z}(k0||(k0={}));class H1{constructor(Z){this.sections=Z}get length(){let Z=0;for(let $=0;$<this.sections.length;$+=2)Z+=this.sections[$];return Z}get newLength(){let Z=0;for(let $=0;$<this.sections.length;$+=2){let J=this.sections[$+1];Z+=J<0?this.sections[$]:J}return Z}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(Z){for(let $=0,J=0,Y=0;$<this.sections.length;){let X=this.sections[$++],Q=this.sections[$++];if(Q<0)Z(J,Y,X),Y+=X;else Y+=Q;J+=X}}iterChangedRanges(Z,$=!1){Z7(this,Z,$)}get invertedDesc(){let Z=[];for(let $=0;$<this.sections.length;){let J=this.sections[$++],Y=this.sections[$++];if(Y<0)Z.push(J,Y);else Z.push(Y,J)}return new H1(Z)}composeDesc(Z){return this.empty?Z:Z.empty?this:I5(this,Z)}mapDesc(Z,$=!1){return Z.empty?this:$7(this,Z,$)}mapPos(Z,$=-1,J=k0.Simple){let Y=0,X=0;for(let Q=0;Q<this.sections.length;){let K=this.sections[Q++],U=this.sections[Q++],q=Y+K;if(U<0){if(q>Z)return X+(Z-Y);X+=K}else{if(J!=k0.Simple&&q>=Z&&(J==k0.TrackDel&&Y<Z&&q>Z||J==k0.TrackBefore&&Y<Z||J==k0.TrackAfter&&q>Z))return null;if(q>Z||q==Z&&$<0&&!K)return Z==Y||$<0?X:X+U;X+=U}Y=q}if(Z>Y)throw RangeError(`Position ${Z} is out of range for changeset of length ${Y}`);return X}touchesRange(Z,$=Z){for(let J=0,Y=0;J<this.sections.length&&Y<=$;){let X=this.sections[J++],Q=this.sections[J++],K=Y+X;if(Q>=0&&Y<=$&&K>=Z)return Y<Z&&K>$?"cover":!0;Y=K}return!1}toString(){let Z="";for(let $=0;$<this.sections.length;){let J=this.sections[$++],Y=this.sections[$++];Z+=(Z?" ":"")+J+(Y>=0?":"+Y:"")}return Z}toJSON(){return this.sections}static fromJSON(Z){if(!Array.isArray(Z)||Z.length%2||Z.some(($)=>typeof $!="number"))throw RangeError("Invalid JSON representation of ChangeDesc");return new H1(Z)}static create(Z){return new H1(Z)}}class L0 extends H1{constructor(Z,$){super(Z);this.inserted=$}apply(Z){if(this.length!=Z.length)throw RangeError("Applying change set to a document with the wrong length");return Z7(this,($,J,Y,X,Q)=>Z=Z.replace(Y,Y+(J-$),Q),!1),Z}mapDesc(Z,$=!1){return $7(this,Z,$,!0)}invert(Z){let $=this.sections.slice(),J=[];for(let Y=0,X=0;Y<$.length;Y+=2){let Q=$[Y],K=$[Y+1];if(K>=0){$[Y]=K,$[Y+1]=Q;let U=Y>>1;while(J.length<U)J.push(Z0.empty);J.push(Q?Z.slice(X,X+Q):Z0.empty)}X+=Q}return new L0($,J)}compose(Z){return this.empty?Z:Z.empty?this:I5(this,Z,!0)}map(Z,$=!1){return Z.empty?this:$7(this,Z,$,!0)}iterChanges(Z,$=!1){Z7(this,Z,$)}get desc(){return H1.create(this.sections)}filter(Z){let $=[],J=[],Y=[],X=new b2(this);Z:for(let Q=0,K=0;;){let U=Q==Z.length?1e9:Z[Q++];while(K<U||K==U&&X.len==0){if(X.done)break Z;let G=Math.min(X.len,U-K);v0(Y,G,-1);let W=X.ins==-1?-1:X.off==0?X.ins:0;if(v0($,G,W),W>0)d1(J,$,X.text);X.forward(G),K+=G}let q=Z[Q++];while(K<q){if(X.done)break Z;let G=Math.min(X.len,q-K);v0($,G,-1),v0(Y,G,X.ins==-1?-1:X.off==0?X.ins:0),X.forward(G),K+=G}}return{changes:new L0($,J),filtered:H1.create(Y)}}toJSON(){let Z=[];for(let $=0;$<this.sections.length;$+=2){let J=this.sections[$],Y=this.sections[$+1];if(Y<0)Z.push(J);else if(Y==0)Z.push([J]);else Z.push([J].concat(this.inserted[$>>1].toJSON()))}return Z}static of(Z,$,J){let Y=[],X=[],Q=0,K=null;function U(G=!1){if(!G&&!Y.length)return;if(Q<$)v0(Y,$-Q,-1);let W=new L0(Y,X);K=K?K.compose(W.map(K)):W,Y=[],X=[],Q=0}function q(G){if(Array.isArray(G))for(let W of G)q(W);else if(G instanceof L0){if(G.length!=$)throw RangeError(`Mismatched change set length (got ${G.length}, expected ${$})`);U(),K=K?K.compose(G.map(K)):G}else{let{from:W,to:j=W,insert:_}=G;if(W>j||W<0||j>$)throw RangeError(`Invalid change range ${W} to ${j} (in doc of length ${$})`);let z=!_?Z0.empty:typeof _=="string"?Z0.of(_.split(J||e9)):_,V=z.length;if(W==j&&V==0)return;if(W<Q)U();if(W>Q)v0(Y,W-Q,-1);v0(Y,j-W,V),d1(X,Y,z),Q=j}}return q(Z),U(!K),K}static empty(Z){return new L0(Z?[Z,-1]:[],[])}static fromJSON(Z){if(!Array.isArray(Z))throw RangeError("Invalid JSON representation of ChangeSet");let $=[],J=[];for(let Y=0;Y<Z.length;Y++){let X=Z[Y];if(typeof X=="number")$.push(X,-1);else if(!Array.isArray(X)||typeof X[0]!="number"||X.some((Q,K)=>K&&typeof Q!="string"))throw RangeError("Invalid JSON representation of ChangeSet");else if(X.length==1)$.push(X[0],0);else{while(J.length<Y)J.push(Z0.empty);J[Y]=Z0.of(X.slice(1)),$.push(X[0],J[Y].length)}}return new L0($,J)}static createSet(Z,$){return new L0(Z,$)}}function v0(Z,$,J,Y=!1){if($==0&&J<=0)return;let X=Z.length-2;if(X>=0&&J<=0&&J==Z[X+1])Z[X]+=$;else if(X>=0&&$==0&&Z[X]==0)Z[X+1]+=J;else if(Y)Z[X]+=$,Z[X+1]+=J;else Z.push($,J)}function d1(Z,$,J){if(J.length==0)return;let Y=$.length-2>>1;if(Y<Z.length)Z[Z.length-1]=Z[Z.length-1].append(J);else{while(Z.length<Y)Z.push(Z0.empty);Z.push(J)}}function Z7(Z,$,J){let Y=Z.inserted;for(let X=0,Q=0,K=0;K<Z.sections.length;){let U=Z.sections[K++],q=Z.sections[K++];if(q<0)X+=U,Q+=U;else{let G=X,W=Q,j=Z0.empty;for(;;){if(G+=U,W+=q,q&&Y)j=j.append(Y[K-2>>1]);if(J||K==Z.sections.length||Z.sections[K+1]<0)break;U=Z.sections[K++],q=Z.sections[K++]}$(X,G,Q,W,j),X=G,Q=W}}}function $7(Z,$,J,Y=!1){let X=[],Q=Y?[]:null,K=new b2(Z),U=new b2($);for(let q=-1;;)if(K.done&&U.len||U.done&&K.len)throw Error("Mismatched change set lengths");else if(K.ins==-1&&U.ins==-1){let G=Math.min(K.len,U.len);v0(X,G,-1),K.forward(G),U.forward(G)}else if(U.ins>=0&&(K.ins<0||q==K.i||K.off==0&&(U.len<K.len||U.len==K.len&&!J))){let G=U.len;v0(X,U.ins,-1);while(G){let W=Math.min(K.len,G);if(K.ins>=0&&q<K.i&&K.len<=W){if(v0(X,0,K.ins),Q)d1(Q,X,K.text);q=K.i}K.forward(W),G-=W}U.next()}else if(K.ins>=0){let G=0,W=K.len;while(W)if(U.ins==-1){let j=Math.min(W,U.len);G+=j,W-=j,U.forward(j)}else if(U.ins==0&&U.len<W)W-=U.len,U.next();else break;if(v0(X,G,q<K.i?K.ins:0),Q&&q<K.i)d1(Q,X,K.text);q=K.i,K.forward(K.len-W)}else if(K.done&&U.done)return Q?L0.createSet(X,Q):H1.create(X);else throw Error("Mismatched change set lengths")}function I5(Z,$,J=!1){let Y=[],X=J?[]:null,Q=new b2(Z),K=new b2($);for(let U=!1;;)if(Q.done&&K.done)return X?L0.createSet(Y,X):H1.create(Y);else if(Q.ins==0)v0(Y,Q.len,0,U),Q.next();else if(K.len==0&&!K.done){if(v0(Y,0,K.ins,U),X)d1(X,Y,K.text);K.next()}else if(Q.done||K.done)throw Error("Mismatched change set lengths");else{let q=Math.min(Q.len2,K.len),G=Y.length;if(Q.ins==-1){let W=K.ins==-1?-1:K.off?0:K.ins;if(v0(Y,q,W,U),X&&W)d1(X,Y,K.text)}else if(K.ins==-1){if(v0(Y,Q.off?0:Q.len,q,U),X)d1(X,Y,Q.textBit(q))}else if(v0(Y,Q.off?0:Q.len,K.off?0:K.ins,U),X&&!K.off)d1(X,Y,K.text);U=(Q.ins>q||K.ins>=0&&K.len>q)&&(U||Y.length>G),Q.forward2(q),K.forward(q)}}class b2{constructor(Z){this.set=Z,this.i=0,this.next()}next(){let{sections:Z}=this.set;if(this.i<Z.length)this.len=Z[this.i++],this.ins=Z[this.i++];else this.len=0,this.ins=-2;this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:Z}=this.set,$=this.i-2>>1;return $>=Z.length?Z0.empty:Z[$]}textBit(Z){let{inserted:$}=this.set,J=this.i-2>>1;return J>=$.length&&!Z?Z0.empty:$[J].slice(this.off,Z==null?void 0:this.off+Z)}forward(Z){if(Z==this.len)this.next();else this.len-=Z,this.off+=Z}forward2(Z){if(this.ins==-1)this.forward(Z);else if(Z==this.ins)this.next();else this.ins-=Z,this.off+=Z}}class G2{constructor(Z,$,J){this.from=Z,this.to=$,this.flags=J}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let Z=this.flags&7;return Z==7?null:Z}get goalColumn(){let Z=this.flags>>6;return Z==16777215?void 0:Z}map(Z,$=-1){let J,Y;if(this.empty)J=Y=Z.mapPos(this.from,$);else J=Z.mapPos(this.from,1),Y=Z.mapPos(this.to,-1);return J==this.from&&Y==this.to?this:new G2(J,Y,this.flags)}extend(Z,$=Z){if(Z<=this.anchor&&$>=this.anchor)return L.range(Z,$);let J=Math.abs(Z-this.anchor)>Math.abs($-this.anchor)?Z:$;return L.range(this.anchor,J)}eq(Z,$=!1){return this.anchor==Z.anchor&&this.head==Z.head&&this.goalColumn==Z.goalColumn&&(!$||!this.empty||this.assoc==Z.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(Z){if(!Z||typeof Z.anchor!="number"||typeof Z.head!="number")throw RangeError("Invalid JSON representation for SelectionRange");return L.range(Z.anchor,Z.head)}static create(Z,$,J){return new G2(Z,$,J)}}class L{constructor(Z,$){this.ranges=Z,this.mainIndex=$}map(Z,$=-1){if(Z.empty)return this;return L.create(this.ranges.map((J)=>J.map(Z,$)),this.mainIndex)}eq(Z,$=!1){if(this.ranges.length!=Z.ranges.length||this.mainIndex!=Z.mainIndex)return!1;for(let J=0;J<this.ranges.length;J++)if(!this.ranges[J].eq(Z.ranges[J],$))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new L([this.main],0)}addRange(Z,$=!0){return L.create([Z].concat(this.ranges),$?0:this.mainIndex+1)}replaceRange(Z,$=this.mainIndex){let J=this.ranges.slice();return J[$]=Z,L.create(J,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((Z)=>Z.toJSON()),main:this.mainIndex}}static fromJSON(Z){if(!Z||!Array.isArray(Z.ranges)||typeof Z.main!="number"||Z.main>=Z.ranges.length)throw RangeError("Invalid JSON representation for EditorSelection");return new L(Z.ranges.map(($)=>G2.fromJSON($)),Z.main)}static single(Z,$=Z){return new L([L.range(Z,$)],0)}static create(Z,$=0){if(Z.length==0)throw RangeError("A selection needs at least one range");for(let J=0,Y=0;Y<Z.length;Y++){let X=Z[Y];if(X.empty?X.from<=J:X.from<J)return L.normalized(Z.slice(),$);J=X.to}return new L(Z,$)}static cursor(Z,$=0,J,Y){return G2.create(Z,Z,($==0?0:$<0?8:16)|(J==null?7:Math.min(6,J))|(Y!==null&&Y!==void 0?Y:16777215)<<6)}static range(Z,$,J,Y){let X=(J!==null&&J!==void 0?J:16777215)<<6|(Y==null?7:Math.min(6,Y));return $<Z?G2.create($,Z,48|X):G2.create(Z,$,($>Z?8:0)|X)}static normalized(Z,$=0){let J=Z[$];Z.sort((Y,X)=>Y.from-X.from),$=Z.indexOf(J);for(let Y=1;Y<Z.length;Y++){let X=Z[Y],Q=Z[Y-1];if(X.empty?X.from<=Q.to:X.from<Q.to){let K=Q.from,U=Math.max(X.to,Q.to);if(Y<=$)$--;Z.splice(--Y,2,X.anchor>X.head?L.range(U,K):L.range(K,U))}}return new L(Z,$)}}function D5(Z,$){for(let J of Z.ranges)if(J.to>$)throw RangeError("Selection points outside of document")}var W7=0;class S{constructor(Z,$,J,Y,X){this.combine=Z,this.compareInput=$,this.compare=J,this.isStatic=Y,this.id=W7++,this.default=Z([]),this.extensions=typeof X=="function"?X(this):X}get reader(){return this}static define(Z={}){return new S(Z.combine||(($)=>$),Z.compareInput||(($,J)=>$===J),Z.compare||(!Z.combine?j7:($,J)=>$===J),!!Z.static,Z.enables)}of(Z){return new q3([],this,0,Z)}compute(Z,$){if(this.isStatic)throw Error("Can't compute a static facet");return new q3(Z,this,1,$)}computeN(Z,$){if(this.isStatic)throw Error("Can't compute a static facet");return new q3(Z,this,2,$)}from(Z,$){if(!$)$=(J)=>J;return this.compute([Z],(J)=>$(J.field(Z)))}}function j7(Z,$){return Z==$||Z.length==$.length&&Z.every((J,Y)=>J===$[Y])}class q3{constructor(Z,$,J,Y){this.dependencies=Z,this.facet=$,this.type=J,this.value=Y,this.id=W7++}dynamicSlot(Z){var $;let J=this.value,Y=this.facet.compareInput,X=this.id,Q=Z[X]>>1,K=this.type==2,U=!1,q=!1,G=[];for(let W of this.dependencies)if(W=="doc")U=!0;else if(W=="selection")q=!0;else if(((($=Z[W.id])!==null&&$!==void 0?$:1)&1)==0)G.push(Z[W.id]);return{create(W){return W.values[Q]=J(W),1},update(W,j){if(U&&j.docChanged||q&&(j.docChanged||j.selection)||J7(W,G)){let _=J(W);if(K?!V5(_,W.values[Q],Y):!Y(_,W.values[Q]))return W.values[Q]=_,1}return 0},reconfigure:(W,j)=>{let _,z=j.config.address[X];if(z!=null){let V=N6(j,z);if(this.dependencies.every((O)=>{return O instanceof S?j.facet(O)===W.facet(O):O instanceof z0?j.field(O,!1)==W.field(O,!1):!0})||(K?V5(_=J(W),V,Y):Y(_=J(W),V)))return W.values[Q]=V,0}else _=J(W);return W.values[Q]=_,1}}}}function V5(Z,$,J){if(Z.length!=$.length)return!1;for(let Y=0;Y<Z.length;Y++)if(!J(Z[Y],$[Y]))return!1;return!0}function J7(Z,$){let J=!1;for(let Y of $)if(G3(Z,Y)&1)J=!0;return J}function zK(Z,$,J){let Y=J.map((q)=>Z[q.id]),X=J.map((q)=>q.type),Q=Y.filter((q)=>!(q&1)),K=Z[$.id]>>1;function U(q){let G=[];for(let W=0;W<Y.length;W++){let j=N6(q,Y[W]);if(X[W]==2)for(let _ of j)G.push(_);else G.push(j)}return $.combine(G)}return{create(q){for(let G of Y)G3(q,G);return q.values[K]=U(q),1},update(q,G){if(!J7(q,Q))return 0;let W=U(q);if($.compare(W,q.values[K]))return 0;return q.values[K]=W,1},reconfigure(q,G){let W=J7(q,Y),j=G.config.facets[$.id],_=G.facet($);if(j&&!W&&j7(J,j))return q.values[K]=_,0;let z=U(q);if($.compare(z,_))return q.values[K]=_,0;return q.values[K]=z,1}}}var j6=S.define({static:!0});class z0{constructor(Z,$,J,Y,X){this.id=Z,this.createF=$,this.updateF=J,this.compareF=Y,this.spec=X,this.provides=void 0}static define(Z){let $=new z0(W7++,Z.create,Z.update,Z.compare||((J,Y)=>J===Y),Z);if(Z.provide)$.provides=Z.provide($);return $}create(Z){let $=Z.facet(j6).find((J)=>J.field==this);return(($===null||$===void 0?void 0:$.create)||this.createF)(Z)}slot(Z){let $=Z[this.id]>>1;return{create:(J)=>{return J.values[$]=this.create(J),1},update:(J,Y)=>{let X=J.values[$],Q=this.updateF(X,Y);if(this.compareF(X,Q))return 0;return J.values[$]=Q,1},reconfigure:(J,Y)=>{let X=J.facet(j6),Q=Y.facet(j6),K;if((K=X.find((U)=>U.field==this))&&K!=Q.find((U)=>U.field==this))return J.values[$]=K.create(J),1;if(Y.config.address[this.id]!=null)return J.values[$]=Y.field(this),0;return J.values[$]=this.create(J),1}}}init(Z){return[this,j6.of({field:this,create:Z})]}get extension(){return this}}var q2={lowest:4,low:3,default:2,high:1,highest:0};function U3(Z){return($)=>new _7($,Z)}var R1={highest:U3(q2.highest),high:U3(q2.high),default:U3(q2.default),low:U3(q2.low),lowest:U3(q2.lowest)};class _7{constructor(Z,$){this.inner=Z,this.prec=$}}class k2{of(Z){return new V6(this,Z)}reconfigure(Z){return k2.reconfigure.of({compartment:this,extension:Z})}get(Z){return Z.config.compartments.get(this)}}class V6{constructor(Z,$){this.compartment=Z,this.inner=$}}class H6{constructor(Z,$,J,Y,X,Q){this.base=Z,this.compartments=$,this.dynamicSlots=J,this.address=Y,this.staticValues=X,this.facets=Q,this.statusTemplate=[];while(this.statusTemplate.length<J.length)this.statusTemplate.push(0)}staticFacet(Z){let $=this.address[Z.id];return $==null?Z.default:this.staticValues[$>>1]}static resolve(Z,$,J){let Y=[],X=Object.create(null),Q=new Map;for(let j of OK(Z,$,Q))if(j instanceof z0)Y.push(j);else(X[j.facet.id]||(X[j.facet.id]=[])).push(j);let K=Object.create(null),U=[],q=[];for(let j of Y)K[j.id]=q.length<<1,q.push((_)=>j.slot(_));let G=J===null||J===void 0?void 0:J.config.facets;for(let j in X){let _=X[j],z=_[0].facet,V=G&&G[j]||[];if(_.every((O)=>O.type==0))if(K[z.id]=U.length<<1|1,j7(V,_))U.push(J.facet(z));else{let O=z.combine(_.map((H)=>H.value));U.push(J&&z.compare(O,J.facet(z))?J.facet(z):O)}else{for(let O of _)if(O.type==0)K[O.id]=U.length<<1|1,U.push(O.value);else K[O.id]=q.length<<1,q.push((H)=>O.dynamicSlot(H));K[z.id]=q.length<<1,q.push((O)=>zK(O,z,_))}}let W=q.map((j)=>j(K));return new H6(Z,Q,W,K,U,X)}}function OK(Z,$,J){let Y=[[],[],[],[],[]],X=new Map;function Q(K,U){let q=X.get(K);if(q!=null){if(q<=U)return;let G=Y[q].indexOf(K);if(G>-1)Y[q].splice(G,1);if(K instanceof V6)J.delete(K.compartment)}if(X.set(K,U),Array.isArray(K))for(let G of K)Q(G,U);else if(K instanceof V6){if(J.has(K.compartment))throw RangeError("Duplicate use of compartment in extensions");let G=$.get(K.compartment)||K.inner;J.set(K.compartment,G),Q(G,U)}else if(K instanceof _7)Q(K.inner,K.prec);else if(K instanceof z0){if(Y[U].push(K),K.provides)Q(K.provides,U)}else if(K instanceof q3){if(Y[U].push(K),K.facet.extensions)Q(K.facet.extensions,q2.default)}else{let G=K.extension;if(!G)throw Error(`Unrecognized extension value in extension set (${K}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);Q(G,U)}}return Q(Z,q2.default),Y.reduce((K,U)=>K.concat(U))}function G3(Z,$){if($&1)return 2;let J=$>>1,Y=Z.status[J];if(Y==4)throw Error("Cyclic dependency between fields and/or facets");if(Y&2)return Y;Z.status[J]=4;let X=Z.computeSlot(Z,Z.config.dynamicSlots[J]);return Z.status[J]=2|X}function N6(Z,$){return $&1?Z.config.staticValues[$>>1]:Z.values[$>>1]}var L5=S.define(),Y7=S.define({combine:(Z)=>Z.some(($)=>$),static:!0}),M5=S.define({combine:(Z)=>Z.length?Z[0]:void 0,static:!0}),A5=S.define(),B5=S.define(),E5=S.define(),P5=S.define({combine:(Z)=>Z.length?Z[0]:!1});class o0{constructor(Z,$){this.type=Z,this.value=$}static define(){return new C5}}class C5{of(Z){return new o0(this,Z)}}class T5{constructor(Z){this.map=Z}of(Z){return new l(this,Z)}}class l{constructor(Z,$){this.type=Z,this.value=$}map(Z){let $=this.type.map(this.value,Z);return $===void 0?void 0:$==this.value?this:new l(this.type,$)}is(Z){return this.type==Z}static define(Z={}){return new T5(Z.map||(($)=>$))}static mapEffects(Z,$){if(!Z.length)return Z;let J=[];for(let Y of Z){let X=Y.map($);if(X)J.push(X)}return J}}l.reconfigure=l.define();l.appendConfig=l.define();class N0{constructor(Z,$,J,Y,X,Q){if(this.startState=Z,this.changes=$,this.selection=J,this.effects=Y,this.annotations=X,this.scrollIntoView=Q,this._doc=null,this._state=null,J)D5(J,$.newLength);if(!X.some((K)=>K.type==N0.time))this.annotations=X.concat(N0.time.of(Date.now()))}static create(Z,$,J,Y,X,Q){return new N0(Z,$,J,Y,X,Q)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){if(!this._state)this.startState.applyTransaction(this);return this._state}annotation(Z){for(let $ of this.annotations)if($.type==Z)return $.value;return}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(Z){let $=this.annotation(N0.userEvent);return!!($&&($==Z||$.length>Z.length&&$.slice(0,Z.length)==Z&&$[Z.length]=="."))}}N0.time=o0.define();N0.userEvent=o0.define();N0.addToHistory=o0.define();N0.remote=o0.define();function VK(Z,$){let J=[];for(let Y=0,X=0;;){let Q,K;if(Y<Z.length&&(X==$.length||$[X]>=Z[Y]))Q=Z[Y++],K=Z[Y++];else if(X<$.length)Q=$[X++],K=$[X++];else return J;if(!J.length||J[J.length-1]<Q)J.push(Q,K);else if(J[J.length-1]<K)J[J.length-1]=K}}function y5(Z,$,J){var Y;let X,Q,K;if(J)X=$.changes,Q=L0.empty($.changes.length),K=Z.changes.compose($.changes);else X=$.changes.map(Z.changes),Q=Z.changes.mapDesc($.changes,!0),K=Z.changes.compose(X);return{changes:K,selection:$.selection?$.selection.map(Q):(Y=Z.selection)===null||Y===void 0?void 0:Y.map(X),effects:l.mapEffects(Z.effects,X).concat(l.mapEffects($.effects,Q)),annotations:Z.annotations.length?Z.annotations.concat($.annotations):$.annotations,scrollIntoView:Z.scrollIntoView||$.scrollIntoView}}function X7(Z,$,J){let Y=$.selection,X=T2($.annotations);if($.userEvent)X=X.concat(N0.userEvent.of($.userEvent));return{changes:$.changes instanceof L0?$.changes:L0.of($.changes||[],J,Z.facet(M5)),selection:Y&&(Y instanceof L?Y:L.single(Y.anchor,Y.head)),effects:T2($.effects),annotations:X,scrollIntoView:!!$.scrollIntoView}}function b5(Z,$,J){let Y=X7(Z,$.length?$[0]:{},Z.doc.length);if($.length&&$[0].filter===!1)J=!1;for(let Q=1;Q<$.length;Q++){if($[Q].filter===!1)J=!1;let K=!!$[Q].sequential;Y=y5(Y,X7(Z,$[Q],K?Y.changes.newLength:Z.doc.length),K)}let X=N0.create(Z,Y.changes,Y.selection,Y.effects,Y.annotations,Y.scrollIntoView);return NK(J?HK(X):X)}function HK(Z){let $=Z.startState,J=!0;for(let X of $.facet(A5)){let Q=X(Z);if(Q===!1){J=!1;break}if(Array.isArray(Q))J=J===!0?Q:VK(J,Q)}if(J!==!0){let X,Q;if(J===!1)Q=Z.changes.invertedDesc,X=L0.empty($.doc.length);else{let K=Z.changes.filter(J);X=K.changes,Q=K.filtered.mapDesc(K.changes).invertedDesc}Z=N0.create($,X,Z.selection&&Z.selection.map(Q),l.mapEffects(Z.effects,Q),Z.annotations,Z.scrollIntoView)}let Y=$.facet(B5);for(let X=Y.length-1;X>=0;X--){let Q=Y[X](Z);if(Q instanceof N0)Z=Q;else if(Array.isArray(Q)&&Q.length==1&&Q[0]instanceof N0)Z=Q[0];else Z=b5($,T2(Q),!1)}return Z}function NK(Z){let $=Z.startState,J=$.facet(E5),Y=Z;for(let X=J.length-1;X>=0;X--){let Q=J[X](Z);if(Q&&Object.keys(Q).length)Y=y5(Y,X7($,Q,Z.changes.newLength),!0)}return Y==Z?Z:N0.create($,Z.changes,Z.selection,Y.effects,Y.annotations,Y.scrollIntoView)}var RK=[];function T2(Z){return Z==null?RK:Array.isArray(Z)?Z:[Z]}var K0=function(Z){return Z[Z.Word=0]="Word",Z[Z.Space=1]="Space",Z[Z.Other=2]="Other",Z}(K0||(K0={})),FK=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Q7;try{Q7=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(Z){}function IK(Z){if(Q7)return Q7.test(Z);for(let $=0;$<Z.length;$++){let J=Z[$];if(/\w/.test(J)||J>"Â€"&&(J.toUpperCase()!=J.toLowerCase()||FK.test(J)))return!0}return!1}function DK(Z){return($)=>{if(!/\S/.test($))return K0.Space;if(IK($))return K0.Word;for(let J=0;J<Z.length;J++)if($.indexOf(Z[J])>-1)return K0.Word;return K0.Other}}class i{constructor(Z,$,J,Y,X,Q){if(this.config=Z,this.doc=$,this.selection=J,this.values=Y,this.status=Z.statusTemplate.slice(),this.computeSlot=X,Q)Q._state=this;for(let K=0;K<this.config.dynamicSlots.length;K++)G3(this,K<<1);this.computeSlot=null}field(Z,$=!0){let J=this.config.address[Z.id];if(J==null){if($)throw RangeError("Field is not present in this state");return}return G3(this,J),N6(this,J)}update(...Z){return b5(this,Z,!0)}applyTransaction(Z){let $=this.config,{base:J,compartments:Y}=$;for(let K of Z.effects)if(K.is(k2.reconfigure)){if($)Y=new Map,$.compartments.forEach((U,q)=>Y.set(q,U)),$=null;Y.set(K.value.compartment,K.value.extension)}else if(K.is(l.reconfigure))$=null,J=K.value;else if(K.is(l.appendConfig))$=null,J=T2(J).concat(K.value);let X;if(!$)$=H6.resolve(J,Y,this),X=new i($,this.doc,this.selection,$.dynamicSlots.map(()=>null),(U,q)=>q.reconfigure(U,this),null).values;else X=Z.startState.values.slice();let Q=Z.startState.facet(Y7)?Z.newSelection:Z.newSelection.asSingle();new i($,Z.newDoc,Q,X,(K,U)=>U.update(K,Z),Z)}replaceSelection(Z){if(typeof Z=="string")Z=this.toText(Z);return this.changeByRange(($)=>({changes:{from:$.from,to:$.to,insert:Z},range:L.cursor($.from+Z.length)}))}changeByRange(Z){let $=this.selection,J=Z($.ranges[0]),Y=this.changes(J.changes),X=[J.range],Q=T2(J.effects);for(let K=1;K<$.ranges.length;K++){let U=Z($.ranges[K]),q=this.changes(U.changes),G=q.map(Y);for(let j=0;j<K;j++)X[j]=X[j].map(G);let W=Y.mapDesc(q,!0);X.push(U.range.map(W)),Y=Y.compose(G),Q=l.mapEffects(Q,G).concat(l.mapEffects(T2(U.effects),W))}return{changes:Y,selection:L.create(X,$.mainIndex),effects:Q}}changes(Z=[]){if(Z instanceof L0)return Z;return L0.of(Z,this.doc.length,this.facet(i.lineSeparator))}toText(Z){return Z0.of(Z.split(this.facet(i.lineSeparator)||e9))}sliceDoc(Z=0,$=this.doc.length){return this.doc.sliceString(Z,$,this.lineBreak)}facet(Z){let $=this.config.address[Z.id];if($==null)return Z.default;return G3(this,$),N6(this,$)}toJSON(Z){let $={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(Z)for(let J in Z){let Y=Z[J];if(Y instanceof z0&&this.config.address[Y.id]!=null)$[J]=Y.spec.toJSON(this.field(Z[J]),this)}return $}static fromJSON(Z,$={},J){if(!Z||typeof Z.doc!="string")throw RangeError("Invalid JSON representation for EditorState");let Y=[];if(J){for(let X in J)if(Object.prototype.hasOwnProperty.call(Z,X)){let Q=J[X],K=Z[X];Y.push(Q.init((U)=>Q.spec.fromJSON(K,U)))}}return i.create({doc:Z.doc,selection:L.fromJSON(Z.selection),extensions:$.extensions?Y.concat([$.extensions]):Y})}static create(Z={}){let $=H6.resolve(Z.extensions||[],new Map),J=Z.doc instanceof Z0?Z.doc:Z0.of((Z.doc||"").split($.staticFacet(i.lineSeparator)||e9)),Y=!Z.selection?L.single(0):Z.selection instanceof L?Z.selection:L.single(Z.selection.anchor,Z.selection.head);if(D5(Y,J.length),!$.staticFacet(Y7))Y=Y.asSingle();return new i($,J,Y,$.dynamicSlots.map(()=>null),(X,Q)=>Q.create(X),null)}get tabSize(){return this.facet(i.tabSize)}get lineBreak(){return this.facet(i.lineSeparator)||`
`}get readOnly(){return this.facet(P5)}phrase(Z,...$){for(let J of this.facet(i.phrases))if(Object.prototype.hasOwnProperty.call(J,Z)){Z=J[Z];break}if($.length)Z=Z.replace(/\$(\$|\d*)/g,(J,Y)=>{if(Y=="$")return"$";let X=+(Y||1);return!X||X>$.length?J:$[X-1]});return Z}languageDataAt(Z,$,J=-1){let Y=[];for(let X of this.facet(L5))for(let Q of X(this,$,J))if(Object.prototype.hasOwnProperty.call(Q,Z))Y.push(Q[Z]);return Y}charCategorizer(Z){let $=this.languageDataAt("wordChars",Z);return DK($.length?$[0]:"")}wordAt(Z){let{text:$,from:J,length:Y}=this.doc.lineAt(Z),X=this.charCategorizer(Z),Q=Z-J,K=Z-J;while(Q>0){let U=R0($,Q,!1);if(X($.slice(U,Q))!=K0.Word)break;Q=U}while(K<Y){let U=R0($,K);if(X($.slice(K,U))!=K0.Word)break;K=U}return Q==K?null:L.range(Q+J,K+J)}}i.allowMultipleSelections=Y7;i.tabSize=S.define({combine:(Z)=>Z.length?Z[0]:4});i.lineSeparator=M5;i.readOnly=P5;i.phrases=S.define({compare(Z,$){let J=Object.keys(Z),Y=Object.keys($);return J.length==Y.length&&J.every((X)=>Z[X]==$[X])}});i.languageData=L5;i.changeFilter=A5;i.transactionFilter=B5;i.transactionExtender=E5;k2.reconfigure=l.define();function u0(Z,$,J={}){let Y={};for(let X of Z)for(let Q of Object.keys(X)){let K=X[Q],U=Y[Q];if(U===void 0)Y[Q]=K;else if(U===K||K===void 0);else if(Object.hasOwnProperty.call(J,Q))Y[Q]=J[Q](U,K);else throw Error("Config merge conflict for field "+Q)}for(let X in $)if(Y[X]===void 0)Y[X]=$[X];return Y}class N1{eq(Z){return this==Z}range(Z,$=Z){return W3.create(Z,$,this)}}N1.prototype.startSide=N1.prototype.endSide=0;N1.prototype.point=!1;N1.prototype.mapMode=k0.TrackDel;function z7(Z,$){return Z==$||Z.constructor==$.constructor&&Z.eq($)}class W3{constructor(Z,$,J){this.from=Z,this.to=$,this.value=J}static create(Z,$,J){return new W3(Z,$,J)}}function K7(Z,$){return Z.from-$.from||Z.value.startSide-$.value.startSide}class O7{constructor(Z,$,J,Y){this.from=Z,this.to=$,this.value=J,this.maxPoint=Y}get length(){return this.to[this.to.length-1]}findIndex(Z,$,J,Y=0){let X=J?this.to:this.from;for(let Q=Y,K=X.length;;){if(Q==K)return Q;let U=Q+K>>1,q=X[U]-Z||(J?this.value[U].endSide:this.value[U].startSide)-$;if(U==Q)return q>=0?Q:K;if(q>=0)K=U;else Q=U+1}}between(Z,$,J,Y){for(let X=this.findIndex($,-1e9,!0),Q=this.findIndex(J,1e9,!1,X);X<Q;X++)if(Y(this.from[X]+Z,this.to[X]+Z,this.value[X])===!1)return!1}map(Z,$){let J=[],Y=[],X=[],Q=-1,K=-1;for(let U=0;U<this.value.length;U++){let q=this.value[U],G=this.from[U]+Z,W=this.to[U]+Z,j,_;if(G==W){let z=$.mapPos(G,q.startSide,q.mapMode);if(z==null)continue;if(j=_=z,q.startSide!=q.endSide){if(_=$.mapPos(G,q.endSide),_<j)continue}}else if(j=$.mapPos(G,q.startSide),_=$.mapPos(W,q.endSide),j>_||j==_&&q.startSide>0&&q.endSide<=0)continue;if((_-j||q.endSide-q.startSide)<0)continue;if(Q<0)Q=j;if(q.point)K=Math.max(K,_-j);J.push(q),Y.push(j-Q),X.push(_-Q)}return{mapped:J.length?new O7(Y,X,J,K):null,pos:Q}}}class r{constructor(Z,$,J,Y){this.chunkPos=Z,this.chunk=$,this.nextLayer=J,this.maxPoint=Y}static create(Z,$,J,Y){return new r(Z,$,J,Y)}get length(){let Z=this.chunk.length-1;return Z<0?0:Math.max(this.chunkEnd(Z),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let Z=this.nextLayer.size;for(let $ of this.chunk)Z+=$.value.length;return Z}chunkEnd(Z){return this.chunkPos[Z]+this.chunk[Z].length}update(Z){let{add:$=[],sort:J=!1,filterFrom:Y=0,filterTo:X=this.length}=Z,Q=Z.filter;if($.length==0&&!Q)return this;if(J)$=$.slice().sort(K7);if(this.isEmpty)return $.length?r.of($):this;let K=new V7(this,null,-1).goto(0),U=0,q=[],G=new r0;while(K.value||U<$.length)if(U<$.length&&(K.from-$[U].from||K.startSide-$[U].value.startSide)>=0){let W=$[U++];if(!G.addInner(W.from,W.to,W.value))q.push(W)}else if(K.rangeIndex==1&&K.chunkIndex<this.chunk.length&&(U==$.length||this.chunkEnd(K.chunkIndex)<$[U].from)&&(!Q||Y>this.chunkEnd(K.chunkIndex)||X<this.chunkPos[K.chunkIndex])&&G.addChunk(this.chunkPos[K.chunkIndex],this.chunk[K.chunkIndex]))K.nextChunk();else{if(!Q||Y>K.to||X<K.from||Q(K.from,K.to,K.value)){if(!G.addInner(K.from,K.to,K.value))q.push(W3.create(K.from,K.to,K.value))}K.next()}return G.finishInner(this.nextLayer.isEmpty&&!q.length?r.empty:this.nextLayer.update({add:q,filter:Q,filterFrom:Y,filterTo:X}))}map(Z){if(Z.empty||this.isEmpty)return this;let $=[],J=[],Y=-1;for(let Q=0;Q<this.chunk.length;Q++){let K=this.chunkPos[Q],U=this.chunk[Q],q=Z.touchesRange(K,K+U.length);if(q===!1)Y=Math.max(Y,U.maxPoint),$.push(U),J.push(Z.mapPos(K));else if(q===!0){let{mapped:G,pos:W}=U.map(K,Z);if(G)Y=Math.max(Y,G.maxPoint),$.push(G),J.push(W)}}let X=this.nextLayer.map(Z);return $.length==0?X:new r(J,$,X||r.empty,Y)}between(Z,$,J){if(this.isEmpty)return;for(let Y=0;Y<this.chunk.length;Y++){let X=this.chunkPos[Y],Q=this.chunk[Y];if($>=X&&Z<=X+Q.length&&Q.between(X,Z-X,$-X,J)===!1)return}this.nextLayer.between(Z,$,J)}iter(Z=0){return j3.from([this]).goto(Z)}get isEmpty(){return this.nextLayer==this}static iter(Z,$=0){return j3.from(Z).goto($)}static compare(Z,$,J,Y,X=-1){let Q=Z.filter((W)=>W.maxPoint>0||!W.isEmpty&&W.maxPoint>=X),K=$.filter((W)=>W.maxPoint>0||!W.isEmpty&&W.maxPoint>=X),U=H5(Q,K,J),q=new P2(Q,U,X),G=new P2(K,U,X);if(J.iterGaps((W,j,_)=>N5(q,W,G,j,_,Y)),J.empty&&J.length==0)N5(q,0,G,0,0,Y)}static eq(Z,$,J=0,Y){if(Y==null)Y=999999999;let X=Z.filter((G)=>!G.isEmpty&&$.indexOf(G)<0),Q=$.filter((G)=>!G.isEmpty&&Z.indexOf(G)<0);if(X.length!=Q.length)return!1;if(!X.length)return!0;let K=H5(X,Q),U=new P2(X,K,0).goto(J),q=new P2(Q,K,0).goto(J);for(;;){if(U.to!=q.to||!U7(U.active,q.active)||U.point&&(!q.point||!z7(U.point,q.point)))return!1;if(U.to>Y)return!0;U.next(),q.next()}}static spans(Z,$,J,Y,X=-1){let Q=new P2(Z,null,X).goto($),K=$,U=Q.openStart;for(;;){let q=Math.min(Q.to,J);if(Q.point){let G=Q.activeForPoint(Q.to),W=Q.pointFrom<$?G.length+1:Q.point.startSide<0?G.length:Math.min(G.length,U);Y.point(K,q,Q.point,G,W,Q.pointRank),U=Math.min(Q.openEnd(q),G.length)}else if(q>K)Y.span(K,q,Q.active,U),U=Q.openEnd(q);if(Q.to>J)return U+(Q.point&&Q.to>J?1:0);K=Q.to,Q.next()}}static of(Z,$=!1){let J=new r0;for(let Y of Z instanceof W3?[Z]:$?LK(Z):Z)J.add(Y.from,Y.to,Y.value);return J.finish()}static join(Z){if(!Z.length)return r.empty;let $=Z[Z.length-1];for(let J=Z.length-2;J>=0;J--)for(let Y=Z[J];Y!=r.empty;Y=Y.nextLayer)$=new r(Y.chunkPos,Y.chunk,$,Math.max(Y.maxPoint,$.maxPoint));return $}}r.empty=new r([],[],null,-1);function LK(Z){if(Z.length>1)for(let $=Z[0],J=1;J<Z.length;J++){let Y=Z[J];if(K7($,Y)>0)return Z.slice().sort(K7);$=Y}return Z}r.empty.nextLayer=r.empty;class r0{finishChunk(Z){if(this.chunks.push(new O7(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,Z)this.from=[],this.to=[],this.value=[]}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(Z,$,J){if(!this.addInner(Z,$,J))(this.nextLayer||(this.nextLayer=new r0)).add(Z,$,J)}addInner(Z,$,J){let Y=Z-this.lastTo||J.startSide-this.last.endSide;if(Y<=0&&(Z-this.lastFrom||J.startSide-this.last.startSide)<0)throw Error("Ranges must be added sorted by `from` position and `startSide`");if(Y<0)return!1;if(this.from.length==250)this.finishChunk(!0);if(this.chunkStart<0)this.chunkStart=Z;if(this.from.push(Z-this.chunkStart),this.to.push($-this.chunkStart),this.last=J,this.lastFrom=Z,this.lastTo=$,this.value.push(J),J.point)this.maxPoint=Math.max(this.maxPoint,$-Z);return!0}addChunk(Z,$){if((Z-this.lastTo||$.value[0].startSide-this.last.endSide)<0)return!1;if(this.from.length)this.finishChunk(!0);this.setMaxPoint=Math.max(this.setMaxPoint,$.maxPoint),this.chunks.push($),this.chunkPos.push(Z);let J=$.value.length-1;return this.last=$.value[J],this.lastFrom=$.from[J]+Z,this.lastTo=$.to[J]+Z,!0}finish(){return this.finishInner(r.empty)}finishInner(Z){if(this.from.length)this.finishChunk(!1);if(this.chunks.length==0)return Z;let $=r.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(Z):Z,this.setMaxPoint);return this.from=null,$}}function H5(Z,$,J){let Y=new Map;for(let Q of Z)for(let K=0;K<Q.chunk.length;K++)if(Q.chunk[K].maxPoint<=0)Y.set(Q.chunk[K],Q.chunkPos[K]);let X=new Set;for(let Q of $)for(let K=0;K<Q.chunk.length;K++){let U=Y.get(Q.chunk[K]);if(U!=null&&(J?J.mapPos(U):U)==Q.chunkPos[K]&&!(J===null||J===void 0?void 0:J.touchesRange(U,U+Q.chunk[K].length)))X.add(Q.chunk[K])}return X}class V7{constructor(Z,$,J,Y=0){this.layer=Z,this.skip=$,this.minPoint=J,this.rank=Y}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(Z,$=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(Z,$,!1),this}gotoInner(Z,$,J){while(this.chunkIndex<this.layer.chunk.length){let Y=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(Y)||this.layer.chunkEnd(this.chunkIndex)<Z||Y.maxPoint<this.minPoint))break;this.chunkIndex++,J=!1}if(this.chunkIndex<this.layer.chunk.length){let Y=this.layer.chunk[this.chunkIndex].findIndex(Z-this.layer.chunkPos[this.chunkIndex],$,!0);if(!J||this.rangeIndex<Y)this.setRangeIndex(Y)}this.next()}forward(Z,$){if((this.to-Z||this.endSide-$)<0)this.gotoInner(Z,$,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let Z=this.layer.chunkPos[this.chunkIndex],$=this.layer.chunk[this.chunkIndex],J=Z+$.from[this.rangeIndex];if(this.from=J,this.to=Z+$.to[this.rangeIndex],this.value=$.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(Z){if(Z==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)while(this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]))this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=Z}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(Z){return this.from-Z.from||this.startSide-Z.startSide||this.rank-Z.rank||this.to-Z.to||this.endSide-Z.endSide}}class j3{constructor(Z){this.heap=Z}static from(Z,$=null,J=-1){let Y=[];for(let X=0;X<Z.length;X++)for(let Q=Z[X];!Q.isEmpty;Q=Q.nextLayer)if(Q.maxPoint>=J)Y.push(new V7(Q,$,J,X));return Y.length==1?Y[0]:new j3(Y)}get startSide(){return this.value?this.value.startSide:0}goto(Z,$=-1e9){for(let J of this.heap)J.goto(Z,$);for(let J=this.heap.length>>1;J>=0;J--)t9(this.heap,J);return this.next(),this}forward(Z,$){for(let J of this.heap)J.forward(Z,$);for(let J=this.heap.length>>1;J>=0;J--)t9(this.heap,J);if((this.to-Z||this.value.endSide-$)<0)this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let Z=this.heap[0];if(this.from=Z.from,this.to=Z.to,this.value=Z.value,this.rank=Z.rank,Z.value)Z.next();t9(this.heap,0)}}}function t9(Z,$){for(let J=Z[$];;){let Y=($<<1)+1;if(Y>=Z.length)break;let X=Z[Y];if(Y+1<Z.length&&X.compare(Z[Y+1])>=0)X=Z[Y+1],Y++;if(J.compare(X)<0)break;Z[Y]=J,Z[$]=X,$=Y}}class P2{constructor(Z,$,J){this.minPoint=J,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=j3.from(Z,$,J)}goto(Z,$=-1e9){return this.cursor.goto(Z,$),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=Z,this.endSide=$,this.openStart=-1,this.next(),this}forward(Z,$){while(this.minActive>-1&&(this.activeTo[this.minActive]-Z||this.active[this.minActive].endSide-$)<0)this.removeActive(this.minActive);this.cursor.forward(Z,$)}removeActive(Z){_6(this.active,Z),_6(this.activeTo,Z),_6(this.activeRank,Z),this.minActive=R5(this.active,this.activeTo)}addActive(Z){let $=0,{value:J,to:Y,rank:X}=this.cursor;while($<this.activeRank.length&&(X-this.activeRank[$]||Y-this.activeTo[$])>0)$++;if(z6(this.active,$,J),z6(this.activeTo,$,Y),z6(this.activeRank,$,X),Z)z6(Z,$,this.cursor.from);this.minActive=R5(this.active,this.activeTo)}next(){let Z=this.to,$=this.point;this.point=null;let J=this.openStart<0?[]:null;for(;;){let Y=this.minActive;if(Y>-1&&(this.activeTo[Y]-this.cursor.from||this.active[Y].endSide-this.cursor.startSide)<0){if(this.activeTo[Y]>Z){this.to=this.activeTo[Y],this.endSide=this.active[Y].endSide;break}if(this.removeActive(Y),J)_6(J,Y)}else if(!this.cursor.value){this.to=this.endSide=1e9;break}else if(this.cursor.from>Z){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let X=this.cursor.value;if(!X.point)this.addActive(J),this.cursor.next();else if($&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=X,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=X.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}}if(J){this.openStart=0;for(let Y=J.length-1;Y>=0&&J[Y]<Z;Y--)this.openStart++}}activeForPoint(Z){if(!this.active.length)return this.active;let $=[];for(let J=this.active.length-1;J>=0;J--){if(this.activeRank[J]<this.pointRank)break;if(this.activeTo[J]>Z||this.activeTo[J]==Z&&this.active[J].endSide>=this.point.endSide)$.push(this.active[J])}return $.reverse()}openEnd(Z){let $=0;for(let J=this.activeTo.length-1;J>=0&&this.activeTo[J]>Z;J--)$++;return $}}function N5(Z,$,J,Y,X,Q){Z.goto($),J.goto(Y);let K=Y+X,U=Y,q=Y-$,G=!!Q.boundChange;for(let W=!1;;){let j=Z.to+q-J.to,_=j||Z.endSide-J.endSide,z=_<0?Z.to+q:J.to,V=Math.min(z,K);if(Z.point||J.point){if(!(Z.point&&J.point&&z7(Z.point,J.point)&&U7(Z.activeForPoint(Z.to),J.activeForPoint(J.to))))Q.comparePoint(U,V,Z.point,J.point);W=!1}else{if(W)Q.boundChange(U);if(V>U&&!U7(Z.active,J.active))Q.compareRange(U,V,Z.active,J.active);if(G&&V<K&&(j||Z.openEnd(z)!=J.openEnd(z)))W=!0}if(z>K)break;if(U=z,_<=0)Z.next();if(_>=0)J.next()}}function U7(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++)if(Z[J]!=$[J]&&!z7(Z[J],$[J]))return!1;return!0}function _6(Z,$){for(let J=$,Y=Z.length-1;J<Y;J++)Z[J]=Z[J+1];Z.pop()}function z6(Z,$,J){for(let Y=Z.length-1;Y>=$;Y--)Z[Y+1]=Z[Y];Z[$]=J}function R5(Z,$){let J=-1,Y=1e9;for(let X=0;X<$.length;X++)if(($[X]-Y||Z[X].endSide-Z[J].endSide)<0)J=X,Y=$[X];return J}function u1(Z,$,J=Z.length){let Y=0;for(let X=0;X<J&&X<Z.length;)if(Z.charCodeAt(X)==9)Y+=$-Y%$,X++;else Y++,X=R0(Z,X);return Y}function R6(Z,$,J,Y){for(let X=0,Q=0;;){if(Q>=$)return X;if(X==Z.length)break;Q+=Z.charCodeAt(X)==9?J-Q%J:1,X=R0(Z,X)}return Y===!0?-1:Z.length}var k5=typeof Symbol>"u"?"__"+"Í¼":Symbol.for("Í¼"),H7=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),S5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class F1{constructor(Z,$){this.rules=[];let{finish:J}=$||{};function Y(Q){return/^@/.test(Q)?[Q]:Q.split(/,\s*/)}function X(Q,K,U,q){let G=[],W=/^@(\w+)\b/.exec(Q[0]),j=W&&W[1]=="keyframes";if(W&&K==null)return U.push(Q[0]+";");for(let _ in K){let z=K[_];if(/&/.test(_))X(_.split(/,\s*/).map((V)=>Q.map((O)=>V.replace(/&/,O))).reduce((V,O)=>V.concat(O)),z,U);else if(z&&typeof z=="object"){if(!W)throw RangeError("The value of a property ("+_+") should be a primitive value.");X(Y(_),z,G,j)}else if(z!=null)G.push(_.replace(/_.*/,"").replace(/[A-Z]/g,(V)=>"-"+V.toLowerCase())+": "+z+";")}if(G.length||j)U.push((J&&!W&&!q?Q.map(J):Q).join(", ")+" {"+G.join(" ")+"}")}for(let Q in Z)X(Y(Q),Z[Q],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let Z=S5[k5]||1;return S5[k5]=Z+1,"Í¼"+Z.toString(36)}static mount(Z,$,J){let Y=Z[H7],X=J&&J.nonce;if(!Y)Y=new h5(Z,X);else if(X)Y.setNonce(X);Y.mount(Array.isArray($)?$:[$],Z)}}var x5=new Map;class h5{constructor(Z,$){let J=Z.ownerDocument||Z,Y=J.defaultView;if(!Z.head&&Z.adoptedStyleSheets&&Y.CSSStyleSheet){let X=x5.get(J);if(X)return Z[H7]=X;this.sheet=new Y.CSSStyleSheet,x5.set(J,this)}else if(this.styleTag=J.createElement("style"),$)this.styleTag.setAttribute("nonce",$);this.modules=[],Z[H7]=this}mount(Z,$){let J=this.sheet,Y=0,X=0;for(let Q=0;Q<Z.length;Q++){let K=Z[Q],U=this.modules.indexOf(K);if(U<X&&U>-1)this.modules.splice(U,1),X--,U=-1;if(U==-1){if(this.modules.splice(X++,0,K),J)for(let q=0;q<K.rules.length;q++)J.insertRule(K.rules[q],Y++)}else{while(X<U)Y+=this.modules[X++].rules.length;Y+=K.rules.length,X++}}if(J){if($.adoptedStyleSheets.indexOf(this.sheet)<0)$.adoptedStyleSheets=[this.sheet,...$.adoptedStyleSheets]}else{let Q="";for(let U=0;U<this.modules.length;U++)Q+=this.modules[U].getRules()+`
`;this.styleTag.textContent=Q;let K=$.head||$;if(this.styleTag.parentNode!=K)K.insertBefore(this.styleTag,K.firstChild)}}setNonce(Z){if(this.styleTag&&this.styleTag.getAttribute("nonce")!=Z)this.styleTag.setAttribute("nonce",Z)}}var m1={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},S2={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},MK=typeof navigator<"u"&&/Mac/.test(navigator.platform),AK=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(O0=0;O0<10;O0++)m1[48+O0]=m1[96+O0]=String(O0);var O0;for(O0=1;O0<=24;O0++)m1[O0+111]="F"+O0;var O0;for(O0=65;O0<=90;O0++)m1[O0]=String.fromCharCode(O0+32),S2[O0]=String.fromCharCode(O0);var O0;for(z3 in m1)if(!S2.hasOwnProperty(z3))S2[z3]=m1[z3];var z3;function w5(Z){var $=MK&&Z.metaKey&&Z.shiftKey&&!Z.ctrlKey&&!Z.altKey||AK&&Z.shiftKey&&Z.key&&Z.key.length==1||Z.key=="Unidentified",J=!$&&Z.key||(Z.shiftKey?S2:m1)[Z.keyCode]||Z.key||"Unidentified";if(J=="Esc")J="Escape";if(J=="Del")J="Delete";if(J=="Left")J="ArrowLeft";if(J=="Up")J="ArrowUp";if(J=="Right")J="ArrowRight";if(J=="Down")J="ArrowDown";return J}function J0(){var Z=arguments[0];if(typeof Z=="string")Z=document.createElement(Z);var $=1,J=arguments[1];if(J&&typeof J=="object"&&J.nodeType==null&&!Array.isArray(J)){for(var Y in J)if(Object.prototype.hasOwnProperty.call(J,Y)){var X=J[Y];if(typeof X=="string")Z.setAttribute(Y,X);else if(X!=null)Z[Y]=X}$++}for(;$<arguments.length;$++)v5(Z,arguments[$]);return Z}function v5(Z,$){if(typeof $=="string")Z.appendChild(document.createTextNode($));else if($==null);else if($.nodeType!=null)Z.appendChild($);else if(Array.isArray($))for(var J=0;J<$.length;J++)v5(Z,$[J]);else throw RangeError("Unsupported child node: "+$)}var g0=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},E7=typeof document<"u"?document:{documentElement:{style:{}}},P7=/Edge\/(\d+)/.exec(g0.userAgent),MZ=/MSIE \d/.test(g0.userAgent),C7=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(g0.userAgent),s6=!!(MZ||C7||P7),u5=!s6&&/gecko\/(\d+)/i.test(g0.userAgent),N7=!s6&&/Chrome\/(\d+)/.exec(g0.userAgent),m5="webkitFontSmoothing"in E7.documentElement.style,T7=!s6&&/Apple Computer/.test(g0.vendor),g5=T7&&(/Mobile\/\w+/.test(g0.userAgent)||g0.maxTouchPoints>2),h={mac:g5||/Mac/.test(g0.platform),windows:/Win/.test(g0.platform),linux:/Linux|X11/.test(g0.platform),ie:s6,ie_version:MZ?E7.documentMode||6:C7?+C7[1]:P7?+P7[1]:0,gecko:u5,gecko_version:u5?+(/Firefox\/(\d+)/.exec(g0.userAgent)||[0,0])[1]:0,chrome:!!N7,chrome_version:N7?+N7[1]:0,ios:g5,android:/Android\b/.test(g0.userAgent),webkit:m5,webkit_version:m5?+(/\bAppleWebKit\/(\d+)/.exec(g0.userAgent)||[0,0])[1]:0,safari:T7,safari_version:T7?+(/\bVersion\/(\d+(\.\d+)?)/.exec(g0.userAgent)||[0,0])[1]:0,tabSize:E7.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function o7(Z,$){for(let J in Z)if(J=="class"&&$.class)$.class+=" "+Z.class;else if(J=="style"&&$.style)$.style+=";"+Z.style;else $[J]=Z[J];return $}var v6=Object.create(null);function t7(Z,$,J){if(Z==$)return!0;if(!Z)Z=v6;if(!$)$=v6;let Y=Object.keys(Z),X=Object.keys($);if(Y.length-(J&&Y.indexOf(J)>-1?1:0)!=X.length-(J&&X.indexOf(J)>-1?1:0))return!1;for(let Q of Y)if(Q!=J&&(X.indexOf(Q)==-1||Z[Q]!==$[Q]))return!1;return!0}function BK(Z,$){for(let J=Z.attributes.length-1;J>=0;J--){let Y=Z.attributes[J].name;if($[Y]==null)Z.removeAttribute(Y)}for(let J in $){let Y=$[J];if(J=="style")Z.style.cssText=Y;else if(Z.getAttribute(J)!=Y)Z.setAttribute(J,Y)}}function f5(Z,$,J){let Y=!1;if($){for(let X in $)if(!(J&&(X in J)))if(Y=!0,X=="style")Z.style.cssText="";else Z.removeAttribute(X)}if(J){for(let X in J)if(!($&&$[X]==J[X]))if(Y=!0,X=="style")Z.style.cssText=J[X];else Z.setAttribute(X,J[X])}return Y}function EK(Z){let $=Object.create(null);for(let J=0;J<Z.attributes.length;J++){let Y=Z.attributes[J];$[Y.name]=Y.value}return $}class e0{eq(Z){return!1}updateDOM(Z,$){return!1}compare(Z){return this==Z||this.constructor==Z.constructor&&this.eq(Z)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(Z){return!0}coordsAt(Z,$,J){return null}get isHidden(){return!1}get editable(){return!1}destroy(Z){}}var w0=function(Z){return Z[Z.Text=0]="Text",Z[Z.WidgetBefore=1]="WidgetBefore",Z[Z.WidgetAfter=2]="WidgetAfter",Z[Z.WidgetRange=3]="WidgetRange",Z}(w0||(w0={}));class g extends N1{constructor(Z,$,J,Y){super();this.startSide=Z,this.endSide=$,this.widget=J,this.spec=Y}get heightRelevant(){return!1}static mark(Z){return new C3(Z)}static widget(Z){let $=Math.max(-1e4,Math.min(1e4,Z.side||0)),J=!!Z.block;return $+=J&&!Z.inlineOrder?$>0?300000000:-400000000:$>0?1e8:-1e8,new _2(Z,$,$,J,Z.widget||null,!1)}static replace(Z){let $=!!Z.block,J,Y;if(Z.isBlockGap)J=-500000000,Y=400000000;else{let{start:X,end:Q}=AZ(Z,$);J=(X?$?-300000000:-1:500000000)-1,Y=(Q?$?200000000:1:-600000000)+1}return new _2(Z,J,Y,$,Z.widget||null,!0)}static line(Z){return new T3(Z)}static set(Z,$=!1){return r.of(Z,$)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}g.none=r.empty;class C3 extends g{constructor(Z){let{start:$,end:J}=AZ(Z);super($?-1:500000000,J?1:-600000000,null,Z);this.tagName=Z.tagName||"span",this.attrs=Z.class&&Z.attributes?o7(Z.attributes,{class:Z.class}):Z.class?{class:Z.class}:Z.attributes||v6}eq(Z){return this==Z||Z instanceof C3&&this.tagName==Z.tagName&&t7(this.attrs,Z.attrs)}range(Z,$=Z){if(Z>=$)throw RangeError("Mark decorations may not be empty");return super.range(Z,$)}}C3.prototype.point=!1;class T3 extends g{constructor(Z){super(-200000000,-200000000,null,Z)}eq(Z){return Z instanceof T3&&this.spec.class==Z.spec.class&&t7(this.spec.attributes,Z.spec.attributes)}range(Z,$=Z){if($!=Z)throw RangeError("Line decoration ranges must be zero-length");return super.range(Z,$)}}T3.prototype.mapMode=k0.TrackBefore;T3.prototype.point=!0;class _2 extends g{constructor(Z,$,J,Y,X,Q){super($,J,X,Z);this.block=Y,this.isReplace=Q,this.mapMode=!Y?k0.TrackDel:$<=0?k0.TrackBefore:k0.TrackAfter}get type(){return this.startSide!=this.endSide?w0.WidgetRange:this.startSide<=0?w0.WidgetBefore:w0.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(Z){return Z instanceof _2&&PK(this.widget,Z.widget)&&this.block==Z.block&&this.startSide==Z.startSide&&this.endSide==Z.endSide}range(Z,$=Z){if(this.isReplace&&(Z>$||Z==$&&this.startSide>0&&this.endSide<=0))throw RangeError("Invalid range for replacement decoration");if(!this.isReplace&&$!=Z)throw RangeError("Widget decorations can only have zero-length ranges");return super.range(Z,$)}}_2.prototype.point=!0;function AZ(Z,$=!1){let{inclusiveStart:J,inclusiveEnd:Y}=Z;if(J==null)J=Z.inclusive;if(Y==null)Y=Z.inclusive;return{start:J!==null&&J!==void 0?J:$,end:Y!==null&&Y!==void 0?Y:$}}function PK(Z,$){return Z==$||!!(Z&&$&&Z.compare($))}function w2(Z,$,J,Y=0){let X=J.length-1;if(X>=0&&J[X]+Y>=Z)J[X]=Math.max(J[X],$);else J.push(Z,$)}class A3 extends N1{constructor(Z,$){super();this.tagName=Z,this.attributes=$}eq(Z){return Z==this||Z instanceof A3&&this.tagName==Z.tagName&&t7(this.attributes,Z.attributes)}static create(Z){return new A3(Z.tagName,Z.attributes||v6)}static set(Z,$=!1){return r.of(Z,$)}}A3.prototype.startSide=A3.prototype.endSide=-1;function m2(Z){let $;if(Z.nodeType==11)$=Z.getSelection?Z:Z.ownerDocument;else $=Z;return $.getSelection()}function y7(Z,$){return $?Z==$||Z.contains($.nodeType!=1?$.parentNode:$):!1}function I3(Z,$){if(!$.anchorNode)return!1;try{return y7(Z,$.anchorNode)}catch(J){return!1}}function C6(Z){if(Z.nodeType==3)return B3(Z,0,Z.nodeValue.length).getClientRects();else if(Z.nodeType==1)return Z.getClientRects();else return[]}function D3(Z,$,J,Y){return J?p5(Z,$,J,Y,-1)||p5(Z,$,J,Y,1):!1}function n1(Z){for(var $=0;;$++)if(Z=Z.previousSibling,!Z)return $}function u6(Z){return Z.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(Z.nodeName)}function p5(Z,$,J,Y,X){for(;;){if(Z==J&&$==Y)return!0;if($==(X<0?0:f1(Z))){if(Z.nodeName=="DIV")return!1;let Q=Z.parentNode;if(!Q||Q.nodeType!=1)return!1;$=n1(Z)+(X<0?0:1),Z=Q}else if(Z.nodeType==1){if(Z=Z.childNodes[$+(X<0?-1:0)],Z.nodeType==1&&Z.contentEditable=="false")return!1;$=X<0?f1(Z):0}else return!1}}function f1(Z){return Z.nodeType==3?Z.nodeValue.length:Z.childNodes.length}function m6(Z,$){let J=$?Z.left:Z.right;return{left:J,right:J,top:Z.top,bottom:Z.bottom}}function CK(Z){let $=Z.visualViewport;if($)return{left:0,right:$.width,top:0,bottom:$.height};return{left:0,right:Z.innerWidth,top:0,bottom:Z.innerHeight}}function BZ(Z,$){let J=$.width/Z.offsetWidth,Y=$.height/Z.offsetHeight;if(J>0.995&&J<1.005||!isFinite(J)||Math.abs($.width-Z.offsetWidth)<1)J=1;if(Y>0.995&&Y<1.005||!isFinite(Y)||Math.abs($.height-Z.offsetHeight)<1)Y=1;return{scaleX:J,scaleY:Y}}function TK(Z,$,J,Y,X,Q,K,U){let q=Z.ownerDocument,G=q.defaultView||window;for(let W=Z,j=!1;W&&!j;)if(W.nodeType==1){let _,z=W==q.body,V=1,O=1;if(z)_=CK(G);else{if(/^(fixed|sticky)$/.test(getComputedStyle(W).position))j=!0;if(W.scrollHeight<=W.clientHeight&&W.scrollWidth<=W.clientWidth){W=W.assignedSlot||W.parentNode;continue}let D=W.getBoundingClientRect();({scaleX:V,scaleY:O}=BZ(W,D)),_={left:D.left,right:D.left+W.clientWidth*V,top:D.top,bottom:D.top+W.clientHeight*O}}let H=0,F=0;if(X=="nearest"){if($.top<_.top){if(F=$.top-(_.top+K),J>0&&$.bottom>_.bottom+F)F=$.bottom-_.bottom+K}else if($.bottom>_.bottom){if(F=$.bottom-_.bottom+K,J<0&&$.top-F<_.top)F=$.top-(_.top+K)}}else{let D=$.bottom-$.top,M=_.bottom-_.top;F=(X=="center"&&D<=M?$.top+D/2-M/2:X=="start"||X=="center"&&J<0?$.top-K:$.bottom-M+K)-_.top}if(Y=="nearest"){if($.left<_.left){if(H=$.left-(_.left+Q),J>0&&$.right>_.right+H)H=$.right-_.right+Q}else if($.right>_.right){if(H=$.right-_.right+Q,J<0&&$.left<_.left+H)H=$.left-(_.left+Q)}}else H=(Y=="center"?$.left+($.right-$.left)/2-(_.right-_.left)/2:Y=="start"==U?$.left-Q:$.right-(_.right-_.left)+Q)-_.left;if(H||F)if(z)G.scrollBy(H,F);else{let D=0,M=0;if(F){let A=W.scrollTop;W.scrollTop+=F/O,M=(W.scrollTop-A)*O}if(H){let A=W.scrollLeft;W.scrollLeft+=H/V,D=(W.scrollLeft-A)*V}if($={left:$.left-D,top:$.top-M,right:$.right-D,bottom:$.bottom-M},D&&Math.abs(D-H)<1)Y="nearest";if(M&&Math.abs(M-F)<1)X="nearest"}if(z)break;if($.top<_.top||$.bottom>_.bottom||$.left<_.left||$.right>_.right)$={left:Math.max($.left,_.left),right:Math.min($.right,_.right),top:Math.max($.top,_.top),bottom:Math.min($.bottom,_.bottom)};W=W.assignedSlot||W.parentNode}else if(W.nodeType==11)W=W.host;else break}function yK(Z){let $=Z.ownerDocument,J,Y;for(let X=Z.parentNode;X;)if(X==$.body||J&&Y)break;else if(X.nodeType==1){if(!Y&&X.scrollHeight>X.clientHeight)Y=X;if(!J&&X.scrollWidth>X.clientWidth)J=X;X=X.assignedSlot||X.parentNode}else if(X.nodeType==11)X=X.host;else break;return{x:J,y:Y}}class EZ{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(Z){return this.anchorNode==Z.anchorNode&&this.anchorOffset==Z.anchorOffset&&this.focusNode==Z.focusNode&&this.focusOffset==Z.focusOffset}setRange(Z){let{anchorNode:$,focusNode:J}=Z;this.set($,Math.min(Z.anchorOffset,$?f1($):0),J,Math.min(Z.focusOffset,J?f1(J):0))}set(Z,$,J,Y){this.anchorNode=Z,this.anchorOffset=$,this.focusNode=J,this.focusOffset=Y}}var W2=null;if(h.safari&&h.safari_version>=26)W2=!1;function PZ(Z){if(Z.setActive)return Z.setActive();if(W2)return Z.focus(W2);let $=[];for(let J=Z;J;J=J.parentNode)if($.push(J,J.scrollTop,J.scrollLeft),J==J.ownerDocument)break;if(Z.focus(W2==null?{get preventScroll(){return W2={preventScroll:!0},!0}}:void 0),!W2){W2=!1;for(let J=0;J<$.length;){let Y=$[J++],X=$[J++],Q=$[J++];if(Y.scrollTop!=X)Y.scrollTop=X;if(Y.scrollLeft!=Q)Y.scrollLeft=Q}}}var l5;function B3(Z,$,J=$){let Y=l5||(l5=document.createRange());return Y.setEnd(Z,J),Y.setStart(Z,$),Y}function v2(Z,$,J,Y){let X={key:$,code:$,keyCode:J,which:J,cancelable:!0};if(Y)({altKey:X.altKey,ctrlKey:X.ctrlKey,shiftKey:X.shiftKey,metaKey:X.metaKey}=Y);let Q=new KeyboardEvent("keydown",X);Q.synthetic=!0,Z.dispatchEvent(Q);let K=new KeyboardEvent("keyup",X);return K.synthetic=!0,Z.dispatchEvent(K),Q.defaultPrevented||K.defaultPrevented}function bK(Z){while(Z){if(Z&&(Z.nodeType==9||Z.nodeType==11&&Z.host))return Z;Z=Z.assignedSlot||Z.parentNode}return null}function kK(Z,$){let{focusNode:J,focusOffset:Y}=$;if(!J||$.anchorNode!=J||$.anchorOffset!=Y)return!1;Y=Math.min(Y,f1(J));for(;;)if(Y){if(J.nodeType!=1)return!1;let X=J.childNodes[Y-1];if(X.contentEditable=="false")Y--;else J=X,Y=f1(J)}else if(J==Z)return!0;else Y=n1(J),J=J.parentNode}function CZ(Z){return Z.scrollTop>Math.max(1,Z.scrollHeight-Z.clientHeight-4)}function TZ(Z,$){for(let J=Z,Y=$;;)if(J.nodeType==3&&Y>0)return{node:J,offset:Y};else if(J.nodeType==1&&Y>0){if(J.contentEditable=="false")return null;J=J.childNodes[Y-1],Y=f1(J)}else if(J.parentNode&&!u6(J))Y=n1(J),J=J.parentNode;else return null}function yZ(Z,$){for(let J=Z,Y=$;;)if(J.nodeType==3&&Y<J.nodeValue.length)return{node:J,offset:Y};else if(J.nodeType==1&&Y<J.childNodes.length){if(J.contentEditable=="false")return null;J=J.childNodes[Y],Y=0}else if(J.parentNode&&!u6(J))Y=n1(J)+1,J=J.parentNode;else return null}class L1{constructor(Z,$,J=!0){this.node=Z,this.offset=$,this.precise=J}static before(Z,$){return new L1(Z.parentNode,n1(Z),$)}static after(Z,$){return new L1(Z.parentNode,n1(Z)+1,$)}}var Q0=function(Z){return Z[Z.LTR=0]="LTR",Z[Z.RTL=1]="RTL",Z}(Q0||(Q0={})),z2=Q0.LTR,e7=Q0.RTL;function bZ(Z){let $=[];for(let J=0;J<Z.length;J++)$.push(1<<+Z[J]);return $}var SK=bZ("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),xK=bZ("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),b7=Object.create(null),b1=[];for(let Z of["()","[]","{}"]){let $=Z.charCodeAt(0),J=Z.charCodeAt(1);b7[$]=J,b7[J]=-$}function kZ(Z){return Z<=247?SK[Z]:1424<=Z&&Z<=1524?2:1536<=Z&&Z<=1785?xK[Z-1536]:1774<=Z&&Z<=2220?4:8192<=Z&&Z<=8204?256:64336<=Z&&Z<=65023?4:1}var hK=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class k1{get dir(){return this.level%2?e7:z2}constructor(Z,$,J){this.from=Z,this.to=$,this.level=J}side(Z,$){return this.dir==$==Z?this.to:this.from}forward(Z,$){return Z==(this.dir==$)}static find(Z,$,J,Y){let X=-1;for(let Q=0;Q<Z.length;Q++){let K=Z[Q];if(K.from<=$&&K.to>=$){if(K.level==J)return Q;if(X<0||(Y!=0?Y<0?K.from<$:K.to>$:Z[X].level>K.level))X=Q}}if(X<0)throw RangeError("Index out of range");return X}}function SZ(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++){let Y=Z[J],X=$[J];if(Y.from!=X.from||Y.to!=X.to||Y.direction!=X.direction||!SZ(Y.inner,X.inner))return!1}return!0}var U0=[];function wK(Z,$,J,Y,X){for(let Q=0;Q<=Y.length;Q++){let K=Q?Y[Q-1].to:$,U=Q<Y.length?Y[Q].from:J,q=Q?256:X;for(let G=K,W=q,j=q;G<U;G++){let _=kZ(Z.charCodeAt(G));if(_==512)_=W;else if(_==8&&j==4)_=16;if(U0[G]=_==4?2:_,_&7)j=_;W=_}for(let G=K,W=q,j=q;G<U;G++){let _=U0[G];if(_==128)if(G<U-1&&W==U0[G+1]&&W&24)_=U0[G]=W;else U0[G]=256;else if(_==64){let z=G+1;while(z<U&&U0[z]==64)z++;let V=G&&W==8||z<J&&U0[z]==8?j==1?1:8:256;for(let O=G;O<z;O++)U0[O]=V;G=z-1}else if(_==8&&j==1)U0[G]=1;if(W=_,_&7)j=_}}}function vK(Z,$,J,Y,X){let Q=X==1?2:1;for(let K=0,U=0,q=0;K<=Y.length;K++){let G=K?Y[K-1].to:$,W=K<Y.length?Y[K].from:J;for(let j=G,_,z,V;j<W;j++)if(z=b7[_=Z.charCodeAt(j)])if(z<0){for(let O=U-3;O>=0;O-=3)if(b1[O+1]==-z){let H=b1[O+2],F=H&2?X:!(H&4)?0:H&1?Q:X;if(F)U0[j]=U0[b1[O]]=F;U=O;break}}else if(b1.length==189)break;else b1[U++]=j,b1[U++]=_,b1[U++]=q;else if((V=U0[j])==2||V==1){let O=V==X;q=O?0:1;for(let H=U-3;H>=0;H-=3){let F=b1[H+2];if(F&2)break;if(O)b1[H+2]|=2;else{if(F&4)break;b1[H+2]|=4}}}}}function uK(Z,$,J,Y){for(let X=0,Q=Y;X<=J.length;X++){let K=X?J[X-1].to:Z,U=X<J.length?J[X].from:$;for(let q=K;q<U;){let G=U0[q];if(G==256){let W=q+1;for(;;)if(W==U){if(X==J.length)break;W=J[X++].to,U=X<J.length?J[X].from:$}else if(U0[W]==256)W++;else break;let j=Q==1,_=(W<$?U0[W]:Y)==1,z=j==_?j?1:2:Y;for(let V=W,O=X,H=O?J[O-1].to:Z;V>q;){if(V==H)V=J[--O].from,H=O?J[O-1].to:Z;U0[--V]=z}q=W}else Q=G,q++}}}function k7(Z,$,J,Y,X,Q,K){let U=Y%2?2:1;if(Y%2==X%2)for(let q=$,G=0;q<J;){let W=!0,j=!1;if(G==Q.length||q<Q[G].from){let O=U0[q];if(O!=U)W=!1,j=O==16}let _=!W&&U==1?[]:null,z=W?Y:Y+1,V=q;Z:for(;;)if(G<Q.length&&V==Q[G].from){if(j)break Z;let O=Q[G];if(!W)for(let H=O.to,F=G+1;;){if(H==J)break Z;if(F<Q.length&&Q[F].from==H)H=Q[F++].to;else if(U0[H]==U)break Z;else break}if(G++,_)_.push(O);else{if(O.from>q)K.push(new k1(q,O.from,z));let H=O.direction==z2!=!(z%2);S7(Z,H?Y+1:Y,X,O.inner,O.from,O.to,K),q=O.to}V=O.to}else if(V==J||(W?U0[V]!=U:U0[V]==U))break;else V++;if(_)k7(Z,q,V,Y+1,X,_,K);else if(q<V)K.push(new k1(q,V,z));q=V}else for(let q=J,G=Q.length;q>$;){let W=!0,j=!1;if(!G||q>Q[G-1].to){let O=U0[q-1];if(O!=U)W=!1,j=O==16}let _=!W&&U==1?[]:null,z=W?Y:Y+1,V=q;Z:for(;;)if(G&&V==Q[G-1].to){if(j)break Z;let O=Q[--G];if(!W)for(let H=O.from,F=G;;){if(H==$)break Z;if(F&&Q[F-1].to==H)H=Q[--F].from;else if(U0[H-1]==U)break Z;else break}if(_)_.push(O);else{if(O.to<q)K.push(new k1(O.to,q,z));let H=O.direction==z2!=!(z%2);S7(Z,H?Y+1:Y,X,O.inner,O.from,O.to,K),q=O.from}V=O.from}else if(V==$||(W?U0[V-1]!=U:U0[V-1]==U))break;else V--;if(_)k7(Z,V,q,Y+1,X,_,K);else if(V<q)K.push(new k1(V,q,z));q=V}}function S7(Z,$,J,Y,X,Q,K){let U=$%2?2:1;wK(Z,X,Q,Y,U),vK(Z,X,Q,Y,U),uK(X,Q,Y,U),k7(Z,X,Q,$,J,Y,K)}function mK(Z,$,J){if(!Z)return[new k1(0,0,$==e7?1:0)];if($==z2&&!J.length&&!hK.test(Z))return xZ(Z.length);if(J.length)while(Z.length>U0.length)U0[U0.length]=256;let Y=[],X=$==z2?0:1;return S7(Z,X,X,J,0,Z.length,Y),Y}function xZ(Z){return[new k1(0,Z,0)]}var hZ="";function gK(Z,$,J,Y,X){var Q;let K=Y.head-Z.from,U=k1.find($,K,(Q=Y.bidiLevel)!==null&&Q!==void 0?Q:-1,Y.assoc),q=$[U],G=q.side(X,J);if(K==G){let _=U+=X?1:-1;if(_<0||_>=$.length)return null;q=$[U=_],K=q.side(!X,J),G=q.side(X,J)}let W=R0(Z.text,K,q.forward(X,J));if(W<q.from||W>q.to)W=G;hZ=Z.text.slice(Math.min(K,W),Math.max(K,W));let j=U==(X?$.length-1:0)?null:$[U+(X?1:-1)];if(j&&W==G&&j.level+(X?0:1)<q.level)return L.cursor(j.side(!X,J)+Z.from,j.forward(X,J)?1:-1,j.level);return L.cursor(W+Z.from,q.forward(X,J)?-1:1,q.level)}function fK(Z,$,J){for(let Y=$;Y<J;Y++){let X=kZ(Z.charCodeAt(Y));if(X==1)return z2;if(X==2||X==4)return e7}return z2}var wZ=S.define(),vZ=S.define(),uZ=S.define(),mZ=S.define(),x7=S.define(),gZ=S.define(),fZ=S.define(),Z4=S.define(),$4=S.define(),pZ=S.define({combine:(Z)=>Z.some(($)=>$)}),lZ=S.define({combine:(Z)=>Z.some(($)=>$)}),dZ=S.define();class u2{constructor(Z,$="nearest",J="nearest",Y=5,X=5,Q=!1){this.range=Z,this.y=$,this.x=J,this.yMargin=Y,this.xMargin=X,this.isSnapshot=Q}map(Z){return Z.empty?this:new u2(this.range.map(Z),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(Z){return this.range.to<=Z.doc.length?this:new u2(L.cursor(Z.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}var F6=l.define({map:(Z,$)=>Z.map($)}),cZ=l.define();function h0(Z,$,J){let Y=Z.facet(mZ);if(Y.length)Y[0]($);else if(window.onerror&&window.onerror(String($),J,void 0,void 0,$));else if(J)console.error(J+":",$);else console.error($)}var g1=S.define({combine:(Z)=>Z.length?Z[0]:!0}),pK=0,x2=S.define({combine(Z){return Z.filter(($,J)=>{for(let Y=0;Y<J;Y++)if(Z[Y].plugin==$.plugin)return!1;return!0})}});class _0{constructor(Z,$,J,Y,X){this.id=Z,this.create=$,this.domEventHandlers=J,this.domEventObservers=Y,this.baseExtensions=X(this),this.extension=this.baseExtensions.concat(x2.of({plugin:this,arg:void 0}))}of(Z){return this.baseExtensions.concat(x2.of({plugin:this,arg:Z}))}static define(Z,$){let{eventHandlers:J,eventObservers:Y,provide:X,decorations:Q}=$||{};return new _0(pK++,Z,J,Y,(K)=>{let U=[];if(Q)U.push(n6.of((q)=>{let G=q.plugin(K);return G?Q(G):g.none}));if(X)U.push(X(K));return U})}static fromClass(Z,$){return _0.define((J,Y)=>new Z(J,Y),$)}}class T6{constructor(Z){this.spec=Z,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(Z){if(!this.value){if(this.spec)try{this.value=this.spec.plugin.create(Z,this.spec.arg)}catch($){h0(Z.state,$,"CodeMirror plugin crashed"),this.deactivate()}}else if(this.mustUpdate){let $=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update($)}catch(J){if(h0($.state,J,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(Y){}this.deactivate()}}return this}destroy(Z){var $;if(($=this.value)===null||$===void 0?void 0:$.destroy)try{this.value.destroy()}catch(J){h0(Z.state,J,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}var sZ=S.define(),J4=S.define(),n6=S.define(),nZ=S.define(),Y4=S.define(),y3=S.define(),iZ=S.define();function d5(Z,$){let J=Z.state.facet(iZ);if(!J.length)return J;let Y=J.map((Q)=>Q instanceof Function?Q(Z):Q),X=[];return r.spans(Y,$.from,$.to,{point(){},span(Q,K,U,q){let G=Q-$.from,W=K-$.from,j=X;for(let _=U.length-1;_>=0;_--,q--){let z=U[_].spec.bidiIsolate,V;if(z==null)z=fK($.text,G,W);if(q>0&&j.length&&(V=j[j.length-1]).to==G&&V.direction==z)V.to=W,j=V.inner;else{let O={from:G,to:W,direction:z,inner:[]};j.push(O),j=O.inner}}}}),X}var rZ=S.define();function X4(Z){let $=0,J=0,Y=0,X=0;for(let Q of Z.state.facet(rZ)){let K=Q(Z);if(K){if(K.left!=null)$=Math.max($,K.left);if(K.right!=null)J=Math.max(J,K.right);if(K.top!=null)Y=Math.max(Y,K.top);if(K.bottom!=null)X=Math.max(X,K.bottom)}}return{left:$,right:J,top:Y,bottom:X}}var O3=S.define();class X1{constructor(Z,$,J,Y){this.fromA=Z,this.toA=$,this.fromB=J,this.toB=Y}join(Z){return new X1(Math.min(this.fromA,Z.fromA),Math.max(this.toA,Z.toA),Math.min(this.fromB,Z.fromB),Math.max(this.toB,Z.toB))}addToSet(Z){let $=Z.length,J=this;for(;$>0;$--){let Y=Z[$-1];if(Y.fromA>J.toA)continue;if(Y.toA<J.fromA)break;J=J.join(Y),Z.splice($-1,1)}return Z.splice($,0,J),Z}static extendWithRanges(Z,$){if($.length==0)return Z;let J=[];for(let Y=0,X=0,Q=0;;){let K=Y<Z.length?Z[Y].fromB:1e9,U=X<$.length?$[X]:1e9,q=Math.min(K,U);if(q==1e9)break;let G=q+Q,W=q,j=G;for(;;)if(X<$.length&&$[X]<=W){let _=$[X+1];X+=2,W=Math.max(W,_);for(let z=Y;z<Z.length&&Z[z].fromB<=W;z++)Q=Z[z].toA-Z[z].toB;j=Math.max(j,_+Q)}else if(Y<Z.length&&Z[Y].fromB<=W){let _=Z[Y++];W=Math.max(W,_.toB),j=Math.max(j,_.toA),Q=_.toA-_.toB}else break;J.push(new X1(G,j,q,W))}return J}}class g6{constructor(Z,$,J){this.view=Z,this.state=$,this.transactions=J,this.flags=0,this.startState=Z.state,this.changes=L0.empty(this.startState.doc.length);for(let X of J)this.changes=this.changes.compose(X.changes);let Y=[];this.changes.iterChangedRanges((X,Q,K,U)=>Y.push(new X1(X,Q,K,U))),this.changedRanges=Y}static create(Z,$,J){return new g6(Z,$,J)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((Z)=>Z.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var lK=[];class M0{constructor(Z,$,J=0){this.dom=Z,this.length=$,this.flags=J,this.parent=null,Z.cmTile=this}get breakAfter(){return this.flags&1}get children(){return lK}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(Z){if(this.flags|=2,this.flags&4){this.flags&=-5;let $=this.domAttrs;if($)BK(this.dom,$)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(Z){this.dom=Z,Z.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(Z,$=this.posAtStart){let J=$;for(let Y of this.children){if(Y==Z)return J;J+=Y.length+Y.breakAfter}throw RangeError("Invalid child in posBefore")}posAfter(Z){return this.posBefore(Z)+Z.length}covers(Z){return!0}coordsIn(Z,$){return null}domPosFor(Z,$){let J=n1(this.dom),Y=this.length?Z>0:$>0;return new L1(this.parent.dom,J+(Y?1:0),Z==0||Z==this.length)}markDirty(Z){if(this.flags&=-3,Z)this.flags|=4;if(this.parent&&this.parent.flags&2)this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let Z=this;Z;Z=Z.parent)if(Z instanceof k3)return Z;return null}static get(Z){return Z.cmTile}}class b3 extends M0{constructor(Z){super(Z,0);this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(Z){this.children.push(Z),Z.parent=this}sync(Z){if(this.flags&2)return;super.sync(Z);let $=this.dom,J=null,Y,X=(Z===null||Z===void 0?void 0:Z.node)==$?Z:null,Q=0;for(let K of this.children){if(K.sync(Z),Q+=K.length+K.breakAfter,Y=J?J.nextSibling:$.firstChild,X&&Y!=K.dom)X.written=!0;if(K.dom.parentNode==$)while(Y&&Y!=K.dom)Y=c5(Y);else $.insertBefore(K.dom,Y);J=K.dom}if(Y=J?J.nextSibling:$.firstChild,X&&Y)X.written=!0;while(Y)Y=c5(Y);this.length=Q}}function c5(Z){let $=Z.nextSibling;return Z.parentNode.removeChild(Z),$}class k3 extends b3{constructor(Z,$){super($);this.view=Z}owns(Z){for(;Z;Z=Z.parent)if(Z==this)return!0;return!1}isBlock(){return!0}nearest(Z){for(;;){if(!Z)return null;let $=M0.get(Z);if($&&this.owns($))return $;Z=Z.parentNode}}blockTiles(Z){for(let $=[],J=this,Y=0,X=0;;)if(Y==J.children.length){if(!$.length)return;if(J=J.parent,J.breakAfter)X++;Y=$.pop()}else{let Q=J.children[Y++];if(Q instanceof s1)$.push(Y),J=Q,Y=0;else{let K=X+Q.length,U=Z(Q,X);if(U!==void 0)return U;X=K+Q.breakAfter}}}resolveBlock(Z,$){let J,Y=-1,X,Q=-1;if(this.blockTiles((K,U)=>{let q=U+K.length;if(Z>=U&&Z<=q){if(K.isWidget()&&$>=-1&&$<=1){if(K.flags&32)return!0;if(K.flags&16)J=void 0}if((U<Z||Z==q&&($<-1?K.length:K.covers(1)))&&(!J||!K.isWidget()&&J.isWidget()))J=K,Y=Z-U;if((q>Z||Z==U&&($>1?K.length:K.covers(-1)))&&(!X||!K.isWidget()&&X.isWidget()))X=K,Q=Z-U}}),!J&&!X)throw Error("No tile at position "+Z);return J&&$<0||!X?{tile:J,offset:Y}:{tile:X,offset:Q}}}class s1 extends b3{constructor(Z,$){super(Z);this.wrapper=$}isBlock(){return!0}covers(Z){if(!this.children.length)return!1;return Z<0?this.children[0].covers(-1):this.lastChild.covers(1)}get domAttrs(){return this.wrapper.attributes}static of(Z,$){let J=new s1($||document.createElement(Z.tagName),Z);if(!$)J.flags|=4;return J}}class g2 extends b3{constructor(Z,$){super(Z);this.attrs=$}isLine(){return!0}static start(Z,$,J){let Y=new g2($||document.createElement("div"),Z);if(!$||!J)Y.flags|=4;return Y}get domAttrs(){return this.attrs}resolveInline(Z,$,J){let Y=null,X=-1,Q=null,K=-1;function U(G,W){for(let j=0,_=0;j<G.children.length&&_<=W;j++){let z=G.children[j],V=_+z.length;if(V>=W){if(z.isComposite())U(z,W-_);else if((!Q||Q.isHidden&&($>0||J&&cK(Q,z)))&&(V>W||z.flags&32))Q=z,K=W-_;else if(_<W||z.flags&16&&!z.isHidden)Y=z,X=W-_}_=V}}U(this,Z);let q=($<0?Y:Q)||Y||Q;return q?{tile:q,offset:q==Y?X:K}:null}coordsIn(Z,$){let J=this.resolveInline(Z,$,!0);if(!J)return dK(this);return J.tile.coordsIn(Math.max(0,J.offset),$)}domIn(Z,$){let J=this.resolveInline(Z,$);if(J){let{tile:Y,offset:X}=J;if(this.dom.contains(Y.dom)){if(Y.isText())return new L1(Y.dom,Math.min(Y.dom.nodeValue.length,X));return Y.domPosFor(X,Y.flags&16?1:Y.flags&32?-1:$)}let Q=J.tile.parent,K=!1;for(let U of Q.children){if(K)return new L1(U.dom,0);if(U==J.tile)K=!0}}return new L1(this.dom,0)}}function dK(Z){let $=Z.dom.lastChild;if(!$)return Z.dom.getBoundingClientRect();let J=C6($);return J[J.length-1]||null}function cK(Z,$){let J=Z.coordsIn(0,1),Y=$.coordsIn(0,1);return J&&Y&&Y.top<J.bottom}class c0 extends b3{constructor(Z,$){super(Z);this.mark=$}get domAttrs(){return this.mark.attrs}static of(Z,$){let J=new c0($||document.createElement(Z.tagName),Z);if(!$)J.flags|=4;return J}}class j2 extends M0{constructor(Z,$){super(Z,$.length);this.text=$}sync(Z){if(this.flags&2)return;if(super.sync(Z),this.dom.nodeValue!=this.text){if(Z&&Z.node==this.dom)Z.written=!0;this.dom.nodeValue=this.text}}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(Z,$){let J=this.dom.nodeValue.length;if(Z>J)Z=J;let Y=Z,X=Z,Q=0;if(Z==0&&$<0||Z==J&&$>=0){if(!(h.chrome||h.gecko)){if(Z)Y--,Q=1;else if(X<J)X++,Q=-1}}else if($<0)Y--;else if(X<J)X++;let K=B3(this.dom,Y,X).getClientRects();if(!K.length)return null;let U=K[(Q?Q<0:$>=0)?0:K.length-1];if(h.safari&&!Q&&U.width==0)U=Array.prototype.find.call(K,(q)=>q.width)||U;return Q?m6(U,Q<0):U||null}static of(Z,$){let J=new j2($||document.createTextNode(Z),Z);if(!$)J.flags|=2;return J}}class O2 extends M0{constructor(Z,$,J,Y){super(Z,$,Y);this.widget=J}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(Z){if(this.flags&48)return!1;return(this.flags&(Z<0?64:128))>0}coordsIn(Z,$){return this.coordsInWidget(Z,$,!1)}coordsInWidget(Z,$,J){let Y=this.widget.coordsAt(this.dom,Z,$);if(Y)return Y;if(J)return m6(this.dom.getBoundingClientRect(),this.length?Z==0:$<=0);else{let X=this.dom.getClientRects(),Q=null;if(!X.length)return null;let K=this.flags&16?!0:this.flags&32?!1:Z>0;for(let U=K?X.length-1:0;;U+=K?-1:1)if(Q=X[U],Z>0?U==0:U==X.length-1||Q.top<Q.bottom)break;return m6(Q,!K)}}get overrideDOMText(){if(!this.length)return Z0.empty;let{root:Z}=this;if(!Z)return Z0.empty;let $=this.posAtStart;return Z.view.state.doc.slice($,$+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(Z,$,J,Y,X){if(!X){if(X=Z.toDOM($),!Z.editable)X.contentEditable="false"}return new O2(X,J,Z,Y)}}class E3 extends M0{constructor(Z){let $=document.createElement("img");$.className="cm-widgetBuffer",$.setAttribute("aria-hidden","true");super($,0,Z)}get isHidden(){return!0}get overrideDOMText(){return Z0.empty}coordsIn(Z){return this.dom.getBoundingClientRect()}}class aZ{constructor(Z){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=Z}advance(Z,$,J){let{tile:Y,index:X,beforeBreak:Q,parents:K}=this;while(Z||$>0)if(!Y.isComposite())if(X==Y.length)Q=!!Y.breakAfter,{tile:Y,index:X}=K.pop(),X++;else if(!Z)break;else{let U=Math.min(Z,Y.length-X);if(J)J.skip(Y,X,X+U);Z-=U,X+=U}else if(Q){if(!Z)break;if(J)J.break();Z--,Q=!1}else if(X==Y.children.length){if(!Z&&!K.length)break;if(J)J.leave(Y);Q=!!Y.breakAfter,{tile:Y,index:X}=K.pop(),X++}else{let U=Y.children[X],q=U.breakAfter;if(($>0?U.length<=Z:U.length<Z)&&(!J||J.skip(U,0,U.length)!==!1||!U.isComposite))Q=!!q,X++,Z-=U.length;else if(K.push({tile:Y,index:X}),Y=U,X=0,J&&U.isComposite())J.enter(U)}return this.tile=Y,this.index=X,this.beforeBreak=Q,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class oZ{constructor(Z,$,J,Y){this.from=Z,this.to=$,this.wrapper=J,this.rank=Y}}class tZ{constructor(Z,$,J){this.cache=Z,this.root=$,this.blockWrappers=J,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(Z,$,J,Y){var X;this.flushBuffer();let Q=this.ensureMarks($,J),K=Q.lastChild;if(K&&K.isText()&&!(K.flags&8)){this.cache.reused.set(K,2);let U=Q.children[Q.children.length-1]=new j2(K.dom,K.text+Z);U.parent=Q}else Q.append(Y||j2.of(Z,(X=this.cache.find(j2))===null||X===void 0?void 0:X.dom));this.pos+=Z.length,this.afterWidget=null}addComposition(Z,$){let J=this.curLine;if(J.dom!=$.line.dom)J.setDOM(this.cache.reused.has($.line)?R7($.line.dom):$.line.dom),this.cache.reused.set($.line,2);let Y=J;for(let K=$.marks.length-1;K>=0;K--){let U=$.marks[K],q=Y.lastChild;if(q instanceof c0&&q.mark.eq(U.mark)){if(q.dom!=U.dom)q.setDOM(R7(U.dom));Y=q}else{if(this.cache.reused.get(U)){let W=M0.get(U.dom);if(W)W.setDOM(R7(U.dom))}let G=c0.of(U.mark,U.dom);Y.append(G),Y=G}this.cache.reused.set(U,2)}let X=M0.get(Z.text);if(X)this.cache.reused.set(X,2);let Q=new j2(Z.text,Z.text.nodeValue);Q.flags|=8,Y.append(Q)}addInlineWidget(Z,$,J){let Y=this.afterWidget&&Z.flags&48&&(this.afterWidget.flags&48)==(Z.flags&48);if(!Y)this.flushBuffer();let X=this.ensureMarks($,J);if(!Y&&!(Z.flags&16))X.append(this.getBuffer(1));X.append(Z),this.pos+=Z.length,this.afterWidget=Z}addMark(Z,$,J){this.flushBuffer(),this.ensureMarks($,J).append(Z),this.pos+=Z.length,this.afterWidget=null}addBlockWidget(Z){this.getBlockPos().append(Z),this.pos+=Z.length,this.lastBlock=Z,this.endLine()}continueWidget(Z){let $=this.afterWidget||this.lastBlock;$.length+=Z,this.pos+=Z}addLineStart(Z,$){var J;if(!Z)Z=J$;let Y=g2.start(Z,$||((J=this.cache.find(g2))===null||J===void 0?void 0:J.dom),!!$);this.getBlockPos().append(this.lastBlock=this.curLine=Y)}addLine(Z){this.getBlockPos().append(Z),this.pos+=Z.length,this.lastBlock=Z,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(Z){if(!this.blockPosCovered())this.addLineStart(Z)}ensureLine(Z){if(!this.curLine)this.addLineStart(Z)}ensureMarks(Z,$){var J;let Y=this.curLine;for(let X=Z.length-1;X>=0;X--){let Q=Z[X],K;if($>0&&(K=Y.lastChild)&&K instanceof c0&&K.mark.eq(Q))Y=K,$--;else{let U=c0.of(Q,(J=this.cache.find(c0,(q)=>q.mark.eq(Q)))===null||J===void 0?void 0:J.dom);Y.append(U),Y=U,$=0}}return Y}endLine(){if(this.curLine){this.flushBuffer();let Z=this.curLine.lastChild;if(!Z||!s5(this.curLine,!1)||Z.dom.nodeName!="BR"&&Z.isWidget()&&!(h.ios&&s5(this.curLine,!0)))this.curLine.append(this.cache.findWidget(F7,0,32)||new O2(F7.toDOM(),0,F7,32));this.curLine=this.afterWidget=null}}updateBlockWrappers(){if(this.wrapperPos>this.pos+1e4)this.blockWrappers.goto(this.pos),this.wrappers.length=0;for(let Z=this.wrappers.length-1;Z>=0;Z--)if(this.wrappers[Z].to<this.pos)this.wrappers.splice(Z,1);for(let Z=this.blockWrappers;Z.value&&Z.from<=this.pos;Z.next())if(Z.to>=this.pos){let $=new oZ(Z.from,Z.to,Z.value,Z.rank),J=this.wrappers.length;while(J>0&&(this.wrappers[J-1].rank-$.rank||this.wrappers[J-1].to-$.to)<0)J--;this.wrappers.splice(J,0,$)}this.wrapperPos=this.pos}getBlockPos(){var Z;this.updateBlockWrappers();let $=this.root;for(let J of this.wrappers){let Y=$.lastChild;if(J.from<this.pos&&Y instanceof s1&&Y.wrapper.eq(J.wrapper))$=Y;else{let X=s1.of(J.wrapper,(Z=this.cache.find(s1,(Q)=>Q.wrapper.eq(J.wrapper)))===null||Z===void 0?void 0:Z.dom);$.append(X),$=X}}return $}blockPosCovered(){let Z=this.lastBlock;return Z!=null&&!Z.breakAfter&&(!Z.isWidget()||(Z.flags&160)>0)}getBuffer(Z){let $=2|(Z<0?16:32),J=this.cache.find(E3,void 0,1);if(J)J.flags=$;return J||new E3($)}flushBuffer(){if(this.afterWidget&&!(this.afterWidget.flags&32))this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null}}class eZ{constructor(Z){this.skipCount=0,this.text="",this.textOff=0,this.cursor=Z.iter()}skip(Z){if(this.textOff+Z<=this.text.length)this.textOff+=Z;else this.skipCount+=Z-(this.text.length-this.textOff),this.text="",this.textOff=0}next(Z){if(this.textOff==this.text.length){let{value:Y,lineBreak:X,done:Q}=this.cursor.next(this.skipCount);if(this.skipCount=0,Q)throw Error("Ran out of text content when drawing inline views");this.text=Y;let K=this.textOff=Math.min(Z,Y.length);return X?null:Y.slice(0,K)}let $=Math.min(this.text.length,this.textOff+Z),J=this.text.slice(this.textOff,$);return this.textOff=$,J}}var f6=[O2,g2,j2,c0,E3,s1,k3];for(let Z=0;Z<f6.length;Z++)f6[Z].bucket=Z;class Z${constructor(Z){this.view=Z,this.buckets=f6.map(()=>[]),this.index=f6.map(()=>0),this.reused=new Map}add(Z){let $=Z.constructor.bucket,J=this.buckets[$];if(J.length<6)J.push(Z);else J[this.index[$]=(this.index[$]+1)%6]=Z}find(Z,$,J=2){let Y=Z.bucket,X=this.buckets[Y],Q=this.index[Y];for(let K=X.length-1;K>=0;K--){let U=(K+Q)%X.length,q=X[U];if((!$||$(q))&&!this.reused.has(q)){if(X.splice(U,1),U<Q)this.index[Y]--;return this.reused.set(q,J),q}}return null}findWidget(Z,$,J){let Y=this.buckets[0];if(Y.length)for(let X=0,Q=0;;X++){if(X==Y.length){if(Q)return null;Q=1,X=0}let K=Y[X];if(!this.reused.has(K)&&(Q==0?K.widget.compare(Z):K.widget.constructor==Z.constructor&&Z.updateDOM(K.dom,this.view))){if(Y.splice(X,1),X<this.index[0])this.index[0]--;if(K.widget==Z&&K.length==$&&(K.flags&497)==J)return this.reused.set(K,1),K;else return this.reused.set(K,2),new O2(K.dom,$,Z,K.flags&-498|J)}}}reuse(Z){return this.reused.set(Z,1),Z}maybeReuse(Z,$=2){if(this.reused.has(Z))return;return this.reused.set(Z,$),Z.dom}clear(){for(let Z=0;Z<this.buckets.length;Z++)this.buckets[Z].length=this.index[Z]=0}}class $${constructor(Z,$,J,Y,X){this.view=Z,this.decorations=Y,this.disallowBlockEffectsFor=X,this.openWidget=!1,this.openMarks=0,this.cache=new Z$(Z),this.text=new eZ(Z.state.doc),this.builder=new tZ(this.cache,new k3(Z,Z.contentDOM),r.iter(J)),this.cache.reused.set($,2),this.old=new aZ($),this.reuseWalker={skip:(Q,K,U)=>{if(this.cache.add(Q),Q.isComposite())return!1},enter:(Q)=>this.cache.add(Q),leave:()=>{},break:()=>{}}}run(Z,$){let J=$&&this.getCompositionContext($.text);for(let Y=0,X=0,Q=0;;){let K=Q<Z.length?Z[Q++]:null,U=K?K.fromA:this.old.root.length;if(U>Y){let q=U-Y;this.preserve(q,!Q,!K),Y=U,X+=q}if(!K)break;if($&&K.fromA<=$.range.fromA&&K.toA>=$.range.toA)this.forward(K.fromA,$.range.fromA,$.range.fromA<$.range.toA?1:-1),this.emit(X,$.range.fromB),this.cache.clear(),this.builder.addComposition($,J),this.text.skip($.range.toB-$.range.fromB),this.forward($.range.fromA,K.toA),this.emit($.range.toB,K.toB);else this.forward(K.fromA,K.toA),this.emit(X,K.toB);X=K.toB,Y=K.toA}if(this.builder.curLine)this.builder.endLine();return this.builder.root}preserve(Z,$,J){let Y=iK(this.old),X=this.openMarks;this.old.advance(Z,J?1:-1,{skip:(Q,K,U)=>{if(Q.isWidget())if(this.openWidget)this.builder.continueWidget(U-K);else{let q=U>0||K<Q.length?O2.of(Q.widget,this.view,U-K,Q.flags&496,this.cache.maybeReuse(Q)):this.cache.reuse(Q);if(q.flags&256)q.flags&=-2,this.builder.addBlockWidget(q);else this.builder.ensureLine(null),this.builder.addInlineWidget(q,Y,X),X=Y.length}else if(Q.isText()){if(this.builder.ensureLine(null),!K&&U==Q.length)this.builder.addText(Q.text,Y,X,this.cache.reuse(Q));else this.cache.add(Q),this.builder.addText(Q.text.slice(K,U),Y,X);X=Y.length}else if(Q.isLine())Q.flags&=-2,this.cache.reused.set(Q,1),this.builder.addLine(Q);else if(Q instanceof E3)this.cache.add(Q);else if(Q instanceof c0)this.builder.ensureLine(null),this.builder.addMark(Q,Y,X),this.cache.reused.set(Q,1),X=Y.length;else return!1;this.openWidget=!1},enter:(Q)=>{if(Q.isLine())this.builder.addLineStart(Q.attrs,this.cache.maybeReuse(Q));else if(this.cache.add(Q),Q instanceof c0)Y.unshift(Q.mark);this.openWidget=!1},leave:(Q)=>{if(Q.isLine()){if(Y.length)Y.length=X=0}else if(Q instanceof c0)Y.shift(),X=Math.min(X,Y.length)},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(Z)}emit(Z,$){let J=null,Y=this.builder,X=0,Q=r.spans(this.decorations,Z,$,{point:(K,U,q,G,W,j)=>{if(q instanceof _2){if(this.disallowBlockEffectsFor[j]){if(q.block)throw RangeError("Block decorations may not be specified via plugins");if(U>this.view.state.doc.lineAt(K).to)throw RangeError("Decorations that replace line breaks may not be specified via plugins")}if(X=G.length,W>G.length)Y.continueWidget(U-K);else{let _=q.widget||(q.block?V2.block:V2.inline),z=sK(q),V=this.cache.findWidget(_,U-K,z)||O2.of(_,this.view,U-K,z);if(q.block){if(q.startSide>0)Y.addLineStartIfNotCovered(J);Y.addBlockWidget(V)}else Y.ensureLine(J),Y.addInlineWidget(V,G,W)}J=null}else J=nK(J,q);if(U>K)this.text.skip(U-K)},span:(K,U,q,G)=>{for(let W=K;W<U;){let j=this.text.next(Math.min(512,U-W));if(j==null)Y.addLineStartIfNotCovered(J),Y.addBreak(),W++;else Y.ensureLine(J),Y.addText(j,q,G),W+=j.length;J=null}}});Y.addLineStartIfNotCovered(J),this.openWidget=Q>X,this.openMarks=Q}forward(Z,$,J=1){if($-Z<=10)this.old.advance($-Z,J,this.reuseWalker);else this.old.advance(5,-1,this.reuseWalker),this.old.advance($-Z-10,-1),this.old.advance(5,J,this.reuseWalker)}getCompositionContext(Z){let $=[],J=null;for(let Y=Z.parentNode;;Y=Y.parentNode){let X=M0.get(Y);if(Y==this.view.contentDOM)break;if(X instanceof c0)$.push(X);else if(X===null||X===void 0?void 0:X.isLine())J=X;else if(Y.nodeName=="DIV"&&!J&&Y!=this.view.contentDOM)J=new g2(Y,J$);else $.push(c0.of(new C3({tagName:Y.nodeName.toLowerCase(),attributes:EK(Y)}),Y))}return{line:J,marks:$}}}function s5(Z,$){let J=(Y)=>{for(let X of Y.children)if(($?X.isText():X.length)||J(X))return!0;return!1};return J(Z)}function sK(Z){let $=Z.isReplace?(Z.startSide<0?64:0)|(Z.endSide>0?128:0):Z.startSide>0?32:16;if(Z.block)$|=256;return $}var J$={class:"cm-line"};function nK(Z,$){let J=$.spec.attributes,Y=$.spec.class;if(!J&&!Y)return Z;if(!Z)Z={class:"cm-line"};if(J)o7(J,Z);if(Y)Z.class+=" "+Y;return Z}function iK(Z){let $=[];for(let J=Z.parents.length;J>1;J--){let Y=J==Z.parents.length?Z.tile:Z.parents[J].tile;if(Y instanceof c0)$.push(Y.mark)}return $}function R7(Z){let $=M0.get(Z);if($)$.setDOM(Z.cloneNode());return Z}class V2 extends e0{constructor(Z){super();this.tag=Z}eq(Z){return Z.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(Z){return Z.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}V2.inline=new V2("span");V2.block=new V2("div");var F7=new class extends e0{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class h7{constructor(Z){this.view=Z,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=g.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new k3(Z,Z.contentDOM),this.updateInner([new X1(0,0,0,Z.state.doc.length)],null)}update(Z){var $;let J=Z.changedRanges;if(this.minWidth>0&&J.length)if(!J.every(({fromA:G,toA:W})=>W<this.minWidthFrom||G>this.minWidthTo))this.minWidth=this.minWidthFrom=this.minWidthTo=0;else this.minWidthFrom=Z.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=Z.changes.mapPos(this.minWidthTo,1);this.updateEditContextFormatting(Z);let Y=-1;if(this.view.inputState.composing>=0&&!this.view.observer.editContext){if(($=this.domChanged)===null||$===void 0?void 0:$.newSel)Y=this.domChanged.newSel.head;else if(!JU(Z.changes,this.hasComposition)&&!Z.selectionSet)Y=Z.state.selection.main.head}let X=Y>-1?aK(this.view,Z.changes,Y):null;if(this.domChanged=null,this.hasComposition){let{from:G,to:W}=this.hasComposition;J=new X1(G,W,Z.changes.mapPos(G,-1),Z.changes.mapPos(W,1)).addToSet(J.slice())}if(this.hasComposition=X?{from:X.range.fromB,to:X.range.toB}:null,(h.ie||h.chrome)&&!X&&Z&&Z.state.doc.lines!=Z.startState.doc.lines)this.forceSelection=!0;let Q=this.decorations,K=this.blockWrappers;this.updateDeco();let U=eK(Q,this.decorations,Z.changes);if(U.length)J=X1.extendWithRanges(J,U);let q=ZU(K,this.blockWrappers,Z.changes);if(q.length)J=X1.extendWithRanges(J,q);if(X&&!J.some((G)=>G.fromA<=X.range.fromA&&G.toA>=X.range.toA))J=X.range.addToSet(J.slice());if(this.tile.flags&2&&J.length==0)return!1;else{if(this.updateInner(J,X),Z.transactions.length)this.lastUpdate=Date.now();return!0}}updateInner(Z,$){this.view.viewState.mustMeasureContent=!0;let{observer:J}=this.view;J.ignore(()=>{if($||Z.length){let Q=this.tile,K=new $$(this.view,Q,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=K.run(Z,$),w7(Q,K.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let X=h.chrome||h.ios?{node:J.selectionRange.focusNode,written:!1}:void 0;if(this.tile.sync(X),X&&(X.written||J.selectionRange.focusNode!=X.node||!this.tile.dom.contains(X.node)))this.forceSelection=!0;this.tile.dom.style.height=""});let Y=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length){for(let X of this.tile.children)if(X.isWidget()&&X.widget instanceof y6)Y.push(X.dom)}J.updateGaps(Y)}updateEditContextFormatting(Z){this.editContextFormatting=this.editContextFormatting.map(Z.changes);for(let $ of Z.transactions)for(let J of $.effects)if(J.is(cZ))this.editContextFormatting=J.value}updateSelection(Z=!1,$=!1){if(Z||!this.view.observer.selectionRange.focusNode)this.view.observer.readSelectionRange();let{dom:J}=this.tile,Y=this.view.root.activeElement,X=Y==J,Q=!X&&!(this.view.state.facet(g1)||J.tabIndex>-1)&&I3(J,this.view.observer.selectionRange)&&!(Y&&J.contains(Y));if(!(X||$||Q))return;let K=this.forceSelection;this.forceSelection=!1;let U=this.view.state.selection.main,q,G;if(U.empty)G=q=this.inlineDOMNearPos(U.anchor,U.assoc||1);else G=this.inlineDOMNearPos(U.head,U.head==U.from?1:-1),q=this.inlineDOMNearPos(U.anchor,U.anchor==U.from?1:-1);if(h.gecko&&U.empty&&!this.hasComposition&&rK(q)){let j=document.createTextNode("");this.view.observer.ignore(()=>q.node.insertBefore(j,q.node.childNodes[q.offset]||null)),q=G=new L1(j,0),K=!0}let W=this.view.observer.selectionRange;if(K||!W.focusNode||(!D3(q.node,q.offset,W.anchorNode,W.anchorOffset)||!D3(G.node,G.offset,W.focusNode,W.focusOffset))&&!this.suppressWidgetCursorChange(W,U))this.view.observer.ignore(()=>{if(h.android&&h.chrome&&J.contains(W.focusNode)&&$U(W.focusNode,J))J.blur(),J.focus({preventScroll:!0});let j=m2(this.view.root);if(!j);else if(U.empty){if(h.gecko){let _=oK(q.node,q.offset);if(_&&_!=3){let z=(_==1?TZ:yZ)(q.node,q.offset);if(z)q=new L1(z.node,z.offset)}}if(j.collapse(q.node,q.offset),U.bidiLevel!=null&&j.caretBidiLevel!==void 0)j.caretBidiLevel=U.bidiLevel}else if(j.extend){j.collapse(q.node,q.offset);try{j.extend(G.node,G.offset)}catch(_){}}else{let _=document.createRange();if(U.anchor>U.head)[q,G]=[G,q];_.setEnd(G.node,G.offset),_.setStart(q.node,q.offset),j.removeAllRanges(),j.addRange(_)}if(Q&&this.view.root.activeElement==J){if(J.blur(),Y)Y.focus()}}),this.view.observer.setSelectionRange(q,G);this.impreciseAnchor=q.precise?null:new L1(W.anchorNode,W.anchorOffset),this.impreciseHead=G.precise?null:new L1(W.focusNode,W.focusOffset)}suppressWidgetCursorChange(Z,$){return this.hasComposition&&$.empty&&D3(Z.focusNode,Z.focusOffset,Z.anchorNode,Z.anchorOffset)&&this.posFromDOM(Z.focusNode,Z.focusOffset)==$.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:Z}=this,$=Z.state.selection.main,J=m2(Z.root),{anchorNode:Y,anchorOffset:X}=Z.observer.selectionRange;if(!J||!$.empty||!$.assoc||!J.modify)return;let Q=this.lineAt($.head,$.assoc);if(!Q)return;let K=Q.posAtStart;if($.head==K||$.head==K+Q.length)return;let U=this.coordsAt($.head,-1),q=this.coordsAt($.head,1);if(!U||!q||U.bottom>q.top)return;let G=this.domAtPos($.head+$.assoc,$.assoc);J.collapse(G.node,G.offset),J.modify("move",$.assoc<0?"forward":"backward","lineboundary"),Z.observer.readSelectionRange();let W=Z.observer.selectionRange;if(Z.docView.posFromDOM(W.anchorNode,W.anchorOffset)!=$.from)J.collapse(Y,X)}posFromDOM(Z,$){let J=this.tile.nearest(Z);if(!J)return this.tile.dom.compareDocumentPosition(Z)&2?0:this.view.state.doc.length;let Y=J.posAtStart;if(J.isComposite()){let X;if(Z==J.dom)X=J.dom.childNodes[$];else{let Q=f1(Z)==0?0:$==0?-1:1;for(;;){let K=Z.parentNode;if(K==J.dom)break;if(Q==0&&K.firstChild!=K.lastChild)if(Z==K.firstChild)Q=-1;else Q=1;Z=K}if(Q<0)X=Z;else X=Z.nextSibling}if(X==J.dom.firstChild)return Y;while(X&&!M0.get(X))X=X.nextSibling;if(!X)return Y+J.length;for(let Q=0,K=Y;;Q++){let U=J.children[Q];if(U.dom==X)return K;K+=U.length+U.breakAfter}}else if(J.isText())return Z==J.dom?Y+$:Y+($?J.length:0);else return Y}domAtPos(Z,$){let{tile:J,offset:Y}=this.tile.resolveBlock(Z,$);if(J.isWidget())return J.domPosFor(Z,$);return J.domIn(Y,$)}inlineDOMNearPos(Z,$){let J,Y=-1,X=!1,Q,K=-1,U=!1;if(this.tile.blockTiles((q,G)=>{if(q.isWidget()){if(q.flags&32&&G>=Z)return!0;if(q.flags&16)X=!0}else{let W=G+q.length;if(G<=Z)J=q,Y=Z-G,X=W<Z;if(W>=Z&&!Q)Q=q,K=Z-G,U=G>Z;if(G>Z&&Q)return!0}}),!J&&!Q)return this.domAtPos(Z,$);if(X&&Q)J=null;else if(U&&J)Q=null;return J&&$<0||!Q?J.domIn(Y,$):Q.domIn(K,$)}coordsAt(Z,$){let{tile:J,offset:Y}=this.tile.resolveBlock(Z,$);if(J.isWidget()){if(J.widget instanceof y6)return null;return J.coordsInWidget(Y,$,!0)}return J.coordsIn(Y,$)}lineAt(Z,$){let{tile:J}=this.tile.resolveBlock(Z,$);return J.isLine()?J:null}coordsForChar(Z){let{tile:$,offset:J}=this.tile.resolveBlock(Z,1);if(!$.isLine())return null;function Y(X,Q){if(X.isComposite())for(let K of X.children){if(K.length>=Q){let U=Y(K,Q);if(U)return U}if(Q-=K.length,Q<0)break}else if(X.isText()&&Q<X.length){let K=R0(X.text,Q);if(K==Q)return null;let U=B3(X.dom,Q,K).getClientRects();for(let q=0;q<U.length;q++){let G=U[q];if(q==U.length-1||G.top<G.bottom&&G.left<G.right)return G}}return null}return Y($,J)}measureVisibleLineHeights(Z){let $=[],{from:J,to:Y}=Z,X=this.view.contentDOM.clientWidth,Q=X>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,K=-1,U=this.view.textDirection==Q0.LTR,q=0,G=(W,j,_)=>{for(let z=0;z<W.children.length;z++){if(j>Y)break;let V=W.children[z],O=j+V.length,H=V.dom.getBoundingClientRect(),{height:F}=H;if(_&&!z)q+=H.top-_.top;if(V instanceof s1){if(O>J)G(V,j,H)}else if(j>=J){if(q>0)$.push(-q);if($.push(F+q),q=0,Q){let D=V.dom.lastChild,M=D?C6(D):[];if(M.length){let A=M[M.length-1],B=U?A.right-H.left:H.right-A.left;if(B>K)K=B,this.minWidth=X,this.minWidthFrom=j,this.minWidthTo=O}}}if(_&&z==W.children.length-1)q+=_.bottom-H.bottom;j=O+V.breakAfter}};return G(this.tile,0,null),$}textDirectionAt(Z){let{tile:$}=this.tile.resolveBlock(Z,1);return getComputedStyle($.dom).direction=="rtl"?Q0.RTL:Q0.LTR}measureTextSize(){let Z=this.tile.blockTiles((Q)=>{if(Q.isLine()&&Q.children.length&&Q.length<=20){let K=0,U;for(let q of Q.children){if(!q.isText()||/[^ -~]/.test(q.text))return;let G=C6(q.dom);if(G.length!=1)return;K+=G[0].width,U=G[0].height}if(K)return{lineHeight:Q.dom.getBoundingClientRect().height,charWidth:K/Q.length,textHeight:U}}});if(Z)return Z;let $=document.createElement("div"),J,Y,X;return $.className="cm-line",$.style.width="99999px",$.style.position="absolute",$.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild($);let Q=C6($.firstChild)[0];J=$.getBoundingClientRect().height,Y=Q&&Q.width?Q.width/27:7,X=Q&&Q.height?Q.height:J,$.remove()}),{lineHeight:J,charWidth:Y,textHeight:X}}computeBlockGapDeco(){let Z=[],$=this.view.viewState;for(let J=0,Y=0;;Y++){let X=Y==$.viewports.length?null:$.viewports[Y],Q=X?X.from-1:this.view.state.doc.length;if(Q>J){let K=($.lineBlockAt(Q).bottom-$.lineBlockAt(J).top)/this.view.scaleY;Z.push(g.replace({widget:new y6(K),block:!0,inclusive:!0,isBlockGap:!0}).range(J,Q))}if(!X)break;J=X.to+1}return g.set(Z)}updateDeco(){let Z=1,$=this.view.state.facet(n6).map((X)=>{return(this.dynamicDecorationMap[Z++]=typeof X=="function")?X(this.view):X}),J=!1,Y=this.view.state.facet(Y4).map((X,Q)=>{let K=typeof X=="function";if(K)J=!0;return K?X(this.view):X});if(Y.length)this.dynamicDecorationMap[Z++]=J,$.push(r.join(Y));this.decorations=[this.editContextFormatting,...$,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];while(Z<this.decorations.length)this.dynamicDecorationMap[Z++]=!1;this.blockWrappers=this.view.state.facet(nZ).map((X)=>typeof X=="function"?X(this.view):X)}scrollIntoView(Z){if(Z.isSnapshot){let q=this.view.viewState.lineBlockAt(Z.range.head);this.view.scrollDOM.scrollTop=q.top-Z.yMargin,this.view.scrollDOM.scrollLeft=Z.xMargin;return}for(let q of this.view.state.facet(dZ))try{if(q(this.view,Z.range,Z))return!0}catch(G){h0(this.view.state,G,"scroll handler")}let{range:$}=Z,J=this.coordsAt($.head,$.empty?$.assoc:$.head>$.anchor?-1:1),Y;if(!J)return;if(!$.empty&&(Y=this.coordsAt($.anchor,$.anchor>$.head?-1:1)))J={left:Math.min(J.left,Y.left),top:Math.min(J.top,Y.top),right:Math.max(J.right,Y.right),bottom:Math.max(J.bottom,Y.bottom)};let X=X4(this.view),Q={left:J.left-X.left,top:J.top-X.top,right:J.right+X.right,bottom:J.bottom+X.bottom},{offsetWidth:K,offsetHeight:U}=this.view.scrollDOM;TK(this.view.scrollDOM,Q,$.head<$.anchor?-1:1,Z.x,Z.y,Math.max(Math.min(Z.xMargin,K),-K),Math.max(Math.min(Z.yMargin,U),-U),this.view.textDirection==Q0.LTR)}lineHasWidget(Z){let $=(J)=>J.isWidget()||J.children.some($);return $(this.tile.resolveBlock(Z,1).tile)}destroy(){w7(this.tile)}}function w7(Z,$){let J=$===null||$===void 0?void 0:$.get(Z);if(J!=1){if(J==null)Z.destroy();for(let Y of Z.children)w7(Y,$)}}function rK(Z){return Z.node.nodeType==1&&Z.node.firstChild&&(Z.offset==0||Z.node.childNodes[Z.offset-1].contentEditable=="false")&&(Z.offset==Z.node.childNodes.length||Z.node.childNodes[Z.offset].contentEditable=="false")}function Y$(Z,$){let J=Z.observer.selectionRange;if(!J.focusNode)return null;let Y=TZ(J.focusNode,J.focusOffset),X=yZ(J.focusNode,J.focusOffset),Q=Y||X;if(X&&Y&&X.node!=Y.node){let U=M0.get(X.node);if(!U||U.isText()&&U.text!=X.node.nodeValue)Q=X;else if(Z.docView.lastCompositionAfterCursor){let q=M0.get(Y.node);if(!(!q||q.isText()&&q.text!=Y.node.nodeValue))Q=X}}if(Z.docView.lastCompositionAfterCursor=Q!=Y,!Q)return null;let K=$-Q.offset;return{from:K,to:K+Q.node.nodeValue.length,node:Q.node}}function aK(Z,$,J){let Y=Y$(Z,J);if(!Y)return null;let{node:X,from:Q,to:K}=Y,U=X.nodeValue;if(/[\n\r]/.test(U))return null;if(Z.state.doc.sliceString(Y.from,Y.to)!=U)return null;let q=$.invertedDesc;return{range:new X1(q.mapPos(Q),q.mapPos(K),Q,K),text:X}}function oK(Z,$){if(Z.nodeType!=1)return 0;return($&&Z.childNodes[$-1].contentEditable=="false"?1:0)|($<Z.childNodes.length&&Z.childNodes[$].contentEditable=="false"?2:0)}var tK=class{constructor(){this.changes=[]}compareRange($,J){w2($,J,this.changes)}comparePoint($,J){w2($,J,this.changes)}boundChange($){w2($,$,this.changes)}};function eK(Z,$,J){let Y=new tK;return r.compare(Z,$,J,Y),Y.changes}class X${constructor(){this.changes=[]}compareRange(Z,$){w2(Z,$,this.changes)}comparePoint(){}boundChange(Z){w2(Z,Z,this.changes)}}function ZU(Z,$,J){let Y=new X$;return r.compare(Z,$,J,Y),Y.changes}function $U(Z,$){for(let J=Z;J&&J!=$;J=J.assignedSlot||J.parentNode)if(J.nodeType==1&&J.contentEditable=="false")return!0;return!1}function JU(Z,$){let J=!1;if($)Z.iterChangedRanges((Y,X)=>{if(Y<$.to&&X>$.from)J=!0});return J}class y6 extends e0{constructor(Z){super();this.height=Z}toDOM(){let Z=document.createElement("div");return Z.className="cm-gap",this.updateDOM(Z),Z}eq(Z){return Z.height==this.height}updateDOM(Z){return Z.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function YU(Z,$,J=1){let Y=Z.charCategorizer($),X=Z.doc.lineAt($),Q=$-X.from;if(X.length==0)return L.cursor($);if(Q==0)J=1;else if(Q==X.length)J=-1;let K=Q,U=Q;if(J<0)K=R0(X.text,Q,!1);else U=R0(X.text,Q);let q=Y(X.text.slice(K,U));while(K>0){let G=R0(X.text,K,!1);if(Y(X.text.slice(G,K))!=q)break;K=G}while(U<X.length){let G=R0(X.text,U);if(Y(X.text.slice(U,G))!=q)break;U=G}return L.range(K+X.from,U+X.from)}function XU(Z,$,J,Y,X){let Q=Math.round((Y-$.left)*Z.defaultCharacterWidth);if(Z.lineWrapping&&J.height>Z.defaultLineHeight*1.5){let U=Z.viewState.heightOracle.textHeight,q=Math.floor((X-J.top-(Z.defaultLineHeight-U)*0.5)/U);Q+=q*Z.viewState.heightOracle.lineLength}let K=Z.state.sliceDoc(J.from,J.to);return J.from+R6(K,Q,Z.state.tabSize)}function v7(Z,$,J){let Y=Z.lineBlockAt($);if(Array.isArray(Y.type)){let X;for(let Q of Y.type){if(Q.from>$)break;if(Q.to<$)continue;if(Q.from<$&&Q.to>$)return Q;if(!X||Q.type==w0.Text&&(X.type!=Q.type||(J<0?Q.from<$:Q.to>$)))X=Q}return X||Y}return Y}function QU(Z,$,J,Y){let X=v7(Z,$.head,$.assoc||-1),Q=!Y||X.type!=w0.Text||!(Z.lineWrapping||X.widgetLineBreaks)?null:Z.coordsAtPos($.assoc<0&&$.head>X.from?$.head-1:$.head);if(Q){let K=Z.dom.getBoundingClientRect(),U=Z.textDirectionAt(X.from),q=Z.posAtCoords({x:J==(U==Q0.LTR)?K.right-1:K.left+1,y:(Q.top+Q.bottom)/2});if(q!=null)return L.cursor(q,J?-1:1)}return L.cursor(J?X.to:X.from,J?-1:1)}function n5(Z,$,J,Y){let X=Z.state.doc.lineAt($.head),Q=Z.bidiSpans(X),K=Z.textDirectionAt(X.from);for(let U=$,q=null;;){let G=gK(X,Q,K,U,J),W=hZ;if(!G){if(X.number==(J?Z.state.doc.lines:1))return U;W=`
`,X=Z.state.doc.line(X.number+(J?1:-1)),Q=Z.bidiSpans(X),G=Z.visualLineSide(X,!J)}if(!q){if(!Y)return G;q=Y(W)}else if(!q(W))return U;U=G}}function KU(Z,$,J){let Y=Z.state.charCategorizer($),X=Y(J);return(Q)=>{let K=Y(Q);if(X==K0.Space)X=K;return X==K}}function UU(Z,$,J,Y){let X=$.head,Q=J?1:-1;if(X==(J?Z.state.doc.length:0))return L.cursor(X,$.assoc);let K=$.goalColumn,U,q=Z.contentDOM.getBoundingClientRect(),G=Z.coordsAtPos(X,$.assoc||-1),W=Z.documentTop;if(G){if(K==null)K=G.left-q.left;U=Q<0?G.top:G.bottom}else{let V=Z.viewState.lineBlockAt(X);if(K==null)K=Math.min(q.right-q.left,Z.defaultCharacterWidth*(X-V.from));U=(Q<0?V.top:V.bottom)+W}let j=q.left+K,_=Y!==null&&Y!==void 0?Y:Z.viewState.heightOracle.textHeight>>1,z=u7(Z,{x:j,y:U+_*Q},!1,Q);return L.cursor(z.pos,z.assoc,void 0,K)}function L3(Z,$,J){for(;;){let Y=0;for(let X of Z)X.between($-1,$+1,(Q,K,U)=>{if($>Q&&$<K){let q=Y||J||($-Q<K-$?-1:1);$=q<0?Q:K,Y=q}});if(!Y)return $}}function Q$(Z,$){let J=null;for(let Y=0;Y<$.ranges.length;Y++){let X=$.ranges[Y],Q=null;if(X.empty){let K=L3(Z,X.from,0);if(K!=X.from)Q=L.cursor(K,-1)}else{let K=L3(Z,X.from,-1),U=L3(Z,X.to,1);if(K!=X.from||U!=X.to)Q=L.range(X.from==X.anchor?K:U,X.from==X.head?K:U)}if(Q){if(!J)J=$.ranges.slice();J[Y]=Q}}return J?L.create(J,$.mainIndex):$}function I7(Z,$,J){let Y=L3(Z.state.facet(y3).map((X)=>X(Z)),J.from,$.head>J.from?-1:1);return Y==J.from?J:L.cursor(Y,Y<J.from?1:-1)}class I1{constructor(Z,$){this.pos=Z,this.assoc=$}}function u7(Z,$,J,Y){let X=Z.contentDOM.getBoundingClientRect(),Q=X.top+Z.viewState.paddingTop,{x:K,y:U}=$,q=U-Q,G;for(;;){if(q<0)return new I1(0,1);if(q>Z.viewState.docHeight)return new I1(Z.state.doc.length,-1);if(G=Z.elementAtHeight(q),Y==null)break;if(G.type==w0.Text){let _=Z.docView.coordsAt(Y<0?G.from:G.to,Y);if(_&&(Y<0?_.top<=q+Q:_.bottom>=q+Q))break}let j=Z.viewState.heightOracle.textHeight/2;q=Y>0?G.bottom+j:G.top-j}if(Z.viewport.from>=G.to||Z.viewport.to<=G.from){if(J)return null;if(G.type==w0.Text){let j=XU(Z,X,G,K,U);return new I1(j,j==G.from?1:-1)}}if(G.type!=w0.Text)return q<(G.top+G.bottom)/2?new I1(G.from,1):new I1(G.to,-1);let W=Z.docView.lineAt(G.from,2);if(!W||W.length!=G.length)W=Z.docView.lineAt(G.from,-2);return K$(Z,W,G.from,K,U)}function K$(Z,$,J,Y,X){let Q=-1,K=null,U=1e9,q=1e9,G=X,W=X,j=(_,z)=>{for(let V=0;V<_.length;V++){let O=_[V];if(O.top==O.bottom)continue;let H=O.left>Y?O.left-Y:O.right<Y?Y-O.right:0,F=O.top>X?O.top-X:O.bottom<X?X-O.bottom:0;if(O.top<=W&&O.bottom>=G)G=Math.min(O.top,G),W=Math.max(O.bottom,W),F=0;if(Q<0||(F-q||H-U)<0)if(Q>=0&&q&&U<H&&K.top<=W-2&&K.bottom>=G+2)q=0;else Q=z,U=H,q=F,K=O}};if($.isText()){for(let z=0;z<$.length;){let V=R0($.text,z);if(j(B3($.dom,z,V).getClientRects(),z),!U&&!q)break;z=V}return Y>(K.left+K.right)/2==(i5(Z,Q+J)==Q0.LTR)?new I1(J+R0($.text,Q),-1):new I1(J+Q,1)}else{if(!$.length)return new I1(J,1);for(let O=0;O<$.children.length;O++){let H=$.children[O];if(H.flags&48)continue;let F=(H.dom.nodeType==1?H.dom:B3(H.dom,0,H.length)).getClientRects();if(j(F,O),!U&&!q)break}let _=$.children[Q],z=$.posBefore(_,J);if(_.isComposite()||_.isText())return K$(Z,_,z,Math.max(K.left,Math.min(K.right,Y)),X);return Y>(K.left+K.right)/2==(i5(Z,Q+J)==Q0.LTR)?new I1(z+_.length,-1):new I1(z,1)}}function i5(Z,$){let J=Z.state.doc.lineAt($);return Z.bidiSpans(J)[k1.find(Z.bidiSpans(J),$-J.from,-1,1)].dir}var V3="ï¿¿";class U${constructor(Z,$){this.points=Z,this.view=$,this.text="",this.lineSeparator=$.state.facet(i.lineSeparator)}append(Z){this.text+=Z}lineBreak(){this.text+=V3}readRange(Z,$){if(!Z)return this;let J=Z.parentNode;for(let Y=Z;;){this.findPointBefore(J,Y);let X=this.text.length;this.readNode(Y);let Q=M0.get(Y),K=Y.nextSibling;if(K==$){if((Q===null||Q===void 0?void 0:Q.breakAfter)&&!K&&J!=this.view.contentDOM)this.lineBreak();break}let U=M0.get(K);if((Q&&U?Q.breakAfter:(Q?Q.breakAfter:u6(Y))||u6(K)&&(Y.nodeName!="BR"||(Q===null||Q===void 0?void 0:Q.isWidget()))&&this.text.length>X)&&!GU(K,$))this.lineBreak();Y=K}return this.findPointBefore(J,$),this}readTextNode(Z){let $=Z.nodeValue;for(let J of this.points)if(J.node==Z)J.pos=this.text.length+Math.min(J.offset,$.length);for(let J=0,Y=this.lineSeparator?null:/\r\n?|\n/g;;){let X=-1,Q=1,K;if(this.lineSeparator)X=$.indexOf(this.lineSeparator,J),Q=this.lineSeparator.length;else if(K=Y.exec($))X=K.index,Q=K[0].length;if(this.append($.slice(J,X<0?$.length:X)),X<0)break;if(this.lineBreak(),Q>1){for(let U of this.points)if(U.node==Z&&U.pos>this.text.length)U.pos-=Q-1}J=X+Q}}readNode(Z){let $=M0.get(Z),J=$&&$.overrideDOMText;if(J!=null){this.findPointInside(Z,J.length);for(let Y=J.iter();!Y.next().done;)if(Y.lineBreak)this.lineBreak();else this.append(Y.value)}else if(Z.nodeType==3)this.readTextNode(Z);else if(Z.nodeName=="BR"){if(Z.nextSibling)this.lineBreak()}else if(Z.nodeType==1)this.readRange(Z.firstChild,null)}findPointBefore(Z,$){for(let J of this.points)if(J.node==Z&&Z.childNodes[J.offset]==$)J.pos=this.text.length}findPointInside(Z,$){for(let J of this.points)if(Z.nodeType==3?J.node==Z:Z.contains(J.node))J.pos=this.text.length+(qU(Z,J.node,J.offset)?$:0)}}function qU(Z,$,J){for(;;){if(!$||J<f1($))return!1;if($==Z)return!0;J=n1($)+1,$=$.parentNode}}function GU(Z,$){let J;for(;;Z=Z.nextSibling){if(Z==$||!Z)break;let Y=M0.get(Z);if(!(Y===null||Y===void 0?void 0:Y.isWidget()))return!1;if(Y)(J||(J=[])).push(Y)}if(J)for(let Y of J){let X=Y.overrideDOMText;if(X===null||X===void 0?void 0:X.length)return!1}return!0}class m7{constructor(Z,$){this.node=Z,this.offset=$,this.pos=-1}}class q${constructor(Z,$,J,Y){this.typeOver=Y,this.bounds=null,this.text="",this.domChanged=$>-1;let{impreciseHead:X,impreciseAnchor:Q}=Z.docView;if(Z.state.readOnly&&$>-1)this.newSel=null;else if($>-1&&(this.bounds=G$(Z.docView.tile,$,J,0))){let K=X||Q?[]:jU(Z),U=new U$(K,Z);U.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=U.text,this.newSel=_U(K,this.bounds.from)}else{let K=Z.observer.selectionRange,U=X&&X.node==K.focusNode&&X.offset==K.focusOffset||!y7(Z.contentDOM,K.focusNode)?Z.state.selection.main.head:Z.docView.posFromDOM(K.focusNode,K.focusOffset),q=Q&&Q.node==K.anchorNode&&Q.offset==K.anchorOffset||!y7(Z.contentDOM,K.anchorNode)?Z.state.selection.main.anchor:Z.docView.posFromDOM(K.anchorNode,K.anchorOffset),G=Z.viewport;if((h.ios||h.chrome)&&Z.state.selection.main.empty&&U!=q&&(G.from>0||G.to<Z.state.doc.length)){let W=Math.min(U,q),j=Math.max(U,q),_=G.from-W,z=G.to-j;if((_==0||_==1||W==0)&&(z==0||z==-1||j==Z.state.doc.length))U=0,q=Z.state.doc.length}if(Z.inputState.composing>-1&&Z.state.selection.ranges.length>1)this.newSel=Z.state.selection.replaceRange(L.range(q,U));else this.newSel=L.single(q,U)}}}function G$(Z,$,J,Y){if(Z.isComposite()){let X=-1,Q=-1,K=-1,U=-1;for(let q=0,G=Y,W=Y;q<Z.children.length;q++){let j=Z.children[q],_=G+j.length;if(G<$&&_>J)return G$(j,$,J,G);if(_>=$&&X==-1)X=q,Q=G;if(G>J&&j.dom.parentNode==Z.dom){K=q,U=W;break}W=_,G=_+j.breakAfter}return{from:Q,to:U<0?Y+Z.length:U,startDOM:(X?Z.children[X-1].dom.nextSibling:null)||Z.dom.firstChild,endDOM:K<Z.children.length&&K>=0?Z.children[K].dom:null}}else if(Z.isText())return{from:Y,to:Y+Z.length,startDOM:Z.dom,endDOM:Z.dom.nextSibling};else return null}function W$(Z,$){let J,{newSel:Y}=$,X=Z.state.selection.main,Q=Z.inputState.lastKeyTime>Date.now()-100?Z.inputState.lastKeyCode:-1;if($.bounds){let{from:K,to:U}=$.bounds,q=X.from,G=null;if(Q===8||h.android&&$.text.length<U-K)q=X.to,G="end";let W=j$(Z.state.doc.sliceString(K,U,V3),$.text,q-K,G);if(W){if(h.chrome&&Q==13&&W.toB==W.from+2&&$.text.slice(W.from,W.toB)==V3+V3)W.toB--;J={from:K+W.from,to:K+W.toA,insert:Z0.of($.text.slice(W.from,W.toB).split(V3))}}}else if(Y&&(!Z.hasFocus&&Z.state.facet(g1)||p6(Y,X)))Y=null;if(!J&&!Y)return!1;if(!J&&$.typeOver&&!X.empty&&Y&&Y.main.empty)J={from:X.from,to:X.to,insert:Z.state.doc.slice(X.from,X.to)};else if((h.mac||h.android)&&J&&J.from==J.to&&J.from==X.head-1&&/^\. ?$/.test(J.insert.toString())&&Z.contentDOM.getAttribute("autocorrect")=="off"){if(Y&&J.insert.length==2)Y=L.single(Y.main.anchor-1,Y.main.head-1);J={from:J.from,to:J.to,insert:Z0.of([J.insert.toString().replace("."," ")])}}else if(J&&J.from>=X.from&&J.to<=X.to&&(J.from!=X.from||J.to!=X.to)&&X.to-X.from-(J.to-J.from)<=4)J={from:X.from,to:X.to,insert:Z.state.doc.slice(X.from,J.from).append(J.insert).append(Z.state.doc.slice(J.to,X.to))};else if(Z.state.doc.lineAt(X.from).to<X.to&&Z.docView.lineHasWidget(X.to)&&Z.inputState.insertingTextAt>Date.now()-50)J={from:X.from,to:X.to,insert:Z.state.toText(Z.inputState.insertingText)};else if(h.chrome&&J&&J.from==J.to&&J.from==X.head&&J.insert.toString()==`
 `&&Z.lineWrapping){if(Y)Y=L.single(Y.main.anchor-1,Y.main.head-1);J={from:X.from,to:X.to,insert:Z0.of([" "])}}if(J)return Q4(Z,J,Y,Q);else if(Y&&!p6(Y,X)){let K=!1,U="select";if(Z.inputState.lastSelectionTime>Date.now()-50){if(Z.inputState.lastSelectionOrigin=="select")K=!0;if(U=Z.inputState.lastSelectionOrigin,U=="select.pointer")Y=Q$(Z.state.facet(y3).map((q)=>q(Z)),Y)}return Z.dispatch({selection:Y,scrollIntoView:K,userEvent:U}),!0}else return!1}function Q4(Z,$,J,Y=-1){if(h.ios&&Z.inputState.flushIOSKey($))return!0;let X=Z.state.selection.main;if(h.android&&($.to==X.to&&($.from==X.from||$.from==X.from-1&&Z.state.sliceDoc($.from,X.from)==" ")&&$.insert.length==1&&$.insert.lines==2&&v2(Z.contentDOM,"Enter",13)||($.from==X.from-1&&$.to==X.to&&$.insert.length==0||Y==8&&$.insert.length<$.to-$.from&&$.to>X.head)&&v2(Z.contentDOM,"Backspace",8)||$.from==X.from&&$.to==X.to+1&&$.insert.length==0&&v2(Z.contentDOM,"Delete",46)))return!0;let Q=$.insert.toString();if(Z.inputState.composing>=0)Z.inputState.composing++;let K,U=()=>K||(K=WU(Z,$,J));if(!Z.state.facet(gZ).some((q)=>q(Z,$.from,$.to,Q,U)))Z.dispatch(U());return!0}function WU(Z,$,J){let Y,X=Z.state,Q=X.selection.main,K=-1;if($.from==$.to&&$.from<Q.from||$.from>Q.to){let q=$.from<Q.from?-1:1,G=q<0?Q.from:Q.to,W=L3(X.facet(y3).map((j)=>j(Z)),G,q);if($.from==W)K=W}if(K>-1)Y={changes:$,selection:L.cursor($.from+$.insert.length,-1)};else if($.from>=Q.from&&$.to<=Q.to&&$.to-$.from>=(Q.to-Q.from)/3&&(!J||J.main.empty&&J.main.from==$.from+$.insert.length)&&Z.inputState.composing<0){let q=Q.from<$.from?X.sliceDoc(Q.from,$.from):"",G=Q.to>$.to?X.sliceDoc($.to,Q.to):"";Y=X.replaceSelection(Z.state.toText(q+$.insert.sliceString(0,void 0,Z.state.lineBreak)+G))}else{let q=X.changes($),G=J&&J.main.to<=q.newLength?J.main:void 0;if(X.selection.ranges.length>1&&(Z.inputState.composing>=0||Z.inputState.compositionPendingChange)&&$.to<=Q.to+10&&$.to>=Q.to-10){let W=Z.state.sliceDoc($.from,$.to),j,_=J&&Y$(Z,J.main.head);if(_){let V=$.insert.length-($.to-$.from);j={from:_.from,to:_.to-V}}else j=Z.state.doc.lineAt(Q.head);let z=Q.to-$.to;Y=X.changeByRange((V)=>{if(V.from==Q.from&&V.to==Q.to)return{changes:q,range:G||V.map(q)};let O=V.to-z,H=O-W.length;if(Z.state.sliceDoc(H,O)!=W||O>=j.from&&H<=j.to)return{range:V};let F=X.changes({from:H,to:O,insert:$.insert}),D=V.to-Q.to;return{changes:F,range:!G?V.map(F):L.range(Math.max(0,G.anchor+D),Math.max(0,G.head+D))}})}else Y={changes:q,selection:G&&X.selection.replaceRange(G)}}let U="input.type";if(Z.composing||Z.inputState.compositionPendingChange&&Z.inputState.compositionEndedAt>Date.now()-50){if(Z.inputState.compositionPendingChange=!1,U+=".compose",Z.inputState.compositionFirstChange)U+=".start",Z.inputState.compositionFirstChange=!1}return X.update(Y,{userEvent:U,scrollIntoView:!0})}function j$(Z,$,J,Y){let X=Math.min(Z.length,$.length),Q=0;while(Q<X&&Z.charCodeAt(Q)==$.charCodeAt(Q))Q++;if(Q==X&&Z.length==$.length)return null;let K=Z.length,U=$.length;while(K>0&&U>0&&Z.charCodeAt(K-1)==$.charCodeAt(U-1))K--,U--;if(Y=="end"){let q=Math.max(0,Q-Math.min(K,U));J-=K+q-Q}if(K<Q&&Z.length<$.length){let q=J<=Q&&J>=K?Q-J:0;Q-=q,U=Q+(U-K),K=Q}else if(U<Q){let q=J<=Q&&J>=U?Q-J:0;Q-=q,K=Q+(K-U),U=Q}return{from:Q,toA:K,toB:U}}function jU(Z){let $=[];if(Z.root.activeElement!=Z.contentDOM)return $;let{anchorNode:J,anchorOffset:Y,focusNode:X,focusOffset:Q}=Z.observer.selectionRange;if(J){if($.push(new m7(J,Y)),X!=J||Q!=Y)$.push(new m7(X,Q))}return $}function _U(Z,$){if(Z.length==0)return null;let J=Z[0].pos,Y=Z.length==2?Z[1].pos:J;return J>-1&&Y>-1?L.single(J+$,Y+$):null}function p6(Z,$){return $.head==Z.main.head&&$.anchor==Z.main.anchor}class _${setSelectionOrigin(Z){this.lastSelectionOrigin=Z,this.lastSelectionTime=Date.now()}constructor(Z){if(this.view=Z,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=Z.hasFocus,h.safari)Z.contentDOM.addEventListener("input",()=>null);if(h.gecko)EU(Z.contentDOM.ownerDocument)}handleEvent(Z){if(!FU(this.view,Z)||this.ignoreDuringComposition(Z))return;if(Z.type=="keydown"&&this.keydown(Z))return;if(this.view.updateState!=0)Promise.resolve().then(()=>this.runHandlers(Z.type,Z));else this.runHandlers(Z.type,Z)}runHandlers(Z,$){let J=this.handlers[Z];if(J){for(let Y of J.observers)Y(this.view,$);for(let Y of J.handlers){if($.defaultPrevented)break;if(Y(this.view,$)){$.preventDefault();break}}}}ensureHandlers(Z){let $=zU(Z),J=this.handlers,Y=this.view.contentDOM;for(let X in $)if(X!="scroll"){let Q=!$[X].handlers.length,K=J[X];if(K&&Q!=!K.handlers.length)Y.removeEventListener(X,this.handleEvent),K=null;if(!K)Y.addEventListener(X,this.handleEvent,{passive:Q})}for(let X in J)if(X!="scroll"&&!$[X])Y.removeEventListener(X,this.handleEvent);this.handlers=$}keydown(Z){if(this.lastKeyCode=Z.keyCode,this.lastKeyTime=Date.now(),Z.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&Z.keyCode!=27&&O$.indexOf(Z.keyCode)<0)this.tabFocusMode=-1;if(h.android&&h.chrome&&!Z.synthetic&&(Z.keyCode==13||Z.keyCode==8))return this.view.observer.delayAndroidKey(Z.key,Z.keyCode),!0;let $;if(h.ios&&!Z.synthetic&&!Z.altKey&&!Z.metaKey&&(($=z$.find((J)=>J.keyCode==Z.keyCode))&&!Z.ctrlKey||OU.indexOf(Z.key)>-1&&Z.ctrlKey&&!Z.shiftKey))return this.pendingIOSKey=$||Z,setTimeout(()=>this.flushIOSKey(),250),!0;if(Z.keyCode!=229)this.view.observer.forceFlush();return!1}flushIOSKey(Z){let $=this.pendingIOSKey;if(!$)return!1;if($.key=="Enter"&&Z&&Z.from<Z.to&&/^\S+$/.test(Z.insert.toString()))return!1;return this.pendingIOSKey=void 0,v2(this.view.contentDOM,$.key,$.keyCode,$ instanceof KeyboardEvent?$:void 0)}ignoreDuringComposition(Z){if(!/^key/.test(Z.type)||Z.synthetic)return!1;if(this.composing>0)return!0;if(h.safari&&!h.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)return this.compositionPendingKey=!1,!0;return!1}startMouseSelection(Z){if(this.mouseSelection)this.mouseSelection.destroy();this.mouseSelection=Z}update(Z){if(this.view.observer.update(Z),this.mouseSelection)this.mouseSelection.update(Z);if(this.draggedContent&&Z.docChanged)this.draggedContent=this.draggedContent.map(Z.changes);if(Z.transactions.length)this.lastKeyCode=this.lastSelectionTime=0}destroy(){if(this.mouseSelection)this.mouseSelection.destroy()}}function r5(Z,$){return(J,Y)=>{try{return $.call(Z,Y,J)}catch(X){h0(J.state,X)}}}function zU(Z){let $=Object.create(null);function J(Y){return $[Y]||($[Y]={observers:[],handlers:[]})}for(let Y of Z){let X=Y.spec,Q=X&&X.plugin.domEventHandlers,K=X&&X.plugin.domEventObservers;if(Q)for(let U in Q){let q=Q[U];if(q)J(U).handlers.push(r5(Y.value,q))}if(K)for(let U in K){let q=K[U];if(q)J(U).observers.push(r5(Y.value,q))}}for(let Y in M1)J(Y).handlers.push(M1[Y]);for(let Y in Q1)J(Y).observers.push(Q1[Y]);return $}var z$=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],OU="dthko",O$=[16,17,18,20,91,92,224,225],I6=6;function D6(Z){return Math.max(0,Z)*0.7+8}function VU(Z,$){return Math.max(Math.abs(Z.clientX-$.clientX),Math.abs(Z.clientY-$.clientY))}class V${constructor(Z,$,J,Y){this.view=Z,this.startEvent=$,this.style=J,this.mustSelect=Y,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=$,this.scrollParents=yK(Z.contentDOM),this.atoms=Z.state.facet(y3).map((Q)=>Q(Z));let X=Z.contentDOM.ownerDocument;X.addEventListener("mousemove",this.move=this.move.bind(this)),X.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=$.shiftKey,this.multiple=Z.state.facet(i.allowMultipleSelections)&&HU(Z,$),this.dragging=RU(Z,$)&&R$($)==1?null:!1}start(Z){if(this.dragging===!1)this.select(Z)}move(Z){if(Z.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&VU(this.startEvent,Z)<10)return;this.select(this.lastEvent=Z);let $=0,J=0,Y=0,X=0,Q=this.view.win.innerWidth,K=this.view.win.innerHeight;if(this.scrollParents.x)({left:Y,right:Q}=this.scrollParents.x.getBoundingClientRect());if(this.scrollParents.y)({top:X,bottom:K}=this.scrollParents.y.getBoundingClientRect());let U=X4(this.view);if(Z.clientX-U.left<=Y+I6)$=-D6(Y-Z.clientX);else if(Z.clientX+U.right>=Q-I6)$=D6(Z.clientX-Q);if(Z.clientY-U.top<=X+I6)J=-D6(X-Z.clientY);else if(Z.clientY+U.bottom>=K-I6)J=D6(Z.clientY-K);this.setScrollSpeed($,J)}up(Z){if(this.dragging==null)this.select(this.lastEvent);if(!this.dragging)Z.preventDefault();this.destroy()}destroy(){this.setScrollSpeed(0,0);let Z=this.view.contentDOM.ownerDocument;Z.removeEventListener("mousemove",this.move),Z.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(Z,$){if(this.scrollSpeed={x:Z,y:$},Z||$){if(this.scrolling<0)this.scrolling=setInterval(()=>this.scroll(),50)}else if(this.scrolling>-1)clearInterval(this.scrolling),this.scrolling=-1}scroll(){let{x:Z,y:$}=this.scrollSpeed;if(Z&&this.scrollParents.x)this.scrollParents.x.scrollLeft+=Z,Z=0;if($&&this.scrollParents.y)this.scrollParents.y.scrollTop+=$,$=0;if(Z||$)this.view.win.scrollBy(Z,$);if(this.dragging===!1)this.select(this.lastEvent)}select(Z){let{view:$}=this,J=Q$(this.atoms,this.style.get(Z,this.extend,this.multiple));if(this.mustSelect||!J.eq($.state.selection,this.dragging===!1))this.view.dispatch({selection:J,userEvent:"select.pointer"});this.mustSelect=!1}update(Z){if(Z.transactions.some(($)=>$.isUserEvent("input.type")))this.destroy();else if(this.style.update(Z))setTimeout(()=>this.select(this.lastEvent),20)}}function HU(Z,$){let J=Z.state.facet(wZ);return J.length?J[0]($):h.mac?$.metaKey:$.ctrlKey}function NU(Z,$){let J=Z.state.facet(vZ);return J.length?J[0]($):h.mac?!$.altKey:!$.ctrlKey}function RU(Z,$){let{main:J}=Z.state.selection;if(J.empty)return!1;let Y=m2(Z.root);if(!Y||Y.rangeCount==0)return!0;let X=Y.getRangeAt(0).getClientRects();for(let Q=0;Q<X.length;Q++){let K=X[Q];if(K.left<=$.clientX&&K.right>=$.clientX&&K.top<=$.clientY&&K.bottom>=$.clientY)return!0}return!1}function FU(Z,$){if(!$.bubbles)return!0;if($.defaultPrevented)return!1;for(let J=$.target,Y;J!=Z.contentDOM;J=J.parentNode)if(!J||J.nodeType==11||(Y=M0.get(J))&&Y.isWidget()&&!Y.isHidden&&Y.widget.ignoreEvent($))return!1;return!0}var M1=Object.create(null),Q1=Object.create(null),H$=h.ie&&h.ie_version<15||h.ios&&h.webkit_version<604;function IU(Z){let $=Z.dom.parentNode;if(!$)return;let J=$.appendChild(document.createElement("textarea"));J.style.cssText="position: fixed; left: -10000px; top: 10px",J.focus(),setTimeout(()=>{Z.focus(),J.remove(),N$(Z,J.value)},50)}function i6(Z,$,J){for(let Y of Z.facet($))J=Y(J,Z);return J}function N$(Z,$){$=i6(Z.state,Z4,$);let{state:J}=Z,Y,X=1,Q=J.toText($),K=Q.lines==J.selection.ranges.length;if(g7!=null&&J.selection.ranges.every((q)=>q.empty)&&g7==Q.toString()){let q=-1;Y=J.changeByRange((G)=>{let W=J.doc.lineAt(G.from);if(W.from==q)return{range:G};q=W.from;let j=J.toText((K?Q.line(X++).text:$)+J.lineBreak);return{changes:{from:W.from,insert:j},range:L.cursor(G.from+j.length)}})}else if(K)Y=J.changeByRange((q)=>{let G=Q.line(X++);return{changes:{from:q.from,to:q.to,insert:G.text},range:L.cursor(q.from+G.length)}});else Y=J.replaceSelection(Q);Z.dispatch(Y,{userEvent:"input.paste",scrollIntoView:!0})}Q1.scroll=(Z)=>{Z.inputState.lastScrollTop=Z.scrollDOM.scrollTop,Z.inputState.lastScrollLeft=Z.scrollDOM.scrollLeft};M1.keydown=(Z,$)=>{if(Z.inputState.setSelectionOrigin("select"),$.keyCode==27&&Z.inputState.tabFocusMode!=0)Z.inputState.tabFocusMode=Date.now()+2000;return!1};Q1.touchstart=(Z,$)=>{Z.inputState.lastTouchTime=Date.now(),Z.inputState.setSelectionOrigin("select.pointer")};Q1.touchmove=(Z)=>{Z.inputState.setSelectionOrigin("select.pointer")};M1.mousedown=(Z,$)=>{if(Z.observer.flush(),Z.inputState.lastTouchTime>Date.now()-2000)return!1;let J=null;for(let Y of Z.state.facet(uZ))if(J=Y(Z,$),J)break;if(!J&&$.button==0)J=LU(Z,$);if(J){let Y=!Z.hasFocus;if(Z.inputState.startMouseSelection(new V$(Z,$,J,Y)),Y)Z.observer.ignore(()=>{PZ(Z.contentDOM);let Q=Z.root.activeElement;if(Q&&!Q.contains(Z.contentDOM))Q.blur()});let X=Z.inputState.mouseSelection;if(X)return X.start($),X.dragging===!1}else Z.inputState.setSelectionOrigin("select.pointer");return!1};function a5(Z,$,J,Y){if(Y==1)return L.cursor($,J);else if(Y==2)return YU(Z.state,$,J);else{let X=Z.docView.lineAt($,J),Q=Z.state.doc.lineAt(X?X.posAtEnd:$),K=X?X.posAtStart:Q.from,U=X?X.posAtEnd:Q.to;if(U<Z.state.doc.length&&U==Q.to)U++;return L.range(K,U)}}var DU=h.ie&&h.ie_version<=11,o5=null,t5=0,e5=0;function R$(Z){if(!DU)return Z.detail;let $=o5,J=e5;return o5=Z,e5=Date.now(),t5=!$||J>Date.now()-400&&Math.abs($.clientX-Z.clientX)<2&&Math.abs($.clientY-Z.clientY)<2?(t5+1)%3:1}function LU(Z,$){let J=Z.posAndSideAtCoords({x:$.clientX,y:$.clientY},!1),Y=R$($),X=Z.state.selection;return{update(Q){if(Q.docChanged)J.pos=Q.changes.mapPos(J.pos),X=X.map(Q.changes)},get(Q,K,U){let q=Z.posAndSideAtCoords({x:Q.clientX,y:Q.clientY},!1),G,W=a5(Z,q.pos,q.assoc,Y);if(J.pos!=q.pos&&!K){let j=a5(Z,J.pos,J.assoc,Y),_=Math.min(j.from,W.from),z=Math.max(j.to,W.to);W=_<W.from?L.range(_,z):L.range(z,_)}if(K)return X.replaceRange(X.main.extend(W.from,W.to));else if(U&&Y==1&&X.ranges.length>1&&(G=MU(X,q.pos)))return G;else if(U)return X.addRange(W);else return L.create([W])}}}function MU(Z,$){for(let J=0;J<Z.ranges.length;J++){let{from:Y,to:X}=Z.ranges[J];if(Y<=$&&X>=$)return L.create(Z.ranges.slice(0,J).concat(Z.ranges.slice(J+1)),Z.mainIndex==J?0:Z.mainIndex-(Z.mainIndex>J?1:0))}return null}M1.dragstart=(Z,$)=>{let{selection:{main:J}}=Z.state;if($.target.draggable){let X=Z.docView.tile.nearest($.target);if(X&&X.isWidget()){let Q=X.posAtStart,K=Q+X.length;if(Q>=J.to||K<=J.from)J=L.range(Q,K)}}let{inputState:Y}=Z;if(Y.mouseSelection)Y.mouseSelection.dragging=!0;if(Y.draggedContent=J,$.dataTransfer)$.dataTransfer.setData("Text",i6(Z.state,$4,Z.state.sliceDoc(J.from,J.to))),$.dataTransfer.effectAllowed="copyMove";return!1};M1.dragend=(Z)=>{return Z.inputState.draggedContent=null,!1};function ZZ(Z,$,J,Y){if(J=i6(Z.state,Z4,J),!J)return;let X=Z.posAtCoords({x:$.clientX,y:$.clientY},!1),{draggedContent:Q}=Z.inputState,K=Y&&Q&&NU(Z,$)?{from:Q.from,to:Q.to}:null,U={from:X,insert:J},q=Z.state.changes(K?[K,U]:U);Z.focus(),Z.dispatch({changes:q,selection:{anchor:q.mapPos(X,-1),head:q.mapPos(X,1)},userEvent:K?"move.drop":"input.drop"}),Z.inputState.draggedContent=null}M1.drop=(Z,$)=>{if(!$.dataTransfer)return!1;if(Z.state.readOnly)return!0;let J=$.dataTransfer.files;if(J&&J.length){let Y=Array(J.length),X=0,Q=()=>{if(++X==J.length)ZZ(Z,$,Y.filter((K)=>K!=null).join(Z.state.lineBreak),!1)};for(let K=0;K<J.length;K++){let U=new FileReader;U.onerror=Q,U.onload=()=>{if(!/[\x00-\x08\x0e-\x1f]{2}/.test(U.result))Y[K]=U.result;Q()},U.readAsText(J[K])}return!0}else{let Y=$.dataTransfer.getData("Text");if(Y)return ZZ(Z,$,Y,!0),!0}return!1};M1.paste=(Z,$)=>{if(Z.state.readOnly)return!0;Z.observer.flush();let J=H$?null:$.clipboardData;if(J)return N$(Z,J.getData("text/plain")||J.getData("text/uri-list")),!0;else return IU(Z),!1};function AU(Z,$){let J=Z.dom.parentNode;if(!J)return;let Y=J.appendChild(document.createElement("textarea"));Y.style.cssText="position: fixed; left: -10000px; top: 10px",Y.value=$,Y.focus(),Y.selectionEnd=$.length,Y.selectionStart=0,setTimeout(()=>{Y.remove(),Z.focus()},50)}function BU(Z){let $=[],J=[],Y=!1;for(let X of Z.selection.ranges)if(!X.empty)$.push(Z.sliceDoc(X.from,X.to)),J.push(X);if(!$.length){let X=-1;for(let{from:Q}of Z.selection.ranges){let K=Z.doc.lineAt(Q);if(K.number>X)$.push(K.text),J.push({from:K.from,to:Math.min(Z.doc.length,K.to+1)});X=K.number}Y=!0}return{text:i6(Z,$4,$.join(Z.lineBreak)),ranges:J,linewise:Y}}var g7=null;M1.copy=M1.cut=(Z,$)=>{let J=m2(Z.root);if(J&&!I3(Z.contentDOM,J))return!1;let{text:Y,ranges:X,linewise:Q}=BU(Z.state);if(!Y&&!Q)return!1;if(g7=Q?Y:null,$.type=="cut"&&!Z.state.readOnly)Z.dispatch({changes:X,scrollIntoView:!0,userEvent:"delete.cut"});let K=H$?null:$.clipboardData;if(K)return K.clearData(),K.setData("text/plain",Y),!0;else return AU(Z,Y),!1};var F$=o0.define();function I$(Z,$){let J=[];for(let Y of Z.facet(fZ)){let X=Y(Z,$);if(X)J.push(X)}return J.length?Z.update({effects:J,annotations:F$.of(!0)}):null}function D$(Z){setTimeout(()=>{let $=Z.hasFocus;if($!=Z.inputState.notifiedFocused){let J=I$(Z.state,$);if(J)Z.dispatch(J);else Z.update([])}},10)}Q1.focus=(Z)=>{if(Z.inputState.lastFocusTime=Date.now(),!Z.scrollDOM.scrollTop&&(Z.inputState.lastScrollTop||Z.inputState.lastScrollLeft))Z.scrollDOM.scrollTop=Z.inputState.lastScrollTop,Z.scrollDOM.scrollLeft=Z.inputState.lastScrollLeft;D$(Z)};Q1.blur=(Z)=>{Z.observer.clearSelectionRange(),D$(Z)};Q1.compositionstart=Q1.compositionupdate=(Z)=>{if(Z.observer.editContext)return;if(Z.inputState.compositionFirstChange==null)Z.inputState.compositionFirstChange=!0;if(Z.inputState.composing<0)Z.inputState.composing=0};Q1.compositionend=(Z)=>{if(Z.observer.editContext)return;if(Z.inputState.composing=-1,Z.inputState.compositionEndedAt=Date.now(),Z.inputState.compositionPendingKey=!0,Z.inputState.compositionPendingChange=Z.observer.pendingRecords().length>0,Z.inputState.compositionFirstChange=null,h.chrome&&h.android)Z.observer.flushSoon();else if(Z.inputState.compositionPendingChange)Promise.resolve().then(()=>Z.observer.flush());else setTimeout(()=>{if(Z.inputState.composing<0&&Z.docView.hasComposition)Z.update([])},50)};Q1.contextmenu=(Z)=>{Z.inputState.lastContextMenu=Date.now()};M1.beforeinput=(Z,$)=>{var J,Y;if($.inputType=="insertText"||$.inputType=="insertCompositionText")Z.inputState.insertingText=$.data,Z.inputState.insertingTextAt=Date.now();if($.inputType=="insertReplacementText"&&Z.observer.editContext){let Q=(J=$.dataTransfer)===null||J===void 0?void 0:J.getData("text/plain"),K=$.getTargetRanges();if(Q&&K.length){let U=K[0],q=Z.posAtDOM(U.startContainer,U.startOffset),G=Z.posAtDOM(U.endContainer,U.endOffset);return Q4(Z,{from:q,to:G,insert:Z.state.toText(Q)},null),!0}}let X;if(h.chrome&&h.android&&(X=z$.find((Q)=>Q.inputType==$.inputType))){if(Z.observer.delayAndroidKey(X.key,X.keyCode),X.key=="Backspace"||X.key=="Delete"){let Q=((Y=window.visualViewport)===null||Y===void 0?void 0:Y.height)||0;setTimeout(()=>{var K;if((((K=window.visualViewport)===null||K===void 0?void 0:K.height)||0)>Q+10&&Z.hasFocus)Z.contentDOM.blur(),Z.focus()},100)}}if(h.ios&&$.inputType=="deleteContentForward")Z.observer.flushSoon();if(h.safari&&$.inputType=="insertText"&&Z.inputState.composing>=0)setTimeout(()=>Q1.compositionend(Z,$),20);return!1};var $Z=new Set;function EU(Z){if(!$Z.has(Z))$Z.add(Z),Z.addEventListener("copy",()=>{}),Z.addEventListener("cut",()=>{})}var JZ=["pre-wrap","normal","pre-line","break-spaces"],f2=!1;function YZ(){f2=!1}class L${constructor(Z){this.lineWrapping=Z,this.doc=Z0.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(Z,$){let J=this.doc.lineAt($).number-this.doc.lineAt(Z).number+1;if(this.lineWrapping)J+=Math.max(0,Math.ceil(($-Z-J*this.lineLength*0.5)/this.lineLength));return this.lineHeight*J}heightForLine(Z){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((Z-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight}setDoc(Z){return this.doc=Z,this}mustRefreshForWrapping(Z){return JZ.indexOf(Z)>-1!=this.lineWrapping}mustRefreshForHeights(Z){let $=!1;for(let J=0;J<Z.length;J++){let Y=Z[J];if(Y<0)J++;else if(!this.heightSamples[Math.floor(Y*10)])$=!0,this.heightSamples[Math.floor(Y*10)]=!0}return $}refresh(Z,$,J,Y,X,Q){let K=JZ.indexOf(Z)>-1,U=Math.abs($-this.lineHeight)>0.3||this.lineWrapping!=K||Math.abs(J-this.charWidth)>0.1;if(this.lineWrapping=K,this.lineHeight=$,this.charWidth=J,this.textHeight=Y,this.lineLength=X,U){this.heightSamples={};for(let q=0;q<Q.length;q++){let G=Q[q];if(G<0)q++;else this.heightSamples[Math.floor(G*10)]=!0}}return U}}class M${constructor(Z,$){this.from=Z,this.heights=$,this.index=0}get more(){return this.index<this.heights.length}}class D1{constructor(Z,$,J,Y,X){this.from=Z,this.length=$,this.top=J,this.height=Y,this._content=X}get type(){return typeof this._content=="number"?w0.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof _2?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(Z){let $=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(Z._content)?Z._content:[Z]);return new D1(this.from,this.length+Z.length,this.top,this.height+Z.height,$)}}var G0=function(Z){return Z[Z.ByPos=0]="ByPos",Z[Z.ByHeight=1]="ByHeight",Z[Z.ByPosNoHeight=2]="ByPosNoHeight",Z}(G0||(G0={})),b6=0.001;class f0{constructor(Z,$,J=2){this.length=Z,this.height=$,this.flags=J}get outdated(){return(this.flags&2)>0}set outdated(Z){this.flags=(Z?2:0)|this.flags&-3}setHeight(Z){if(this.height!=Z){if(Math.abs(this.height-Z)>b6)f2=!0;this.height=Z}}replace(Z,$,J){return f0.of(J)}decomposeLeft(Z,$){$.push(this)}decomposeRight(Z,$){$.push(this)}applyChanges(Z,$,J,Y){let X=this,Q=J.doc;for(let K=Y.length-1;K>=0;K--){let{fromA:U,toA:q,fromB:G,toB:W}=Y[K],j=X.lineAt(U,G0.ByPosNoHeight,J.setDoc($),0,0),_=j.to>=q?j:X.lineAt(q,G0.ByPosNoHeight,J,0,0);W+=_.to-q,q=_.to;while(K>0&&j.from<=Y[K-1].toA)if(U=Y[K-1].fromA,G=Y[K-1].fromB,K--,U<j.from)j=X.lineAt(U,G0.ByPosNoHeight,J,0,0);G+=j.from-U,U=j.from;let z=U4.build(J.setDoc(Q),Z,G,W);X=l6(X,X.replace(U,q,z))}return X.updateHeight(J,0)}static empty(){return new t0(0,0,0)}static of(Z){if(Z.length==1)return Z[0];let $=0,J=Z.length,Y=0,X=0;for(;;)if($==J)if(Y>X*2){let K=Z[$-1];if(K.break)Z.splice(--$,1,K.left,null,K.right);else Z.splice(--$,1,K.left,K.right);J+=1+K.break,Y-=K.size}else if(X>Y*2){let K=Z[J];if(K.break)Z.splice(J,1,K.left,null,K.right);else Z.splice(J,1,K.left,K.right);J+=2+K.break,X-=K.size}else break;else if(Y<X){let K=Z[$++];if(K)Y+=K.size}else{let K=Z[--J];if(K)X+=K.size}let Q=0;if(Z[$-1]==null)Q=1,$--;else if(Z[$]==null)Q=1,J++;return new A$(f0.of(Z.slice(0,$)),Q,f0.of(Z.slice(J)))}}function l6(Z,$){if(Z==$)return Z;if(Z.constructor!=$.constructor)f2=!0;return $}f0.prototype.size=1;var PU=g.replace({});class K4 extends f0{constructor(Z,$,J){super(Z,$);this.deco=J,this.spaceAbove=0}mainBlock(Z,$){return new D1($,this.length,Z+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(Z,$,J,Y){return this.spaceAbove&&Z<J+this.spaceAbove?new D1(Y,0,J,this.spaceAbove,PU):this.mainBlock(J,Y)}lineAt(Z,$,J,Y,X){let Q=this.mainBlock(Y,X);return this.spaceAbove?this.blockAt(0,J,Y,X).join(Q):Q}forEachLine(Z,$,J,Y,X,Q){if(Z<=X+this.length&&$>=X)Q(this.lineAt(0,G0.ByPos,J,Y,X))}setMeasuredHeight(Z){let $=Z.heights[Z.index++];if($<0)this.spaceAbove=-$,$=Z.heights[Z.index++];else this.spaceAbove=0;this.setHeight($)}updateHeight(Z,$=0,J=!1,Y){if(Y&&Y.from<=$&&Y.more)this.setMeasuredHeight(Y);return this.outdated=!1,this}toString(){return`block(${this.length})`}}class t0 extends K4{constructor(Z,$,J){super(Z,$,null);this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=J}mainBlock(Z,$){return new D1($,this.length,Z+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(Z,$,J){let Y=J[0];if(J.length==1&&(Y instanceof t0||Y instanceof x0&&Y.flags&4)&&Math.abs(this.length-Y.length)<10){if(Y instanceof x0)Y=new t0(Y.length,this.height,this.spaceAbove);else Y.height=this.height;if(!this.outdated)Y.outdated=!1;return Y}else return f0.of(J)}updateHeight(Z,$=0,J=!1,Y){if(Y&&Y.from<=$&&Y.more)this.setMeasuredHeight(Y);else if(J||this.outdated)this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,Z.heightForLine(this.length-this.collapsed))+this.breaks*Z.lineHeight);return this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class x0 extends f0{constructor(Z){super(Z,0)}heightMetrics(Z,$){let J=Z.doc.lineAt($).number,Y=Z.doc.lineAt($+this.length).number,X=Y-J+1,Q,K=0;if(Z.lineWrapping){let U=Math.min(this.height,Z.lineHeight*X);if(Q=U/X,this.length>X+1)K=(this.height-U)/(this.length-X-1)}else Q=this.height/X;return{firstLine:J,lastLine:Y,perLine:Q,perChar:K}}blockAt(Z,$,J,Y){let{firstLine:X,lastLine:Q,perLine:K,perChar:U}=this.heightMetrics($,Y);if($.lineWrapping){let q=Y+(Z<$.lineHeight?0:Math.round(Math.max(0,Math.min(1,(Z-J)/this.height))*this.length)),G=$.doc.lineAt(q),W=K+G.length*U,j=Math.max(J,Z-W/2);return new D1(G.from,G.length,j,W,0)}else{let q=Math.max(0,Math.min(Q-X,Math.floor((Z-J)/K))),{from:G,length:W}=$.doc.line(X+q);return new D1(G,W,J+K*q,K,0)}}lineAt(Z,$,J,Y,X){if($==G0.ByHeight)return this.blockAt(Z,J,Y,X);if($==G0.ByPosNoHeight){let{from:_,to:z}=J.doc.lineAt(Z);return new D1(_,z-_,0,0,0)}let{firstLine:Q,perLine:K,perChar:U}=this.heightMetrics(J,X),q=J.doc.lineAt(Z),G=K+q.length*U,W=q.number-Q,j=Y+K*W+U*(q.from-X-W);return new D1(q.from,q.length,Math.max(Y,Math.min(j,Y+this.height-G)),G,0)}forEachLine(Z,$,J,Y,X,Q){Z=Math.max(Z,X),$=Math.min($,X+this.length);let{firstLine:K,perLine:U,perChar:q}=this.heightMetrics(J,X);for(let G=Z,W=Y;G<=$;){let j=J.doc.lineAt(G);if(G==Z){let z=j.number-K;W+=U*z+q*(Z-X-z)}let _=U+q*j.length;Q(new D1(j.from,j.length,W,_,0)),W+=_,G=j.to+1}}replace(Z,$,J){let Y=this.length-$;if(Y>0){let X=J[J.length-1];if(X instanceof x0)J[J.length-1]=new x0(X.length+Y);else J.push(null,new x0(Y-1))}if(Z>0){let X=J[0];if(X instanceof x0)J[0]=new x0(Z+X.length);else J.unshift(new x0(Z-1),null)}return f0.of(J)}decomposeLeft(Z,$){$.push(new x0(Z-1),null)}decomposeRight(Z,$){$.push(null,new x0(this.length-Z-1))}updateHeight(Z,$=0,J=!1,Y){let X=$+this.length;if(Y&&Y.from<=$+this.length&&Y.more){let Q=[],K=Math.max($,Y.from),U=-1;if(Y.from>$)Q.push(new x0(Y.from-$-1).updateHeight(Z,$));while(K<=X&&Y.more){let G=Z.doc.lineAt(K).length;if(Q.length)Q.push(null);let W=Y.heights[Y.index++],j=0;if(W<0)j=-W,W=Y.heights[Y.index++];if(U==-1)U=W;else if(Math.abs(W-U)>=b6)U=-2;let _=new t0(G,W,j);_.outdated=!1,Q.push(_),K+=G+1}if(K<=X)Q.push(null,new x0(X-K).updateHeight(Z,K));let q=f0.of(Q);if(U<0||Math.abs(q.height-this.height)>=b6||Math.abs(U-this.heightMetrics(Z,$).perLine)>=b6)f2=!0;return l6(this,q)}else if(J||this.outdated)this.setHeight(Z.heightForGap($,$+this.length)),this.outdated=!1;return this}toString(){return`gap(${this.length})`}}class A$ extends f0{constructor(Z,$,J){super(Z.length+$+J.length,Z.height+J.height,$|(Z.outdated||J.outdated?2:0));this.left=Z,this.right=J,this.size=Z.size+J.size}get break(){return this.flags&1}blockAt(Z,$,J,Y){let X=J+this.left.height;return Z<X?this.left.blockAt(Z,$,J,Y):this.right.blockAt(Z,$,X,Y+this.left.length+this.break)}lineAt(Z,$,J,Y,X){let Q=Y+this.left.height,K=X+this.left.length+this.break,U=$==G0.ByHeight?Z<Q:Z<K,q=U?this.left.lineAt(Z,$,J,Y,X):this.right.lineAt(Z,$,J,Q,K);if(this.break||(U?q.to<K:q.from>K))return q;let G=$==G0.ByPosNoHeight?G0.ByPosNoHeight:G0.ByPos;if(U)return q.join(this.right.lineAt(K,G,J,Q,K));else return this.left.lineAt(K,G,J,Y,X).join(q)}forEachLine(Z,$,J,Y,X,Q){let K=Y+this.left.height,U=X+this.left.length+this.break;if(this.break){if(Z<U)this.left.forEachLine(Z,$,J,Y,X,Q);if($>=U)this.right.forEachLine(Z,$,J,K,U,Q)}else{let q=this.lineAt(U,G0.ByPos,J,Y,X);if(Z<q.from)this.left.forEachLine(Z,q.from-1,J,Y,X,Q);if(q.to>=Z&&q.from<=$)Q(q);if($>q.to)this.right.forEachLine(q.to+1,$,J,K,U,Q)}}replace(Z,$,J){let Y=this.left.length+this.break;if($<Y)return this.balanced(this.left.replace(Z,$,J),this.right);if(Z>this.left.length)return this.balanced(this.left,this.right.replace(Z-Y,$-Y,J));let X=[];if(Z>0)this.decomposeLeft(Z,X);let Q=X.length;for(let K of J)X.push(K);if(Z>0)XZ(X,Q-1);if($<this.length){let K=X.length;this.decomposeRight($,X),XZ(X,K)}return f0.of(X)}decomposeLeft(Z,$){let J=this.left.length;if(Z<=J)return this.left.decomposeLeft(Z,$);if($.push(this.left),this.break){if(J++,Z>=J)$.push(null)}if(Z>J)this.right.decomposeLeft(Z-J,$)}decomposeRight(Z,$){let J=this.left.length,Y=J+this.break;if(Z>=Y)return this.right.decomposeRight(Z-Y,$);if(Z<J)this.left.decomposeRight(Z,$);if(this.break&&Z<Y)$.push(null);$.push(this.right)}balanced(Z,$){if(Z.size>2*$.size||$.size>2*Z.size)return f0.of(this.break?[Z,null,$]:[Z,$]);return this.left=l6(this.left,Z),this.right=l6(this.right,$),this.setHeight(Z.height+$.height),this.outdated=Z.outdated||$.outdated,this.size=Z.size+$.size,this.length=Z.length+this.break+$.length,this}updateHeight(Z,$=0,J=!1,Y){let{left:X,right:Q}=this,K=$+X.length+this.break,U=null;if(Y&&Y.from<=$+X.length&&Y.more)U=X=X.updateHeight(Z,$,J,Y);else X.updateHeight(Z,$,J);if(Y&&Y.from<=K+Q.length&&Y.more)U=Q=Q.updateHeight(Z,K,J,Y);else Q.updateHeight(Z,K,J);if(U)return this.balanced(X,Q);return this.height=this.left.height+this.right.height,this.outdated=!1,this}toString(){return this.left+(this.break?" ":"-")+this.right}}function XZ(Z,$){let J,Y;if(Z[$]==null&&(J=Z[$-1])instanceof x0&&(Y=Z[$+1])instanceof x0)Z.splice($-1,3,new x0(J.length+1+Y.length))}var CU=5;class U4{constructor(Z,$){this.pos=Z,this.oracle=$,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=Z}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(Z,$){if(this.lineStart>-1){let J=Math.min($,this.lineEnd),Y=this.nodes[this.nodes.length-1];if(Y instanceof t0)Y.length+=J-this.pos;else if(J>this.pos||!this.isCovered)this.nodes.push(new t0(J-this.pos,-1,0));if(this.writtenTo=J,$>J)this.nodes.push(null),this.writtenTo++,this.lineStart=-1}this.pos=$}point(Z,$,J){if(Z<$||J.heightRelevant){let Y=J.widget?J.widget.estimatedHeight:0,X=J.widget?J.widget.lineBreaks:0;if(Y<0)Y=this.oracle.lineHeight;let Q=$-Z;if(J.block)this.addBlock(new K4(Q,Y,J));else if(Q||X||Y>=CU)this.addLineDeco(Y,X,Q)}else if($>Z)this.span(Z,$);if(this.lineEnd>-1&&this.lineEnd<this.pos)this.lineEnd=this.oracle.doc.lineAt(this.pos).to}enterLine(){if(this.lineStart>-1)return;let{from:Z,to:$}=this.oracle.doc.lineAt(this.pos);if(this.lineStart=Z,this.lineEnd=$,this.writtenTo<Z){if(this.writtenTo<Z-1||this.nodes[this.nodes.length-1]==null)this.nodes.push(this.blankContent(this.writtenTo,Z-1));this.nodes.push(null)}if(this.pos>Z)this.nodes.push(new t0(this.pos-Z,-1,0));this.writtenTo=this.pos}blankContent(Z,$){let J=new x0($-Z);if(this.oracle.doc.lineAt(Z).to==$)J.flags|=4;return J}ensureLine(){this.enterLine();let Z=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(Z instanceof t0)return Z;let $=new t0(0,-1,0);return this.nodes.push($),$}addBlock(Z){this.enterLine();let $=Z.deco;if($&&$.startSide>0&&!this.isCovered)this.ensureLine();if(this.nodes.push(Z),this.writtenTo=this.pos=this.pos+Z.length,$&&$.endSide>0)this.covering=Z}addLineDeco(Z,$,J){let Y=this.ensureLine();Y.length+=J,Y.collapsed+=J,Y.widgetHeight=Math.max(Y.widgetHeight,Z),Y.breaks+=$,this.writtenTo=this.pos=this.pos+J}finish(Z){let $=this.nodes.length==0?null:this.nodes[this.nodes.length-1];if(this.lineStart>-1&&!($ instanceof t0)&&!this.isCovered)this.nodes.push(new t0(0,-1,0));else if(this.writtenTo<this.pos||$==null)this.nodes.push(this.blankContent(this.writtenTo,this.pos));let J=Z;for(let Y of this.nodes){if(Y instanceof t0)Y.updateHeight(this.oracle,J);J+=Y?Y.length:1}return this.nodes}static build(Z,$,J,Y){let X=new U4(J,Z);return r.spans($,J,Y,X,0),X.finish(J)}}function TU(Z,$,J){let Y=new B$;return r.compare(Z,$,J,Y,0),Y.changes}class B${constructor(){this.changes=[]}compareRange(){}comparePoint(Z,$,J,Y){if(Z<$||J&&J.heightRelevant||Y&&Y.heightRelevant)w2(Z,$,this.changes,5)}}function yU(Z,$){let J=Z.getBoundingClientRect(),Y=Z.ownerDocument,X=Y.defaultView||window,Q=Math.max(0,J.left),K=Math.min(X.innerWidth,J.right),U=Math.max(0,J.top),q=Math.min(X.innerHeight,J.bottom);for(let G=Z.parentNode;G&&G!=Y.body;)if(G.nodeType==1){let W=G,j=window.getComputedStyle(W);if((W.scrollHeight>W.clientHeight||W.scrollWidth>W.clientWidth)&&j.overflow!="visible"){let _=W.getBoundingClientRect();Q=Math.max(Q,_.left),K=Math.min(K,_.right),U=Math.max(U,_.top),q=Math.min(G==Z.parentNode?X.innerHeight:q,_.bottom)}G=j.position=="absolute"||j.position=="fixed"?W.offsetParent:W.parentNode}else if(G.nodeType==11)G=G.host;else break;return{left:Q-J.left,right:Math.max(Q,K)-J.left,top:U-(J.top+$),bottom:Math.max(U,q)-(J.top+$)}}function bU(Z){let $=Z.getBoundingClientRect(),J=Z.ownerDocument.defaultView||window;return $.left<J.innerWidth&&$.right>0&&$.top<J.innerHeight&&$.bottom>0}function kU(Z,$){let J=Z.getBoundingClientRect();return{left:0,right:J.right-J.left,top:$,bottom:J.bottom-(J.top+$)}}class k6{constructor(Z,$,J,Y){this.from=Z,this.to=$,this.size=J,this.displaySize=Y}static same(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++){let Y=Z[J],X=$[J];if(Y.from!=X.from||Y.to!=X.to||Y.size!=X.size)return!1}return!0}draw(Z,$){return g.replace({widget:new E$(this.displaySize*($?Z.scaleY:Z.scaleX),$)}).range(this.from,this.to)}}class E$ extends e0{constructor(Z,$){super();this.size=Z,this.vertical=$}eq(Z){return Z.size==this.size&&Z.vertical==this.vertical}toDOM(){let Z=document.createElement("div");if(this.vertical)Z.style.height=this.size+"px";else Z.style.width=this.size+"px",Z.style.height="2px",Z.style.display="inline-block";return Z}get estimatedHeight(){return this.vertical?this.size:-1}}class f7{constructor(Z){this.state=Z,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=QZ,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Q0.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let $=Z.facet(J4).some((J)=>typeof J!="function"&&J.class=="cm-lineWrapping");this.heightOracle=new L$($),this.stateDeco=KZ(Z),this.heightMap=f0.empty().applyChanges(this.stateDeco,Z0.empty,this.heightOracle.setDoc(Z.doc),[new X1(0,0,0,Z.doc.length)]);for(let J=0;J<2;J++)if(this.viewport=this.getViewport(0,null),!this.updateForViewport())break;this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=g.set(this.lineGaps.map((J)=>J.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let Z=[this.viewport],{main:$}=this.state.selection;for(let J=0;J<=1;J++){let Y=J?$.head:$.anchor;if(!Z.some(({from:X,to:Q})=>Y>=X&&Y<=Q)){let{from:X,to:Q}=this.lineBlockAt(Y);Z.push(new H3(X,Q))}}return this.viewports=Z.sort((J,Y)=>J.from-Y.from),this.updateScaler()}updateScaler(){let Z=this.scaler;return this.scaler=this.heightMap.height<=7000000?QZ:new q4(this.heightOracle,this.heightMap,this.viewports),Z.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(Z)=>{this.viewportLines.push(N3(Z,this.scaler))})}update(Z,$=null){this.state=Z.state;let J=this.stateDeco;this.stateDeco=KZ(this.state);let Y=Z.changedRanges,X=X1.extendWithRanges(Y,TU(J,this.stateDeco,Z?Z.changes:L0.empty(this.state.doc.length))),Q=this.heightMap.height,K=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);if(YZ(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,Z.startState.doc,this.heightOracle.setDoc(this.state.doc),X),this.heightMap.height!=Q||f2)Z.flags|=2;if(K)this.scrollAnchorPos=Z.changes.mapPos(K.from,-1),this.scrollAnchorHeight=K.top;else this.scrollAnchorPos=-1,this.scrollAnchorHeight=Q;let U=X.length?this.mapViewport(this.viewport,Z.changes):this.viewport;if($&&($.range.head<U.from||$.range.head>U.to)||!this.viewportIsAppropriate(U))U=this.getViewport(0,$);let q=U.from!=this.viewport.from||U.to!=this.viewport.to;if(this.viewport=U,Z.flags|=this.updateForViewport(),q||!Z.changes.empty||Z.flags&2)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>4000)this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,Z.changes)));if(Z.flags|=this.computeVisibleRanges(Z.changes),$)this.scrollTarget=$;if(!this.mustEnforceCursorAssoc&&(Z.selectionSet||Z.focusChanged)&&Z.view.lineWrapping&&Z.state.selection.main.empty&&Z.state.selection.main.assoc&&!Z.state.facet(lZ))this.mustEnforceCursorAssoc=!0}measure(Z){let $=Z.contentDOM,J=window.getComputedStyle($),Y=this.heightOracle,X=J.whiteSpace;this.defaultTextDirection=J.direction=="rtl"?Q0.RTL:Q0.LTR;let Q=this.heightOracle.mustRefreshForWrapping(X)||this.mustMeasureContent,K=$.getBoundingClientRect(),U=Q||this.mustMeasureContent||this.contentDOMHeight!=K.height;this.contentDOMHeight=K.height,this.mustMeasureContent=!1;let q=0,G=0;if(K.width&&K.height){let{scaleX:M,scaleY:A}=BZ($,K);if(M>0.005&&Math.abs(this.scaleX-M)>0.005||A>0.005&&Math.abs(this.scaleY-A)>0.005)this.scaleX=M,this.scaleY=A,q|=16,Q=U=!0}let W=(parseInt(J.paddingTop)||0)*this.scaleY,j=(parseInt(J.paddingBottom)||0)*this.scaleY;if(this.paddingTop!=W||this.paddingBottom!=j)this.paddingTop=W,this.paddingBottom=j,q|=18;if(this.editorWidth!=Z.scrollDOM.clientWidth){if(Y.lineWrapping)U=!0;this.editorWidth=Z.scrollDOM.clientWidth,q|=16}let _=Z.scrollDOM.scrollTop*this.scaleY;if(this.scrollTop!=_)this.scrollAnchorHeight=-1,this.scrollTop=_;this.scrolledToBottom=CZ(Z.scrollDOM);let z=(this.printing?kU:yU)($,this.paddingTop),V=z.top-this.pixelViewport.top,O=z.bottom-this.pixelViewport.bottom;this.pixelViewport=z;let H=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(H!=this.inView){if(this.inView=H,H)U=!0}if(!this.inView&&!this.scrollTarget&&!bU(Z.dom))return 0;let F=K.width;if(this.contentDOMWidth!=F||this.editorHeight!=Z.scrollDOM.clientHeight)this.contentDOMWidth=K.width,this.editorHeight=Z.scrollDOM.clientHeight,q|=16;if(U){let M=Z.docView.measureVisibleLineHeights(this.viewport);if(Y.mustRefreshForHeights(M))Q=!0;if(Q||Y.lineWrapping&&Math.abs(F-this.contentDOMWidth)>Y.charWidth){let{lineHeight:A,charWidth:B,textHeight:w}=Z.docView.measureTextSize();if(Q=A>0&&Y.refresh(X,A,B,w,Math.max(5,F/B),M),Q)Z.docView.minWidth=0,q|=16}if(V>0&&O>0)G=Math.max(V,O);else if(V<0&&O<0)G=Math.min(V,O);YZ();for(let A of this.viewports){let B=A.from==this.viewport.from?M:Z.docView.measureVisibleLineHeights(A);this.heightMap=(Q?f0.empty().applyChanges(this.stateDeco,Z0.empty,this.heightOracle,[new X1(0,0,0,Z.state.doc.length)]):this.heightMap).updateHeight(Y,0,Q,new M$(A.from,B))}if(f2)q|=2}let D=!this.viewportIsAppropriate(this.viewport,G)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);if(D){if(q&2)q|=this.updateScaler();this.viewport=this.getViewport(G,this.scrollTarget),q|=this.updateForViewport()}if(q&2||D)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>4000)this.updateLineGaps(this.ensureLineGaps(Q?[]:this.lineGaps,Z));if(q|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc)this.mustEnforceCursorAssoc=!1,Z.docView.enforceCursorAssoc();return q}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(Z,$){let J=0.5-Math.max(-0.5,Math.min(0.5,Z/1000/2)),Y=this.heightMap,X=this.heightOracle,{visibleTop:Q,visibleBottom:K}=this,U=new H3(Y.lineAt(Q-J*1000,G0.ByHeight,X,0,0).from,Y.lineAt(K+(1-J)*1000,G0.ByHeight,X,0,0).to);if($){let{head:q}=$.range;if(q<U.from||q>U.to){let G=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),W=Y.lineAt(q,G0.ByPos,X,0,0),j;if($.y=="center")j=(W.top+W.bottom)/2-G/2;else if($.y=="start"||$.y=="nearest"&&q<U.from)j=W.top;else j=W.bottom-G;U=new H3(Y.lineAt(j-500,G0.ByHeight,X,0,0).from,Y.lineAt(j+G+500,G0.ByHeight,X,0,0).to)}}return U}mapViewport(Z,$){let J=$.mapPos(Z.from,-1),Y=$.mapPos(Z.to,1);return new H3(this.heightMap.lineAt(J,G0.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(Y,G0.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:Z,to:$},J=0){if(!this.inView)return!0;let{top:Y}=this.heightMap.lineAt(Z,G0.ByPos,this.heightOracle,0,0),{bottom:X}=this.heightMap.lineAt($,G0.ByPos,this.heightOracle,0,0),{visibleTop:Q,visibleBottom:K}=this;return(Z==0||Y<=Q-Math.max(10,Math.min(-J,250)))&&($==this.state.doc.length||X>=K+Math.max(10,Math.min(J,250)))&&(Y>Q-2000&&X<K+2000)}mapLineGaps(Z,$){if(!Z.length||$.empty)return Z;let J=[];for(let Y of Z)if(!$.touchesRange(Y.from,Y.to))J.push(new k6($.mapPos(Y.from),$.mapPos(Y.to),Y.size,Y.displaySize));return J}ensureLineGaps(Z,$){let J=this.heightOracle.lineWrapping,Y=J?1e4:2000,X=Y>>1,Q=Y<<1;if(this.defaultTextDirection!=Q0.LTR&&!J)return[];let K=[],U=(G,W,j,_)=>{if(W-G<X)return;let z=this.state.selection.main,V=[z.from];if(!z.empty)V.push(z.to);for(let H of V)if(H>G&&H<W){U(G,H-10,j,_),U(H+10,W,j,_);return}let O=xU(Z,(H)=>H.from>=j.from&&H.to<=j.to&&Math.abs(H.from-G)<X&&Math.abs(H.to-W)<X&&!V.some((F)=>H.from<F&&H.to>F));if(!O){if(W<j.to&&$&&J&&$.visibleRanges.some((D)=>D.from<=W&&D.to>=W)){let D=$.moveToLineBoundary(L.cursor(W),!1,!0).head;if(D>G)W=D}let H=this.gapSize(j,G,W,_),F=J||H<2000000?H:2000000;O=new k6(G,W,H,F)}K.push(O)},q=(G)=>{if(G.length<Q||G.type!=w0.Text)return;let W=SU(G.from,G.to,this.stateDeco);if(W.total<Q)return;let j=this.scrollTarget?this.scrollTarget.range.head:null,_,z;if(J){let V=Y/this.heightOracle.lineLength*this.heightOracle.lineHeight,O,H;if(j!=null){let F=M6(W,j),D=((this.visibleBottom-this.visibleTop)/2+V)/G.height;O=F-D,H=F+D}else O=(this.visibleTop-G.top-V)/G.height,H=(this.visibleBottom-G.top+V)/G.height;_=L6(W,O),z=L6(W,H)}else{let V=W.total*this.heightOracle.charWidth,O=Y*this.heightOracle.charWidth,H=0;if(V>2000000){for(let B of Z)if(B.from>=G.from&&B.from<G.to&&B.size!=B.displaySize&&B.from*this.heightOracle.charWidth+H<this.pixelViewport.left)H=B.size-B.displaySize}let F=this.pixelViewport.left+H,D=this.pixelViewport.right+H,M,A;if(j!=null){let B=M6(W,j),w=((D-F)/2+O)/V;M=B-w,A=B+w}else M=(F-O)/V,A=(D+O)/V;_=L6(W,M),z=L6(W,A)}if(_>G.from)U(G.from,_,G,W);if(z<G.to)U(z,G.to,G,W)};for(let G of this.viewportLines)if(Array.isArray(G.type))G.type.forEach(q);else q(G);return K}gapSize(Z,$,J,Y){let X=M6(Y,J)-M6(Y,$);if(this.heightOracle.lineWrapping)return Z.height*X;else return Y.total*this.heightOracle.charWidth*X}updateLineGaps(Z){if(!k6.same(Z,this.lineGaps))this.lineGaps=Z,this.lineGapDeco=g.set(Z.map(($)=>$.draw(this,this.heightOracle.lineWrapping)))}computeVisibleRanges(Z){let $=this.stateDeco;if(this.lineGaps.length)$=$.concat(this.lineGapDeco);let J=[];r.spans($,this.viewport.from,this.viewport.to,{span(X,Q){J.push({from:X,to:Q})},point(){}},20);let Y=0;if(J.length!=this.visibleRanges.length)Y=12;else for(let X=0;X<J.length&&!(Y&8);X++){let Q=this.visibleRanges[X],K=J[X];if(Q.from!=K.from||Q.to!=K.to){if(Y|=4,!(Z&&Z.mapPos(Q.from,-1)==K.from&&Z.mapPos(Q.to,1)==K.to))Y|=8}}return this.visibleRanges=J,Y}lineBlockAt(Z){return Z>=this.viewport.from&&Z<=this.viewport.to&&this.viewportLines.find(($)=>$.from<=Z&&$.to>=Z)||N3(this.heightMap.lineAt(Z,G0.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(Z){return Z>=this.viewportLines[0].top&&Z<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(($)=>$.top<=Z&&$.bottom>=Z)||N3(this.heightMap.lineAt(this.scaler.fromDOM(Z),G0.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(Z){let $=this.lineBlockAtHeight(Z+8);return $.from>=this.viewport.from||this.viewportLines[0].top-Z>200?$:this.viewportLines[0]}elementAtHeight(Z){return N3(this.heightMap.blockAt(this.scaler.fromDOM(Z),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class H3{constructor(Z,$){this.from=Z,this.to=$}}function SU(Z,$,J){let Y=[],X=Z,Q=0;if(r.spans(J,Z,$,{span(){},point(K,U){if(K>X)Y.push({from:X,to:K}),Q+=K-X;X=U}},20),X<$)Y.push({from:X,to:$}),Q+=$-X;return{total:Q,ranges:Y}}function L6({total:Z,ranges:$},J){if(J<=0)return $[0].from;if(J>=1)return $[$.length-1].to;let Y=Math.floor(Z*J);for(let X=0;;X++){let{from:Q,to:K}=$[X],U=K-Q;if(Y<=U)return Q+Y;Y-=U}}function M6(Z,$){let J=0;for(let{from:Y,to:X}of Z.ranges){if($<=X){J+=$-Y;break}J+=X-Y}return J/Z.total}function xU(Z,$){for(let J of Z)if($(J))return J;return}var QZ={toDOM(Z){return Z},fromDOM(Z){return Z},scale:1,eq(Z){return Z==this}};function KZ(Z){let $=Z.facet(n6).filter((Y)=>typeof Y!="function"),J=Z.facet(Y4).filter((Y)=>typeof Y!="function");if(J.length)$.push(r.join(J));return $}class q4{constructor(Z,$,J){let Y=0,X=0,Q=0;this.viewports=J.map(({from:K,to:U})=>{let q=$.lineAt(K,G0.ByPos,Z,0,0).top,G=$.lineAt(U,G0.ByPos,Z,0,0).bottom;return Y+=G-q,{from:K,to:U,top:q,bottom:G,domTop:0,domBottom:0}}),this.scale=(7000000-Y)/($.height-Y);for(let K of this.viewports)K.domTop=Q+(K.top-X)*this.scale,Q=K.domBottom=K.domTop+(K.bottom-K.top),X=K.bottom}toDOM(Z){for(let $=0,J=0,Y=0;;$++){let X=$<this.viewports.length?this.viewports[$]:null;if(!X||Z<X.top)return Y+(Z-J)*this.scale;if(Z<=X.bottom)return X.domTop+(Z-X.top);J=X.bottom,Y=X.domBottom}}fromDOM(Z){for(let $=0,J=0,Y=0;;$++){let X=$<this.viewports.length?this.viewports[$]:null;if(!X||Z<X.domTop)return J+(Z-Y)/this.scale;if(Z<=X.domBottom)return X.top+(Z-X.domTop);J=X.bottom,Y=X.domBottom}}eq(Z){if(!(Z instanceof q4))return!1;return this.scale==Z.scale&&this.viewports.length==Z.viewports.length&&this.viewports.every(($,J)=>$.from==Z.viewports[J].from&&$.to==Z.viewports[J].to)}}function N3(Z,$){if($.scale==1)return Z;let J=$.toDOM(Z.top),Y=$.toDOM(Z.bottom);return new D1(Z.from,Z.length,J,Y-J,Array.isArray(Z._content)?Z._content.map((X)=>N3(X,$)):Z._content)}var A6=S.define({combine:(Z)=>Z.join(" ")}),p7=S.define({combine:(Z)=>Z.indexOf(!0)>-1}),l7=F1.newName(),P$=F1.newName(),C$=F1.newName(),T$={"&light":"."+P$,"&dark":"."+C$};function d7(Z,$,J){return new F1($,{finish(Y){return/&/.test(Y)?Y.replace(/&\w*/,(X)=>{if(X=="&")return Z;if(!J||!J[X])throw RangeError(`Unsupported selector: ${X}`);return J[X]}):Z+" "+Y}})}var hU=d7("."+l7,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},T$),wU={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},D7=h.ie&&h.ie_version<=11;class y${constructor(Z){if(this.view=Z,this.active=!1,this.editContext=null,this.selectionRange=new EZ,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=Z.contentDOM,this.observer=new MutationObserver(($)=>{for(let J of $)this.queue.push(J);if((h.ie&&h.ie_version<=11||h.ios&&Z.composing)&&$.some((J)=>J.type=="childList"&&J.removedNodes.length||J.type=="characterData"&&J.oldValue.length>J.target.nodeValue.length))this.flushSoon();else this.flush()}),window.EditContext&&h.android&&Z.constructor.EDIT_CONTEXT!==!1&&!(h.chrome&&h.chrome_version<126)){if(this.editContext=new b$(Z),Z.state.facet(g1))Z.contentDOM.editContext=this.editContext.editContext}if(D7)this.onCharData=($)=>{this.queue.push({target:$.target,type:"characterData",oldValue:$.prevValue}),this.flushSoon()};if(this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia)this.printQuery=window.matchMedia("print");if(typeof ResizeObserver=="function")this.resizeScroll=new ResizeObserver(()=>{var $;if((($=this.view.docView)===null||$===void 0?void 0:$.lastUpdate)<Date.now()-75)this.onResize()}),this.resizeScroll.observe(Z.scrollDOM);if(this.addWindowListeners(this.win=Z.win),this.start(),typeof IntersectionObserver=="function")this.intersection=new IntersectionObserver(($)=>{if(this.parentCheck<0)this.parentCheck=setTimeout(this.listenForScroll.bind(this),1000);if($.length>0&&$[$.length-1].intersectionRatio>0!=this.intersecting){if(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView)this.onScrollChanged(document.createEvent("Event"))}},{threshold:[0,0.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(($)=>{if($.length>0&&$[$.length-1].intersectionRatio>0)this.onScrollChanged(document.createEvent("Event"))},{});this.listenForScroll(),this.readSelectionRange()}onScrollChanged(Z){if(this.view.inputState.runHandlers("scroll",Z),this.intersecting)this.view.measure()}onScroll(Z){if(this.intersecting)this.flush(!1);if(this.editContext)this.view.requestMeasure(this.editContext.measureReq);this.onScrollChanged(Z)}onResize(){if(this.resizeTimeout<0)this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50)}onPrint(Z){if((Z.type=="change"||!Z.type)&&!Z.matches)return;this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(Z){if(this.gapIntersection&&(Z.length!=this.gaps.length||this.gaps.some(($,J)=>$!=Z[J]))){this.gapIntersection.disconnect();for(let $ of Z)this.gapIntersection.observe($);this.gaps=Z}}onSelectionChange(Z){let $=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:J}=this,Y=this.selectionRange;if(J.state.facet(g1)?J.root.activeElement!=this.dom:!I3(this.dom,Y))return;let X=Y.anchorNode&&J.docView.tile.nearest(Y.anchorNode);if(X&&X.isWidget()&&X.widget.ignoreEvent(Z)){if(!$)this.selectionChanged=!1;return}if((h.ie&&h.ie_version<=11||h.android&&h.chrome)&&!J.state.selection.main.empty&&Y.focusNode&&D3(Y.focusNode,Y.focusOffset,Y.anchorNode,Y.anchorOffset))this.flushSoon();else this.flush(!1)}readSelectionRange(){let{view:Z}=this,$=m2(Z.root);if(!$)return!1;let J=h.safari&&Z.root.nodeType==11&&Z.root.activeElement==this.dom&&vU(this.view,$)||$;if(!J||this.selectionRange.eq(J))return!1;let Y=I3(this.dom,J);if(Y&&!this.selectionChanged&&Z.inputState.lastFocusTime>Date.now()-200&&Z.inputState.lastTouchTime<Date.now()-300&&kK(this.dom,J))return this.view.inputState.lastFocusTime=0,Z.docView.updateSelection(),!1;if(this.selectionRange.setRange(J),Y)this.selectionChanged=!0;return!0}setSelectionRange(Z,$){this.selectionRange.set(Z.node,Z.offset,$.node,$.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let Z=0,$=null;for(let J=this.dom;J;)if(J.nodeType==1){if(!$&&Z<this.scrollTargets.length&&this.scrollTargets[Z]==J)Z++;else if(!$)$=this.scrollTargets.slice(0,Z);if($)$.push(J);J=J.assignedSlot||J.parentNode}else if(J.nodeType==11)J=J.host;else break;if(Z<this.scrollTargets.length&&!$)$=this.scrollTargets.slice(0,Z);if($){for(let J of this.scrollTargets)J.removeEventListener("scroll",this.onScroll);for(let J of this.scrollTargets=$)J.addEventListener("scroll",this.onScroll)}}ignore(Z){if(!this.active)return Z();try{return this.stop(),Z()}finally{this.start(),this.clear()}}start(){if(this.active)return;if(this.observer.observe(this.dom,wU),D7)this.dom.addEventListener("DOMCharacterDataModified",this.onCharData);this.active=!0}stop(){if(!this.active)return;if(this.active=!1,this.observer.disconnect(),D7)this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData)}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(Z,$){var J;if(!this.delayedAndroidKey){let Y=()=>{let X=this.delayedAndroidKey;if(X){if(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=X.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&X.force)v2(this.dom,X.key,X.keyCode)}};this.flushingAndroidKey=this.view.win.requestAnimationFrame(Y)}if(!this.delayedAndroidKey||Z=="Enter")this.delayedAndroidKey={key:Z,keyCode:$,force:this.lastChange<Date.now()-50||!!((J=this.delayedAndroidKey)===null||J===void 0?void 0:J.force)}}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){if(this.delayedFlush<0)this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()})}forceFlush(){if(this.delayedFlush>=0)this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1;this.flush()}pendingRecords(){for(let Z of this.observer.takeRecords())this.queue.push(Z);return this.queue}processRecords(){let Z=this.pendingRecords();if(Z.length)this.queue=[];let $=-1,J=-1,Y=!1;for(let X of Z){let Q=this.readMutation(X);if(!Q)continue;if(Q.typeOver)Y=!0;if($==-1)({from:$,to:J}=Q);else $=Math.min(Q.from,$),J=Math.max(Q.to,J)}return{from:$,to:J,typeOver:Y}}readChange(){let{from:Z,to:$,typeOver:J}=this.processRecords(),Y=this.selectionChanged&&I3(this.dom,this.selectionRange);if(Z<0&&!Y)return null;if(Z>-1)this.lastChange=Date.now();this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let X=new q$(this.view,Z,$,J);return this.view.docView.domChanged={newSel:X.newSel?X.newSel.main:null},X}flush(Z=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;if(Z)this.readSelectionRange();let $=this.readChange();if(!$)return this.view.requestMeasure(),!1;let J=this.view.state,Y=W$(this.view,$);if(this.view.state==J&&($.domChanged||$.newSel&&!p6(this.view.state.selection,$.newSel.main)))this.view.update([]);return Y}readMutation(Z){let $=this.view.docView.tile.nearest(Z.target);if(!$||$.isWidget())return null;if($.markDirty(Z.type=="attributes"),Z.type=="childList"){let J=UZ($,Z.previousSibling||Z.target.previousSibling,-1),Y=UZ($,Z.nextSibling||Z.target.nextSibling,1);return{from:J?$.posAfter(J):$.posAtStart,to:Y?$.posBefore(Y):$.posAtEnd,typeOver:!1}}else if(Z.type=="characterData")return{from:$.posAtStart,to:$.posAtEnd,typeOver:Z.target.nodeValue==Z.oldValue};else return null}setWindow(Z){if(Z!=this.win)this.removeWindowListeners(this.win),this.win=Z,this.addWindowListeners(this.win)}addWindowListeners(Z){if(Z.addEventListener("resize",this.onResize),this.printQuery)if(this.printQuery.addEventListener)this.printQuery.addEventListener("change",this.onPrint);else this.printQuery.addListener(this.onPrint);else Z.addEventListener("beforeprint",this.onPrint);Z.addEventListener("scroll",this.onScroll),Z.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(Z){if(Z.removeEventListener("scroll",this.onScroll),Z.removeEventListener("resize",this.onResize),this.printQuery)if(this.printQuery.removeEventListener)this.printQuery.removeEventListener("change",this.onPrint);else this.printQuery.removeListener(this.onPrint);else Z.removeEventListener("beforeprint",this.onPrint);Z.document.removeEventListener("selectionchange",this.onSelectionChange)}update(Z){if(this.editContext){if(this.editContext.update(Z),Z.startState.facet(g1)!=Z.state.facet(g1))Z.view.contentDOM.editContext=Z.state.facet(g1)?this.editContext.editContext:null}}destroy(){var Z,$,J;this.stop(),(Z=this.intersection)===null||Z===void 0||Z.disconnect(),($=this.gapIntersection)===null||$===void 0||$.disconnect(),(J=this.resizeScroll)===null||J===void 0||J.disconnect();for(let Y of this.scrollTargets)Y.removeEventListener("scroll",this.onScroll);if(this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext)this.view.contentDOM.editContext=null,this.editContext.destroy()}}function UZ(Z,$,J){while($){let Y=M0.get($);if(Y&&Y.parent==Z)return Y;let X=$.parentNode;$=X!=Z.dom?X:J>0?$.nextSibling:$.previousSibling}return null}function qZ(Z,$){let{startContainer:J,startOffset:Y,endContainer:X,endOffset:Q}=$,K=Z.docView.domAtPos(Z.state.selection.main.anchor,1);if(D3(K.node,K.offset,X,Q))[J,Y,X,Q]=[X,Q,J,Y];return{anchorNode:J,anchorOffset:Y,focusNode:X,focusOffset:Q}}function vU(Z,$){if($.getComposedRanges){let X=$.getComposedRanges(Z.root)[0];if(X)return qZ(Z,X)}let J=null;function Y(X){X.preventDefault(),X.stopImmediatePropagation(),J=X.getTargetRanges()[0]}return Z.contentDOM.addEventListener("beforeinput",Y,!0),Z.dom.ownerDocument.execCommand("indent"),Z.contentDOM.removeEventListener("beforeinput",Y,!0),J?qZ(Z,J):null}class b${constructor(Z){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(Z.state);let $=this.editContext=new window.EditContext({text:Z.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,Z.state.selection.main.anchor))),selectionEnd:this.toContextPos(Z.state.selection.main.head)});this.handlers.textupdate=(J)=>{let Y=Z.state.selection.main,{anchor:X,head:Q}=Y,K=this.toEditorPos(J.updateRangeStart),U=this.toEditorPos(J.updateRangeEnd);if(Z.inputState.composing>=0&&!this.composing)this.composing={contextBase:J.updateRangeStart,editorBase:K,drifted:!1};let q=U-K>J.text.length;if(K==this.from&&X<this.from)K=X;else if(U==this.to&&X>this.to)U=X;let G=j$(Z.state.sliceDoc(K,U),J.text,(q?Y.from:Y.to)-K,q?"end":null);if(!G){let j=L.single(this.toEditorPos(J.selectionStart),this.toEditorPos(J.selectionEnd));if(!p6(j,Y))Z.dispatch({selection:j,userEvent:"select"});return}let W={from:G.from+K,to:G.toA+K,insert:Z0.of(J.text.slice(G.from,G.toB).split(`
`))};if((h.mac||h.android)&&W.from==Q-1&&/^\. ?$/.test(J.text)&&Z.contentDOM.getAttribute("autocorrect")=="off")W={from:K,to:U,insert:Z0.of([J.text.replace("."," ")])};if(this.pendingContextChange=W,!Z.state.readOnly){let j=this.to-this.from+(W.to-W.from+W.insert.length);Q4(Z,W,L.single(this.toEditorPos(J.selectionStart,j),this.toEditorPos(J.selectionEnd,j)))}if(this.pendingContextChange)this.revertPending(Z.state),this.setSelection(Z.state);if(W.from<W.to&&!W.insert.length&&Z.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test($.text.slice(Math.max(0,J.updateRangeStart-1),Math.min($.text.length,J.updateRangeStart+1))))this.handlers.compositionend(J)},this.handlers.characterboundsupdate=(J)=>{let Y=[],X=null;for(let Q=this.toEditorPos(J.rangeStart),K=this.toEditorPos(J.rangeEnd);Q<K;Q++){let U=Z.coordsForChar(Q);X=U&&new DOMRect(U.left,U.top,U.right-U.left,U.bottom-U.top)||X||new DOMRect,Y.push(X)}$.updateCharacterBounds(J.rangeStart,Y)},this.handlers.textformatupdate=(J)=>{let Y=[];for(let X of J.getTextFormats()){let{underlineStyle:Q,underlineThickness:K}=X;if(!/none/i.test(Q)&&!/none/i.test(K)){let U=this.toEditorPos(X.rangeStart),q=this.toEditorPos(X.rangeEnd);if(U<q){let G=`text-decoration: underline ${/^[a-z]/.test(Q)?Q+" ":Q=="Dashed"?"dashed ":Q=="Squiggle"?"wavy ":""}${/thin/i.test(K)?1:2}px`;Y.push(g.mark({attributes:{style:G}}).range(U,q))}}}Z.dispatch({effects:cZ.of(g.set(Y))})},this.handlers.compositionstart=()=>{if(Z.inputState.composing<0)Z.inputState.composing=0,Z.inputState.compositionFirstChange=!0},this.handlers.compositionend=()=>{if(Z.inputState.composing=-1,Z.inputState.compositionFirstChange=null,this.composing){let{drifted:J}=this.composing;if(this.composing=null,J)this.reset(Z.state)}};for(let J in this.handlers)$.addEventListener(J,this.handlers[J]);this.measureReq={read:(J)=>{this.editContext.updateControlBounds(J.contentDOM.getBoundingClientRect());let Y=m2(J.root);if(Y&&Y.rangeCount)this.editContext.updateSelectionBounds(Y.getRangeAt(0).getBoundingClientRect())}}}applyEdits(Z){let $=0,J=!1,Y=this.pendingContextChange;if(Z.changes.iterChanges((X,Q,K,U,q)=>{if(J)return;let G=q.length-(Q-X);if(Y&&Q>=Y.to)if(Y.from==X&&Y.to==Q&&Y.insert.eq(q)){Y=this.pendingContextChange=null,$+=G,this.to+=G;return}else Y=null,this.revertPending(Z.state);if(X+=$,Q+=$,Q<=this.from)this.from+=G,this.to+=G;else if(X<this.to){if(X<this.from||Q>this.to||this.to-this.from+q.length>30000){J=!0;return}this.editContext.updateText(this.toContextPos(X),this.toContextPos(Q),q.toString()),this.to+=G}$+=G}),Y&&!J)this.revertPending(Z.state);return!J}update(Z){let $=this.pendingContextChange,J=Z.startState.selection.main;if(this.composing&&(this.composing.drifted||!Z.changes.touchesRange(J.from,J.to)&&Z.transactions.some((Y)=>!Y.isUserEvent("input.type")&&Y.changes.touchesRange(this.from,this.to))))this.composing.drifted=!0,this.composing.editorBase=Z.changes.mapPos(this.composing.editorBase);else if(!this.applyEdits(Z)||!this.rangeIsValid(Z.state))this.pendingContextChange=null,this.reset(Z.state);else if(Z.docChanged||Z.selectionSet||$)this.setSelection(Z.state);if(Z.geometryChanged||Z.docChanged||Z.selectionSet)Z.view.requestMeasure(this.measureReq)}resetRange(Z){let{head:$}=Z.selection.main;this.from=Math.max(0,$-1e4),this.to=Math.min(Z.doc.length,$+1e4)}reset(Z){this.resetRange(Z),this.editContext.updateText(0,this.editContext.text.length,Z.doc.sliceString(this.from,this.to)),this.setSelection(Z)}revertPending(Z){let $=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos($.from),this.toContextPos($.from+$.insert.length),Z.doc.sliceString($.from,$.to))}setSelection(Z){let{main:$}=Z.selection,J=this.toContextPos(Math.max(this.from,Math.min(this.to,$.anchor))),Y=this.toContextPos($.head);if(this.editContext.selectionStart!=J||this.editContext.selectionEnd!=Y)this.editContext.updateSelection(J,Y)}rangeIsValid(Z){let{head:$}=Z.selection.main;return!(this.from>0&&$-this.from<500||this.to<Z.doc.length&&this.to-$<500||this.to-this.from>30000)}toEditorPos(Z,$=this.to-this.from){Z=Math.min(Z,$);let J=this.composing;return J&&J.drifted?J.editorBase+(Z-J.contextBase):Z+this.from}toContextPos(Z){let $=this.composing;return $&&$.drifted?$.contextBase+(Z-$.editorBase):Z-this.from}destroy(){for(let Z in this.handlers)this.editContext.removeEventListener(Z,this.handlers[Z])}}class P{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(Z={}){var $;if(this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),Z.parent)Z.parent.appendChild(this.dom);let{dispatch:J}=Z;if(this.dispatchTransactions=Z.dispatchTransactions||J&&((Y)=>Y.forEach((X)=>J(X,this)))||((Y)=>this.update(Y)),this.dispatch=this.dispatch.bind(this),this._root=Z.root||bK(Z.parent)||document,this.viewState=new f7(Z.state||i.create(Z)),Z.scrollTo&&Z.scrollTo.is(F6))this.viewState.scrollTarget=Z.scrollTo.value.clip(this.viewState.state);this.plugins=this.state.facet(x2).map((Y)=>new T6(Y));for(let Y of this.plugins)Y.update(this);if(this.observer=new y$(this),this.inputState=new _$(this),this.inputState.ensureHandlers(this.plugins),this.docView=new h7(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),($=document.fonts)===null||$===void 0?void 0:$.ready)document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...Z){let $=Z.length==1&&Z[0]instanceof N0?Z:Z.length==1&&Array.isArray(Z[0])?Z[0]:[this.state.update(...Z)];this.dispatchTransactions($,this)}update(Z){if(this.updateState!=0)throw Error("Calls to EditorView.update are not allowed while an update is in progress");let $=!1,J=!1,Y,X=this.state;for(let j of Z){if(j.startState!=X)throw RangeError("Trying to update state with a transaction that doesn't start from the previous state.");X=j.state}if(this.destroyed){this.viewState.state=X;return}let Q=this.hasFocus,K=0,U=null;if(Z.some((j)=>j.annotation(F$)))this.inputState.notifiedFocused=Q,K=1;else if(Q!=this.inputState.notifiedFocused){if(this.inputState.notifiedFocused=Q,U=I$(X,Q),!U)K=1}let q=this.observer.delayedAndroidKey,G=null;if(q){if(this.observer.clearDelayedAndroidKey(),G=this.observer.readChange(),G&&!this.state.doc.eq(X.doc)||!this.state.selection.eq(X.selection))G=null}else this.observer.clear();if(X.facet(i.phrases)!=this.state.facet(i.phrases))return this.setState(X);Y=g6.create(this,X,Z),Y.flags|=K;let W=this.viewState.scrollTarget;try{this.updateState=2;for(let j of Z){if(W)W=W.map(j.changes);if(j.scrollIntoView){let{main:_}=j.state.selection;W=new u2(_.empty?_:L.cursor(_.head,_.head>_.anchor?-1:1))}for(let _ of j.effects)if(_.is(F6))W=_.value.clip(this.state)}if(this.viewState.update(Y,W),this.bidiCache=d6.update(this.bidiCache,Y.changes),!Y.empty)this.updatePlugins(Y),this.inputState.update(Y);if($=this.docView.update(Y),this.state.facet(O3)!=this.styleModules)this.mountStyles();J=this.updateAttrs(),this.showAnnouncements(Z),this.docView.updateSelection($,Z.some((j)=>j.isUserEvent("select.pointer")))}finally{this.updateState=0}if(Y.startState.facet(A6)!=Y.state.facet(A6))this.viewState.mustMeasureContent=!0;if($||J||W||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)this.requestMeasure();if($)this.docViewUpdate();if(!Y.empty)for(let j of this.state.facet(x7))try{j(Y)}catch(_){h0(this.state,_,"update listener")}if(U||G)Promise.resolve().then(()=>{if(U&&this.state==U.startState)this.dispatch(U);if(G){if(!W$(this,G)&&q.force)v2(this.contentDOM,q.key,q.keyCode)}})}setState(Z){if(this.updateState!=0)throw Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=Z;return}this.updateState=2;let $=this.hasFocus;try{for(let J of this.plugins)J.destroy(this);this.viewState=new f7(Z),this.plugins=Z.facet(x2).map((J)=>new T6(J)),this.pluginMap.clear();for(let J of this.plugins)J.update(this);this.docView.destroy(),this.docView=new h7(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}if($)this.focus();this.requestMeasure()}updatePlugins(Z){let $=Z.startState.facet(x2),J=Z.state.facet(x2);if($!=J){let Y=[];for(let X of J){let Q=$.indexOf(X);if(Q<0)Y.push(new T6(X));else{let K=this.plugins[Q];K.mustUpdate=Z,Y.push(K)}}for(let X of this.plugins)if(X.mustUpdate!=Z)X.destroy(this);this.plugins=Y,this.pluginMap.clear()}else for(let Y of this.plugins)Y.mustUpdate=Z;for(let Y=0;Y<this.plugins.length;Y++)this.plugins[Y].update(this);if($!=J)this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let Z of this.plugins){let $=Z.value;if($&&$.docViewUpdate)try{$.docViewUpdate(this)}catch(J){h0(this.state,J,"doc view update listener")}}}measure(Z=!0){if(this.destroyed)return;if(this.measureScheduled>-1)this.win.cancelAnimationFrame(this.measureScheduled);if(this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}if(this.measureScheduled=0,Z)this.observer.forceFlush();let $=null,J=this.scrollDOM,Y=J.scrollTop*this.scaleY,{scrollAnchorPos:X,scrollAnchorHeight:Q}=this.viewState;if(Math.abs(Y-this.viewState.scrollTop)>1)Q=-1;this.viewState.scrollAnchorHeight=-1;try{for(let K=0;;K++){if(Q<0)if(CZ(J))X=-1,Q=this.viewState.heightMap.height;else{let _=this.viewState.scrollAnchorAt(Y);X=_.from,Q=_.top}this.updateState=1;let U=this.viewState.measure(this);if(!U&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(K>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let q=[];if(!(U&4))[this.measureRequests,q]=[q,this.measureRequests];let G=q.map((_)=>{try{return _.read(this)}catch(z){return h0(this.state,z),GZ}}),W=g6.create(this,this.state,[]),j=!1;if(W.flags|=U,!$)$=W;else $.flags|=U;if(this.updateState=2,!W.empty){if(this.updatePlugins(W),this.inputState.update(W),this.updateAttrs(),j=this.docView.update(W),j)this.docViewUpdate()}for(let _=0;_<q.length;_++)if(G[_]!=GZ)try{let z=q[_];if(z.write)z.write(G[_],this)}catch(z){h0(this.state,z)}if(j)this.docView.updateSelection(!0);if(!W.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,Q=-1;continue}else{let z=(X<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(X).top)-Q;if(z>1||z<-1){Y=Y+z,J.scrollTop=Y/this.scaleY,Q=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if($&&!$.empty)for(let K of this.state.facet(x7))K($)}get themeClasses(){return l7+" "+(this.state.facet(p7)?C$:P$)+" "+this.state.facet(A6)}updateAttrs(){let Z=WZ(this,sZ,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),$={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:!this.state.facet(g1)?"false":"true",class:"cm-content",style:`${h.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};if(this.state.readOnly)$["aria-readonly"]="true";WZ(this,J4,$);let J=this.observer.ignore(()=>{let Y=f5(this.contentDOM,this.contentAttrs,$),X=f5(this.dom,this.editorAttrs,Z);return Y||X});return this.editorAttrs=Z,this.contentAttrs=$,J}showAnnouncements(Z){let $=!0;for(let J of Z)for(let Y of J.effects)if(Y.is(P.announce)){if($)this.announceDOM.textContent="";$=!1;let X=this.announceDOM.appendChild(document.createElement("div"));X.textContent=Y.value}}mountStyles(){this.styleModules=this.state.facet(O3);let Z=this.state.facet(P.cspNonce);F1.mount(this.root,this.styleModules.concat(hU).reverse(),Z?{nonce:Z}:void 0)}readMeasured(){if(this.updateState==2)throw Error("Reading the editor layout isn't allowed during an update");if(this.updateState==0&&this.measureScheduled>-1)this.measure(!1)}requestMeasure(Z){if(this.measureScheduled<0)this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure());if(Z){if(this.measureRequests.indexOf(Z)>-1)return;if(Z.key!=null){for(let $=0;$<this.measureRequests.length;$++)if(this.measureRequests[$].key===Z.key){this.measureRequests[$]=Z;return}}this.measureRequests.push(Z)}}plugin(Z){let $=this.pluginMap.get(Z);if($===void 0||$&&$.plugin!=Z)this.pluginMap.set(Z,$=this.plugins.find((J)=>J.plugin==Z)||null);return $&&$.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(Z){return this.readMeasured(),this.viewState.elementAtHeight(Z)}lineBlockAtHeight(Z){return this.readMeasured(),this.viewState.lineBlockAtHeight(Z)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(Z){return this.viewState.lineBlockAt(Z)}get contentHeight(){return this.viewState.contentHeight}moveByChar(Z,$,J){return I7(this,Z,n5(this,Z,$,J))}moveByGroup(Z,$){return I7(this,Z,n5(this,Z,$,(J)=>KU(this,Z.head,J)))}visualLineSide(Z,$){let J=this.bidiSpans(Z),Y=this.textDirectionAt(Z.from),X=J[$?J.length-1:0];return L.cursor(X.side($,Y)+Z.from,X.forward(!$,Y)?1:-1)}moveToLineBoundary(Z,$,J=!0){return QU(this,Z,$,J)}moveVertically(Z,$,J){return I7(this,Z,UU(this,Z,$,J))}domAtPos(Z,$=1){return this.docView.domAtPos(Z,$)}posAtDOM(Z,$=0){return this.docView.posFromDOM(Z,$)}posAtCoords(Z,$=!0){this.readMeasured();let J=u7(this,Z,$);return J&&J.pos}posAndSideAtCoords(Z,$=!0){return this.readMeasured(),u7(this,Z,$)}coordsAtPos(Z,$=1){this.readMeasured();let J=this.docView.coordsAt(Z,$);if(!J||J.left==J.right)return J;let Y=this.state.doc.lineAt(Z),X=this.bidiSpans(Y),Q=X[k1.find(X,Z-Y.from,-1,$)];return m6(J,Q.dir==Q0.LTR==$>0)}coordsForChar(Z){return this.readMeasured(),this.docView.coordsForChar(Z)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(Z){if(!this.state.facet(pZ)||Z<this.viewport.from||Z>this.viewport.to)return this.textDirection;return this.readMeasured(),this.docView.textDirectionAt(Z)}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(Z){if(Z.length>uU)return xZ(Z.length);let $=this.textDirectionAt(Z.from),J;for(let X of this.bidiCache)if(X.from==Z.from&&X.dir==$&&(X.fresh||SZ(X.isolates,J=d5(this,Z))))return X.order;if(!J)J=d5(this,Z);let Y=mK(Z.text,$,J);return this.bidiCache.push(new d6(Z.from,Z.to,$,J,!0,Y)),Y}get hasFocus(){var Z;return(this.dom.ownerDocument.hasFocus()||h.safari&&((Z=this.inputState)===null||Z===void 0?void 0:Z.lastContextMenu)>Date.now()-30000)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{PZ(this.contentDOM),this.docView.updateSelection()})}setRoot(Z){if(this._root!=Z)this._root=Z,this.observer.setWindow((Z.nodeType==9?Z:Z.ownerDocument).defaultView||window),this.mountStyles()}destroy(){if(this.root.activeElement==this.contentDOM)this.contentDOM.blur();for(let Z of this.plugins)Z.destroy(this);if(this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1)this.win.cancelAnimationFrame(this.measureScheduled);this.destroyed=!0}static scrollIntoView(Z,$={}){return F6.of(new u2(typeof Z=="number"?L.cursor(Z):Z,$.y,$.x,$.yMargin,$.xMargin))}scrollSnapshot(){let{scrollTop:Z,scrollLeft:$}=this.scrollDOM,J=this.viewState.scrollAnchorAt(Z);return F6.of(new u2(L.cursor(J.from),"start","start",J.top-Z,$,!0))}setTabFocusMode(Z){if(Z==null)this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1;else if(typeof Z=="boolean")this.inputState.tabFocusMode=Z?0:-1;else if(this.inputState.tabFocusMode!=0)this.inputState.tabFocusMode=Date.now()+Z}static domEventHandlers(Z){return _0.define(()=>({}),{eventHandlers:Z})}static domEventObservers(Z){return _0.define(()=>({}),{eventObservers:Z})}static theme(Z,$){let J=F1.newName(),Y=[A6.of(J),O3.of(d7(`.${J}`,Z))];if($&&$.dark)Y.push(p7.of(!0));return Y}static baseTheme(Z){return R1.lowest(O3.of(d7("."+l7,Z,T$)))}static findFromDOM(Z){var $;let J=Z.querySelector(".cm-content"),Y=J&&M0.get(J)||M0.get(Z);return(($=Y===null||Y===void 0?void 0:Y.root)===null||$===void 0?void 0:$.view)||null}}P.styleModule=O3;P.inputHandler=gZ;P.clipboardInputFilter=Z4;P.clipboardOutputFilter=$4;P.scrollHandler=dZ;P.focusChangeEffect=fZ;P.perLineTextDirection=pZ;P.exceptionSink=mZ;P.updateListener=x7;P.editable=g1;P.mouseSelectionStyle=uZ;P.dragMovesSelection=vZ;P.clickAddsSelectionRange=wZ;P.decorations=n6;P.blockWrappers=nZ;P.outerDecorations=Y4;P.atomicRanges=y3;P.bidiIsolatedRanges=iZ;P.scrollMargins=rZ;P.darkTheme=p7;P.cspNonce=S.define({combine:(Z)=>Z.length?Z[0]:""});P.contentAttributes=J4;P.editorAttributes=sZ;P.lineWrapping=P.contentAttributes.of({class:"cm-lineWrapping"});P.announce=l.define();var uU=4096,GZ={};class d6{constructor(Z,$,J,Y,X,Q){this.from=Z,this.to=$,this.dir=J,this.isolates=Y,this.fresh=X,this.order=Q}static update(Z,$){if($.empty&&!Z.some((X)=>X.fresh))return Z;let J=[],Y=Z.length?Z[Z.length-1].dir:Q0.LTR;for(let X=Math.max(0,Z.length-10);X<Z.length;X++){let Q=Z[X];if(Q.dir==Y&&!$.touchesRange(Q.from,Q.to))J.push(new d6($.mapPos(Q.from,1),$.mapPos(Q.to,-1),Q.dir,Q.isolates,!1,Q.order))}return J}}function WZ(Z,$,J){for(let Y=Z.state.facet($),X=Y.length-1;X>=0;X--){let Q=Y[X],K=typeof Q=="function"?Q(Z):Q;if(K)o7(K,J)}return J}var mU=h.mac?"mac":h.windows?"win":h.linux?"linux":"key";function gU(Z,$){let J=Z.split(/-(?!$)/),Y=J[J.length-1];if(Y=="Space")Y=" ";let X,Q,K,U;for(let q=0;q<J.length-1;++q){let G=J[q];if(/^(cmd|meta|m)$/i.test(G))U=!0;else if(/^a(lt)?$/i.test(G))X=!0;else if(/^(c|ctrl|control)$/i.test(G))Q=!0;else if(/^s(hift)?$/i.test(G))K=!0;else if(/^mod$/i.test(G))if($=="mac")U=!0;else Q=!0;else throw Error("Unrecognized modifier name: "+G)}if(X)Y="Alt-"+Y;if(Q)Y="Ctrl-"+Y;if(U)Y="Meta-"+Y;if(K)Y="Shift-"+Y;return Y}function B6(Z,$,J){if($.altKey)Z="Alt-"+Z;if($.ctrlKey)Z="Ctrl-"+Z;if($.metaKey)Z="Meta-"+Z;if(J!==!1&&$.shiftKey)Z="Shift-"+Z;return Z}var fU=R1.default(P.domEventHandlers({keydown(Z,$){return x$(k$($.state),Z,$,"editor")}})),N2=S.define({enables:fU}),jZ=new WeakMap;function k$(Z){let $=Z.facet(N2),J=jZ.get($);if(!J)jZ.set($,J=lU($.reduce((Y,X)=>Y.concat(X),[])));return J}function S$(Z,$,J){return x$(k$(Z.state),$,Z,J)}var c1=null,pU=4000;function lU(Z,$=mU){let J=Object.create(null),Y=Object.create(null),X=(K,U)=>{let q=Y[K];if(q==null)Y[K]=U;else if(q!=U)throw Error("Key binding "+K+" is used both as a regular binding and as a multi-stroke prefix")},Q=(K,U,q,G,W)=>{var j,_;let z=J[K]||(J[K]=Object.create(null)),V=U.split(/ (?!$)/).map((F)=>gU(F,$));for(let F=1;F<V.length;F++){let D=V.slice(0,F).join(" ");if(X(D,!0),!z[D])z[D]={preventDefault:!0,stopPropagation:!1,run:[(M)=>{let A=c1={view:M,prefix:D,scope:K};return setTimeout(()=>{if(c1==A)c1=null},pU),!0}]}}let O=V.join(" ");X(O,!1);let H=z[O]||(z[O]={preventDefault:!1,stopPropagation:!1,run:((_=(j=z._any)===null||j===void 0?void 0:j.run)===null||_===void 0?void 0:_.slice())||[]});if(q)H.run.push(q);if(G)H.preventDefault=!0;if(W)H.stopPropagation=!0};for(let K of Z){let U=K.scope?K.scope.split(" "):["editor"];if(K.any)for(let G of U){let W=J[G]||(J[G]=Object.create(null));if(!W._any)W._any={preventDefault:!1,stopPropagation:!1,run:[]};let{any:j}=K;for(let _ in W)W[_].run.push((z)=>j(z,c7))}let q=K[$]||K.key;if(!q)continue;for(let G of U)if(Q(G,q,K.run,K.preventDefault,K.stopPropagation),K.shift)Q(G,"Shift-"+q,K.shift,K.preventDefault,K.stopPropagation)}return J}var c7=null;function x$(Z,$,J,Y){c7=$;let X=w5($),Q=S0(X,0),K=a0(Q)==X.length&&X!=" ",U="",q=!1,G=!1,W=!1;if(c1&&c1.view==J&&c1.scope==Y){if(U=c1.prefix+" ",O$.indexOf($.keyCode)<0)G=!0,c1=null}let j=new Set,_=(H)=>{if(H){for(let F of H.run)if(!j.has(F)){if(j.add(F),F(J)){if(H.stopPropagation)W=!0;return!0}}if(H.preventDefault){if(H.stopPropagation)W=!0;G=!0}}return!1},z=Z[Y],V,O;if(z){if(_(z[U+B6(X,$,!K)]))q=!0;else if(K&&($.altKey||$.metaKey||$.ctrlKey)&&!(h.windows&&$.ctrlKey&&$.altKey)&&!(h.mac&&$.altKey&&!($.ctrlKey||$.metaKey))&&(V=m1[$.keyCode])&&V!=X){if(_(z[U+B6(V,$,!0)]))q=!0;else if($.shiftKey&&(O=S2[$.keyCode])!=X&&O!=V&&_(z[U+B6(O,$,!1)]))q=!0}else if(K&&$.shiftKey&&_(z[U+B6(X,$,!0)]))q=!0;if(!q&&_(z._any))q=!0}if(G)q=!0;if(q&&W)$.stopPropagation();return c7=null,q}class S3{constructor(Z,$,J,Y,X){this.className=Z,this.left=$,this.top=J,this.width=Y,this.height=X}draw(){let Z=document.createElement("div");return Z.className=this.className,this.adjust(Z),Z}update(Z,$){if($.className!=this.className)return!1;return this.adjust(Z),!0}adjust(Z){if(Z.style.left=this.left+"px",Z.style.top=this.top+"px",this.width!=null)Z.style.width=this.width+"px";Z.style.height=this.height+"px"}eq(Z){return this.left==Z.left&&this.top==Z.top&&this.width==Z.width&&this.height==Z.height&&this.className==Z.className}static forRange(Z,$,J){if(J.empty){let Y=Z.coordsAtPos(J.head,J.assoc||1);if(!Y)return[];let X=h$(Z);return[new S3($,Y.left-X.left,Y.top-X.top,null,Y.bottom-Y.top)]}else return dU(Z,$,J)}}function h$(Z){let $=Z.scrollDOM.getBoundingClientRect();return{left:(Z.textDirection==Q0.LTR?$.left:$.right-Z.scrollDOM.clientWidth*Z.scaleX)-Z.scrollDOM.scrollLeft*Z.scaleX,top:$.top-Z.scrollDOM.scrollTop*Z.scaleY}}function _Z(Z,$,J,Y){let X=Z.coordsAtPos($,J*2);if(!X)return Y;let Q=Z.dom.getBoundingClientRect(),K=(X.top+X.bottom)/2,U=Z.posAtCoords({x:Q.left+1,y:K}),q=Z.posAtCoords({x:Q.right-1,y:K});if(U==null||q==null)return Y;return{from:Math.max(Y.from,Math.min(U,q)),to:Math.min(Y.to,Math.max(U,q))}}function dU(Z,$,J){if(J.to<=Z.viewport.from||J.from>=Z.viewport.to)return[];let Y=Math.max(J.from,Z.viewport.from),X=Math.min(J.to,Z.viewport.to),Q=Z.textDirection==Q0.LTR,K=Z.contentDOM,U=K.getBoundingClientRect(),q=h$(Z),G=K.querySelector(".cm-line"),W=G&&window.getComputedStyle(G),j=U.left+(W?parseInt(W.paddingLeft)+Math.min(0,parseInt(W.textIndent)):0),_=U.right-(W?parseInt(W.paddingRight):0),z=v7(Z,Y,1),V=v7(Z,X,-1),O=z.type==w0.Text?z:null,H=V.type==w0.Text?V:null;if(O&&(Z.lineWrapping||z.widgetLineBreaks))O=_Z(Z,Y,1,O);if(H&&(Z.lineWrapping||V.widgetLineBreaks))H=_Z(Z,X,-1,H);if(O&&H&&O.from==H.from&&O.to==H.to)return D(M(J.from,J.to,O));else{let B=O?M(J.from,null,O):A(z,!1),w=H?M(null,J.to,H):A(V,!0),x=[];if((O||z).to<(H||V).from-(O&&H?1:0)||z.widgetLineBreaks>1&&B.bottom+Z.defaultLineHeight/2<w.top)x.push(F(j,B.bottom,_,w.top));else if(B.bottom<w.top&&Z.elementAtHeight((B.bottom+w.top)/2).type==w0.Text)B.bottom=w.top=(B.bottom+w.top)/2;return D(B).concat(x).concat(D(w))}function F(B,w,x,c){return new S3($,B-q.left,w-q.top,x-B,c-w)}function D({top:B,bottom:w,horizontal:x}){let c=[];for(let a=0;a<x.length;a+=2)c.push(F(x[a],B,x[a+1],w));return c}function M(B,w,x){let c=1e9,a=-1e9,T=[];function C(f,t,I0,T0,Y1){let B0=Z.coordsAtPos(f,f==x.to?-2:2),R=Z.coordsAtPos(I0,I0==x.from?2:-2);if(!B0||!R)return;if(c=Math.min(B0.top,R.top,c),a=Math.max(B0.bottom,R.bottom,a),Y1==Q0.LTR)T.push(Q&&t?j:B0.left,Q&&T0?_:R.right);else T.push(!Q&&T0?j:R.left,!Q&&t?_:B0.right)}let E=B!==null&&B!==void 0?B:x.from,y=w!==null&&w!==void 0?w:x.to;for(let f of Z.visibleRanges)if(f.to>E&&f.from<y)for(let t=Math.max(f.from,E),I0=Math.min(f.to,y);;){let T0=Z.state.doc.lineAt(t);for(let Y1 of Z.bidiSpans(T0)){let B0=Y1.from+T0.from,R=Y1.to+T0.from;if(B0>=I0)break;if(R>t)C(Math.max(B0,t),B==null&&B0<=E,Math.min(R,I0),w==null&&R>=y,Y1.dir)}if(t=T0.to+1,t>=I0)break}if(T.length==0)C(E,B==null,y,w==null,Z.textDirection);return{top:c,bottom:a,horizontal:T}}function A(B,w){let x=U.top+(w?B.top:B.bottom);return{top:x,bottom:x,horizontal:[]}}}function cU(Z,$){return Z.constructor==$.constructor&&Z.eq($)}class w${constructor(Z,$){if(this.view=Z,this.layer=$,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=Z.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),$.above)this.dom.classList.add("cm-layer-above");if($.class)this.dom.classList.add($.class);if(this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(Z.state),Z.requestMeasure(this.measureReq),$.mount)$.mount(this.dom,Z)}update(Z){if(Z.startState.facet(S6)!=Z.state.facet(S6))this.setOrder(Z.state);if(this.layer.update(Z,this.dom)||Z.geometryChanged)this.scale(),Z.view.requestMeasure(this.measureReq)}docViewUpdate(Z){if(this.layer.updateOnDocViewUpdate!==!1)Z.requestMeasure(this.measureReq)}setOrder(Z){let $=0,J=Z.facet(S6);while($<J.length&&J[$]!=this.layer)$++;this.dom.style.zIndex=String((this.layer.above?150:-1)-$)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:Z,scaleY:$}=this.view;if(Z!=this.scaleX||$!=this.scaleY)this.scaleX=Z,this.scaleY=$,this.dom.style.transform=`scale(${1/Z}, ${1/$})`}draw(Z){if(Z.length!=this.drawn.length||Z.some(($,J)=>!cU($,this.drawn[J]))){let $=this.dom.firstChild,J=0;for(let Y of Z)if(Y.update&&$&&Y.constructor&&this.drawn[J].constructor&&Y.update($,this.drawn[J]))$=$.nextSibling,J++;else this.dom.insertBefore(Y.draw(),$);while($){let Y=$.nextSibling;$.remove(),$=Y}if(this.drawn=Z,h.safari&&h.safari_version>=26)this.dom.style.display=this.dom.firstChild?"":"none"}}destroy(){if(this.layer.destroy)this.layer.destroy(this.dom,this.view);this.dom.remove()}}var S6=S.define();function v$(Z){return[_0.define(($)=>new w$($,Z)),S6.of(Z)]}var P3=S.define({combine(Z){return u0(Z,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:($,J)=>Math.min($,J),drawRangeCursor:($,J)=>$||J})}});function u$(Z={}){return[P3.of(Z),sU,nU,iU,lZ.of(!0)]}function m$(Z){return Z.startState.facet(P3)!=Z.state.facet(P3)}var sU=v$({above:!0,markers(Z){let{state:$}=Z,J=$.facet(P3),Y=[];for(let X of $.selection.ranges){let Q=X==$.selection.main;if(X.empty||J.drawRangeCursor){let K=Q?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",U=X.empty?X:L.cursor(X.head,X.head>X.anchor?-1:1);for(let q of S3.forRange(Z,K,U))Y.push(q)}}return Y},update(Z,$){if(Z.transactions.some((Y)=>Y.selection))$.style.animationName=$.style.animationName=="cm-blink"?"cm-blink2":"cm-blink";let J=m$(Z);if(J)zZ(Z.state,$);return Z.docChanged||Z.selectionSet||J},mount(Z,$){zZ($.state,Z)},class:"cm-cursorLayer"});function zZ(Z,$){$.style.animationDuration=Z.facet(P3).cursorBlinkRate+"ms"}var nU=v$({above:!1,markers(Z){return Z.state.selection.ranges.map(($)=>$.empty?[]:S3.forRange(Z,"cm-selectionBackground",$)).reduce(($,J)=>$.concat(J))},update(Z,$){return Z.docChanged||Z.selectionSet||Z.viewportChanged||m$(Z)},class:"cm-selectionLayer"}),iU=R1.highest(P.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),g$=l.define({map(Z,$){return Z==null?null:$.mapPos(Z)}}),R3=z0.define({create(){return null},update(Z,$){if(Z!=null)Z=$.changes.mapPos(Z);return $.effects.reduce((J,Y)=>Y.is(g$)?Y.value:J,Z)}}),rU=_0.fromClass(class{constructor(Z){this.view=Z,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(Z){var $;let J=Z.state.field(R3);if(J==null){if(this.cursor!=null)($=this.cursor)===null||$===void 0||$.remove(),this.cursor=null}else{if(!this.cursor)this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor";if(Z.startState.field(R3)!=J||Z.docChanged||Z.geometryChanged)this.view.requestMeasure(this.measureReq)}}readPos(){let{view:Z}=this,$=Z.state.field(R3),J=$!=null&&Z.coordsAtPos($);if(!J)return null;let Y=Z.scrollDOM.getBoundingClientRect();return{left:J.left-Y.left+Z.scrollDOM.scrollLeft*Z.scaleX,top:J.top-Y.top+Z.scrollDOM.scrollTop*Z.scaleY,height:J.bottom-J.top}}drawCursor(Z){if(this.cursor){let{scaleX:$,scaleY:J}=this.view;if(Z)this.cursor.style.left=Z.left/$+"px",this.cursor.style.top=Z.top/J+"px",this.cursor.style.height=Z.height/J+"px";else this.cursor.style.left="-100000px"}}destroy(){if(this.cursor)this.cursor.remove()}setDropPos(Z){if(this.view.state.field(R3)!=Z)this.view.dispatch({effects:g$.of(Z)})}},{eventObservers:{dragover(Z){this.setDropPos(this.view.posAtCoords({x:Z.clientX,y:Z.clientY}))},dragleave(Z){if(Z.target==this.view.contentDOM||!this.view.contentDOM.contains(Z.relatedTarget))this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function f$(){return[R3,rU]}function OZ(Z,$,J,Y,X){$.lastIndex=0;for(let Q=Z.iterRange(J,Y),K=J,U;!Q.next().done;K+=Q.value.length)if(!Q.lineBreak)while(U=$.exec(Q.value))X(K+U.index,U)}function aU(Z,$){let J=Z.visibleRanges;if(J.length==1&&J[0].from==Z.viewport.from&&J[0].to==Z.viewport.to)return J;let Y=[];for(let{from:X,to:Q}of J)if(X=Math.max(Z.state.doc.lineAt(X).from,X-$),Q=Math.min(Z.state.doc.lineAt(Q).to,Q+$),Y.length&&Y[Y.length-1].to>=X)Y[Y.length-1].to=Q;else Y.push({from:X,to:Q});return Y}class p${constructor(Z){let{regexp:$,decoration:J,decorate:Y,boundary:X,maxLength:Q=1000}=Z;if(!$.global)throw RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=$,Y)this.addMatch=(K,U,q,G)=>Y(G,q,q+K[0].length,K,U);else if(typeof J=="function")this.addMatch=(K,U,q,G)=>{let W=J(K,U,q);if(W)G(q,q+K[0].length,W)};else if(J)this.addMatch=(K,U,q,G)=>G(q,q+K[0].length,J);else throw RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=X,this.maxLength=Q}createDeco(Z){let $=new r0,J=$.add.bind($);for(let{from:Y,to:X}of aU(Z,this.maxLength))OZ(Z.state.doc,this.regexp,Y,X,(Q,K)=>this.addMatch(K,Z,Q,J));return $.finish()}updateDeco(Z,$){let J=1e9,Y=-1;if(Z.docChanged)Z.changes.iterChanges((X,Q,K,U)=>{if(U>=Z.view.viewport.from&&K<=Z.view.viewport.to)J=Math.min(K,J),Y=Math.max(U,Y)});if(Z.viewportMoved||Y-J>1000)return this.createDeco(Z.view);if(Y>-1)return this.updateRange(Z.view,$.map(Z.changes),J,Y);return $}updateRange(Z,$,J,Y){for(let X of Z.visibleRanges){let Q=Math.max(X.from,J),K=Math.min(X.to,Y);if(K>=Q){let U=Z.state.doc.lineAt(Q),q=U.to<K?Z.state.doc.lineAt(K):U,G=Math.max(X.from,U.from),W=Math.min(X.to,q.to);if(this.boundary){for(;Q>U.from;Q--)if(this.boundary.test(U.text[Q-1-U.from])){G=Q;break}for(;K<q.to;K++)if(this.boundary.test(q.text[K-q.from])){W=K;break}}let j=[],_,z=(V,O,H)=>j.push(H.range(V,O));if(U==q){this.regexp.lastIndex=G-U.from;while((_=this.regexp.exec(U.text))&&_.index<W-U.from)this.addMatch(_,Z,_.index+U.from,z)}else OZ(Z.state.doc,this.regexp,G,W,(V,O)=>this.addMatch(O,Z,V,z));$=$.update({filterFrom:G,filterTo:W,filter:(V,O)=>V<G||O>W,add:j})}}return $}}var s7=/x/.unicode!=null?"gu":"g",oU=new RegExp(`[\x00-\b
-\x1F-ÂŸÂ­Øœâ€‹â€Žâ€\u2028\u2029â€­â€®â¦â§â©\uFEFFï¿¹-ï¿¼]`,s7),tU={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},L7=null;function eU(){var Z;if(L7==null&&typeof document<"u"&&document.body){let $=document.body.style;L7=((Z=$.tabSize)!==null&&Z!==void 0?Z:$.MozTabSize)!=null}return L7||!1}var x6=S.define({combine(Z){let $=u0(Z,{render:null,specialChars:oU,addSpecialChars:null});if($.replaceTabs=!eU())$.specialChars=new RegExp("\t|"+$.specialChars.source,s7);if($.addSpecialChars)$.specialChars=new RegExp($.specialChars.source+"|"+$.addSpecialChars.source,s7);return $}});function l$(Z={}){return[x6.of(Z),Zq()]}var VZ=null;function Zq(){return VZ||(VZ=_0.fromClass(class{constructor(Z){this.view=Z,this.decorations=g.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(Z.state.facet(x6)),this.decorations=this.decorator.createDeco(Z)}makeDecorator(Z){return new p$({regexp:Z.specialChars,decoration:($,J,Y)=>{let{doc:X}=J.state,Q=S0($[0],0);if(Q==9){let K=X.lineAt(Y),U=J.state.tabSize,q=u1(K.text,U,Y-K.from);return g.replace({widget:new c$((U-q%U)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[Q]||(this.decorationCache[Q]=g.replace({widget:new d$(Z,Q)}))},boundary:Z.replaceTabs?void 0:/[^]/})}update(Z){let $=Z.state.facet(x6);if(Z.startState.facet(x6)!=$)this.decorator=this.makeDecorator($),this.decorations=this.decorator.createDeco(Z.view);else this.decorations=this.decorator.updateDeco(Z,this.decorations)}},{decorations:(Z)=>Z.decorations}))}var $q="â€¢";function Jq(Z){if(Z>=32)return $q;if(Z==10)return"â¤";return String.fromCharCode(9216+Z)}class d$ extends e0{constructor(Z,$){super();this.options=Z,this.code=$}eq(Z){return Z.code==this.code}toDOM(Z){let $=Jq(this.code),J=Z.state.phrase("Control character")+" "+(tU[this.code]||"0x"+this.code.toString(16)),Y=this.options.render&&this.options.render(this.code,J,$);if(Y)return Y;let X=document.createElement("span");return X.textContent=$,X.title=J,X.setAttribute("aria-label",J),X.className="cm-specialChar",X}ignoreEvent(){return!1}}class c$ extends e0{constructor(Z){super();this.width=Z}eq(Z){return Z.width==this.width}toDOM(){let Z=document.createElement("span");return Z.textContent="\t",Z.className="cm-tab",Z.style.width=this.width+"px",Z}ignoreEvent(){return!1}}function s$(){return Xq}var Yq=g.line({class:"cm-activeLine"}),Xq=_0.fromClass(class{constructor(Z){this.decorations=this.getDeco(Z)}update(Z){if(Z.docChanged||Z.selectionSet)this.decorations=this.getDeco(Z.view)}getDeco(Z){let $=-1,J=[];for(let Y of Z.state.selection.ranges){let X=Z.lineBlockAt(Y.head);if(X.from>$)J.push(Yq.range(X.from)),$=X.from}return g.set(J)}},{decorations:(Z)=>Z.decorations});var n7=2000;function Qq(Z,$,J){let Y=Math.min($.line,J.line),X=Math.max($.line,J.line),Q=[];if($.off>n7||J.off>n7||$.col<0||J.col<0){let K=Math.min($.off,J.off),U=Math.max($.off,J.off);for(let q=Y;q<=X;q++){let G=Z.doc.line(q);if(G.length<=U)Q.push(L.range(G.from+K,G.to+U))}}else{let K=Math.min($.col,J.col),U=Math.max($.col,J.col);for(let q=Y;q<=X;q++){let G=Z.doc.line(q),W=R6(G.text,K,Z.tabSize,!0);if(W<0)Q.push(L.cursor(G.to));else{let j=R6(G.text,U,Z.tabSize);Q.push(L.range(G.from+W,G.from+j))}}}return Q}function Kq(Z,$){let J=Z.coordsAtPos(Z.viewport.from);return J?Math.round(Math.abs((J.left-$)/Z.defaultCharacterWidth)):-1}function HZ(Z,$){let J=Z.posAtCoords({x:$.clientX,y:$.clientY},!1),Y=Z.state.doc.lineAt(J),X=J-Y.from,Q=X>n7?-1:X==Y.length?Kq(Z,$.clientX):u1(Y.text,Z.state.tabSize,J-Y.from);return{line:Y.number,col:Q,off:X}}function Uq(Z,$){let J=HZ(Z,$),Y=Z.state.selection;if(!J)return null;return{update(X){if(X.docChanged){let Q=X.changes.mapPos(X.startState.doc.line(J.line).from),K=X.state.doc.lineAt(Q);J={line:K.number,col:J.col,off:Math.min(J.off,K.length)},Y=Y.map(X.changes)}},get(X,Q,K){let U=HZ(Z,X);if(!U)return Y;let q=Qq(Z.state,J,U);if(!q.length)return Y;if(K)return L.create(q.concat(Y.ranges));else return L.create(q)}}}function n$(Z){let $=(Z===null||Z===void 0?void 0:Z.eventFilter)||((J)=>J.altKey&&J.button==0);return P.mouseSelectionStyle.of((J,Y)=>$(Y)?Uq(J,Y):null)}var qq={Alt:[18,(Z)=>!!Z.altKey],Control:[17,(Z)=>!!Z.ctrlKey],Shift:[16,(Z)=>!!Z.shiftKey],Meta:[91,(Z)=>!!Z.metaKey]},Gq={style:"cursor: crosshair"};function i$(Z={}){let[$,J]=qq[Z.key||"Alt"],Y=_0.fromClass(class{constructor(X){this.view=X,this.isDown=!1}set(X){if(this.isDown!=X)this.isDown=X,this.view.update([])}},{eventObservers:{keydown(X){this.set(X.keyCode==$||J(X))},keyup(X){if(X.keyCode==$||!J(X))this.set(!1)},mousemove(X){this.set(J(X))}}});return[Y,P.contentAttributes.of((X)=>{var Q;return((Q=X.plugin(Y))===null||Q===void 0?void 0:Q.isDown)?Gq:null})]}var E6="-10000px";class G4{constructor(Z,$,J,Y){this.facet=$,this.createTooltipView=J,this.removeTooltipView=Y,this.input=Z.state.facet($),this.tooltips=this.input.filter((Q)=>Q);let X=null;this.tooltipViews=this.tooltips.map((Q)=>X=J(Q,X))}update(Z,$){var J;let Y=Z.state.facet(this.facet),X=Y.filter((U)=>U);if(Y===this.input){for(let U of this.tooltipViews)if(U.update)U.update(Z);return!1}let Q=[],K=$?[]:null;for(let U=0;U<X.length;U++){let q=X[U],G=-1;if(!q)continue;for(let W=0;W<this.tooltips.length;W++){let j=this.tooltips[W];if(j&&j.create==q.create)G=W}if(G<0){if(Q[U]=this.createTooltipView(q,U?Q[U-1]:null),K)K[U]=!!q.above}else{let W=Q[U]=this.tooltipViews[G];if(K)K[U]=$[G];if(W.update)W.update(Z)}}for(let U of this.tooltipViews)if(Q.indexOf(U)<0)this.removeTooltipView(U),(J=U.destroy)===null||J===void 0||J.call(U);if($)K.forEach((U,q)=>$[q]=U),$.length=K.length;return this.input=Y,this.tooltips=X,this.tooltipViews=Q,!0}}function Wq(Z){let $=Z.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:$.clientHeight,right:$.clientWidth}}var M7=S.define({combine:(Z)=>{var $,J,Y;return{position:h.ios?"absolute":(($=Z.find((X)=>X.position))===null||$===void 0?void 0:$.position)||"fixed",parent:((J=Z.find((X)=>X.parent))===null||J===void 0?void 0:J.parent)||null,tooltipSpace:((Y=Z.find((X)=>X.tooltipSpace))===null||Y===void 0?void 0:Y.tooltipSpace)||Wq}}}),NZ=new WeakMap,W4=_0.fromClass(class{constructor(Z){this.view=Z,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let $=Z.state.facet(M7);this.position=$.position,this.parent=$.parent,this.classes=Z.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new G4(Z,x3,(J,Y)=>this.createTooltip(J,Y),(J)=>{if(this.resizeObserver)this.resizeObserver.unobserve(J.dom);J.dom.remove()}),this.above=this.manager.tooltips.map((J)=>!!J.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver((J)=>{if(Date.now()>this.lastTransaction-50&&J.length>0&&J[J.length-1].intersectionRatio<1)this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),Z.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){if(this.parent)this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container);else this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let Z of this.manager.tooltipViews)this.intersectionObserver.observe(Z.dom)}}measureSoon(){if(this.measureTimeout<0)this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50)}update(Z){if(Z.transactions.length)this.lastTransaction=Date.now();let $=this.manager.update(Z,this.above);if($)this.observeIntersection();let J=$||Z.geometryChanged,Y=Z.state.facet(M7);if(Y.position!=this.position&&!this.madeAbsolute){this.position=Y.position;for(let X of this.manager.tooltipViews)X.dom.style.position=this.position;J=!0}if(Y.parent!=this.parent){if(this.parent)this.container.remove();this.parent=Y.parent,this.createContainer();for(let X of this.manager.tooltipViews)this.container.appendChild(X.dom);J=!0}else if(this.parent&&this.view.themeClasses!=this.classes)this.classes=this.container.className=this.view.themeClasses;if(J)this.maybeMeasure()}createTooltip(Z,$){let J=Z.create(this.view),Y=$?$.dom:null;if(J.dom.classList.add("cm-tooltip"),Z.arrow&&!J.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let X=document.createElement("div");X.className="cm-tooltip-arrow",J.dom.appendChild(X)}if(J.dom.style.position=this.position,J.dom.style.top=E6,J.dom.style.left="0px",this.container.insertBefore(J.dom,Y),J.mount)J.mount(this.view);if(this.resizeObserver)this.resizeObserver.observe(J.dom);return J}destroy(){var Z,$,J;this.view.win.removeEventListener("resize",this.measureSoon);for(let Y of this.manager.tooltipViews)Y.dom.remove(),(Z=Y.destroy)===null||Z===void 0||Z.call(Y);if(this.parent)this.container.remove();($=this.resizeObserver)===null||$===void 0||$.disconnect(),(J=this.intersectionObserver)===null||J===void 0||J.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let Z=1,$=1,J=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:Q}=this.manager.tooltipViews[0];if(h.safari){let K=Q.getBoundingClientRect();J=Math.abs(K.top+1e4)>1||Math.abs(K.left)>1}else J=!!Q.offsetParent&&Q.offsetParent!=this.container.ownerDocument.body}if(J||this.position=="absolute")if(this.parent){let Q=this.parent.getBoundingClientRect();if(Q.width&&Q.height)Z=Q.width/this.parent.offsetWidth,$=Q.height/this.parent.offsetHeight}else({scaleX:Z,scaleY:$}=this.view.viewState);let Y=this.view.scrollDOM.getBoundingClientRect(),X=X4(this.view);return{visible:{left:Y.left+X.left,top:Y.top+X.top,right:Y.right-X.right,bottom:Y.bottom-X.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((Q,K)=>{let U=this.manager.tooltipViews[K];return U.getCoords?U.getCoords(Q.pos):this.view.coordsAtPos(Q.pos)}),size:this.manager.tooltipViews.map(({dom:Q})=>Q.getBoundingClientRect()),space:this.view.state.facet(M7).tooltipSpace(this.view),scaleX:Z,scaleY:$,makeAbsolute:J}}writeMeasure(Z){var $;if(Z.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let U of this.manager.tooltipViews)U.dom.style.position="absolute"}let{visible:J,space:Y,scaleX:X,scaleY:Q}=Z,K=[];for(let U=0;U<this.manager.tooltips.length;U++){let q=this.manager.tooltips[U],G=this.manager.tooltipViews[U],{dom:W}=G,j=Z.pos[U],_=Z.size[U];if(!j||q.clip!==!1&&(j.bottom<=Math.max(J.top,Y.top)||j.top>=Math.min(J.bottom,Y.bottom)||j.right<Math.max(J.left,Y.left)-0.1||j.left>Math.min(J.right,Y.right)+0.1)){W.style.top=E6;continue}let z=q.arrow?G.dom.querySelector(".cm-tooltip-arrow"):null,V=z?7:0,O=_.right-_.left,H=($=NZ.get(G))!==null&&$!==void 0?$:_.bottom-_.top,F=G.offset||_q,D=this.view.textDirection==Q0.LTR,M=_.width>Y.right-Y.left?D?Y.left:Y.right-_.width:D?Math.max(Y.left,Math.min(j.left-(z?14:0)+F.x,Y.right-O)):Math.min(Math.max(Y.left,j.left-O+(z?14:0)-F.x),Y.right-O),A=this.above[U];if(!q.strictSide&&(A?j.top-H-V-F.y<Y.top:j.bottom+H+V+F.y>Y.bottom)&&A==Y.bottom-j.bottom>j.top-Y.top)A=this.above[U]=!A;let B=(A?j.top-Y.top:Y.bottom-j.bottom)-V;if(B<H&&G.resize!==!1){if(B<this.view.defaultLineHeight){W.style.top=E6;continue}NZ.set(G,H),W.style.height=(H=B)/Q+"px"}else if(W.style.height)W.style.height="";let w=A?j.top-H-V-F.y:j.bottom+V+F.y,x=M+O;if(G.overlap!==!0){for(let c of K)if(c.left<x&&c.right>M&&c.top<w+H&&c.bottom>w)w=A?c.top-H-2-V:c.bottom+V+2}if(this.position=="absolute")W.style.top=(w-Z.parent.top)/Q+"px",RZ(W,(M-Z.parent.left)/X);else W.style.top=w/Q+"px",RZ(W,M/X);if(z){let c=j.left+(D?F.x:-F.x)-(M+14-7);z.style.left=c/X+"px"}if(G.overlap!==!0)K.push({left:M,top:w,right:x,bottom:w+H});if(W.classList.toggle("cm-tooltip-above",A),W.classList.toggle("cm-tooltip-below",!A),G.positioned)G.positioned(Z.space)}}maybeMeasure(){if(this.manager.tooltips.length){if(this.view.inView)this.view.requestMeasure(this.measureReq);if(this.inView!=this.view.inView){if(this.inView=this.view.inView,!this.inView)for(let Z of this.manager.tooltipViews)Z.dom.style.top=E6}}}},{eventObservers:{scroll(){this.maybeMeasure()}}});function RZ(Z,$){let J=parseInt(Z.style.left,10);if(isNaN(J)||Math.abs($-J)>1)Z.style.left=$+"px"}var jq=P.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),_q={x:0,y:0},x3=S.define({enables:[W4,jq]}),c6=S.define({combine:(Z)=>Z.reduce(($,J)=>$.concat(J),[])});class r6{static create(Z){return new r6(Z)}constructor(Z){this.view=Z,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new G4(Z,c6,($,J)=>this.createHostedView($,J),($)=>$.dom.remove())}createHostedView(Z,$){let J=Z.create(this.view);if(J.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(J.dom,$?$.dom.nextSibling:this.dom.firstChild),this.mounted&&J.mount)J.mount(this.view);return J}mount(Z){for(let $ of this.manager.tooltipViews)if($.mount)$.mount(Z);this.mounted=!0}positioned(Z){for(let $ of this.manager.tooltipViews)if($.positioned)$.positioned(Z)}update(Z){this.manager.update(Z)}destroy(){var Z;for(let $ of this.manager.tooltipViews)(Z=$.destroy)===null||Z===void 0||Z.call($)}passProp(Z){let $=void 0;for(let J of this.manager.tooltipViews){let Y=J[Z];if(Y!==void 0){if($===void 0)$=Y;else if($!==Y)return}}return $}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}var zq=x3.compute([c6],(Z)=>{let $=Z.facet(c6);if($.length===0)return null;return{pos:Math.min(...$.map((J)=>J.pos)),end:Math.max(...$.map((J)=>{var Y;return(Y=J.end)!==null&&Y!==void 0?Y:J.pos})),create:r6.create,above:$[0].above,arrow:$.some((J)=>J.arrow)}});class r${constructor(Z,$,J,Y,X){this.view=Z,this.source=$,this.field=J,this.setHover=Y,this.hoverTime=X,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:Z.dom,time:0},this.checkHover=this.checkHover.bind(this),Z.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),Z.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){if(this.pending)this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20)}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let Z=Date.now()-this.lastMove.time;if(Z<this.hoverTime)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-Z);else this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:Z,lastMove:$}=this,J=Z.docView.tile.nearest($.target);if(!J)return;let Y,X=1;if(J.isWidget())Y=J.posAtStart;else{if(Y=Z.posAtCoords($),Y==null)return;let K=Z.coordsAtPos(Y);if(!K||$.y<K.top||$.y>K.bottom||$.x<K.left-Z.defaultCharacterWidth||$.x>K.right+Z.defaultCharacterWidth)return;let U=Z.bidiSpans(Z.state.doc.lineAt(Y)).find((G)=>G.from<=Y&&G.to>=Y),q=U&&U.dir==Q0.RTL?-1:1;X=$.x<K.left?-q:q}let Q=this.source(Z,Y,X);if(Q===null||Q===void 0?void 0:Q.then){let K=this.pending={pos:Y};Q.then((U)=>{if(this.pending==K){if(this.pending=null,U&&!(Array.isArray(U)&&!U.length))Z.dispatch({effects:this.setHover.of(Array.isArray(U)?U:[U])})}},(U)=>h0(Z.state,U,"hover tooltip"))}else if(Q&&!(Array.isArray(Q)&&!Q.length))Z.dispatch({effects:this.setHover.of(Array.isArray(Q)?Q:[Q])})}get tooltip(){let Z=this.view.plugin(W4),$=Z?Z.manager.tooltips.findIndex((J)=>J.create==r6.create):-1;return $>-1?Z.manager.tooltipViews[$]:null}mousemove(Z){var $,J;if(this.lastMove={x:Z.clientX,y:Z.clientY,target:Z.target,time:Date.now()},this.hoverTimeout<0)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime);let{active:Y,tooltip:X}=this;if(Y.length&&X&&!Oq(X.dom,Z)||this.pending){let{pos:Q}=Y[0]||this.pending,K=(J=($=Y[0])===null||$===void 0?void 0:$.end)!==null&&J!==void 0?J:Q;if(Q==K?this.view.posAtCoords(this.lastMove)!=Q:!Vq(this.view,Q,K,Z.clientX,Z.clientY))this.view.dispatch({effects:this.setHover.of([])}),this.pending=null}}mouseleave(Z){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:$}=this;if($.length){let{tooltip:J}=this;if(!(J&&J.dom.contains(Z.relatedTarget)))this.view.dispatch({effects:this.setHover.of([])});else this.watchTooltipLeave(J.dom)}}watchTooltipLeave(Z){let $=(J)=>{if(Z.removeEventListener("mouseleave",$),this.active.length&&!this.view.dom.contains(J.relatedTarget))this.view.dispatch({effects:this.setHover.of([])})};Z.addEventListener("mouseleave",$)}destroy(){clearTimeout(this.hoverTimeout),clearTimeout(this.restartTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}var P6=4;function Oq(Z,$){let{left:J,right:Y,top:X,bottom:Q}=Z.getBoundingClientRect(),K;if(K=Z.querySelector(".cm-tooltip-arrow")){let U=K.getBoundingClientRect();X=Math.min(U.top,X),Q=Math.max(U.bottom,Q)}return $.clientX>=J-P6&&$.clientX<=Y+P6&&$.clientY>=X-P6&&$.clientY<=Q+P6}function Vq(Z,$,J,Y,X,Q){let K=Z.scrollDOM.getBoundingClientRect(),U=Z.documentTop+Z.documentPadding.top+Z.contentHeight;if(K.left>Y||K.right<Y||K.top>X||Math.min(K.bottom,U)<X)return!1;let q=Z.posAtCoords({x:Y,y:X},!1);return q>=$&&q<=J}function a$(Z,$={}){let J=l.define(),Y=z0.define({create(){return[]},update(X,Q){if(X.length){if($.hideOnChange&&(Q.docChanged||Q.selection))X=[];else if($.hideOn)X=X.filter((K)=>!$.hideOn(Q,K));if(Q.docChanged){let K=[];for(let U of X){let q=Q.changes.mapPos(U.pos,-1,k0.TrackDel);if(q!=null){let G=Object.assign(Object.create(null),U);if(G.pos=q,G.end!=null)G.end=Q.changes.mapPos(G.end);K.push(G)}}X=K}}for(let K of Q.effects){if(K.is(J))X=K.value;if(K.is(Hq))X=[]}return X},provide:(X)=>c6.from(X)});return{active:Y,extension:[Y,_0.define((X)=>new r$(X,Z,Y,J,$.hoverTime||300)),zq]}}function j4(Z,$){let J=Z.plugin(W4);if(!J)return null;let Y=J.manager.tooltips.indexOf($);return Y<0?null:J.manager.tooltipViews[Y]}var Hq=l.define();var FZ=S.define({combine(Z){let $,J;for(let Y of Z)$=$||Y.topContainer,J=J||Y.bottomContainer;return{topContainer:$,bottomContainer:J}}});function h3(Z,$){let J=Z.plugin(o$),Y=J?J.specs.indexOf($):-1;return Y>-1?J.panels[Y]:null}var o$=_0.fromClass(class{constructor(Z){this.input=Z.state.facet(H2),this.specs=this.input.filter((J)=>J),this.panels=this.specs.map((J)=>J(Z));let $=Z.state.facet(FZ);this.top=new F3(Z,!0,$.topContainer),this.bottom=new F3(Z,!1,$.bottomContainer),this.top.sync(this.panels.filter((J)=>J.top)),this.bottom.sync(this.panels.filter((J)=>!J.top));for(let J of this.panels)if(J.dom.classList.add("cm-panel"),J.mount)J.mount()}update(Z){let $=Z.state.facet(FZ);if(this.top.container!=$.topContainer)this.top.sync([]),this.top=new F3(Z.view,!0,$.topContainer);if(this.bottom.container!=$.bottomContainer)this.bottom.sync([]),this.bottom=new F3(Z.view,!1,$.bottomContainer);this.top.syncClasses(),this.bottom.syncClasses();let J=Z.state.facet(H2);if(J!=this.input){let Y=J.filter((q)=>q),X=[],Q=[],K=[],U=[];for(let q of Y){let G=this.specs.indexOf(q),W;if(G<0)W=q(Z.view),U.push(W);else if(W=this.panels[G],W.update)W.update(Z);X.push(W),(W.top?Q:K).push(W)}this.specs=Y,this.panels=X,this.top.sync(Q),this.bottom.sync(K);for(let q of U)if(q.dom.classList.add("cm-panel"),q.mount)q.mount()}else for(let Y of this.panels)if(Y.update)Y.update(Z)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:(Z)=>P.scrollMargins.of(($)=>{let J=$.plugin(Z);return J&&{top:J.top.scrollMargin(),bottom:J.bottom.scrollMargin()}})});class F3{constructor(Z,$,J){this.view=Z,this.top=$,this.container=J,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(Z){for(let $ of this.panels)if($.destroy&&Z.indexOf($)<0)$.destroy();this.panels=Z,this.syncDOM()}syncDOM(){if(this.panels.length==0){if(this.dom)this.dom.remove(),this.dom=void 0;return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let $=this.container||this.view.dom;$.insertBefore(this.dom,this.top?$.firstChild:null)}let Z=this.dom.firstChild;for(let $ of this.panels)if($.dom.parentNode==this.dom){while(Z!=$.dom)Z=IZ(Z);Z=Z.nextSibling}else this.dom.insertBefore($.dom,Z);while(Z)Z=IZ(Z)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!this.container||this.classes==this.view.themeClasses)return;for(let Z of this.classes.split(" "))if(Z)this.container.classList.remove(Z);for(let Z of(this.classes=this.view.themeClasses).split(" "))if(Z)this.container.classList.add(Z)}}function IZ(Z){let $=Z.nextSibling;return Z.remove(),$}var H2=S.define({enables:o$});function t$(Z,$){let J,Y=new Promise((K)=>J=K),X=(K)=>Nq(K,$,J);if(Z.state.field(A7,!1))Z.dispatch({effects:e$.of(X)});else Z.dispatch({effects:l.appendConfig.of(A7.init(()=>[X]))});let Q=ZJ.of(X);return{close:Q,result:Y.then((K)=>{return(Z.win.queueMicrotask||((q)=>Z.win.setTimeout(q,10)))(()=>{if(Z.state.field(A7).indexOf(X)>-1)Z.dispatch({effects:Q})}),K})}}var A7=z0.define({create(){return[]},update(Z,$){for(let J of $.effects)if(J.is(e$))Z=[J.value].concat(Z);else if(J.is(ZJ))Z=Z.filter((Y)=>Y!=J.value);return Z},provide:(Z)=>H2.computeN([Z],($)=>$.field(Z))}),e$=l.define(),ZJ=l.define();function Nq(Z,$,J){let Y=$.content?$.content(Z,()=>K(null)):null;if(!Y){if(Y=J0("form"),$.input){let U=J0("input",$.input);if(/^(text|password|number|email|tel|url)$/.test(U.type))U.classList.add("cm-textfield");if(!U.name)U.name="input";Y.appendChild(J0("label",($.label||"")+": ",U))}else Y.appendChild(document.createTextNode($.label||""));Y.appendChild(document.createTextNode(" ")),Y.appendChild(J0("button",{class:"cm-button",type:"submit"},$.submitLabel||"OK"))}let X=Y.nodeName=="FORM"?[Y]:Y.querySelectorAll("form");for(let U=0;U<X.length;U++){let q=X[U];q.addEventListener("keydown",(G)=>{if(G.keyCode==27)G.preventDefault(),K(null);else if(G.keyCode==13)G.preventDefault(),K(q)}),q.addEventListener("submit",(G)=>{G.preventDefault(),K(q)})}let Q=J0("div",Y,J0("button",{onclick:()=>K(null),"aria-label":Z.state.phrase("close"),class:"cm-dialog-close",type:"button"},["Ã—"]));if($.class)Q.className=$.class;Q.classList.add("cm-dialog");function K(U){if(Q.contains(Q.ownerDocument.activeElement))Z.focus();J(U)}return{dom:Q,top:$.top,mount:()=>{if($.focus){let U;if(typeof $.focus=="string")U=Y.querySelector($.focus);else U=Y.querySelector("input")||Y.querySelector("button");if(U&&"select"in U)U.select();else if(U&&"focus"in U)U.focus()}}}}class K1 extends N1{compare(Z){return this==Z||this.constructor==Z.constructor&&this.eq(Z)}eq(Z){return!1}destroy(Z){}}K1.prototype.elementClass="";K1.prototype.toDOM=void 0;K1.prototype.mapMode=k0.TrackBefore;K1.prototype.startSide=K1.prototype.endSide=-1;K1.prototype.point=!0;var h6=S.define(),Rq=S.define(),Fq={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>r.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},M3=S.define();function _4(Z){return[$J(),M3.of({...Fq,...Z})]}var i7=S.define({combine:(Z)=>Z.some(($)=>$)});function $J(Z){let $=[Iq];if(Z&&Z.fixed===!1)$.push(i7.of(!0));return $}var Iq=_0.fromClass(class{constructor(Z){this.view=Z,this.domAfter=null,this.prevViewport=Z.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=Z.state.facet(M3).map(($)=>new a7(Z,$)),this.fixed=!Z.state.facet(i7);for(let $ of this.gutters)if($.config.side=="after")this.getDOMAfter().appendChild($.dom);else this.dom.appendChild($.dom);if(this.fixed)this.dom.style.position="sticky";this.syncGutters(!1),Z.scrollDOM.insertBefore(this.dom,Z.contentDOM)}getDOMAfter(){if(!this.domAfter)this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter);return this.domAfter}update(Z){if(this.updateGutters(Z)){let $=this.prevViewport,J=Z.view.viewport,Y=Math.min($.to,J.to)-Math.max($.from,J.from);this.syncGutters(Y<(J.to-J.from)*0.8)}if(Z.geometryChanged){let $=this.view.contentHeight/this.view.scaleY+"px";if(this.dom.style.minHeight=$,this.domAfter)this.domAfter.style.minHeight=$}if(this.view.state.facet(i7)!=!this.fixed){if(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter)this.domAfter.style.position=this.fixed?"sticky":""}this.prevViewport=Z.view.viewport}syncGutters(Z){let $=this.dom.nextSibling;if(Z){if(this.dom.remove(),this.domAfter)this.domAfter.remove()}let J=r.iter(this.view.state.facet(h6),this.view.viewport.from),Y=[],X=this.gutters.map((Q)=>new JJ(Q,this.view.viewport,-this.view.documentPadding.top));for(let Q of this.view.viewportLineBlocks){if(Y.length)Y=[];if(Array.isArray(Q.type)){let K=!0;for(let U of Q.type)if(U.type==w0.Text&&K){r7(J,Y,U.from);for(let q of X)q.line(this.view,U,Y);K=!1}else if(U.widget)for(let q of X)q.widget(this.view,U)}else if(Q.type==w0.Text){r7(J,Y,Q.from);for(let K of X)K.line(this.view,Q,Y)}else if(Q.widget)for(let K of X)K.widget(this.view,Q)}for(let Q of X)Q.finish();if(Z){if(this.view.scrollDOM.insertBefore(this.dom,$),this.domAfter)this.view.scrollDOM.appendChild(this.domAfter)}}updateGutters(Z){let $=Z.startState.facet(M3),J=Z.state.facet(M3),Y=Z.docChanged||Z.heightChanged||Z.viewportChanged||!r.eq(Z.startState.facet(h6),Z.state.facet(h6),Z.view.viewport.from,Z.view.viewport.to);if($==J){for(let X of this.gutters)if(X.update(Z))Y=!0}else{Y=!0;let X=[];for(let Q of J){let K=$.indexOf(Q);if(K<0)X.push(new a7(this.view,Q));else this.gutters[K].update(Z),X.push(this.gutters[K])}for(let Q of this.gutters)if(Q.dom.remove(),X.indexOf(Q)<0)Q.destroy();for(let Q of X)if(Q.config.side=="after")this.getDOMAfter().appendChild(Q.dom);else this.dom.appendChild(Q.dom);this.gutters=X}return Y}destroy(){for(let Z of this.gutters)Z.destroy();if(this.dom.remove(),this.domAfter)this.domAfter.remove()}},{provide:(Z)=>P.scrollMargins.of(($)=>{let J=$.plugin(Z);if(!J||J.gutters.length==0||!J.fixed)return null;let Y=J.dom.offsetWidth*$.scaleX,X=J.domAfter?J.domAfter.offsetWidth*$.scaleX:0;return $.textDirection==Q0.LTR?{left:Y,right:X}:{right:Y,left:X}})});function DZ(Z){return Array.isArray(Z)?Z:[Z]}function r7(Z,$,J){while(Z.value&&Z.from<=J){if(Z.from==J)$.push(Z.value);Z.next()}}class JJ{constructor(Z,$,J){this.gutter=Z,this.height=J,this.i=0,this.cursor=r.iter(Z.markers,$.from)}addElement(Z,$,J){let{gutter:Y}=this,X=($.top-this.height)/Z.scaleY,Q=$.height/Z.scaleY;if(this.i==Y.elements.length){let K=new z4(Z,Q,X,J);Y.elements.push(K),Y.dom.appendChild(K.dom)}else Y.elements[this.i].update(Z,Q,X,J);this.height=$.bottom,this.i++}line(Z,$,J){let Y=[];if(r7(this.cursor,Y,$.from),J.length)Y=Y.concat(J);let X=this.gutter.config.lineMarker(Z,$,Y);if(X)Y.unshift(X);let Q=this.gutter;if(Y.length==0&&!Q.config.renderEmptyElements)return;this.addElement(Z,$,Y)}widget(Z,$){let J=this.gutter.config.widgetMarker(Z,$.widget,$),Y=J?[J]:null;for(let X of Z.state.facet(Rq)){let Q=X(Z,$.widget,$);if(Q)(Y||(Y=[])).push(Q)}if(Y)this.addElement(Z,$,Y)}finish(){let Z=this.gutter;while(Z.elements.length>this.i){let $=Z.elements.pop();Z.dom.removeChild($.dom),$.destroy()}}}class a7{constructor(Z,$){this.view=Z,this.config=$,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let J in $.domEventHandlers)this.dom.addEventListener(J,(Y)=>{let X=Y.target,Q;if(X!=this.dom&&this.dom.contains(X)){while(X.parentNode!=this.dom)X=X.parentNode;let U=X.getBoundingClientRect();Q=(U.top+U.bottom)/2}else Q=Y.clientY;let K=Z.lineBlockAtHeight(Q-Z.documentTop);if($.domEventHandlers[J](Z,K,Y))Y.preventDefault()});if(this.markers=DZ($.markers(Z)),$.initialSpacer)this.spacer=new z4(Z,0,0,[$.initialSpacer(Z)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none"}update(Z){let $=this.markers;if(this.markers=DZ(this.config.markers(Z.view)),this.spacer&&this.config.updateSpacer){let Y=this.config.updateSpacer(this.spacer.markers[0],Z);if(Y!=this.spacer.markers[0])this.spacer.update(Z.view,0,0,[Y])}let J=Z.view.viewport;return!r.eq(this.markers,$,J.from,J.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(Z):!1)}destroy(){for(let Z of this.elements)Z.destroy()}}class z4{constructor(Z,$,J,Y){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(Z,$,J,Y)}update(Z,$,J,Y){if(this.height!=$)this.height=$,this.dom.style.height=$+"px";if(this.above!=J)this.dom.style.marginTop=(this.above=J)?J+"px":"";if(!Dq(this.markers,Y))this.setMarkers(Z,Y)}setMarkers(Z,$){let J="cm-gutterElement",Y=this.dom.firstChild;for(let X=0,Q=0;;){let K=Q,U=X<$.length?$[X++]:null,q=!1;if(U){let G=U.elementClass;if(G)J+=" "+G;for(let W=Q;W<this.markers.length;W++)if(this.markers[W].compare(U)){K=W,q=!0;break}}else K=this.markers.length;while(Q<K){let G=this.markers[Q++];if(G.toDOM){G.destroy(Y);let W=Y.nextSibling;Y.remove(),Y=W}}if(!U)break;if(U.toDOM)if(q)Y=Y.nextSibling;else this.dom.insertBefore(U.toDOM(Z),Y);if(q)Q++}this.dom.className=J,this.markers=$}destroy(){this.setMarkers(null,[])}}function Dq(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++)if(!Z[J].compare($[J]))return!1;return!0}var Lq=S.define(),Mq=S.define(),h2=S.define({combine(Z){return u0(Z,{formatNumber:String,domEventHandlers:{}},{domEventHandlers($,J){let Y=Object.assign({},$);for(let X in J){let Q=Y[X],K=J[X];Y[X]=Q?(U,q,G)=>Q(U,q,G)||K(U,q,G):K}return Y}})}});class w6 extends K1{constructor(Z){super();this.number=Z}eq(Z){return this.number==Z.number}toDOM(){return document.createTextNode(this.number)}}function B7(Z,$){return Z.state.facet(h2).formatNumber($,Z.state)}var Aq=M3.compute([h2],(Z)=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers($){return $.state.facet(Lq)},lineMarker($,J,Y){if(Y.some((X)=>X.toDOM))return null;return new w6(B7($,$.state.doc.lineAt(J.from).number))},widgetMarker:($,J,Y)=>{for(let X of $.state.facet(Mq)){let Q=X($,J,Y);if(Q)return Q}return null},lineMarkerChange:($)=>$.startState.facet(h2)!=$.state.facet(h2),initialSpacer($){return new w6(B7($,LZ($.state.doc.lines)))},updateSpacer($,J){let Y=B7(J.view,LZ(J.view.state.doc.lines));return Y==$.number?$:new w6(Y)},domEventHandlers:Z.facet(h2).domEventHandlers,side:"before"}));function YJ(Z={}){return[h2.of(Z),$J(),Aq]}function LZ(Z){let $=9;while($<Z)$=$*10+9;return $}var Bq=new class extends K1{constructor(){super(...arguments);this.elementClass="cm-activeLineGutter"}},Eq=h6.compute(["selection"],(Z)=>{let $=[],J=-1;for(let Y of Z.selection.ranges){let X=Z.doc.lineAt(Y.head).from;if(X>J)J=X,$.push(Bq.range(X))}return r.of($)});function XJ(){return Eq}var Pq=0;class o6{constructor(Z,$){this.from=Z,this.to=$}}class o{constructor(Z={}){this.id=Pq++,this.perNode=!!Z.perNode,this.deserialize=Z.deserialize||(()=>{throw Error("This node type doesn't define a deserialize function")}),this.combine=Z.combine||null}add(Z){if(this.perNode)throw RangeError("Can't add per-node props to node types");if(typeof Z!="function")Z=p0.match(Z);return($)=>{let J=Z($);return J===void 0?null:[this,J]}}}o.closedBy=new o({deserialize:(Z)=>Z.split(" ")});o.openedBy=new o({deserialize:(Z)=>Z.split(" ")});o.group=new o({deserialize:(Z)=>Z.split(" ")});o.isolate=new o({deserialize:(Z)=>{if(Z&&Z!="rtl"&&Z!="ltr"&&Z!="auto")throw RangeError("Invalid value for isolate: "+Z);return Z||"auto"}});o.contextHash=new o({perNode:!0});o.lookAhead=new o({perNode:!0});o.mounted=new o({perNode:!0});class p2{constructor(Z,$,J,Y=!1){this.tree=Z,this.overlay=$,this.parser=J,this.bracketed=Y}static get(Z){return Z&&Z.props&&Z.props[o.mounted.id]}}var Cq=Object.create(null);class p0{constructor(Z,$,J,Y=0){this.name=Z,this.props=$,this.id=J,this.flags=Y}static define(Z){let $=Z.props&&Z.props.length?Object.create(null):Cq,J=(Z.top?1:0)|(Z.skipped?2:0)|(Z.error?4:0)|(Z.name==null?8:0),Y=new p0(Z.name||"",$,Z.id,J);if(Z.props)for(let X of Z.props){if(!Array.isArray(X))X=X(Y);if(X){if(X[0].perNode)throw RangeError("Can't store a per-node prop on a node type");$[X[0].id]=X[1]}}return Y}prop(Z){return this.props[Z.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(Z){if(typeof Z=="string"){if(this.name==Z)return!0;let $=this.prop(o.group);return $?$.indexOf(Z)>-1:!1}return this.id==Z}static match(Z){let $=Object.create(null);for(let J in Z)for(let Y of J.split(" "))$[Y]=Z[J];return(J)=>{for(let Y=J.prop(o.group),X=-1;X<(Y?Y.length:0);X++){let Q=$[X<0?J.name:Y[X]];if(Q)return Q}}}}p0.none=new p0("",Object.create(null),0,8);class Z9{constructor(Z){this.types=Z;for(let $=0;$<Z.length;$++)if(Z[$].id!=$)throw RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...Z){let $=[];for(let J of this.types){let Y=null;for(let X of Z){let Q=X(J);if(Q){if(!Y)Y=Object.assign({},J.props);let K=Q[1],U=Q[0];if(U.combine&&U.id in Y)K=U.combine(Y[U.id],K);Y[U.id]=K}}$.push(Y?new p0(J.name,Y,J.id,J.flags):J)}return new Z9($)}}var a6=new WeakMap,QJ=new WeakMap,F0;(function(Z){Z[Z.ExcludeBuffers=1]="ExcludeBuffers",Z[Z.IncludeAnonymous=2]="IncludeAnonymous",Z[Z.IgnoreMounts=4]="IgnoreMounts",Z[Z.IgnoreOverlays=8]="IgnoreOverlays",Z[Z.EnterBracketed=16]="EnterBracketed"})(F0||(F0={}));class j0{constructor(Z,$,J,Y,X){if(this.type=Z,this.children=$,this.positions=J,this.length=Y,this.props=null,X&&X.length){this.props=Object.create(null);for(let[Q,K]of X)this.props[typeof Q=="number"?Q:Q.id]=K}}toString(){let Z=p2.get(this);if(Z&&!Z.overlay)return Z.tree.toString();let $="";for(let J of this.children){let Y=J.toString();if(Y){if($)$+=",";$+=Y}}return!this.type.name?$:(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+($.length?"("+$+")":"")}cursor(Z=0){return new e6(this.topNode,Z)}cursorAt(Z,$=0,J=0){let Y=a6.get(this)||this.topNode,X=new e6(Y);return X.moveTo(Z,$),a6.set(this,X._tree),X}get topNode(){return new U1(this,0,0,null)}resolve(Z,$=0){let J=w3(a6.get(this)||this.topNode,Z,$,!1);return a6.set(this,J),J}resolveInner(Z,$=0){let J=w3(QJ.get(this)||this.topNode,Z,$,!0);return QJ.set(this,J),J}resolveStack(Z,$=0){return Tq(this,Z,$)}iterate(Z){let{enter:$,leave:J,from:Y=0,to:X=this.length}=Z,Q=Z.mode||0,K=(Q&F0.IncludeAnonymous)>0;for(let U=this.cursor(Q|F0.IncludeAnonymous);;){let q=!1;if(U.from<=X&&U.to>=Y&&(!K&&U.type.isAnonymous||$(U)!==!1)){if(U.firstChild())continue;q=!0}for(;;){if(q&&J&&(K||!U.type.isAnonymous))J(U);if(U.nextSibling())break;if(!U.parent())return;q=!0}}}prop(Z){return!Z.perNode?this.type.prop(Z):this.props?this.props[Z.id]:void 0}get propValues(){let Z=[];if(this.props)for(let $ in this.props)Z.push([+$,this.props[$]]);return Z}balance(Z={}){return this.children.length<=8?this:R4(p0.none,this.children,this.positions,0,this.children.length,0,this.length,($,J,Y)=>new j0(this.type,$,J,Y,this.propValues),Z.makeTree||(($,J,Y)=>new j0(p0.none,$,J,Y)))}static build(Z){return yq(Z)}}j0.empty=new j0(p0.none,[],[],0);class V4{constructor(Z,$){this.buffer=Z,this.index=$}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new V4(this.buffer,this.index)}}class r1{constructor(Z,$,J){this.buffer=Z,this.length=$,this.set=J}get type(){return p0.none}toString(){let Z=[];for(let $=0;$<this.buffer.length;)Z.push(this.childString($)),$=this.buffer[$+3];return Z.join(",")}childString(Z){let $=this.buffer[Z],J=this.buffer[Z+3],Y=this.set.types[$],X=Y.name;if(/\W/.test(X)&&!Y.isError)X=JSON.stringify(X);if(Z+=4,J==Z)return X;let Q=[];while(Z<J)Q.push(this.childString(Z)),Z=this.buffer[Z+3];return X+"("+Q.join(",")+")"}findChild(Z,$,J,Y,X){let{buffer:Q}=this,K=-1;for(let U=Z;U!=$;U=Q[U+3])if(qJ(X,Y,Q[U+1],Q[U+2])){if(K=U,J>0)break}return K}slice(Z,$,J){let Y=this.buffer,X=new Uint16Array($-Z),Q=0;for(let K=Z,U=0;K<$;){X[U++]=Y[K++],X[U++]=Y[K++]-J;let q=X[U++]=Y[K++]-J;X[U++]=Y[K++]-Z,Q=Math.max(Q,q)}return new r1(X,Q,this.set)}}function qJ(Z,$,J,Y){switch(Z){case-2:return J<$;case-1:return Y>=$&&J<$;case 0:return J<$&&Y>$;case 1:return J<=$&&Y>$;case 2:return Y>$;case 4:return!0}}function w3(Z,$,J,Y){var X;while(Z.from==Z.to||(J<1?Z.from>=$:Z.from>$)||(J>-1?Z.to<=$:Z.to<$)){let K=!Y&&Z instanceof U1&&Z.index<0?null:Z.parent;if(!K)return Z;Z=K}let Q=Y?0:F0.IgnoreOverlays;if(Y){for(let K=Z,U=K.parent;U;K=U,U=K.parent)if(K instanceof U1&&K.index<0&&((X=U.enter($,J,Q))===null||X===void 0?void 0:X.from)!=K.from)Z=U}for(;;){let K=Z.enter($,J,Q);if(!K)return Z;Z=K}}class H4{cursor(Z=0){return new e6(this,Z)}getChild(Z,$=null,J=null){let Y=KJ(this,Z,$,J);return Y.length?Y[0]:null}getChildren(Z,$=null,J=null){return KJ(this,Z,$,J)}resolve(Z,$=0){return w3(this,Z,$,!1)}resolveInner(Z,$=0){return w3(this,Z,$,!0)}matchContext(Z){return O4(this.parent,Z)}enterUnfinishedNodesBefore(Z){let $=this.childBefore(Z),J=this;while($){let Y=$.lastChild;if(!Y||Y.to!=$.to)break;if(Y.type.isError&&Y.from==Y.to)J=$,$=Y.prevSibling;else $=Y}return J}get node(){return this}get next(){return this.parent}}class U1 extends H4{constructor(Z,$,J,Y){super();this._tree=Z,this.from=$,this.index=J,this._parent=Y}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(Z,$,J,Y,X=0){var Q;for(let K=this;;){for(let{children:U,positions:q}=K._tree,G=$>0?U.length:-1;Z!=G;Z+=$){let W=U[Z],j=q[Z]+K.from;if(!(X&F0.EnterBracketed&&W instanceof j0&&((Q=p2.get(W))===null||Q===void 0?void 0:Q.overlay)===null&&(j>=J||j+W.length<=J))&&!qJ(Y,J,j,j+W.length))continue;if(W instanceof r1){if(X&F0.ExcludeBuffers)continue;let _=W.findChild(0,W.buffer.length,$,J-j,Y);if(_>-1)return new i1(new GJ(K,W,Z,j),null,_)}else if(X&F0.IncludeAnonymous||(!W.type.isAnonymous||N4(W))){let _;if(!(X&F0.IgnoreMounts)&&(_=p2.get(W))&&!_.overlay)return new U1(_.tree,j,Z,K);let z=new U1(W,j,Z,K);return X&F0.IncludeAnonymous||!z.type.isAnonymous?z:z.nextChild($<0?W.children.length-1:0,$,J,Y,X)}}if(X&F0.IncludeAnonymous||!K.type.isAnonymous)return null;if(K.index>=0)Z=K.index+$;else Z=$<0?-1:K._parent._tree.children.length;if(K=K._parent,!K)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(Z){return this.nextChild(0,1,Z,2)}childBefore(Z){return this.nextChild(this._tree.children.length-1,-1,Z,-2)}prop(Z){return this._tree.prop(Z)}enter(Z,$,J=0){let Y;if(!(J&F0.IgnoreOverlays)&&(Y=p2.get(this._tree))&&Y.overlay){let X=Z-this.from,Q=J&F0.EnterBracketed&&Y.bracketed;for(let{from:K,to:U}of Y.overlay)if(($>0||Q?K<=X:K<X)&&($<0||Q?U>=X:U>X))return new U1(Y.tree,Y.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,Z,$,J)}nextSignificantParent(){let Z=this;while(Z.type.isAnonymous&&Z._parent)Z=Z._parent;return Z}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function KJ(Z,$,J,Y){let X=Z.cursor(),Q=[];if(!X.firstChild())return Q;if(J!=null){for(let K=!1;!K;)if(K=X.type.is(J),!X.nextSibling())return Q}for(;;){if(Y!=null&&X.type.is(Y))return Q;if(X.type.is($))Q.push(X.node);if(!X.nextSibling())return Y==null?Q:[]}}function O4(Z,$,J=$.length-1){for(let Y=Z;J>=0;Y=Y.parent){if(!Y)return!1;if(!Y.type.isAnonymous){if($[J]&&$[J]!=Y.name)return!1;J--}}return!0}class GJ{constructor(Z,$,J,Y){this.parent=Z,this.buffer=$,this.index=J,this.start=Y}}class i1 extends H4{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(Z,$,J){super();this.context=Z,this._parent=$,this.index=J,this.type=Z.buffer.set.types[Z.buffer.buffer[J]]}child(Z,$,J){let{buffer:Y}=this.context,X=Y.findChild(this.index+4,Y.buffer[this.index+3],Z,$-this.context.start,J);return X<0?null:new i1(this.context,this,X)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(Z){return this.child(1,Z,2)}childBefore(Z){return this.child(-1,Z,-2)}prop(Z){return this.type.prop(Z)}enter(Z,$,J=0){if(J&F0.ExcludeBuffers)return null;let{buffer:Y}=this.context,X=Y.findChild(this.index+4,Y.buffer[this.index+3],$>0?1:-1,Z-this.context.start,$);return X<0?null:new i1(this.context,this,X)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(Z){return this._parent?null:this.context.parent.nextChild(this.context.index+Z,Z,0,4)}get nextSibling(){let{buffer:Z}=this.context,$=Z.buffer[this.index+3];if($<(this._parent?Z.buffer[this._parent.index+3]:Z.buffer.length))return new i1(this.context,this._parent,$);return this.externalSibling(1)}get prevSibling(){let{buffer:Z}=this.context,$=this._parent?this._parent.index+4:0;if(this.index==$)return this.externalSibling(-1);return new i1(this.context,this._parent,Z.findChild($,this.index,-1,0,4))}get tree(){return null}toTree(){let Z=[],$=[],{buffer:J}=this.context,Y=this.index+4,X=J.buffer[this.index+3];if(X>Y){let Q=J.buffer[this.index+1];Z.push(J.slice(Y,X,Q)),$.push(0)}return new j0(this.type,Z,$,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function WJ(Z){if(!Z.length)return null;let $=0,J=Z[0];for(let Q=1;Q<Z.length;Q++){let K=Z[Q];if(K.from>J.from||K.to<J.to)J=K,$=Q}let Y=J instanceof U1&&J.index<0?null:J.parent,X=Z.slice();if(Y)X[$]=Y;else X.splice($,1);return new jJ(X,J)}class jJ{constructor(Z,$){this.heads=Z,this.node=$}get next(){return WJ(this.heads)}}function Tq(Z,$,J){let Y=Z.resolveInner($,J),X=null;for(let Q=Y instanceof U1?Y:Y.context.parent;Q;Q=Q.parent)if(Q.index<0){let K=Q.parent;(X||(X=[Y])).push(K.resolve($,J)),Q=K}else{let K=p2.get(Q.tree);if(K&&K.overlay&&K.overlay[0].from<=$&&K.overlay[K.overlay.length-1].to>=$){let U=new U1(K.tree,K.overlay[0].from+Q.from,-1,Q);(X||(X=[Y])).push(w3(U,$,J,!1))}}return X?WJ(X):Y}class e6{get name(){return this.type.name}constructor(Z,$=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=$&~F0.EnterBracketed,Z instanceof U1)this.yieldNode(Z);else{this._tree=Z.context.parent,this.buffer=Z.context;for(let J=Z._parent;J;J=J._parent)this.stack.unshift(J.index);this.bufferNode=Z,this.yieldBuf(Z.index)}}yieldNode(Z){if(!Z)return!1;return this._tree=Z,this.type=Z.type,this.from=Z.from,this.to=Z.to,!0}yieldBuf(Z,$){this.index=Z;let{start:J,buffer:Y}=this.buffer;return this.type=$||Y.set.types[Y.buffer[Z]],this.from=J+Y.buffer[Z+1],this.to=J+Y.buffer[Z+2],!0}yield(Z){if(!Z)return!1;if(Z instanceof U1)return this.buffer=null,this.yieldNode(Z);return this.buffer=Z.context,this.yieldBuf(Z.index,Z.type)}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(Z,$,J){if(!this.buffer)return this.yield(this._tree.nextChild(Z<0?this._tree._tree.children.length-1:0,Z,$,J,this.mode));let{buffer:Y}=this.buffer,X=Y.findChild(this.index+4,Y.buffer[this.index+3],Z,$-this.buffer.start,J);if(X<0)return!1;return this.stack.push(this.index),this.yieldBuf(X)}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(Z){return this.enterChild(1,Z,2)}childBefore(Z){return this.enterChild(-1,Z,-2)}enter(Z,$,J=this.mode){if(!this.buffer)return this.yield(this._tree.enter(Z,$,J));return J&F0.ExcludeBuffers?!1:this.enterChild(1,Z,$)}parent(){if(!this.buffer)return this.yieldNode(this.mode&F0.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let Z=this.mode&F0.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(Z)}sibling(Z){if(!this.buffer)return!this._tree._parent?!1:this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+Z,Z,0,4,this.mode));let{buffer:$}=this.buffer,J=this.stack.length-1;if(Z<0){let Y=J<0?0:this.stack[J]+4;if(this.index!=Y)return this.yieldBuf($.findChild(Y,this.index,-1,0,4))}else{let Y=$.buffer[this.index+3];if(Y<(J<0?$.buffer.length:$.buffer[this.stack[J]+3]))return this.yieldBuf(Y)}return J<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+Z,Z,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(Z){let $,J,{buffer:Y}=this;if(Y){if(Z>0){if(this.index<Y.buffer.buffer.length)return!1}else for(let X=0;X<this.index;X++)if(Y.buffer.buffer[X+3]<this.index)return!1;({index:$,parent:J}=Y)}else({index:$,_parent:J}=this._tree);for(;J;{index:$,_parent:J}=J)if($>-1)for(let X=$+Z,Q=Z<0?-1:J._tree.children.length;X!=Q;X+=Z){let K=J._tree.children[X];if(this.mode&F0.IncludeAnonymous||K instanceof r1||!K.type.isAnonymous||N4(K))return!1}return!0}move(Z,$){if($&&this.enterChild(Z,0,4))return!0;for(;;){if(this.sibling(Z))return!0;if(this.atLastNode(Z)||!this.parent())return!1}}next(Z=!0){return this.move(1,Z)}prev(Z=!0){return this.move(-1,Z)}moveTo(Z,$=0){while(this.from==this.to||($<1?this.from>=Z:this.from>Z)||($>-1?this.to<=Z:this.to<Z))if(!this.parent())break;while(this.enterChild(1,Z,$));return this}get node(){if(!this.buffer)return this._tree;let Z=this.bufferNode,$=null,J=0;if(Z&&Z.context==this.buffer)Z:for(let Y=this.index,X=this.stack.length;X>=0;){for(let Q=Z;Q;Q=Q._parent)if(Q.index==Y){if(Y==this.index)return Q;$=Q,J=X+1;break Z}Y=this.stack[--X]}for(let Y=J;Y<this.stack.length;Y++)$=new i1(this.buffer,$,this.stack[Y]);return this.bufferNode=new i1(this.buffer,$,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(Z,$){for(let J=0;;){let Y=!1;if(this.type.isAnonymous||Z(this)!==!1){if(this.firstChild()){J++;continue}if(!this.type.isAnonymous)Y=!0}for(;;){if(Y&&$)$(this);if(Y=this.type.isAnonymous,!J)return;if(this.nextSibling())break;this.parent(),J--,Y=!0}}}matchContext(Z){if(!this.buffer)return O4(this.node.parent,Z);let{buffer:$}=this.buffer,{types:J}=$.set;for(let Y=Z.length-1,X=this.stack.length-1;Y>=0;X--){if(X<0)return O4(this._tree,Z,Y);let Q=J[$.buffer[this.stack[X]]];if(!Q.isAnonymous){if(Z[Y]&&Z[Y]!=Q.name)return!1;Y--}}return!0}}function N4(Z){return Z.children.some(($)=>$ instanceof r1||!$.type.isAnonymous||N4($))}function yq(Z){var $;let{buffer:J,nodeSet:Y,maxBufferLength:X=1024,reused:Q=[],minRepeatType:K=Y.types.length}=Z,U=Array.isArray(J)?new V4(J,J.length):J,q=Y.types,G=0,W=0;function j(B,w,x,c,a,T){let{id:C,start:E,end:y,size:f}=U,t=W,I0=G;if(f<0)if(U.next(),f==-1){let N=Q[C];x.push(N),c.push(E-B);return}else if(f==-3){G=C;return}else if(f==-4){W=C;return}else throw RangeError(`Unrecognized record size: ${f}`);let T0=q[C],Y1,B0,R=E-B;if(y-E<=X&&(B0=H(U.pos-w,a))){let N=new Uint16Array(B0.size-B0.skip),v=U.pos-B0.size,m=N.length;while(U.pos>v)m=F(B0.start,N,m);Y1=new r1(N,y-B0.start,Y),R=B0.start-B}else{let N=U.pos-f;U.next();let v=[],m=[],d=C>=K?C:-1,s=0,n=y;while(U.pos>N)if(d>=0&&U.id==d&&U.size>=0){if(U.end<=n-X)V(v,m,E,s,U.end,n,d,t,I0),s=v.length,n=U.end;U.next()}else if(T>2500)_(E,N,v,m);else j(E,N,v,m,d,T+1);if(d>=0&&s>0&&s<v.length)V(v,m,E,s,E,n,d,t,I0);if(v.reverse(),m.reverse(),d>-1&&s>0){let p=z(T0,I0);Y1=R4(T0,v,m,0,v.length,0,y-E,p,p)}else Y1=O(T0,v,m,y-E,t-y,I0)}x.push(Y1),c.push(R)}function _(B,w,x,c){let a=[],T=0,C=-1;while(U.pos>w){let{id:E,start:y,end:f,size:t}=U;if(t>4)U.next();else if(C>-1&&y<C)break;else{if(C<0)C=f-X;a.push(E,y,f),T++,U.next()}}if(T){let E=new Uint16Array(T*4),y=a[a.length-2];for(let f=a.length-3,t=0;f>=0;f-=3)E[t++]=a[f],E[t++]=a[f+1]-y,E[t++]=a[f+2]-y,E[t++]=t;x.push(new r1(E,a[2]-y,Y)),c.push(y-B)}}function z(B,w){return(x,c,a)=>{let T=0,C=x.length-1,E,y;if(C>=0&&(E=x[C])instanceof j0){if(!C&&E.type==B&&E.length==a)return E;if(y=E.prop(o.lookAhead))T=c[C]+E.length+y}return O(B,x,c,a,T,w)}}function V(B,w,x,c,a,T,C,E,y){let f=[],t=[];while(B.length>c)f.push(B.pop()),t.push(w.pop()+x-a);B.push(O(Y.types[C],f,t,T-a,E-T,y)),w.push(a-x)}function O(B,w,x,c,a,T,C){if(T){let E=[o.contextHash,T];C=C?[E].concat(C):[E]}if(a>25){let E=[o.lookAhead,a];C=C?[E].concat(C):[E]}return new j0(B,w,x,c,C)}function H(B,w){let x=U.fork(),c=0,a=0,T=0,C=x.end-X,E={size:0,start:0,skip:0};Z:for(let y=x.pos-B;x.pos>y;){let f=x.size;if(x.id==w&&f>=0){E.size=c,E.start=a,E.skip=T,T+=4,c+=4,x.next();continue}let t=x.pos-f;if(f<0||t<y||x.start<C)break;let I0=x.id>=K?4:0,T0=x.start;x.next();while(x.pos>t){if(x.size<0)if(x.size==-3||x.size==-4)I0+=4;else break Z;else if(x.id>=K)I0+=4;x.next()}a=T0,c+=f,T+=I0}if(w<0||c==B)E.size=c,E.start=a,E.skip=T;return E.size>4?E:void 0}function F(B,w,x){let{id:c,start:a,end:T,size:C}=U;if(U.next(),C>=0&&c<K){let E=x;if(C>4){let y=U.pos-(C-4);while(U.pos>y)x=F(B,w,x)}w[--x]=E,w[--x]=T-B,w[--x]=a-B,w[--x]=c}else if(C==-3)G=c;else if(C==-4)W=c;return x}let D=[],M=[];while(U.pos>0)j(Z.start||0,Z.bufferStart||0,D,M,-1,0);let A=($=Z.length)!==null&&$!==void 0?$:D.length?M[0]+D[0].length:0;return new j0(q[Z.topID],D.reverse(),M.reverse(),A)}var UJ=new WeakMap;function t6(Z,$){if(!Z.isAnonymous||$ instanceof r1||$.type!=Z)return 1;let J=UJ.get($);if(J==null){J=1;for(let Y of $.children){if(Y.type!=Z||!(Y instanceof j0)){J=1;break}J+=t6(Z,Y)}UJ.set($,J)}return J}function R4(Z,$,J,Y,X,Q,K,U,q){let G=0;for(let V=Y;V<X;V++)G+=t6(Z,$[V]);let W=Math.ceil(G*1.5/8),j=[],_=[];function z(V,O,H,F,D){for(let M=H;M<F;){let A=M,B=O[M],w=t6(Z,V[M]);M++;for(;M<F;M++){let x=t6(Z,V[M]);if(w+x>=W)break;w+=x}if(M==A+1){if(w>W){let x=V[A];z(x.children,x.positions,0,x.children.length,O[A]+D);continue}j.push(V[A])}else{let x=O[M-1]+V[M-1].length-B;j.push(R4(Z,V,O,A,M,B,x,null,q))}_.push(B+D-Q)}}return z($,J,Y,X,0),(U||q)(j,_,K)}class a1{constructor(Z,$,J,Y,X=!1,Q=!1){this.from=Z,this.to=$,this.tree=J,this.offset=Y,this.open=(X?1:0)|(Q?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(Z,$=[],J=!1){let Y=[new a1(0,Z.length,Z,0,!1,J)];for(let X of $)if(X.to>Z.length)Y.push(X);return Y}static applyChanges(Z,$,J=128){if(!$.length)return Z;let Y=[],X=1,Q=Z.length?Z[0]:null;for(let K=0,U=0,q=0;;K++){let G=K<$.length?$[K]:null,W=G?G.fromA:1e9;if(W-U>=J)while(Q&&Q.from<W){let j=Q;if(U>=j.from||W<=j.to||q){let _=Math.max(j.from,U)-q,z=Math.min(j.to,W)-q;j=_>=z?null:new a1(_,z,j.tree,j.offset+q,K>0,!!G)}if(j)Y.push(j);if(Q.to>W)break;Q=X<Z.length?Z[X++]:null}if(!G)break;U=G.toA,q=G.toA-G.toB}return Y}}class $9{startParse(Z,$,J){if(typeof Z=="string")Z=new _J(Z);return J=!J?[new o6(0,Z.length)]:J.length?J.map((Y)=>new o6(Y.from,Y.to)):[new o6(0,0)],this.createParse(Z,$||[],J)}parse(Z,$,J){let Y=this.startParse(Z,$,J);for(;;){let X=Y.advance();if(X)return X}}}class _J{constructor(Z){this.string=Z}get length(){return this.string.length}chunk(Z){return this.string.slice(Z)}get lineChunks(){return!1}read(Z,$){return this.string.slice(Z,$)}}var JO=new o({perNode:!0});var bq=0;class q1{constructor(Z,$,J,Y){this.name=Z,this.set=$,this.base=J,this.modified=Y,this.id=bq++}toString(){let{name:Z}=this;for(let $ of this.modified)if($.name)Z=`${$.name}(${Z})`;return Z}static define(Z,$){let J=typeof Z=="string"?Z:"?";if(Z instanceof q1)$=Z;if($===null||$===void 0?void 0:$.base)throw Error("Can not derive from a modified tag");let Y=new q1(J,[],null,[]);if(Y.set.push(Y),$)for(let X of $.set)Y.set.push(X);return Y}static defineModifier(Z){let $=new Q9(Z);return(J)=>{if(J.modified.indexOf($)>-1)return J;return Q9.get(J.base||J,J.modified.concat($).sort((Y,X)=>Y.id-X.id))}}}var kq=0;class Q9{constructor(Z){this.name=Z,this.instances=[],this.id=kq++}static get(Z,$){if(!$.length)return Z;let J=$[0].instances.find((K)=>K.base==Z&&Sq($,K.modified));if(J)return J;let Y=[],X=new q1(Z.name,Y,Z,$);for(let K of $)K.instances.push(X);let Q=xq($);for(let K of Z.set)if(!K.modified.length)for(let U of Q)Y.push(Q9.get(K,U));return X}}function Sq(Z,$){return Z.length==$.length&&Z.every((J,Y)=>J==$[Y])}function xq(Z){let $=[[]];for(let J=0;J<Z.length;J++)for(let Y=0,X=$.length;Y<X;Y++)$.push($[Y].concat(Z[J]));return $.sort((J,Y)=>Y.length-J.length)}function VJ(Z){let $=Object.create(null);for(let J in Z){let Y=Z[J];if(!Array.isArray(Y))Y=[Y];for(let X of J.split(" "))if(X){let Q=[],K=2,U=X;for(let j=0;;){if(U=="..."&&j>0&&j+3==X.length){K=1;break}let _=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(U);if(!_)throw RangeError("Invalid path: "+X);if(Q.push(_[0]=="*"?"":_[0][0]=='"'?JSON.parse(_[0]):_[0]),j+=_[0].length,j==X.length)break;let z=X[j++];if(j==X.length&&z=="!"){K=0;break}if(z!="/")throw RangeError("Invalid path: "+X);U=X.slice(j)}let q=Q.length-1,G=Q[q];if(!G)throw RangeError("Invalid path: "+X);let W=new l2(Y,K,q>0?Q.slice(0,q):null);$[G]=W.sort($[G])}}return HJ.add($)}var HJ=new o({combine(Z,$){let J,Y,X;while(Z||$){if(!Z||$&&Z.depth>=$.depth)X=$,$=$.next;else X=Z,Z=Z.next;if(J&&J.mode==X.mode&&!X.context&&!J.context)continue;let Q=new l2(X.tags,X.mode,X.context);if(J)J.next=Q;else Y=Q;J=Q}return Y}});class l2{constructor(Z,$,J,Y){this.tags=Z,this.mode=$,this.context=J,this.next=Y}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(Z){if(!Z||Z.depth<this.depth)return this.next=Z,this;return Z.next=this.sort(Z.next),Z}get depth(){return this.context?this.context.length:0}}l2.empty=new l2([],2,null);function D4(Z,$){let J=Object.create(null);for(let Q of Z)if(!Array.isArray(Q.tag))J[Q.tag.id]=Q.class;else for(let K of Q.tag)J[K.id]=Q.class;let{scope:Y,all:X=null}=$||{};return{style:(Q)=>{let K=X;for(let U of Q)for(let q of U.set){let G=J[q.id];if(G){K=K?K+" "+G:G;break}}return K},scope:Y}}function hq(Z,$){let J=null;for(let Y of Z){let X=Y.style($);if(X)J=J?J+" "+X:X}return J}function NJ(Z,$,J,Y=0,X=Z.length){let Q=new RJ(Y,Array.isArray($)?$:[$],J);Q.highlightRange(Z.cursor(),Y,X,"",Q.highlighters),Q.flush(X)}class RJ{constructor(Z,$,J){this.at=Z,this.highlighters=$,this.span=J,this.class=""}startSpan(Z,$){if($!=this.class){if(this.flush(Z),Z>this.at)this.at=Z;this.class=$}}flush(Z){if(Z>this.at&&this.class)this.span(this.at,Z,this.class)}highlightRange(Z,$,J,Y,X){let{type:Q,from:K,to:U}=Z;if(K>=J||U<=$)return;if(Q.isTop)X=this.highlighters.filter((_)=>!_.scope||_.scope(Q));let q=Y,G=wq(Z)||l2.empty,W=hq(X,G.tags);if(W){if(q)q+=" ";if(q+=W,G.mode==1)Y+=(Y?" ":"")+W}if(this.startSpan(Math.max($,K),q),G.opaque)return;let j=Z.tree&&Z.tree.prop(o.mounted);if(j&&j.overlay){let _=Z.node.enter(j.overlay[0].from+K,1),z=this.highlighters.filter((O)=>!O.scope||O.scope(j.tree.type)),V=Z.firstChild();for(let O=0,H=K;;O++){let F=O<j.overlay.length?j.overlay[O]:null,D=F?F.from+K:U,M=Math.max($,H),A=Math.min(J,D);if(M<A&&V){while(Z.from<A)if(this.highlightRange(Z,M,A,Y,X),this.startSpan(Math.min(A,Z.to),q),Z.to>=D||!Z.nextSibling())break}if(!F||D>J)break;if(H=F.to+K,H>$)this.highlightRange(_.cursor(),Math.max($,F.from+K),Math.min(J,H),"",z),this.startSpan(Math.min(J,H),q)}if(V)Z.parent()}else if(Z.firstChild()){if(j)Y="";do{if(Z.to<=$)continue;if(Z.from>=J)break;this.highlightRange(Z,$,J,Y,X),this.startSpan(Math.min(J,Z.to),q)}while(Z.nextSibling());Z.parent()}}}function wq(Z){let $=Z.type.prop(HJ);while($&&$.context&&!Z.matchContext($.context))$=$.next;return $||null}var b=q1.define,J9=b(),o1=b(),zJ=b(o1),OJ=b(o1),t1=b(),Y9=b(t1),F4=b(t1),h1=b(),R2=b(h1),S1=b(),x1=b(),I4=b(),v3=b(I4),X9=b(),I={comment:J9,lineComment:b(J9),blockComment:b(J9),docComment:b(J9),name:o1,variableName:b(o1),typeName:zJ,tagName:b(zJ),propertyName:OJ,attributeName:b(OJ),className:b(o1),labelName:b(o1),namespace:b(o1),macroName:b(o1),literal:t1,string:Y9,docString:b(Y9),character:b(Y9),attributeValue:b(Y9),number:F4,integer:b(F4),float:b(F4),bool:b(t1),regexp:b(t1),escape:b(t1),color:b(t1),url:b(t1),keyword:S1,self:b(S1),null:b(S1),atom:b(S1),unit:b(S1),modifier:b(S1),operatorKeyword:b(S1),controlKeyword:b(S1),definitionKeyword:b(S1),moduleKeyword:b(S1),operator:x1,derefOperator:b(x1),arithmeticOperator:b(x1),logicOperator:b(x1),bitwiseOperator:b(x1),compareOperator:b(x1),updateOperator:b(x1),definitionOperator:b(x1),typeOperator:b(x1),controlOperator:b(x1),punctuation:I4,separator:b(I4),bracket:v3,angleBracket:b(v3),squareBracket:b(v3),paren:b(v3),brace:b(v3),content:h1,heading:R2,heading1:b(R2),heading2:b(R2),heading3:b(R2),heading4:b(R2),heading5:b(R2),heading6:b(R2),contentSeparator:b(h1),list:b(h1),quote:b(h1),emphasis:b(h1),strong:b(h1),link:b(h1),monospace:b(h1),strikethrough:b(h1),inserted:b(),deleted:b(),changed:b(),invalid:b(),meta:X9,documentMeta:b(X9),annotation:b(X9),processingInstruction:b(X9),definition:q1.defineModifier("definition"),constant:q1.defineModifier("constant"),function:q1.defineModifier("function"),standard:q1.defineModifier("standard"),local:q1.defineModifier("local"),special:q1.defineModifier("special")};for(let Z in I){let $=I[Z];if($ instanceof q1)$.name=Z}var QO=D4([{tag:I.link,class:"tok-link"},{tag:I.heading,class:"tok-heading"},{tag:I.emphasis,class:"tok-emphasis"},{tag:I.strong,class:"tok-strong"},{tag:I.keyword,class:"tok-keyword"},{tag:I.atom,class:"tok-atom"},{tag:I.bool,class:"tok-bool"},{tag:I.url,class:"tok-url"},{tag:I.labelName,class:"tok-labelName"},{tag:I.inserted,class:"tok-inserted"},{tag:I.deleted,class:"tok-deleted"},{tag:I.literal,class:"tok-literal"},{tag:I.string,class:"tok-string"},{tag:I.number,class:"tok-number"},{tag:[I.regexp,I.escape,I.special(I.string)],class:"tok-string2"},{tag:I.variableName,class:"tok-variableName"},{tag:I.local(I.variableName),class:"tok-variableName tok-local"},{tag:I.definition(I.variableName),class:"tok-variableName tok-definition"},{tag:I.special(I.variableName),class:"tok-variableName2"},{tag:I.definition(I.propertyName),class:"tok-propertyName tok-definition"},{tag:I.typeName,class:"tok-typeName"},{tag:I.namespace,class:"tok-namespace"},{tag:I.className,class:"tok-className"},{tag:I.macroName,class:"tok-macroName"},{tag:I.propertyName,class:"tok-propertyName"},{tag:I.operator,class:"tok-operator"},{tag:I.comment,class:"tok-comment"},{tag:I.meta,class:"tok-meta"},{tag:I.invalid,class:"tok-invalid"},{tag:I.punctuation,class:"tok-punctuation"}]);var L4,d2=new o;function vq(Z){return S.define({combine:Z?($)=>$.concat(Z):void 0})}var uq=new o;class G1{constructor(Z,$,J=[],Y=""){if(this.data=Z,this.name=Y,!i.prototype.hasOwnProperty("tree"))Object.defineProperty(i.prototype,"tree",{get(){return E0(this)}});this.parser=$,this.extension=[e1.of(this),i.languageData.of((X,Q,K)=>{let U=FJ(X,Q,K),q=U.type.prop(d2);if(!q)return[];let G=X.facet(q),W=U.type.prop(uq);if(W){let j=U.resolve(Q-U.from,K);for(let _ of W)if(_.test(j,X)){let z=X.facet(_.facet);return _.type=="replace"?z:z.concat(G)}}return G})].concat(J)}isActiveAt(Z,$,J=-1){return FJ(Z,$,J).type.prop(d2)==this.data}findRegions(Z){let $=Z.facet(e1);if(($===null||$===void 0?void 0:$.data)==this.data)return[{from:0,to:Z.doc.length}];if(!$||!$.allowsNesting)return[];let J=[],Y=(X,Q)=>{if(X.prop(d2)==this.data){J.push({from:Q,to:Q+X.length});return}let K=X.prop(o.mounted);if(K){if(K.tree.prop(d2)==this.data){if(K.overlay)for(let U of K.overlay)J.push({from:U.from+Q,to:U.to+Q});else J.push({from:Q,to:Q+X.length});return}else if(K.overlay){let U=J.length;if(Y(K.tree,K.overlay[0].from+Q),J.length>U)return}}for(let U=0;U<X.children.length;U++){let q=X.children[U];if(q instanceof j0)Y(q,X.positions[U]+Q)}};return Y(E0(Z),0),J}get allowsNesting(){return!0}}G1.setState=l.define();function FJ(Z,$,J){let Y=Z.facet(e1),X=E0(Z).topNode;if(!Y||Y.allowsNesting){for(let Q=X;Q;Q=Q.enter($,J,F0.ExcludeBuffers|F0.EnterBracketed))if(Q.type.isTop)X=Q}return X}function E0(Z){let $=Z.field(G1.state,!1);return $?$.tree:j0.empty}class PJ{constructor(Z){this.doc=Z,this.cursorPos=0,this.string="",this.cursor=Z.iter()}get length(){return this.doc.length}syncTo(Z){return this.string=this.cursor.next(Z-this.cursorPos).value,this.cursorPos=Z+this.string.length,this.cursorPos-this.string.length}chunk(Z){return this.syncTo(Z),this.string}get lineChunks(){return!0}read(Z,$){let J=this.cursorPos-this.string.length;if(Z<J||$>=this.cursorPos)return this.doc.sliceString(Z,$);else return this.string.slice(Z-J,$-J)}}var u3=null;class c2{constructor(Z,$,J=[],Y,X,Q,K,U){this.parser=Z,this.state=$,this.fragments=J,this.tree=Y,this.treeLen=X,this.viewport=Q,this.skipped=K,this.scheduleOn=U,this.parse=null,this.tempSkipped=[]}static create(Z,$,J){return new c2(Z,$,[],j0.empty,0,J,[],null)}startParse(){return this.parser.startParse(new PJ(this.state.doc),this.fragments)}work(Z,$){if($!=null&&$>=this.state.doc.length)$=void 0;if(this.tree!=j0.empty&&this.isDone($!==null&&$!==void 0?$:this.state.doc.length))return this.takeTree(),!0;return this.withContext(()=>{var J;if(typeof Z=="number"){let Y=Date.now()+Z;Z=()=>Date.now()>Y}if(!this.parse)this.parse=this.startParse();if($!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>$)&&$<this.state.doc.length)this.parse.stopAt($);for(;;){let Y=this.parse.advance();if(Y)if(this.fragments=this.withoutTempSkipped(a1.addTree(Y,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(J=this.parse.stoppedAt)!==null&&J!==void 0?J:this.state.doc.length,this.tree=Y,this.parse=null,this.treeLen<($!==null&&$!==void 0?$:this.state.doc.length))this.parse=this.startParse();else return!0;if(Z())return!1}})}takeTree(){let Z,$;if(this.parse&&(Z=this.parse.parsedPos)>=this.treeLen){if(this.parse.stoppedAt==null||this.parse.stoppedAt>Z)this.parse.stopAt(Z);this.withContext(()=>{while(!($=this.parse.advance()));}),this.treeLen=Z,this.tree=$,this.fragments=this.withoutTempSkipped(a1.addTree(this.tree,this.fragments,!0)),this.parse=null}}withContext(Z){let $=u3;u3=this;try{return Z()}finally{u3=$}}withoutTempSkipped(Z){for(let $;$=this.tempSkipped.pop();)Z=IJ(Z,$.from,$.to);return Z}changes(Z,$){let{fragments:J,tree:Y,treeLen:X,viewport:Q,skipped:K}=this;if(this.takeTree(),!Z.empty){let U=[];if(Z.iterChangedRanges((q,G,W,j)=>U.push({fromA:q,toA:G,fromB:W,toB:j})),J=a1.applyChanges(J,U),Y=j0.empty,X=0,Q={from:Z.mapPos(Q.from,-1),to:Z.mapPos(Q.to,1)},this.skipped.length){K=[];for(let q of this.skipped){let G=Z.mapPos(q.from,1),W=Z.mapPos(q.to,-1);if(G<W)K.push({from:G,to:W})}}}return new c2(this.parser,$,J,Y,X,Q,K,this.scheduleOn)}updateViewport(Z){if(this.viewport.from==Z.from&&this.viewport.to==Z.to)return!1;this.viewport=Z;let $=this.skipped.length;for(let J=0;J<this.skipped.length;J++){let{from:Y,to:X}=this.skipped[J];if(Y<Z.to&&X>Z.from)this.fragments=IJ(this.fragments,Y,X),this.skipped.splice(J--,1)}if(this.skipped.length>=$)return!1;return this.reset(),!0}reset(){if(this.parse)this.takeTree(),this.parse=null}skipUntilInView(Z,$){this.skipped.push({from:Z,to:$})}static getSkippingParser(Z){return new class extends $9{createParse($,J,Y){let X=Y[0].from,Q=Y[Y.length-1].to;return{parsedPos:X,advance(){let U=u3;if(U){for(let q of Y)U.tempSkipped.push(q);if(Z)U.scheduleOn=U.scheduleOn?Promise.all([U.scheduleOn,Z]):Z}return this.parsedPos=Q,new j0(p0.none,[],[],Q-X)},stoppedAt:null,stopAt(){}}}}}isDone(Z){Z=Math.min(Z,this.state.doc.length);let $=this.fragments;return this.treeLen>=Z&&$.length&&$[0].from==0&&$[0].to>=Z}static get(){return u3}}function IJ(Z,$,J){return a1.applyChanges(Z,[{fromA:$,toA:J,fromB:$,toB:J}])}class s2{constructor(Z){this.context=Z,this.tree=Z.tree}apply(Z){if(!Z.docChanged&&this.tree==this.context.tree)return this;let $=this.context.changes(Z.changes,Z.state),J=this.context.treeLen==Z.startState.doc.length?void 0:Math.max(Z.changes.mapPos(this.context.treeLen),$.viewport.to);if(!$.work(20,J))$.takeTree();return new s2($)}static init(Z){let $=Math.min(3000,Z.doc.length),J=c2.create(Z.facet(e1).parser,Z,{from:0,to:$});if(!J.work(20,$))J.takeTree();return new s2(J)}}G1.state=z0.define({create:s2.init,update(Z,$){for(let J of $.effects)if(J.is(G1.setState))return J.value;if($.startState.facet(e1)!=$.state.facet(e1))return s2.init($.state);return Z.apply($)}});var CJ=(Z)=>{let $=setTimeout(()=>Z(),500);return()=>clearTimeout($)};if(typeof requestIdleCallback<"u")CJ=(Z)=>{let $=-1,J=setTimeout(()=>{$=requestIdleCallback(Z,{timeout:400})},100);return()=>$<0?clearTimeout(J):cancelIdleCallback($)};var M4=typeof navigator<"u"&&((L4=navigator.scheduling)===null||L4===void 0?void 0:L4.isInputPending)?()=>navigator.scheduling.isInputPending():null,mq=_0.fromClass(class{constructor($){this.view=$,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update($){let J=this.view.state.field(G1.state).context;if(J.updateViewport($.view.viewport)||this.view.viewport.to>J.treeLen)this.scheduleWork();if($.docChanged||$.selectionSet){if(this.view.hasFocus)this.chunkBudget+=50;this.scheduleWork()}this.checkAsyncSchedule(J)}scheduleWork(){if(this.working)return;let{state:$}=this.view,J=$.field(G1.state);if(J.tree!=J.context.tree||!J.context.isDone($.doc.length))this.working=CJ(this.work)}work($){this.working=null;let J=Date.now();if(this.chunkEnd<J&&(this.chunkEnd<0||this.view.hasFocus))this.chunkEnd=J+30000,this.chunkBudget=3000;if(this.chunkBudget<=0)return;let{state:Y,viewport:{to:X}}=this.view,Q=Y.field(G1.state);if(Q.tree==Q.context.tree&&Q.context.isDone(X+1e5))return;let K=Date.now()+Math.min(this.chunkBudget,100,$&&!M4?Math.max(25,$.timeRemaining()-5):1e9),U=Q.context.treeLen<X&&Y.doc.length>X+1000,q=Q.context.work(()=>{return M4&&M4()||Date.now()>K},X+(U?0:1e5));if(this.chunkBudget-=Date.now()-J,q||this.chunkBudget<=0)Q.context.takeTree(),this.view.dispatch({effects:G1.setState.of(new s2(Q.context))});if(this.chunkBudget>0&&!(q&&!U))this.scheduleWork();this.checkAsyncSchedule(Q.context)}checkAsyncSchedule($){if($.scheduleOn)this.workScheduled++,$.scheduleOn.then(()=>this.scheduleWork()).catch((J)=>h0(this.view.state,J)).then(()=>this.workScheduled--),$.scheduleOn=null}destroy(){if(this.working)this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),e1=S.define({combine(Z){return Z.length?Z[0]:null},enables:(Z)=>[G1.state,mq,P.contentAttributes.compute([Z],($)=>{let J=$.facet(Z);return J&&J.name?{"data-language":J.name}:{}})]});var gq=S.define(),g3=S.define({combine:(Z)=>{if(!Z.length)return"  ";let $=Z[0];if(!$||/\S/.test($)||Array.from($).some((J)=>J!=$[0]))throw Error("Invalid indent unit: "+JSON.stringify(Z[0]));return $}});function Z2(Z){let $=Z.facet(g3);return $.charCodeAt(0)==9?Z.tabSize*$.length:$.length}function n2(Z,$){let J="",Y=Z.tabSize,X=Z.facet(g3)[0];if(X=="\t"){while($>=Y)J+="\t",$-=Y;X=" "}for(let Q=0;Q<$;Q++)J+=X;return J}function G9(Z,$){if(Z instanceof i)Z=new i2(Z);for(let Y of Z.state.facet(gq)){let X=Y(Z,$);if(X!==void 0)return X}let J=E0(Z.state);return J.length>=$?fq(Z,J,$):null}class i2{constructor(Z,$={}){this.state=Z,this.options=$,this.unit=Z2(Z)}lineAt(Z,$=1){let J=this.state.doc.lineAt(Z),{simulateBreak:Y,simulateDoubleBreak:X}=this.options;if(Y!=null&&Y>=J.from&&Y<=J.to)if(X&&Y==Z)return{text:"",from:Z};else if($<0?Y<Z:Y<=Z)return{text:J.text.slice(Y-J.from),from:Y};else return{text:J.text.slice(0,Y-J.from),from:J.from};return J}textAfterPos(Z,$=1){if(this.options.simulateDoubleBreak&&Z==this.options.simulateBreak)return"";let{text:J,from:Y}=this.lineAt(Z,$);return J.slice(Z-Y,Math.min(J.length,Z+100-Y))}column(Z,$=1){let{text:J,from:Y}=this.lineAt(Z,$),X=this.countColumn(J,Z-Y),Q=this.options.overrideIndentation?this.options.overrideIndentation(Y):-1;if(Q>-1)X+=Q-this.countColumn(J,J.search(/\S|$/));return X}countColumn(Z,$=Z.length){return u1(Z,this.state.tabSize,$)}lineIndent(Z,$=1){let{text:J,from:Y}=this.lineAt(Z,$),X=this.options.overrideIndentation;if(X){let Q=X(Y);if(Q>-1)return Q}return this.countColumn(J,J.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}var TJ=new o;function fq(Z,$,J){let Y=$.resolveStack(J),X=$.resolveInner(J,-1).resolve(J,0).enterUnfinishedNodesBefore(J);if(X!=Y.node){let Q=[];for(let K=X;K&&!(K.from<Y.node.from||K.to>Y.node.to||K.from==Y.node.from&&K.type==Y.node.type);K=K.parent)Q.push(K);for(let K=Q.length-1;K>=0;K--)Y={node:Q[K],next:Y}}return yJ(Y,Z,J)}function yJ(Z,$,J){for(let Y=Z;Y;Y=Y.next){let X=lq(Y.node);if(X)return X(T4.create($,J,Y))}return 0}function pq(Z){return Z.pos==Z.options.simulateBreak&&Z.options.simulateDoubleBreak}function lq(Z){let $=Z.type.prop(TJ);if($)return $;let J=Z.firstChild,Y;if(J&&(Y=J.type.prop(o.closedBy))){let X=Z.lastChild,Q=X&&Y.indexOf(X.name)>-1;return(K)=>nq(K,!0,1,void 0,Q&&!pq(K)?X.from:void 0)}return Z.parent==null?dq:null}function dq(){return 0}class T4 extends i2{constructor(Z,$,J){super(Z.state,Z.options);this.base=Z,this.pos=$,this.context=J}get node(){return this.context.node}static create(Z,$,J){return new T4(Z,$,J)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(Z){let $=this.state.doc.lineAt(Z.from);for(;;){let J=Z.resolve($.from);while(J.parent&&J.parent.from==J.from)J=J.parent;if(cq(J,Z))break;$=this.state.doc.lineAt(J.from)}return this.lineIndent($.from)}continue(){return yJ(this.context.next,this.base,this.pos)}}function cq(Z,$){for(let J=$;J;J=J.parent)if(Z==J)return!0;return!1}function sq(Z){let $=Z.node,J=$.childAfter($.from),Y=$.lastChild;if(!J)return null;let X=Z.options.simulateBreak,Q=Z.state.doc.lineAt(J.from),K=X==null||X<=Q.from?Q.to:Math.min(Q.to,X);for(let U=J.to;;){let q=$.childAfter(U);if(!q||q==Y)return null;if(!q.type.isSkipped){if(q.from>=K)return null;let G=/^ */.exec(Q.text.slice(J.to-Q.from))[0].length;return{from:J.from,to:J.to+G}}U=q.to}}function nq(Z,$,J,Y,X){let Q=Z.textAfter,K=Q.match(/^\s*/)[0].length,U=Y&&Q.slice(K,K+Y.length)==Y||X==Z.pos+K,q=$?sq(Z):null;if(q)return U?Z.column(q.from):Z.column(q.to);return Z.baseIndent+(U?0:Z.unit*J)}var iq=200;function bJ(){return i.transactionFilter.of((Z)=>{if(!Z.docChanged||!Z.isUserEvent("input.type")&&!Z.isUserEvent("input.complete"))return Z;let $=Z.startState.languageDataAt("indentOnInput",Z.startState.selection.main.head);if(!$.length)return Z;let J=Z.newDoc,{head:Y}=Z.newSelection.main,X=J.lineAt(Y);if(Y>X.from+iq)return Z;let Q=J.sliceString(X.from,Y);if(!$.some((G)=>G.test(Q)))return Z;let{state:K}=Z,U=-1,q=[];for(let{head:G}of K.selection.ranges){let W=K.doc.lineAt(G);if(W.from==U)continue;U=W.from;let j=G9(K,W.from);if(j==null)continue;let _=/^\s*/.exec(W.text)[0],z=n2(K,j);if(_!=z)q.push({from:W.from,to:W.from+_.length,insert:z})}return q.length?[Z,{changes:q,sequential:!0}]:Z})}var rq=S.define(),aq=new o;function oq(Z,$,J){let Y=E0(Z);if(Y.length<J)return null;let X=Y.resolveStack(J,1),Q=null;for(let K=X;K;K=K.next){let U=K.node;if(U.to<=J||U.from>J)continue;if(Q&&U.from<$)break;let q=U.type.prop(aq);if(q&&(U.to<Y.length-50||Y.length==Z.doc.length||!tq(U))){let G=q(U,Z);if(G&&G.from<=J&&G.from>=$&&G.to>J)Q=G}}return Q}function tq(Z){let $=Z.lastChild;return $&&$.to==Z.to&&$.type.isError}function U9(Z,$,J){for(let Y of Z.facet(rq)){let X=Y(Z,$,J);if(X)return X}return oq(Z,$,J)}function kJ(Z,$){let J=$.mapPos(Z.from,1),Y=$.mapPos(Z.to,-1);return J>=Y?void 0:{from:J,to:Y}}var W9=l.define({map:kJ}),f3=l.define({map:kJ});function SJ(Z){let $=[];for(let{head:J}of Z.state.selection.ranges){if($.some((Y)=>Y.from<=J&&Y.to>=J))continue;$.push(Z.lineBlockAt(J))}return $}var F2=z0.define({create(){return g.none},update(Z,$){if($.isUserEvent("delete"))$.changes.iterChangedRanges((J,Y)=>Z=DJ(Z,J,Y));Z=Z.map($.changes);for(let J of $.effects)if(J.is(W9)&&!eq(Z,J.value.from,J.value.to)){let{preparePlaceholder:Y}=$.state.facet(y4),X=!Y?LJ:g.replace({widget:new mJ(Y($.state,J.value))});Z=Z.update({add:[X.range(J.value.from,J.value.to)]})}else if(J.is(f3))Z=Z.update({filter:(Y,X)=>J.value.from!=Y||J.value.to!=X,filterFrom:J.value.from,filterTo:J.value.to});if($.selection)Z=DJ(Z,$.selection.main.head);return Z},provide:(Z)=>P.decorations.from(Z),toJSON(Z,$){let J=[];return Z.between(0,$.doc.length,(Y,X)=>{J.push(Y,X)}),J},fromJSON(Z){if(!Array.isArray(Z)||Z.length%2)throw RangeError("Invalid JSON for fold state");let $=[];for(let J=0;J<Z.length;){let Y=Z[J++],X=Z[J++];if(typeof Y!="number"||typeof X!="number")throw RangeError("Invalid JSON for fold state");$.push(LJ.range(Y,X))}return g.set($,!0)}});function DJ(Z,$,J=$){let Y=!1;return Z.between($,J,(X,Q)=>{if(X<J&&Q>$)Y=!0}),!Y?Z:Z.update({filterFrom:$,filterTo:J,filter:(X,Q)=>X>=J||Q<=$})}function q9(Z,$,J){var Y;let X=null;return(Y=Z.field(F2,!1))===null||Y===void 0||Y.between($,J,(Q,K)=>{if(!X||X.from>Q)X={from:Q,to:K}}),X}function eq(Z,$,J){let Y=!1;return Z.between($,$,(X,Q)=>{if(X==$&&Q==J)Y=!0}),Y}function xJ(Z,$){return Z.field(F2,!1)?$:$.concat(l.appendConfig.of(vJ()))}var ZG=(Z)=>{for(let $ of SJ(Z)){let J=U9(Z.state,$.from,$.to);if(J)return Z.dispatch({effects:xJ(Z.state,[W9.of(J),hJ(Z,J)])}),!0}return!1},$G=(Z)=>{if(!Z.state.field(F2,!1))return!1;let $=[];for(let J of SJ(Z)){let Y=q9(Z.state,J.from,J.to);if(Y)$.push(f3.of(Y),hJ(Z,Y,!1))}if($.length)Z.dispatch({effects:$});return $.length>0};function hJ(Z,$,J=!0){let Y=Z.state.doc.lineAt($.from).number,X=Z.state.doc.lineAt($.to).number;return P.announce.of(`${Z.state.phrase(J?"Folded lines":"Unfolded lines")} ${Y} ${Z.state.phrase("to")} ${X}.`)}var JG=(Z)=>{let{state:$}=Z,J=[];for(let Y=0;Y<$.doc.length;){let X=Z.lineBlockAt(Y),Q=U9($,X.from,X.to);if(Q)J.push(W9.of(Q));Y=(Q?Z.lineBlockAt(Q.to):X).to+1}if(J.length)Z.dispatch({effects:xJ(Z.state,J)});return!!J.length},YG=(Z)=>{let $=Z.state.field(F2,!1);if(!$||!$.size)return!1;let J=[];return $.between(0,Z.state.doc.length,(Y,X)=>{J.push(f3.of({from:Y,to:X}))}),Z.dispatch({effects:J}),!0};var wJ=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:ZG},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:$G},{key:"Ctrl-Alt-[",run:JG},{key:"Ctrl-Alt-]",run:YG}],XG={placeholderDOM:null,preparePlaceholder:null,placeholderText:"â€¦"},y4=S.define({combine(Z){return u0(Z,XG)}});function vJ(Z){let $=[F2,KG];if(Z)$.push(y4.of(Z));return $}function uJ(Z,$){let{state:J}=Z,Y=J.facet(y4),X=(K)=>{let U=Z.lineBlockAt(Z.posAtDOM(K.target)),q=q9(Z.state,U.from,U.to);if(q)Z.dispatch({effects:f3.of(q)});K.preventDefault()};if(Y.placeholderDOM)return Y.placeholderDOM(Z,X,$);let Q=document.createElement("span");return Q.textContent=Y.placeholderText,Q.setAttribute("aria-label",J.phrase("folded code")),Q.title=J.phrase("unfold"),Q.className="cm-foldPlaceholder",Q.onclick=X,Q}var LJ=g.replace({widget:new class extends e0{toDOM(Z){return uJ(Z,null)}}});class mJ extends e0{constructor(Z){super();this.value=Z}eq(Z){return this.value==Z.value}toDOM(Z){return uJ(Z,this.value)}}var QG={openText:"âŒ„",closedText:"â€º",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class K9 extends K1{constructor(Z,$){super();this.config=Z,this.open=$}eq(Z){return this.config==Z.config&&this.open==Z.open}toDOM(Z){if(this.config.markerDOM)return this.config.markerDOM(this.open);let $=document.createElement("span");return $.textContent=this.open?this.config.openText:this.config.closedText,$.title=Z.state.phrase(this.open?"Fold line":"Unfold line"),$}}function gJ(Z={}){let $={...QG,...Z},J=new K9($,!0),Y=new K9($,!1),X=_0.fromClass(class{constructor(K){this.from=K.viewport.from,this.markers=this.buildMarkers(K)}update(K){if(K.docChanged||K.viewportChanged||K.startState.facet(e1)!=K.state.facet(e1)||K.startState.field(F2,!1)!=K.state.field(F2,!1)||E0(K.startState)!=E0(K.state)||$.foldingChanged(K))this.markers=this.buildMarkers(K.view)}buildMarkers(K){let U=new r0;for(let q of K.viewportLineBlocks){let G=q9(K.state,q.from,q.to)?Y:U9(K.state,q.from,q.to)?J:null;if(G)U.add(q.from,q.from,G)}return U.finish()}}),{domEventHandlers:Q}=$;return[X,_4({class:"cm-foldGutter",markers(K){var U;return((U=K.plugin(X))===null||U===void 0?void 0:U.markers)||r.empty},initialSpacer(){return new K9($,!1)},domEventHandlers:{...Q,click:(K,U,q)=>{if(Q.click&&Q.click(K,U,q))return!0;let G=q9(K.state,U.from,U.to);if(G)return K.dispatch({effects:f3.of(G)}),!0;let W=U9(K.state,U.from,U.to);if(W)return K.dispatch({effects:W9.of(W)}),!0;return!1}}}),vJ()]}var KG=P.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class r2{constructor(Z,$){this.specs=Z;let J;function Y(K){let U=F1.newName();return(J||(J=Object.create(null)))["."+U]=K,U}let X=typeof $.all=="string"?$.all:$.all?Y($.all):void 0,Q=$.scope;this.scope=Q instanceof G1?(K)=>K.prop(d2)==Q.data:Q?(K)=>K==Q:void 0,this.style=D4(Z.map((K)=>({tag:K.tag,class:K.class||Y(Object.assign({},K,{tag:null}))})),{all:X}).style,this.module=J?new F1(J):null,this.themeType=$.themeType}static define(Z,$){return new r2(Z,$||{})}}var E4=S.define(),fJ=S.define({combine(Z){return Z.length?[Z[0]]:null}});function A4(Z){let $=Z.facet(E4);return $.length?$:Z.facet(fJ)}function j9(Z,$){let J=[UG],Y;if(Z instanceof r2){if(Z.module)J.push(P.styleModule.of(Z.module));Y=Z.themeType}if($===null||$===void 0?void 0:$.fallback)J.push(fJ.of(Z));else if(Y)J.push(E4.computeN([P.darkTheme],(X)=>{return X.facet(P.darkTheme)==(Y=="dark")?[Z]:[]}));else J.push(E4.of(Z));return J}class pJ{constructor(Z){this.markCache=Object.create(null),this.tree=E0(Z.state),this.decorations=this.buildDeco(Z,A4(Z.state)),this.decoratedTo=Z.viewport.to}update(Z){let $=E0(Z.state),J=A4(Z.state),Y=J!=A4(Z.startState),{viewport:X}=Z.view,Q=Z.changes.mapPos(this.decoratedTo,1);if($.length<X.to&&!Y&&$.type==this.tree.type&&Q>=X.to)this.decorations=this.decorations.map(Z.changes),this.decoratedTo=Q;else if($!=this.tree||Z.viewportChanged||Y)this.tree=$,this.decorations=this.buildDeco(Z.view,J),this.decoratedTo=X.to}buildDeco(Z,$){if(!$||!this.tree.length)return g.none;let J=new r0;for(let{from:Y,to:X}of Z.visibleRanges)NJ(this.tree,$,(Q,K,U)=>{J.add(Q,K,this.markCache[U]||(this.markCache[U]=g.mark({class:U})))},Y,X);return J.finish()}}var UG=R1.high(_0.fromClass(pJ,{decorations:(Z)=>Z.decorations})),lJ=r2.define([{tag:I.meta,color:"#404740"},{tag:I.link,textDecoration:"underline"},{tag:I.heading,textDecoration:"underline",fontWeight:"bold"},{tag:I.emphasis,fontStyle:"italic"},{tag:I.strong,fontWeight:"bold"},{tag:I.strikethrough,textDecoration:"line-through"},{tag:I.keyword,color:"#708"},{tag:[I.atom,I.bool,I.url,I.contentSeparator,I.labelName],color:"#219"},{tag:[I.literal,I.inserted],color:"#164"},{tag:[I.string,I.deleted],color:"#a11"},{tag:[I.regexp,I.escape,I.special(I.string)],color:"#e40"},{tag:I.definition(I.variableName),color:"#00f"},{tag:I.local(I.variableName),color:"#30a"},{tag:[I.typeName,I.namespace],color:"#085"},{tag:I.className,color:"#167"},{tag:[I.special(I.variableName),I.macroName],color:"#256"},{tag:I.definition(I.propertyName),color:"#00c"},{tag:I.comment,color:"#940"},{tag:I.invalid,color:"#f00"}]),qG=P.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),dJ=1e4,cJ="()[]{}",sJ=S.define({combine(Z){return u0(Z,{afterCursor:!0,brackets:cJ,maxScanDistance:dJ,renderMatch:jG})}}),GG=g.mark({class:"cm-matchingBracket"}),WG=g.mark({class:"cm-nonmatchingBracket"});function jG(Z){let $=[],J=Z.matched?GG:WG;if($.push(J.range(Z.start.from,Z.start.to)),Z.end)$.push(J.range(Z.end.from,Z.end.to));return $}var _G=z0.define({create(){return g.none},update(Z,$){if(!$.docChanged&&!$.selection)return Z;let J=[],Y=$.state.facet(sJ);for(let X of $.state.selection.ranges){if(!X.empty)continue;let Q=A1($.state,X.head,-1,Y)||X.head>0&&A1($.state,X.head-1,1,Y)||Y.afterCursor&&(A1($.state,X.head,1,Y)||X.head<$.state.doc.length&&A1($.state,X.head+1,-1,Y));if(Q)J=J.concat(Y.renderMatch(Q,$.state))}return g.set(J,!0)},provide:(Z)=>P.decorations.from(Z)}),zG=[_G,qG];function nJ(Z={}){return[sJ.of(Z),zG]}var OG=new o;function P4(Z,$,J){let Y=Z.prop($<0?o.openedBy:o.closedBy);if(Y)return Y;if(Z.name.length==1){let X=J.indexOf(Z.name);if(X>-1&&X%2==($<0?1:0))return[J[X+$]]}return null}function C4(Z){let $=Z.type.prop(OG);return $?$(Z.node):Z}function A1(Z,$,J,Y={}){let X=Y.maxScanDistance||dJ,Q=Y.brackets||cJ,K=E0(Z),U=K.resolveInner($,J);for(let q=U;q;q=q.parent){let G=P4(q.type,J,Q);if(G&&q.from<q.to){let W=C4(q);if(W&&(J>0?$>=W.from&&$<W.to:$>W.from&&$<=W.to))return VG(Z,$,J,q,W,G,Q)}}return HG(Z,$,J,K,U.type,X,Q)}function VG(Z,$,J,Y,X,Q,K){let U=Y.parent,q={from:X.from,to:X.to},G=0,W=U===null||U===void 0?void 0:U.cursor();if(W&&(J<0?W.childBefore(Y.from):W.childAfter(Y.to)))do if(J<0?W.to<=Y.from:W.from>=Y.to){if(G==0&&Q.indexOf(W.type.name)>-1&&W.from<W.to){let j=C4(W);return{start:q,end:j?{from:j.from,to:j.to}:void 0,matched:!0}}else if(P4(W.type,J,K))G++;else if(P4(W.type,-J,K)){if(G==0){let j=C4(W);return{start:q,end:j&&j.from<j.to?{from:j.from,to:j.to}:void 0,matched:!1}}G--}}while(J<0?W.prevSibling():W.nextSibling());return{start:q,matched:!1}}function HG(Z,$,J,Y,X,Q,K){let U=J<0?Z.sliceDoc($-1,$):Z.sliceDoc($,$+1),q=K.indexOf(U);if(q<0||q%2==0!=J>0)return null;let G={from:J<0?$-1:$,to:J>0?$+1:$},W=Z.doc.iterRange($,J>0?Z.doc.length:0),j=0;for(let _=0;!W.next().done&&_<=Q;){let z=W.value;if(J<0)_+=z.length;let V=$+_*J;for(let O=J>0?0:z.length-1,H=J>0?z.length:-1;O!=H;O+=J){let F=K.indexOf(z[O]);if(F<0||Y.resolveInner(V+O,1).type!=X)continue;if(F%2==0==J>0)j++;else if(j==1)return{start:G,end:{from:V+O,to:V+O+1},matched:F>>1==q>>1};else j--}if(J>0)_+=z.length}return W.done?{start:G,matched:!1}:null}function MJ(Z,$,J,Y=0,X=0){if($==null){if($=Z.search(/[^\s\u00a0]/),$==-1)$=Z.length}let Q=X;for(let K=Y;K<$;K++)if(Z.charCodeAt(K)==9)Q+=J-Q%J;else Q++;return Q}class b4{constructor(Z,$,J,Y){this.string=Z,this.tabSize=$,this.indentUnit=J,this.overrideIndent=Y,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(Z){let $=this.string.charAt(this.pos),J;if(typeof Z=="string")J=$==Z;else J=$&&(Z instanceof RegExp?Z.test($):Z($));if(J)return++this.pos,$}eatWhile(Z){let $=this.pos;while(this.eat(Z));return this.pos>$}eatSpace(){let Z=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>Z}skipToEnd(){this.pos=this.string.length}skipTo(Z){let $=this.string.indexOf(Z,this.pos);if($>-1)return this.pos=$,!0}backUp(Z){this.pos-=Z}column(){if(this.lastColumnPos<this.start)this.lastColumnValue=MJ(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start;return this.lastColumnValue}indentation(){var Z;return(Z=this.overrideIndent)!==null&&Z!==void 0?Z:MJ(this.string,null,this.tabSize)}match(Z,$,J){if(typeof Z=="string"){let Y=(Q)=>J?Q.toLowerCase():Q,X=this.string.substr(this.pos,Z.length);if(Y(X)==Y(Z)){if($!==!1)this.pos+=Z.length;return!0}else return null}else{let Y=this.string.slice(this.pos).match(Z);if(Y&&Y.index>0)return null;if(Y&&$!==!1)this.pos+=Y[0].length;return Y}}current(){return this.string.slice(this.start,this.pos)}}function NG(Z){return{name:Z.name||"",token:Z.token,blankLine:Z.blankLine||(()=>{}),startState:Z.startState||(()=>!0),copyState:Z.copyState||RG,indent:Z.indent||(()=>null),languageData:Z.languageData||{},tokenTable:Z.tokenTable||S4,mergeTokens:Z.mergeTokens!==!1}}function RG(Z){if(typeof Z!="object")return Z;let $={};for(let J in Z){let Y=Z[J];$[J]=Y instanceof Array?Y.slice():Y}return $}var AJ=new WeakMap;class I2 extends G1{constructor(Z){let $=vq(Z.languageData),J=NG(Z),Y,X=new class extends $9{createParse(Q,K,U){return new rJ(Y,Q,K,U)}};super($,X,[],Z.name);this.topNode=LG($,this),Y=this,this.streamParser=J,this.stateAfter=new o({perNode:!0}),this.tokenTable=Z.tokenTable?new x4(J.tokenTable):DG}static define(Z){return new I2(Z)}getIndent(Z){let $=void 0,{overrideIndentation:J}=Z.options;if(J){if($=AJ.get(Z.state),$!=null&&$<Z.pos-1e4)$=void 0}let Y=k4(this,Z.node.tree,Z.node.from,Z.node.from,$!==null&&$!==void 0?$:Z.pos),X,Q;if(Y)Q=Y.state,X=Y.pos+1;else Q=this.streamParser.startState(Z.unit),X=Z.node.from;if(Z.pos-X>1e4)return null;while(X<Z.pos){let U=Z.state.doc.lineAt(X),q=Math.min(Z.pos,U.to);if(U.length){let G=J?J(U.from):-1,W=new b4(U.text,Z.state.tabSize,Z.unit,G<0?void 0:G);while(W.pos<q-U.from)aJ(this.streamParser.token,W,Q)}else this.streamParser.blankLine(Q,Z.unit);if(q==Z.pos)break;X=U.to+1}let K=Z.lineAt(Z.pos);if(J&&$==null)AJ.set(Z.state,K.from);return this.streamParser.indent(Q,/^\s*(.*)/.exec(K.text)[1],Z)}get allowsNesting(){return!1}}function k4(Z,$,J,Y,X){let Q=J>=Y&&J+$.length<=X&&$.prop(Z.stateAfter);if(Q)return{state:Z.streamParser.copyState(Q),pos:J+$.length};for(let K=$.children.length-1;K>=0;K--){let U=$.children[K],q=J+$.positions[K],G=U instanceof j0&&q<X&&k4(Z,U,q,Y,X);if(G)return G}return null}function iJ(Z,$,J,Y,X){if(X&&J<=0&&Y>=$.length)return $;if(!X&&J==0&&$.type==Z.topNode)X=!0;for(let Q=$.children.length-1;Q>=0;Q--){let K=$.positions[Q],U=$.children[Q],q;if(K<Y&&U instanceof j0){if(!(q=iJ(Z,U,J-K,Y-K,X)))break;return!X?q:new j0($.type,$.children.slice(0,Q).concat(q),$.positions.slice(0,Q+1),K+q.length)}}return null}function FG(Z,$,J,Y,X){for(let Q of $){let K=Q.from+(Q.openStart?25:0),U=Q.to-(Q.openEnd?25:0),q=K<=J&&U>J&&k4(Z,Q.tree,0-Q.offset,J,U),G;if(q&&q.pos<=Y&&(G=iJ(Z,Q.tree,J+Q.offset,q.pos+Q.offset,!1)))return{state:q.state,tree:G}}return{state:Z.streamParser.startState(X?Z2(X):4),tree:j0.empty}}class rJ{constructor(Z,$,J,Y){this.lang=Z,this.input=$,this.fragments=J,this.ranges=Y,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=Y[Y.length-1].to;let X=c2.get(),Q=Y[0].from,{state:K,tree:U}=FG(Z,J,Q,this.to,X===null||X===void 0?void 0:X.state);this.state=K,this.parsedPos=this.chunkStart=Q+U.length;for(let q=0;q<U.children.length;q++)this.chunks.push(U.children[q]),this.chunkPos.push(U.positions[q]);if(X&&this.parsedPos<X.viewport.from-1e5&&Y.some((q)=>q.from<=X.viewport.from&&q.to>=X.viewport.from))this.state=this.lang.streamParser.startState(Z2(X.state)),X.skipUntilInView(this.parsedPos,X.viewport.from),this.parsedPos=X.viewport.from;this.moveRangeIndex()}advance(){let Z=c2.get(),$=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),J=Math.min($,this.chunkStart+512);if(Z)J=Math.min(J,Z.viewport.to);while(this.parsedPos<J)this.parseLine(Z);if(this.chunkStart<this.parsedPos)this.finishChunk();if(this.parsedPos>=$)return this.finish();if(Z&&this.parsedPos>=Z.viewport.to)return Z.skipUntilInView(this.parsedPos,$),this.finish();return null}stopAt(Z){this.stoppedAt=Z}lineAfter(Z){let $=this.input.chunk(Z);if(!this.input.lineChunks){let J=$.indexOf(`
`);if(J>-1)$=$.slice(0,J)}else if($==`
`)$="";return Z+$.length<=this.to?$:$.slice(0,this.to-Z)}nextLine(){let Z=this.parsedPos,$=this.lineAfter(Z),J=Z+$.length;for(let Y=this.rangeIndex;;){let X=this.ranges[Y].to;if(X>=J)break;if($=$.slice(0,X-(J-$.length)),Y++,Y==this.ranges.length)break;let Q=this.ranges[Y].from,K=this.lineAfter(Q);$+=K,J=Q+K.length}return{line:$,end:J}}skipGapsTo(Z,$,J){for(;;){let Y=this.ranges[this.rangeIndex].to,X=Z+$;if(J>0?Y>X:Y>=X)break;let Q=this.ranges[++this.rangeIndex].from;$+=Q-Y}return $}moveRangeIndex(){while(this.ranges[this.rangeIndex].to<this.parsedPos)this.rangeIndex++}emitToken(Z,$,J,Y){let X=4;if(this.ranges.length>1){Y=this.skipGapsTo($,Y,1),$+=Y;let K=this.chunk.length;Y=this.skipGapsTo(J,Y,-1),J+=Y,X+=this.chunk.length-K}let Q=this.chunk.length-4;if(this.lang.streamParser.mergeTokens&&X==4&&Q>=0&&this.chunk[Q]==Z&&this.chunk[Q+2]==$)this.chunk[Q+2]=J;else this.chunk.push(Z,$,J,X);return Y}parseLine(Z){let{line:$,end:J}=this.nextLine(),Y=0,{streamParser:X}=this.lang,Q=new b4($,Z?Z.state.tabSize:4,Z?Z2(Z.state):2);if(Q.eol())X.blankLine(this.state,Q.indentUnit);else while(!Q.eol()){let K=aJ(X.token,Q,this.state);if(K)Y=this.emitToken(this.lang.tokenTable.resolve(K),this.parsedPos+Q.start,this.parsedPos+Q.pos,Y);if(Q.start>1e4)break}if(this.parsedPos=J,this.moveRangeIndex(),this.parsedPos<this.to)this.parsedPos++}finishChunk(){let Z=j0.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:IG,topID:0,maxBufferLength:512,reused:this.chunkReused});Z=new j0(Z.type,Z.children,Z.positions,Z.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(Z),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new j0(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function aJ(Z,$,J){$.start=$.pos;for(let Y=0;Y<10;Y++){let X=Z($,J);if($.pos>$.start)return X}throw Error("Stream parser failed to advance stream.")}var S4=Object.create(null),m3=[p0.none],IG=new Z9(m3),BJ=[],EJ=Object.create(null),oJ=Object.create(null);for(let[Z,$]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])oJ[Z]=tJ(S4,$);class x4{constructor(Z){this.extra=Z,this.table=Object.assign(Object.create(null),oJ)}resolve(Z){return!Z?0:this.table[Z]||(this.table[Z]=tJ(this.extra,Z))}}var DG=new x4(S4);function B4(Z,$){if(BJ.indexOf(Z)>-1)return;BJ.push(Z),console.warn($)}function tJ(Z,$){let J=[];for(let U of $.split(" ")){let q=[];for(let G of U.split(".")){let W=Z[G]||I[G];if(!W)B4(G,`Unknown highlighting tag ${G}`);else if(typeof W=="function")if(!q.length)B4(G,`Modifier ${G} used at start of tag`);else q=q.map(W);else if(q.length)B4(G,`Tag ${G} used as modifier`);else q=Array.isArray(W)?W:[W]}for(let G of q)J.push(G)}if(!J.length)return 0;let Y=$.replace(/ /g,"_"),X=Y+" "+J.map((U)=>U.id),Q=EJ[X];if(Q)return Q.id;let K=EJ[X]=p0.define({id:m3.length,name:Y,props:[VJ({[Y]:J})]});return m3.push(K),K.id}function LG(Z,$){let J=p0.define({id:m3.length,name:"Document",props:[d2.add(()=>Z),TJ.add(()=>(Y)=>$.getIndent(Y))],top:!0});return m3.push(J),J}var _O={rtl:g.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:Q0.RTL}),ltr:g.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:Q0.LTR}),auto:g.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})};var MG=(Z)=>{let{state:$}=Z,J=$.doc.lineAt($.selection.main.from),Y=f4(Z.state,J.from);return Y.line?AG(Z):Y.block?EG(Z):!1};function g4(Z,$){return({state:J,dispatch:Y})=>{if(J.readOnly)return!1;let X=Z($,J);if(!X)return!1;return Y(J.update(X)),!0}}var AG=g4(TG,0);var BG=g4(UY,0);var EG=g4((Z,$)=>UY(Z,$,CG($)),0);function f4(Z,$){let J=Z.languageDataAt("commentTokens",$,1);return J.length?J[0]:{}}var p3=50;function PG(Z,{open:$,close:J},Y,X){let Q=Z.sliceDoc(Y-p3,Y),K=Z.sliceDoc(X,X+p3),U=/\s*$/.exec(Q)[0].length,q=/^\s*/.exec(K)[0].length,G=Q.length-U;if(Q.slice(G-$.length,G)==$&&K.slice(q,q+J.length)==J)return{open:{pos:Y-U,margin:U&&1},close:{pos:X+q,margin:q&&1}};let W,j;if(X-Y<=2*p3)W=j=Z.sliceDoc(Y,X);else W=Z.sliceDoc(Y,Y+p3),j=Z.sliceDoc(X-p3,X);let _=/^\s*/.exec(W)[0].length,z=/\s*$/.exec(j)[0].length,V=j.length-z-J.length;if(W.slice(_,_+$.length)==$&&j.slice(V,V+J.length)==J)return{open:{pos:Y+_+$.length,margin:/\s/.test(W.charAt(_+$.length))?1:0},close:{pos:X-z-J.length,margin:/\s/.test(j.charAt(V-1))?1:0}};return null}function CG(Z){let $=[];for(let J of Z.selection.ranges){let Y=Z.doc.lineAt(J.from),X=J.to<=Y.to?Y:Z.doc.lineAt(J.to);if(X.from>Y.from&&X.from==J.to)X=J.to==Y.to+1?Y:Z.doc.lineAt(J.to-1);let Q=$.length-1;if(Q>=0&&$[Q].to>Y.from)$[Q].to=X.to;else $.push({from:Y.from+/^\s*/.exec(Y.text)[0].length,to:X.to})}return $}function UY(Z,$,J=$.selection.ranges){let Y=J.map((Q)=>f4($,Q.from).block);if(!Y.every((Q)=>Q))return null;let X=J.map((Q,K)=>PG($,Y[K],Q.from,Q.to));if(Z!=2&&!X.every((Q)=>Q))return{changes:$.changes(J.map((Q,K)=>{if(X[K])return[];return[{from:Q.from,insert:Y[K].open+" "},{from:Q.to,insert:" "+Y[K].close}]}))};else if(Z!=1&&X.some((Q)=>Q)){let Q=[];for(let K=0,U;K<X.length;K++)if(U=X[K]){let q=Y[K],{open:G,close:W}=U;Q.push({from:G.pos-q.open.length,to:G.pos+G.margin},{from:W.pos-W.margin,to:W.pos+q.close.length})}return{changes:Q}}return null}function TG(Z,$,J=$.selection.ranges){let Y=[],X=-1;for(let{from:Q,to:K}of J){let U=Y.length,q=1e9,G=f4($,Q).line;if(!G)continue;for(let W=Q;W<=K;){let j=$.doc.lineAt(W);if(j.from>X&&(Q==K||K>j.from)){X=j.from;let _=/^\s*/.exec(j.text)[0].length,z=_==j.length,V=j.text.slice(_,_+G.length)==G?_:-1;if(_<j.text.length&&_<q)q=_;Y.push({line:j,comment:V,token:G,indent:_,empty:z,single:!1})}W=j.to+1}if(q<1e9){for(let W=U;W<Y.length;W++)if(Y[W].indent<Y[W].line.text.length)Y[W].indent=q}if(Y.length==U+1)Y[U].single=!0}if(Z!=2&&Y.some((Q)=>Q.comment<0&&(!Q.empty||Q.single))){let Q=[];for(let{line:U,token:q,indent:G,empty:W,single:j}of Y)if(j||!W)Q.push({from:U.from+G,insert:q+" "});let K=$.changes(Q);return{changes:K,selection:$.selection.map(K,1)}}else if(Z!=1&&Y.some((Q)=>Q.comment>=0)){let Q=[];for(let{line:K,comment:U,token:q}of Y)if(U>=0){let G=K.from+U,W=G+q.length;if(K.text[W-K.from]==" ")W++;Q.push({from:G,to:W})}return{changes:Q}}return null}var w4=o0.define(),yG=o0.define(),bG=S.define(),qY=S.define({combine(Z){return u0(Z,{minDepth:100,newGroupDelay:500,joinToEvent:($,J)=>J},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:($,J)=>(Y,X)=>$(Y,X)||J(Y,X)})}}),GY=z0.define({create(){return w1.empty},update(Z,$){let J=$.state.facet(qY),Y=$.annotation(w4);if(Y){let q=s0.fromTransaction($,Y.selection),G=Y.side,W=G==0?Z.undone:Z.done;if(q)W=z9(W,W.length,J.minDepth,q);else W=zY(W,$.startState.selection);return new w1(G==0?Y.rest:W,G==0?W:Y.rest)}let X=$.annotation(yG);if(X=="full"||X=="before")Z=Z.isolate();if($.annotation(N0.addToHistory)===!1)return!$.changes.empty?Z.addMapping($.changes.desc):Z;let Q=s0.fromTransaction($),K=$.annotation(N0.time),U=$.annotation(N0.userEvent);if(Q)Z=Z.addChanges(Q,K,U,J,$);else if($.selection)Z=Z.addSelection($.startState.selection,K,U,J.newGroupDelay);if(X=="full"||X=="after")Z=Z.isolate();return Z},toJSON(Z){return{done:Z.done.map(($)=>$.toJSON()),undone:Z.undone.map(($)=>$.toJSON())}},fromJSON(Z){return new w1(Z.done.map(s0.fromJSON),Z.undone.map(s0.fromJSON))}});function WY(Z={}){return[GY,qY.of(Z),P.domEventHandlers({beforeinput($,J){let Y=$.inputType=="historyUndo"?jY:$.inputType=="historyRedo"?v4:null;if(!Y)return!1;return $.preventDefault(),Y(J)}})]}function O9(Z,$){return function({state:J,dispatch:Y}){if(!$&&J.readOnly)return!1;let X=J.field(GY,!1);if(!X)return!1;let Q=X.pop(Z,J,$);if(!Q)return!1;return Y(Q),!0}}var jY=O9(0,!1),v4=O9(1,!1),kG=O9(0,!0),SG=O9(1,!0);class s0{constructor(Z,$,J,Y,X){this.changes=Z,this.effects=$,this.mapped=J,this.startSelection=Y,this.selectionsAfter=X}setSelAfter(Z){return new s0(this.changes,this.effects,this.mapped,this.startSelection,Z)}toJSON(){var Z,$,J;return{changes:(Z=this.changes)===null||Z===void 0?void 0:Z.toJSON(),mapped:($=this.mapped)===null||$===void 0?void 0:$.toJSON(),startSelection:(J=this.startSelection)===null||J===void 0?void 0:J.toJSON(),selectionsAfter:this.selectionsAfter.map((Y)=>Y.toJSON())}}static fromJSON(Z){return new s0(Z.changes&&L0.fromJSON(Z.changes),[],Z.mapped&&H1.fromJSON(Z.mapped),Z.startSelection&&L.fromJSON(Z.startSelection),Z.selectionsAfter.map(L.fromJSON))}static fromTransaction(Z,$){let J=W1;for(let Y of Z.startState.facet(bG)){let X=Y(Z);if(X.length)J=J.concat(X)}if(!J.length&&Z.changes.empty)return null;return new s0(Z.changes.invert(Z.startState.doc),J,void 0,$||Z.startState.selection,W1)}static selection(Z){return new s0(void 0,W1,void 0,void 0,Z)}}function z9(Z,$,J,Y){let X=$+1>J+20?$-J-1:0,Q=Z.slice(X,$);return Q.push(Y),Q}function xG(Z,$){let J=[],Y=!1;return Z.iterChangedRanges((X,Q)=>J.push(X,Q)),$.iterChangedRanges((X,Q,K,U)=>{for(let q=0;q<J.length;){let G=J[q++],W=J[q++];if(U>=G&&K<=W)Y=!0}}),Y}function hG(Z,$){return Z.ranges.length==$.ranges.length&&Z.ranges.filter((J,Y)=>J.empty!=$.ranges[Y].empty).length===0}function _Y(Z,$){return!Z.length?$:!$.length?Z:Z.concat($)}var W1=[],wG=200;function zY(Z,$){if(!Z.length)return[s0.selection([$])];else{let J=Z[Z.length-1],Y=J.selectionsAfter.slice(Math.max(0,J.selectionsAfter.length-wG));if(Y.length&&Y[Y.length-1].eq($))return Z;return Y.push($),z9(Z,Z.length-1,1e9,J.setSelAfter(Y))}}function vG(Z){let $=Z[Z.length-1],J=Z.slice();return J[Z.length-1]=$.setSelAfter($.selectionsAfter.slice(0,$.selectionsAfter.length-1)),J}function h4(Z,$){if(!Z.length)return Z;let J=Z.length,Y=W1;while(J){let X=uG(Z[J-1],$,Y);if(X.changes&&!X.changes.empty||X.effects.length){let Q=Z.slice(0,J);return Q[J-1]=X,Q}else $=X.mapped,J--,Y=X.selectionsAfter}return Y.length?[s0.selection(Y)]:W1}function uG(Z,$,J){let Y=_Y(Z.selectionsAfter.length?Z.selectionsAfter.map((U)=>U.map($)):W1,J);if(!Z.changes)return s0.selection(Y);let X=Z.changes.map($),Q=$.mapDesc(Z.changes,!0),K=Z.mapped?Z.mapped.composeDesc(Q):Q;return new s0(X,l.mapEffects(Z.effects,$),K,Z.startSelection.map(Q),Y)}var mG=/^(input\.type|delete)($|\.)/;class w1{constructor(Z,$,J=0,Y=void 0){this.done=Z,this.undone=$,this.prevTime=J,this.prevUserEvent=Y}isolate(){return this.prevTime?new w1(this.done,this.undone):this}addChanges(Z,$,J,Y,X){let Q=this.done,K=Q[Q.length-1];if(K&&K.changes&&!K.changes.empty&&Z.changes&&(!J||mG.test(J))&&(!K.selectionsAfter.length&&$-this.prevTime<Y.newGroupDelay&&Y.joinToEvent(X,xG(K.changes,Z.changes))||J=="input.type.compose"))Q=z9(Q,Q.length-1,Y.minDepth,new s0(Z.changes.compose(K.changes),_Y(l.mapEffects(Z.effects,K.changes),K.effects),K.mapped,K.startSelection,W1));else Q=z9(Q,Q.length,Y.minDepth,Z);return new w1(Q,W1,$,J)}addSelection(Z,$,J,Y){let X=this.done.length?this.done[this.done.length-1].selectionsAfter:W1;if(X.length>0&&$-this.prevTime<Y&&J==this.prevUserEvent&&J&&/^select($|\.)/.test(J)&&hG(X[X.length-1],Z))return this;return new w1(zY(this.done,Z),this.undone,$,J)}addMapping(Z){return new w1(h4(this.done,Z),h4(this.undone,Z),this.prevTime,this.prevUserEvent)}pop(Z,$,J){let Y=Z==0?this.done:this.undone;if(Y.length==0)return null;let X=Y[Y.length-1],Q=X.selectionsAfter[0]||$.selection;if(J&&X.selectionsAfter.length)return $.update({selection:X.selectionsAfter[X.selectionsAfter.length-1],annotations:w4.of({side:Z,rest:vG(Y),selection:Q}),userEvent:Z==0?"select.undo":"select.redo",scrollIntoView:!0});else if(!X.changes)return null;else{let K=Y.length==1?W1:Y.slice(0,Y.length-1);if(X.mapped)K=h4(K,X.mapped);return $.update({changes:X.changes,selection:X.startSelection,effects:X.effects,annotations:w4.of({side:Z,rest:K,selection:Q}),filter:!1,userEvent:Z==0?"undo":"redo",scrollIntoView:!0})}}}w1.empty=new w1(W1,W1);var OY=[{key:"Mod-z",run:jY,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:v4,preventDefault:!0},{linux:"Ctrl-Shift-z",run:v4,preventDefault:!0},{key:"Mod-u",run:kG,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:SG,preventDefault:!0}];function a2(Z,$){return L.create(Z.ranges.map($),Z.mainIndex)}function B1(Z,$){return Z.update({selection:$,scrollIntoView:!0,userEvent:"select"})}function E1({state:Z,dispatch:$},J){let Y=a2(Z.selection,J);if(Y.eq(Z.selection,!0))return!1;return $(B1(Z,Y)),!0}function V9(Z,$){return L.cursor($?Z.to:Z.from)}function VY(Z,$){return E1(Z,(J)=>J.empty?Z.moveByChar(J,$):V9(J,$))}function m0(Z){return Z.textDirectionAt(Z.state.selection.main.head)==Q0.LTR}var HY=(Z)=>VY(Z,!m0(Z)),NY=(Z)=>VY(Z,m0(Z));function RY(Z,$){return E1(Z,(J)=>J.empty?Z.moveByGroup(J,$):V9(J,$))}var gG=(Z)=>RY(Z,!m0(Z)),fG=(Z)=>RY(Z,m0(Z));var LO=typeof Intl<"u"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function pG(Z,$,J){if($.type.prop(J))return!0;let Y=$.to-$.from;return Y&&(Y>2||/[^\s,.;:]/.test(Z.sliceDoc($.from,$.to)))||$.firstChild}function H9(Z,$,J){let Y=E0(Z).resolveInner($.head),X=J?o.closedBy:o.openedBy;for(let q=$.head;;){let G=J?Y.childAfter(q):Y.childBefore(q);if(!G)break;if(pG(Z,G,X))Y=G;else q=J?G.to:G.from}let Q=Y.type.prop(X),K,U;if(Q&&(K=J?A1(Z,Y.from,1):A1(Z,Y.to,-1))&&K.matched)U=J?K.end.to:K.end.from;else U=J?Y.to:Y.from;return L.cursor(U,J?-1:1)}var lG=(Z)=>E1(Z,($)=>H9(Z.state,$,!m0(Z))),dG=(Z)=>E1(Z,($)=>H9(Z.state,$,m0(Z)));function FY(Z,$){return E1(Z,(J)=>{if(!J.empty)return V9(J,$);let Y=Z.moveVertically(J,$);return Y.head!=J.head?Y:Z.moveToLineBoundary(J,$)})}var IY=(Z)=>FY(Z,!1),DY=(Z)=>FY(Z,!0);function LY(Z){let $=Z.scrollDOM.clientHeight<Z.scrollDOM.scrollHeight-2,J=0,Y=0,X;if($){for(let Q of Z.state.facet(P.scrollMargins)){let K=Q(Z);if(K===null||K===void 0?void 0:K.top)J=Math.max(K===null||K===void 0?void 0:K.top,J);if(K===null||K===void 0?void 0:K.bottom)Y=Math.max(K===null||K===void 0?void 0:K.bottom,Y)}X=Z.scrollDOM.clientHeight-J-Y}else X=(Z.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:J,marginBottom:Y,selfScroll:$,height:Math.max(Z.defaultLineHeight,X-5)}}function MY(Z,$){let J=LY(Z),{state:Y}=Z,X=a2(Y.selection,(K)=>{return K.empty?Z.moveVertically(K,$,J.height):V9(K,$)});if(X.eq(Y.selection))return!1;let Q;if(J.selfScroll){let K=Z.coordsAtPos(Y.selection.main.head),U=Z.scrollDOM.getBoundingClientRect(),q=U.top+J.marginTop,G=U.bottom-J.marginBottom;if(K&&K.top>q&&K.bottom<G)Q=P.scrollIntoView(X.main.head,{y:"start",yMargin:K.top-q})}return Z.dispatch(B1(Y,X),{effects:Q}),!0}var eJ=(Z)=>MY(Z,!1),u4=(Z)=>MY(Z,!0);function $2(Z,$,J){let Y=Z.lineBlockAt($.head),X=Z.moveToLineBoundary($,J);if(X.head==$.head&&X.head!=(J?Y.to:Y.from))X=Z.moveToLineBoundary($,J,!1);if(!J&&X.head==Y.from&&Y.length){let Q=/^\s*/.exec(Z.state.sliceDoc(Y.from,Math.min(Y.from+100,Y.to)))[0].length;if(Q&&$.head!=Y.from+Q)X=L.cursor(Y.from+Q)}return X}var cG=(Z)=>E1(Z,($)=>$2(Z,$,!0)),sG=(Z)=>E1(Z,($)=>$2(Z,$,!1)),nG=(Z)=>E1(Z,($)=>$2(Z,$,!m0(Z))),iG=(Z)=>E1(Z,($)=>$2(Z,$,m0(Z))),rG=(Z)=>E1(Z,($)=>L.cursor(Z.lineBlockAt($.head).from,1)),aG=(Z)=>E1(Z,($)=>L.cursor(Z.lineBlockAt($.head).to,-1));function oG(Z,$,J){let Y=!1,X=a2(Z.selection,(Q)=>{let K=A1(Z,Q.head,-1)||A1(Z,Q.head,1)||Q.head>0&&A1(Z,Q.head-1,1)||Q.head<Z.doc.length&&A1(Z,Q.head+1,-1);if(!K||!K.end)return Q;Y=!0;let U=K.start.from==Q.head?K.end.to:K.end.from;return J?L.range(Q.anchor,U):L.cursor(U)});if(!Y)return!1;return $(B1(Z,X)),!0}var tG=({state:Z,dispatch:$})=>oG(Z,$,!1);function j1(Z,$){let J=a2(Z.state.selection,(Y)=>{let X=$(Y);return L.range(Y.anchor,X.head,X.goalColumn,X.bidiLevel||void 0)});if(J.eq(Z.state.selection))return!1;return Z.dispatch(B1(Z.state,J)),!0}function AY(Z,$){return j1(Z,(J)=>Z.moveByChar(J,$))}var BY=(Z)=>AY(Z,!m0(Z)),EY=(Z)=>AY(Z,m0(Z));function PY(Z,$){return j1(Z,(J)=>Z.moveByGroup(J,$))}var eG=(Z)=>PY(Z,!m0(Z)),ZW=(Z)=>PY(Z,m0(Z));var $W=(Z)=>j1(Z,($)=>H9(Z.state,$,!m0(Z))),JW=(Z)=>j1(Z,($)=>H9(Z.state,$,m0(Z)));function CY(Z,$){return j1(Z,(J)=>Z.moveVertically(J,$))}var TY=(Z)=>CY(Z,!1),yY=(Z)=>CY(Z,!0);function bY(Z,$){return j1(Z,(J)=>Z.moveVertically(J,$,LY(Z).height))}var ZY=(Z)=>bY(Z,!1),$Y=(Z)=>bY(Z,!0),YW=(Z)=>j1(Z,($)=>$2(Z,$,!0)),XW=(Z)=>j1(Z,($)=>$2(Z,$,!1)),QW=(Z)=>j1(Z,($)=>$2(Z,$,!m0(Z))),KW=(Z)=>j1(Z,($)=>$2(Z,$,m0(Z))),UW=(Z)=>j1(Z,($)=>L.cursor(Z.lineBlockAt($.head).from)),qW=(Z)=>j1(Z,($)=>L.cursor(Z.lineBlockAt($.head).to)),JY=({state:Z,dispatch:$})=>{return $(B1(Z,{anchor:0})),!0},YY=({state:Z,dispatch:$})=>{return $(B1(Z,{anchor:Z.doc.length})),!0},XY=({state:Z,dispatch:$})=>{return $(B1(Z,{anchor:Z.selection.main.anchor,head:0})),!0},QY=({state:Z,dispatch:$})=>{return $(B1(Z,{anchor:Z.selection.main.anchor,head:Z.doc.length})),!0},GW=({state:Z,dispatch:$})=>{return $(Z.update({selection:{anchor:0,head:Z.doc.length},userEvent:"select"})),!0},WW=({state:Z,dispatch:$})=>{let J=N9(Z).map(({from:Y,to:X})=>L.range(Y,Math.min(X+1,Z.doc.length)));return $(Z.update({selection:L.create(J),userEvent:"select"})),!0},jW=({state:Z,dispatch:$})=>{let J=a2(Z.selection,(Y)=>{let X=E0(Z),Q=X.resolveStack(Y.from,1);if(Y.empty){let K=X.resolveStack(Y.from,-1);if(K.node.from>=Q.node.from&&K.node.to<=Q.node.to)Q=K}for(let K=Q;K;K=K.next){let{node:U}=K;if((U.from<Y.from&&U.to>=Y.to||U.to>Y.to&&U.from<=Y.from)&&K.next)return L.range(U.to,U.from)}return Y});if(J.eq(Z.selection))return!1;return $(B1(Z,J)),!0};function kY(Z,$){let{state:J}=Z,Y=J.selection,X=J.selection.ranges.slice();for(let Q of J.selection.ranges){let K=J.doc.lineAt(Q.head);if($?K.to<Z.state.doc.length:K.from>0)for(let U=Q;;){let q=Z.moveVertically(U,$);if(q.head<K.from||q.head>K.to){if(!X.some((G)=>G.head==q.head))X.push(q);break}else if(q.head==U.head)break;else U=q}}if(X.length==Y.ranges.length)return!1;return Z.dispatch(B1(J,L.create(X,X.length-1))),!0}var _W=(Z)=>kY(Z,!1),zW=(Z)=>kY(Z,!0),OW=({state:Z,dispatch:$})=>{let J=Z.selection,Y=null;if(J.ranges.length>1)Y=L.create([J.main]);else if(!J.main.empty)Y=L.create([L.cursor(J.main.head)]);if(!Y)return!1;return $(B1(Z,Y)),!0};function l3(Z,$){if(Z.state.readOnly)return!1;let J="delete.selection",{state:Y}=Z,X=Y.changeByRange((Q)=>{let{from:K,to:U}=Q;if(K==U){let q=$(Q);if(q<K)J="delete.backward",q=_9(Z,q,!1);else if(q>K)J="delete.forward",q=_9(Z,q,!0);K=Math.min(K,q),U=Math.max(U,q)}else K=_9(Z,K,!1),U=_9(Z,U,!0);return K==U?{range:Q}:{changes:{from:K,to:U},range:L.cursor(K,K<Q.head?-1:1)}});if(X.changes.empty)return!1;return Z.dispatch(Y.update(X,{scrollIntoView:!0,userEvent:J,effects:J=="delete.selection"?P.announce.of(Y.phrase("Selection deleted")):void 0})),!0}function _9(Z,$,J){if(Z instanceof P)for(let Y of Z.state.facet(P.atomicRanges).map((X)=>X(Z)))Y.between($,$,(X,Q)=>{if(X<$&&Q>$)$=J?Q:X});return $}var SY=(Z,$,J)=>l3(Z,(Y)=>{let X=Y.from,{state:Q}=Z,K=Q.doc.lineAt(X),U,q;if(J&&!$&&X>K.from&&X<K.from+200&&!/[^ \t]/.test(U=K.text.slice(0,X-K.from))){if(U[U.length-1]=="\t")return X-1;let G=u1(U,Q.tabSize),W=G%Z2(Q)||Z2(Q);for(let j=0;j<W&&U[U.length-1-j]==" ";j++)X--;q=X}else if(q=R0(K.text,X-K.from,$,$)+K.from,q==X&&K.number!=($?Q.doc.lines:1))q+=$?1:-1;else if(!$&&/[\ufe00-\ufe0f]/.test(K.text.slice(q-K.from,X-K.from)))q=R0(K.text,q-K.from,!1,!1)+K.from;return q}),m4=(Z)=>SY(Z,!1,!0);var xY=(Z)=>SY(Z,!0,!1),hY=(Z,$)=>l3(Z,(J)=>{let Y=J.head,{state:X}=Z,Q=X.doc.lineAt(Y),K=X.charCategorizer(Y);for(let U=null;;){if(Y==($?Q.to:Q.from)){if(Y==J.head&&Q.number!=($?X.doc.lines:1))Y+=$?1:-1;break}let q=R0(Q.text,Y-Q.from,$)+Q.from,G=Q.text.slice(Math.min(Y,q)-Q.from,Math.max(Y,q)-Q.from),W=K(G);if(U!=null&&W!=U)break;if(G!=" "||Y!=J.head)U=W;Y=q}return Y}),wY=(Z)=>hY(Z,!1),VW=(Z)=>hY(Z,!0);var HW=(Z)=>l3(Z,($)=>{let J=Z.lineBlockAt($.head).to;return $.head<J?J:Math.min(Z.state.doc.length,$.head+1)});var NW=(Z)=>l3(Z,($)=>{let J=Z.moveToLineBoundary($,!1).head;return $.head>J?J:Math.max(0,$.head-1)}),RW=(Z)=>l3(Z,($)=>{let J=Z.moveToLineBoundary($,!0).head;return $.head<J?J:Math.min(Z.state.doc.length,$.head+1)});var FW=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let J=Z.changeByRange((Y)=>{return{changes:{from:Y.from,to:Y.to,insert:Z0.of(["",""])},range:L.cursor(Y.from)}});return $(Z.update(J,{scrollIntoView:!0,userEvent:"input"})),!0},IW=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let J=Z.changeByRange((Y)=>{if(!Y.empty||Y.from==0||Y.from==Z.doc.length)return{range:Y};let X=Y.from,Q=Z.doc.lineAt(X),K=X==Q.from?X-1:R0(Q.text,X-Q.from,!1)+Q.from,U=X==Q.to?X+1:R0(Q.text,X-Q.from,!0)+Q.from;return{changes:{from:K,to:U,insert:Z.doc.slice(X,U).append(Z.doc.slice(K,X))},range:L.cursor(U)}});if(J.changes.empty)return!1;return $(Z.update(J,{scrollIntoView:!0,userEvent:"move.character"})),!0};function N9(Z){let $=[],J=-1;for(let Y of Z.selection.ranges){let X=Z.doc.lineAt(Y.from),Q=Z.doc.lineAt(Y.to);if(!Y.empty&&Y.to==Q.from)Q=Z.doc.lineAt(Y.to-1);if(J>=X.number){let K=$[$.length-1];K.to=Q.to,K.ranges.push(Y)}else $.push({from:X.from,to:Q.to,ranges:[Y]});J=Q.number+1}return $}function vY(Z,$,J){if(Z.readOnly)return!1;let Y=[],X=[];for(let Q of N9(Z)){if(J?Q.to==Z.doc.length:Q.from==0)continue;let K=Z.doc.lineAt(J?Q.to+1:Q.from-1),U=K.length+1;if(J){Y.push({from:Q.to,to:K.to},{from:Q.from,insert:K.text+Z.lineBreak});for(let q of Q.ranges)X.push(L.range(Math.min(Z.doc.length,q.anchor+U),Math.min(Z.doc.length,q.head+U)))}else{Y.push({from:K.from,to:Q.from},{from:Q.to,insert:Z.lineBreak+K.text});for(let q of Q.ranges)X.push(L.range(q.anchor-U,q.head-U))}}if(!Y.length)return!1;return $(Z.update({changes:Y,scrollIntoView:!0,selection:L.create(X,Z.selection.mainIndex),userEvent:"move.line"})),!0}var DW=({state:Z,dispatch:$})=>vY(Z,$,!1),LW=({state:Z,dispatch:$})=>vY(Z,$,!0);function uY(Z,$,J){if(Z.readOnly)return!1;let Y=[];for(let Q of N9(Z))if(J)Y.push({from:Q.from,insert:Z.doc.slice(Q.from,Q.to)+Z.lineBreak});else Y.push({from:Q.to,insert:Z.lineBreak+Z.doc.slice(Q.from,Q.to)});let X=Z.changes(Y);return $(Z.update({changes:X,selection:Z.selection.map(X,J?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}var MW=({state:Z,dispatch:$})=>uY(Z,$,!1),AW=({state:Z,dispatch:$})=>uY(Z,$,!0),BW=(Z)=>{if(Z.state.readOnly)return!1;let{state:$}=Z,J=$.changes(N9($).map(({from:X,to:Q})=>{if(X>0)X--;else if(Q<$.doc.length)Q++;return{from:X,to:Q}})),Y=a2($.selection,(X)=>{let Q=void 0;if(Z.lineWrapping){let K=Z.lineBlockAt(X.head),U=Z.coordsAtPos(X.head,X.assoc||1);if(U)Q=K.bottom+Z.documentTop-U.bottom+Z.defaultLineHeight/2}return Z.moveVertically(X,!0,Q)}).map(J);return Z.dispatch({changes:J,selection:Y,scrollIntoView:!0,userEvent:"delete.line"}),!0};function EW(Z,$){if(/\(\)|\[\]|\{\}/.test(Z.sliceDoc($-1,$+1)))return{from:$,to:$};let J=E0(Z).resolveInner($),Y=J.childBefore($),X=J.childAfter($),Q;if(Y&&X&&Y.to<=$&&X.from>=$&&(Q=Y.type.prop(o.closedBy))&&Q.indexOf(X.name)>-1&&Z.doc.lineAt(Y.to).from==Z.doc.lineAt(X.from).from&&!/\S/.test(Z.sliceDoc(Y.to,X.from)))return{from:Y.to,to:X.from};return null}var KY=mY(!1),PW=mY(!0);function mY(Z){return({state:$,dispatch:J})=>{if($.readOnly)return!1;let Y=$.changeByRange((X)=>{let{from:Q,to:K}=X,U=$.doc.lineAt(Q),q=!Z&&Q==K&&EW($,Q);if(Z)Q=K=(K<=U.to?U:$.doc.lineAt(K)).to;let G=new i2($,{simulateBreak:Q,simulateDoubleBreak:!!q}),W=G9(G,Q);if(W==null)W=u1(/^\s*/.exec($.doc.lineAt(Q).text)[0],$.tabSize);while(K<U.to&&/\s/.test(U.text[K-U.from]))K++;if(q)({from:Q,to:K}=q);else if(Q>U.from&&Q<U.from+100&&!/\S/.test(U.text.slice(0,Q)))Q=U.from;let j=["",n2($,W)];if(q)j.push(n2($,G.lineIndent(U.from,-1)));return{changes:{from:Q,to:K,insert:Z0.of(j)},range:L.cursor(Q+1+j[1].length)}});return J($.update(Y,{scrollIntoView:!0,userEvent:"input"})),!0}}function p4(Z,$){let J=-1;return Z.changeByRange((Y)=>{let X=[];for(let K=Y.from;K<=Y.to;){let U=Z.doc.lineAt(K);if(U.number>J&&(Y.empty||Y.to>U.from))$(U,X,Y),J=U.number;K=U.to+1}let Q=Z.changes(X);return{changes:X,range:L.range(Q.mapPos(Y.anchor,1),Q.mapPos(Y.head,1))}})}var CW=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let J=Object.create(null),Y=new i2(Z,{overrideIndentation:(Q)=>{let K=J[Q];return K==null?-1:K}}),X=p4(Z,(Q,K,U)=>{let q=G9(Y,Q.from);if(q==null)return;if(!/\S/.test(Q.text))q=0;let G=/^\s*/.exec(Q.text)[0],W=n2(Z,q);if(G!=W||U.from<Q.from+G.length)J[Q.from]=q,K.push({from:Q.from,to:Q.from+G.length,insert:W})});if(!X.changes.empty)$(Z.update(X,{userEvent:"indent"}));return!0},gY=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;return $(Z.update(p4(Z,(J,Y)=>{Y.push({from:J.from,insert:Z.facet(g3)})}),{userEvent:"input.indent"})),!0},fY=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;return $(Z.update(p4(Z,(J,Y)=>{let X=/^\s*/.exec(J.text)[0];if(!X)return;let Q=u1(X,Z.tabSize),K=0,U=n2(Z,Math.max(0,Q-Z2(Z)));while(K<X.length&&K<U.length&&X.charCodeAt(K)==U.charCodeAt(K))K++;Y.push({from:J.from+K,to:J.from+X.length,insert:U.slice(K)})}),{userEvent:"delete.dedent"})),!0},TW=(Z)=>{return Z.setTabFocusMode(),!0};var yW=[{key:"Ctrl-b",run:HY,shift:BY,preventDefault:!0},{key:"Ctrl-f",run:NY,shift:EY},{key:"Ctrl-p",run:IY,shift:TY},{key:"Ctrl-n",run:DY,shift:yY},{key:"Ctrl-a",run:rG,shift:UW},{key:"Ctrl-e",run:aG,shift:qW},{key:"Ctrl-d",run:xY},{key:"Ctrl-h",run:m4},{key:"Ctrl-k",run:HW},{key:"Ctrl-Alt-h",run:wY},{key:"Ctrl-o",run:FW},{key:"Ctrl-t",run:IW},{key:"Ctrl-v",run:u4}],bW=[{key:"ArrowLeft",run:HY,shift:BY,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:gG,shift:eG,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:nG,shift:QW,preventDefault:!0},{key:"ArrowRight",run:NY,shift:EY,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:fG,shift:ZW,preventDefault:!0},{mac:"Cmd-ArrowRight",run:iG,shift:KW,preventDefault:!0},{key:"ArrowUp",run:IY,shift:TY,preventDefault:!0},{mac:"Cmd-ArrowUp",run:JY,shift:XY},{mac:"Ctrl-ArrowUp",run:eJ,shift:ZY},{key:"ArrowDown",run:DY,shift:yY,preventDefault:!0},{mac:"Cmd-ArrowDown",run:YY,shift:QY},{mac:"Ctrl-ArrowDown",run:u4,shift:$Y},{key:"PageUp",run:eJ,shift:ZY},{key:"PageDown",run:u4,shift:$Y},{key:"Home",run:sG,shift:XW,preventDefault:!0},{key:"Mod-Home",run:JY,shift:XY},{key:"End",run:cG,shift:YW,preventDefault:!0},{key:"Mod-End",run:YY,shift:QY},{key:"Enter",run:KY,shift:KY},{key:"Mod-a",run:GW},{key:"Backspace",run:m4,shift:m4,preventDefault:!0},{key:"Delete",run:xY,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:wY,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:VW,preventDefault:!0},{mac:"Mod-Backspace",run:NW,preventDefault:!0},{mac:"Mod-Delete",run:RW,preventDefault:!0}].concat(yW.map((Z)=>({mac:Z.key,run:Z.run,shift:Z.shift}))),R9=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:lG,shift:$W},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:dG,shift:JW},{key:"Alt-ArrowUp",run:DW},{key:"Shift-Alt-ArrowUp",run:MW},{key:"Alt-ArrowDown",run:LW},{key:"Shift-Alt-ArrowDown",run:AW},{key:"Mod-Alt-ArrowUp",run:_W},{key:"Mod-Alt-ArrowDown",run:zW},{key:"Escape",run:OW},{key:"Mod-Enter",run:PW},{key:"Alt-l",mac:"Ctrl-l",run:WW},{key:"Mod-i",run:jW,preventDefault:!0},{key:"Mod-[",run:fY},{key:"Mod-]",run:gY},{key:"Mod-Alt-\\",run:CW},{key:"Shift-Mod-k",run:BW},{key:"Shift-Mod-\\",run:tG},{key:"Mod-/",run:MG},{key:"Alt-A",run:BG},{key:"Ctrl-m",mac:"Shift-Alt-m",run:TW}].concat(bW),pY={key:"Tab",run:gY,shift:fY};var lY=typeof String.prototype.normalize=="function"?(Z)=>Z.normalize("NFKD"):(Z)=>Z;class D2{constructor(Z,$,J=0,Y=Z.length,X,Q){this.test=Q,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=Z.iterRange(J,Y),this.bufferStart=J,this.normalize=X?(K)=>X(lY(K)):lY,this.query=this.normalize($)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return S0(this.buffer,this.bufferPos)}next(){while(this.matches.length)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let Z=this.peek();if(Z<0)return this.done=!0,this;let $=_3(Z),J=this.bufferStart+this.bufferPos;this.bufferPos+=a0(Z);let Y=this.normalize($);if(Y.length)for(let X=0,Q=J;;X++){let K=Y.charCodeAt(X),U=this.match(K,Q,this.bufferPos+this.bufferStart);if(X==Y.length-1){if(U)return this.value=U,this;break}if(Q==J&&X<$.length&&$.charCodeAt(X)==K)Q++}}}match(Z,$,J){let Y=null;for(let X=0;X<this.matches.length;X+=2){let Q=this.matches[X],K=!1;if(this.query.charCodeAt(Q)==Z)if(Q==this.query.length-1)Y={from:this.matches[X+1],to:J};else this.matches[X]++,K=!0;if(!K)this.matches.splice(X,2),X-=2}if(this.query.charCodeAt(0)==Z)if(this.query.length==1)Y={from:$,to:J};else this.matches.push(1,$);if(Y&&this.test&&!this.test(Y.from,Y.to,this.buffer,this.bufferStart))Y=null;return Y}}if(typeof Symbol<"u")D2.prototype[Symbol.iterator]=function(){return this};var sY={from:-1,to:-1,match:/.*/.exec("")},c4="gm"+(/x/.unicode==null?"":"u");class s4{constructor(Z,$,J,Y=0,X=Z.length){if(this.text=Z,this.to=X,this.curLine="",this.done=!1,this.value=sY,/\\[sWDnr]|\n|\r|\[\^/.test($))return new n4(Z,$,J,Y,X);this.re=new RegExp($,c4+((J===null||J===void 0?void 0:J.ignoreCase)?"i":"")),this.test=J===null||J===void 0?void 0:J.test,this.iter=Z.iter();let Q=Z.lineAt(Y);this.curLineStart=Q.from,this.matchPos=L9(Z,Y),this.getLine(this.curLineStart)}getLine(Z){if(this.iter.next(Z),this.iter.lineBreak)this.curLine="";else{if(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to)this.curLine=this.curLine.slice(0,this.to-this.curLineStart);this.iter.next()}}nextLine(){if(this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to)this.curLine="";else this.getLine(0)}next(){for(let Z=this.matchPos-this.curLineStart;;){this.re.lastIndex=Z;let $=this.matchPos<=this.to&&this.re.exec(this.curLine);if($){let J=this.curLineStart+$.index,Y=J+$[0].length;if(this.matchPos=L9(this.text,Y+(J==Y?1:0)),J==this.curLineStart+this.curLine.length)this.nextLine();if((J<Y||J>this.value.to)&&(!this.test||this.test(J,Y,$)))return this.value={from:J,to:Y,match:$},this;Z=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),Z=0;else return this.done=!0,this}}}var l4=new WeakMap;class e2{constructor(Z,$){this.from=Z,this.text=$}get to(){return this.from+this.text.length}static get(Z,$,J){let Y=l4.get(Z);if(!Y||Y.from>=J||Y.to<=$){let K=new e2($,Z.sliceString($,J));return l4.set(Z,K),K}if(Y.from==$&&Y.to==J)return Y;let{text:X,from:Q}=Y;if(Q>$)X=Z.sliceString($,Q)+X,Q=$;if(Y.to<J)X+=Z.sliceString(Y.to,J);return l4.set(Z,new e2(Q,X)),new e2($,X.slice($-Q,J-Q))}}class n4{constructor(Z,$,J,Y,X){this.text=Z,this.to=X,this.done=!1,this.value=sY,this.matchPos=L9(Z,Y),this.re=new RegExp($,c4+((J===null||J===void 0?void 0:J.ignoreCase)?"i":"")),this.test=J===null||J===void 0?void 0:J.test,this.flat=e2.get(Z,Y,this.chunkEnd(Y+5000))}chunkEnd(Z){return Z>=this.to?this.to:this.text.lineAt(Z).to}next(){for(;;){let Z=this.re.lastIndex=this.matchPos-this.flat.from,$=this.re.exec(this.flat.text);if($&&!$[0]&&$.index==Z)this.re.lastIndex=Z+1,$=this.re.exec(this.flat.text);if($){let J=this.flat.from+$.index,Y=J+$[0].length;if((this.flat.to>=this.to||$.index+$[0].length<=this.flat.text.length-10)&&(!this.test||this.test(J,Y,$)))return this.value={from:J,to:Y,match:$},this.matchPos=L9(this.text,Y+(J==Y?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=e2.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}if(typeof Symbol<"u")s4.prototype[Symbol.iterator]=n4.prototype[Symbol.iterator]=function(){return this};function kW(Z){try{return new RegExp(Z,c4),!0}catch($){return!1}}function L9(Z,$){if($>=Z.length)return $;let J=Z.lineAt($),Y;while($<J.to&&(Y=J.text.charCodeAt($-J.from))>=56320&&Y<57344)$++;return $}var SW=(Z)=>{let{state:$}=Z,J=String($.doc.lineAt(Z.state.selection.main.head).number),{close:Y,result:X}=t$(Z,{label:$.phrase("Go to line"),input:{type:"text",name:"line",value:J},focus:!0,submitLabel:$.phrase("go")});return X.then((Q)=>{let K=Q&&/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(Q.elements.line.value);if(!K){Z.dispatch({effects:Y});return}let U=$.doc.lineAt($.selection.main.head),[,q,G,W,j]=K,_=W?+W.slice(1):0,z=G?+G:U.number;if(G&&j){let H=z/100;if(q)H=H*(q=="-"?-1:1)+U.number/$.doc.lines;z=Math.round($.doc.lines*H)}else if(G&&q)z=z*(q=="-"?-1:1)+U.number;let V=$.doc.line(Math.max(1,Math.min($.doc.lines,z))),O=L.cursor(V.from+Math.max(0,Math.min(_,V.length)));Z.dispatch({effects:[Y,P.scrollIntoView(O.from,{y:"center"})],selection:O})}),!0},xW={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},nY=S.define({combine(Z){return u0(Z,xW,{highlightWordAroundCursor:($,J)=>$||J,minSelectionLength:Math.min,maxMatches:Math.min})}});function iY(Z){let $=[mW,uW];if(Z)$.push(nY.of(Z));return $}var hW=g.mark({class:"cm-selectionMatch"}),wW=g.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function dY(Z,$,J,Y){return(J==0||Z($.sliceDoc(J-1,J))!=K0.Word)&&(Y==$.doc.length||Z($.sliceDoc(Y,Y+1))!=K0.Word)}function vW(Z,$,J,Y){return Z($.sliceDoc(J,J+1))==K0.Word&&Z($.sliceDoc(Y-1,Y))==K0.Word}var uW=_0.fromClass(class{constructor(Z){this.decorations=this.getDeco(Z)}update(Z){if(Z.selectionSet||Z.docChanged||Z.viewportChanged)this.decorations=this.getDeco(Z.view)}getDeco(Z){let $=Z.state.facet(nY),{state:J}=Z,Y=J.selection;if(Y.ranges.length>1)return g.none;let X=Y.main,Q,K=null;if(X.empty){if(!$.highlightWordAroundCursor)return g.none;let q=J.wordAt(X.head);if(!q)return g.none;K=J.charCategorizer(X.head),Q=J.sliceDoc(q.from,q.to)}else{let q=X.to-X.from;if(q<$.minSelectionLength||q>200)return g.none;if($.wholeWords){if(Q=J.sliceDoc(X.from,X.to),K=J.charCategorizer(X.head),!(dY(K,J,X.from,X.to)&&vW(K,J,X.from,X.to)))return g.none}else if(Q=J.sliceDoc(X.from,X.to),!Q)return g.none}let U=[];for(let q of Z.visibleRanges){let G=new D2(J.doc,Q,q.from,q.to);while(!G.next().done){let{from:W,to:j}=G.value;if(!K||dY(K,J,W,j)){if(X.empty&&W<=X.from&&j>=X.to)U.push(wW.range(W,j));else if(W>=X.to||j<=X.from)U.push(hW.range(W,j));if(U.length>$.maxMatches)return g.none}}}return g.set(U)}},{decorations:(Z)=>Z.decorations}),mW=P.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),gW=({state:Z,dispatch:$})=>{let{selection:J}=Z,Y=L.create(J.ranges.map((X)=>Z.wordAt(X.head)||L.cursor(X.head)),J.mainIndex);if(Y.eq(J))return!1;return $(Z.update({selection:Y})),!0};function fW(Z,$){let{main:J,ranges:Y}=Z.selection,X=Z.wordAt(J.head),Q=X&&X.from==J.from&&X.to==J.to;for(let K=!1,U=new D2(Z.doc,$,Y[Y.length-1].to);;)if(U.next(),U.done){if(K)return null;U=new D2(Z.doc,$,0,Math.max(0,Y[Y.length-1].from-1)),K=!0}else{if(K&&Y.some((q)=>q.from==U.value.from))continue;if(Q){let q=Z.wordAt(U.value.from);if(!q||q.from!=U.value.from||q.to!=U.value.to)continue}return U.value}}var pW=({state:Z,dispatch:$})=>{let{ranges:J}=Z.selection;if(J.some((Q)=>Q.from===Q.to))return gW({state:Z,dispatch:$});let Y=Z.sliceDoc(J[0].from,J[0].to);if(Z.selection.ranges.some((Q)=>Z.sliceDoc(Q.from,Q.to)!=Y))return!1;let X=fW(Z,Y);if(!X)return!1;return $(Z.update({selection:Z.selection.addRange(L.range(X.from,X.to),!1),effects:P.scrollIntoView(X.to)})),!0},Z3=S.define({combine(Z){return u0(Z,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:($)=>new JX($),scrollToMatch:($)=>P.scrollIntoView($)})}});class i4{constructor(Z){this.search=Z.search,this.caseSensitive=!!Z.caseSensitive,this.literal=!!Z.literal,this.regexp=!!Z.regexp,this.replace=Z.replace||"",this.valid=!!this.search&&(!this.regexp||kW(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!Z.wholeWord,this.test=Z.test}unquote(Z){return this.literal?Z:Z.replace(/\\([nrt\\])/g,($,J)=>J=="n"?`
`:J=="r"?"\r":J=="t"?"\t":"\\")}eq(Z){return this.search==Z.search&&this.replace==Z.replace&&this.caseSensitive==Z.caseSensitive&&this.regexp==Z.regexp&&this.wholeWord==Z.wholeWord&&this.test==Z.test}create(){return this.regexp?new aY(this):new rY(this)}getCursor(Z,$=0,J){let Y=Z.doc?Z:i.create({doc:Z});if(J==null)J=Y.doc.length;return this.regexp?t2(this,Y,$,J):o2(this,Y,$,J)}}class r4{constructor(Z){this.spec=Z}}function lW(Z,$,J){return(Y,X,Q,K)=>{if(J&&!J(Y,X,Q,K))return!1;let U=Y>=K&&X<=K+Q.length?Q.slice(Y-K,X-K):$.doc.sliceString(Y,X);return Z(U,$,Y,X)}}function o2(Z,$,J,Y){let X;if(Z.wholeWord)X=dW($.doc,$.charCategorizer($.selection.main.head));if(Z.test)X=lW(Z.test,$,X);return new D2($.doc,Z.unquoted,J,Y,Z.caseSensitive?void 0:(Q)=>Q.toLowerCase(),X)}function dW(Z,$){return(J,Y,X,Q)=>{if(Q>J||Q+X.length<Y)Q=Math.max(0,J-2),X=Z.sliceString(Q,Math.min(Z.length,Y+2));return($(M9(X,J-Q))!=K0.Word||$(A9(X,J-Q))!=K0.Word)&&($(A9(X,Y-Q))!=K0.Word||$(M9(X,Y-Q))!=K0.Word)}}class rY extends r4{constructor(Z){super(Z)}nextMatch(Z,$,J){let Y=o2(this.spec,Z,J,Z.doc.length).nextOverlapping();if(Y.done){let X=Math.min(Z.doc.length,$+this.spec.unquoted.length);Y=o2(this.spec,Z,0,X).nextOverlapping()}return Y.done||Y.value.from==$&&Y.value.to==J?null:Y.value}prevMatchInRange(Z,$,J){for(let Y=J;;){let X=Math.max($,Y-1e4-this.spec.unquoted.length),Q=o2(this.spec,Z,X,Y),K=null;while(!Q.nextOverlapping().done)K=Q.value;if(K)return K;if(X==$)return null;Y-=1e4}}prevMatch(Z,$,J){let Y=this.prevMatchInRange(Z,0,$);if(!Y)Y=this.prevMatchInRange(Z,Math.max(0,J-this.spec.unquoted.length),Z.doc.length);return Y&&(Y.from!=$||Y.to!=J)?Y:null}getReplacement(Z){return this.spec.unquote(this.spec.replace)}matchAll(Z,$){let J=o2(this.spec,Z,0,Z.doc.length),Y=[];while(!J.next().done){if(Y.length>=$)return null;Y.push(J.value)}return Y}highlight(Z,$,J,Y){let X=o2(this.spec,Z,Math.max(0,$-this.spec.unquoted.length),Math.min(J+this.spec.unquoted.length,Z.doc.length));while(!X.next().done)Y(X.value.from,X.value.to)}}function cW(Z,$,J){return(Y,X,Q)=>{return(!J||J(Y,X,Q))&&Z(Q[0],$,Y,X)}}function t2(Z,$,J,Y){let X;if(Z.wholeWord)X=sW($.charCategorizer($.selection.main.head));if(Z.test)X=cW(Z.test,$,X);return new s4($.doc,Z.search,{ignoreCase:!Z.caseSensitive,test:X},J,Y)}function M9(Z,$){return Z.slice(R0(Z,$,!1),$)}function A9(Z,$){return Z.slice($,R0(Z,$))}function sW(Z){return($,J,Y)=>!Y[0].length||(Z(M9(Y.input,Y.index))!=K0.Word||Z(A9(Y.input,Y.index))!=K0.Word)&&(Z(A9(Y.input,Y.index+Y[0].length))!=K0.Word||Z(M9(Y.input,Y.index+Y[0].length))!=K0.Word)}class aY extends r4{nextMatch(Z,$,J){let Y=t2(this.spec,Z,J,Z.doc.length).next();if(Y.done)Y=t2(this.spec,Z,0,$).next();return Y.done?null:Y.value}prevMatchInRange(Z,$,J){for(let Y=1;;Y++){let X=Math.max($,J-Y*1e4),Q=t2(this.spec,Z,X,J),K=null;while(!Q.next().done)K=Q.value;if(K&&(X==$||K.from>X+10))return K;if(X==$)return null}}prevMatch(Z,$,J){return this.prevMatchInRange(Z,0,$)||this.prevMatchInRange(Z,J,Z.doc.length)}getReplacement(Z){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,($,J)=>{if(J=="&")return Z.match[0];if(J=="$")return"$";for(let Y=J.length;Y>0;Y--){let X=+J.slice(0,Y);if(X>0&&X<Z.match.length)return Z.match[X]+J.slice(Y)}return $})}matchAll(Z,$){let J=t2(this.spec,Z,0,Z.doc.length),Y=[];while(!J.next().done){if(Y.length>=$)return null;Y.push(J.value)}return Y}highlight(Z,$,J,Y){let X=t2(this.spec,Z,Math.max(0,$-250),Math.min(J+250,Z.doc.length));while(!X.next().done)Y(X.value.from,X.value.to)}}var d3=l.define(),a4=l.define(),J2=z0.define({create(Z){return new D9(d4(Z).create(),null)},update(Z,$){for(let J of $.effects)if(J.is(d3))Z=new D9(J.value.create(),Z.panel);else if(J.is(a4))Z=new D9(Z.query,J.value?o4:null);return Z},provide:(Z)=>H2.from(Z,($)=>$.panel)});class D9{constructor(Z,$){this.query=Z,this.panel=$}}var nW=g.mark({class:"cm-searchMatch"}),iW=g.mark({class:"cm-searchMatch cm-searchMatch-selected"}),rW=_0.fromClass(class{constructor(Z){this.view=Z,this.decorations=this.highlight(Z.state.field(J2))}update(Z){let $=Z.state.field(J2);if($!=Z.startState.field(J2)||Z.docChanged||Z.selectionSet||Z.viewportChanged)this.decorations=this.highlight($)}highlight({query:Z,panel:$}){if(!$||!Z.spec.valid)return g.none;let{view:J}=this,Y=new r0;for(let X=0,Q=J.visibleRanges,K=Q.length;X<K;X++){let{from:U,to:q}=Q[X];while(X<K-1&&q>Q[X+1].from-500)q=Q[++X].to;Z.highlight(J.state,U,q,(G,W)=>{let j=J.state.selection.ranges.some((_)=>_.from==G&&_.to==W);Y.add(G,W,j?iW:nW)})}return Y.finish()}},{decorations:(Z)=>Z.decorations});function c3(Z){return($)=>{let J=$.state.field(J2,!1);return J&&J.query.spec.valid?Z($,J):eY($)}}var B9=c3((Z,{query:$})=>{let{to:J}=Z.state.selection.main,Y=$.nextMatch(Z.state,J,J);if(!Y)return!1;let X=L.single(Y.from,Y.to),Q=Z.state.facet(Z3);return Z.dispatch({selection:X,effects:[t4(Z,Y),Q.scrollToMatch(X.main,Z)],userEvent:"select.search"}),tY(Z),!0}),E9=c3((Z,{query:$})=>{let{state:J}=Z,{from:Y}=J.selection.main,X=$.prevMatch(J,Y,Y);if(!X)return!1;let Q=L.single(X.from,X.to),K=Z.state.facet(Z3);return Z.dispatch({selection:Q,effects:[t4(Z,X),K.scrollToMatch(Q.main,Z)],userEvent:"select.search"}),tY(Z),!0}),aW=c3((Z,{query:$})=>{let J=$.matchAll(Z.state,1000);if(!J||!J.length)return!1;return Z.dispatch({selection:L.create(J.map((Y)=>L.range(Y.from,Y.to))),userEvent:"select.search.matches"}),!0}),oW=({state:Z,dispatch:$})=>{let J=Z.selection;if(J.ranges.length>1||J.main.empty)return!1;let{from:Y,to:X}=J.main,Q=[],K=0;for(let U=new D2(Z.doc,Z.sliceDoc(Y,X));!U.next().done;){if(Q.length>1000)return!1;if(U.value.from==Y)K=Q.length;Q.push(L.range(U.value.from,U.value.to))}return $(Z.update({selection:L.create(Q,K),userEvent:"select.search.matches"})),!0},cY=c3((Z,{query:$})=>{let{state:J}=Z,{from:Y,to:X}=J.selection.main;if(J.readOnly)return!1;let Q=$.nextMatch(J,Y,Y);if(!Q)return!1;let K=Q,U=[],q,G,W=[];if(K.from==Y&&K.to==X)G=J.toText($.getReplacement(K)),U.push({from:K.from,to:K.to,insert:G}),K=$.nextMatch(J,K.from,K.to),W.push(P.announce.of(J.phrase("replaced match on line $",J.doc.lineAt(Y).number)+"."));let j=Z.state.changes(U);if(K)q=L.single(K.from,K.to).map(j),W.push(t4(Z,K)),W.push(J.facet(Z3).scrollToMatch(q.main,Z));return Z.dispatch({changes:j,selection:q,effects:W,userEvent:"input.replace"}),!0}),tW=c3((Z,{query:$})=>{if(Z.state.readOnly)return!1;let J=$.matchAll(Z.state,1e9).map((X)=>{let{from:Q,to:K}=X;return{from:Q,to:K,insert:$.getReplacement(X)}});if(!J.length)return!1;let Y=Z.state.phrase("replaced $ matches",J.length)+".";return Z.dispatch({changes:J,effects:P.announce.of(Y),userEvent:"input.replace.all"}),!0});function o4(Z){return Z.state.facet(Z3).createPanel(Z)}function d4(Z,$){var J,Y,X,Q,K;let U=Z.selection.main,q=U.empty||U.to>U.from+100?"":Z.sliceDoc(U.from,U.to);if($&&!q)return $;let G=Z.facet(Z3);return new i4({search:((J=$===null||$===void 0?void 0:$.literal)!==null&&J!==void 0?J:G.literal)?q:q.replace(/\n/g,"\\n"),caseSensitive:(Y=$===null||$===void 0?void 0:$.caseSensitive)!==null&&Y!==void 0?Y:G.caseSensitive,literal:(X=$===null||$===void 0?void 0:$.literal)!==null&&X!==void 0?X:G.literal,regexp:(Q=$===null||$===void 0?void 0:$.regexp)!==null&&Q!==void 0?Q:G.regexp,wholeWord:(K=$===null||$===void 0?void 0:$.wholeWord)!==null&&K!==void 0?K:G.wholeWord})}function oY(Z){let $=h3(Z,o4);return $&&$.dom.querySelector("[main-field]")}function tY(Z){let $=oY(Z);if($&&$==Z.root.activeElement)$.select()}var eY=(Z)=>{let $=Z.state.field(J2,!1);if($&&$.panel){let J=oY(Z);if(J&&J!=Z.root.activeElement){let Y=d4(Z.state,$.query.spec);if(Y.valid)Z.dispatch({effects:d3.of(Y)});J.focus(),J.select()}}else Z.dispatch({effects:[a4.of(!0),$?d3.of(d4(Z.state,$.query.spec)):l.appendConfig.of(Zj)]});return!0},ZX=(Z)=>{let $=Z.state.field(J2,!1);if(!$||!$.panel)return!1;let J=h3(Z,o4);if(J&&J.dom.contains(Z.root.activeElement))Z.focus();return Z.dispatch({effects:a4.of(!1)}),!0},$X=[{key:"Mod-f",run:eY,scope:"editor search-panel"},{key:"F3",run:B9,shift:E9,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:B9,shift:E9,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:ZX,scope:"editor search-panel"},{key:"Mod-Shift-l",run:oW},{key:"Mod-Alt-g",run:SW},{key:"Mod-d",run:pW,preventDefault:!0}];class JX{constructor(Z){this.view=Z;let $=this.query=Z.state.field(J2).query.spec;this.commit=this.commit.bind(this),this.searchField=J0("input",{value:$.search,placeholder:Z1(Z,"Find"),"aria-label":Z1(Z,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=J0("input",{value:$.replace,placeholder:Z1(Z,"Replace"),"aria-label":Z1(Z,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=J0("input",{type:"checkbox",name:"case",form:"",checked:$.caseSensitive,onchange:this.commit}),this.reField=J0("input",{type:"checkbox",name:"re",form:"",checked:$.regexp,onchange:this.commit}),this.wordField=J0("input",{type:"checkbox",name:"word",form:"",checked:$.wholeWord,onchange:this.commit});function J(Y,X,Q){return J0("button",{class:"cm-button",name:Y,onclick:X,type:"button"},Q)}this.dom=J0("div",{onkeydown:(Y)=>this.keydown(Y),class:"cm-search"},[this.searchField,J("next",()=>B9(Z),[Z1(Z,"next")]),J("prev",()=>E9(Z),[Z1(Z,"previous")]),J("select",()=>aW(Z),[Z1(Z,"all")]),J0("label",null,[this.caseField,Z1(Z,"match case")]),J0("label",null,[this.reField,Z1(Z,"regexp")]),J0("label",null,[this.wordField,Z1(Z,"by word")]),...Z.state.readOnly?[]:[J0("br"),this.replaceField,J("replace",()=>cY(Z),[Z1(Z,"replace")]),J("replaceAll",()=>tW(Z),[Z1(Z,"replace all")])],J0("button",{name:"close",onclick:()=>ZX(Z),"aria-label":Z1(Z,"close"),type:"button"},["Ã—"])])}commit(){let Z=new i4({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});if(!Z.eq(this.query))this.query=Z,this.view.dispatch({effects:d3.of(Z)})}keydown(Z){if(S$(this.view,Z,"search-panel"))Z.preventDefault();else if(Z.keyCode==13&&Z.target==this.searchField)Z.preventDefault(),(Z.shiftKey?E9:B9)(this.view);else if(Z.keyCode==13&&Z.target==this.replaceField)Z.preventDefault(),cY(this.view)}update(Z){for(let $ of Z.transactions)for(let J of $.effects)if(J.is(d3)&&!J.value.eq(this.query))this.setQuery(J.value)}setQuery(Z){this.query=Z,this.searchField.value=Z.search,this.replaceField.value=Z.replace,this.caseField.checked=Z.caseSensitive,this.reField.checked=Z.regexp,this.wordField.checked=Z.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Z3).top}}function Z1(Z,$){return Z.state.phrase($)}var F9=30,I9=/[\s\.,:;?!]/;function t4(Z,{from:$,to:J}){let Y=Z.state.doc.lineAt($),X=Z.state.doc.lineAt(J).to,Q=Math.max(Y.from,$-F9),K=Math.min(X,J+F9),U=Z.state.sliceDoc(Q,K);if(Q!=Y.from){for(let q=0;q<F9;q++)if(!I9.test(U[q+1])&&I9.test(U[q])){U=U.slice(q);break}}if(K!=X){for(let q=U.length-1;q>U.length-F9;q--)if(!I9.test(U[q-1])&&I9.test(U[q])){U=U.slice(0,q);break}}return P.announce.of(`${Z.state.phrase("current match")}. ${U} ${Z.state.phrase("on line")} ${Y.number}.`)}var eW=P.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Zj=[J2,R1.low(rW),eW];class Y8{constructor(Z,$,J,Y){this.state=Z,this.pos=$,this.explicit=J,this.view=Y,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(Z){let $=E0(this.state).resolveInner(this.pos,-1);while($&&Z.indexOf($.name)<0)$=$.parent;return $?{from:$.from,to:this.pos,text:this.state.sliceDoc($.from,this.pos),type:$.type}:null}matchBefore(Z){let $=this.state.doc.lineAt(this.pos),J=Math.max($.from,this.pos-250),Y=$.text.slice(J-$.from,this.pos-$.from),X=Y.search(WX(Z,!1));return X<0?null:{from:J+X,to:this.pos,text:Y.slice(X)}}get aborted(){return this.abortListeners==null}addEventListener(Z,$,J){if(Z=="abort"&&this.abortListeners){if(this.abortListeners.push($),J&&J.onDocChange)this.abortOnDocChange=!0}}}function YX(Z){let $=Object.keys(Z).join(""),J=/\w/.test($);if(J)$=$.replace(/\w/g,"");return`[${J?"\\w":""}${$.replace(/[^\w\s]/g,"\\$&")}]`}function $j(Z){let $=Object.create(null),J=Object.create(null);for(let{label:X}of Z){$[X[0]]=!0;for(let Q=1;Q<X.length;Q++)J[X[Q]]=!0}let Y=YX($)+YX(J)+"*$";return[new RegExp("^"+Y),new RegExp(Y)]}function Jj(Z){let $=Z.map((X)=>typeof X=="string"?{label:X}:X),[J,Y]=$.every((X)=>/^\w+$/.test(X.label))?[/\w*$/,/\w+$/]:$j($);return(X)=>{let Q=X.matchBefore(Y);return Q||X.explicit?{from:Q?Q.from:X.pos,options:$,validFor:J}:null}}class J8{constructor(Z,$,J,Y){this.completion=Z,this.source=$,this.match=J,this.score=Y}}function M2(Z){return Z.selection.main.from}function WX(Z,$){var J;let{source:Y}=Z,X=$&&Y[0]!="^",Q=Y[Y.length-1]!="$";if(!X&&!Q)return Z;return new RegExp(`${X?"^":""}(?:${Y})${Q?"$":""}`,(J=Z.flags)!==null&&J!==void 0?J:Z.ignoreCase?"i":"")}var jX=o0.define();function Yj(Z,$,J,Y){let{main:X}=Z.selection,Q=J-X.from,K=Y-X.from;return{...Z.changeByRange((U)=>{if(U!=X&&J!=Y&&Z.sliceDoc(U.from+Q,U.from+K)!=Z.sliceDoc(J,Y))return{range:U};let q=Z.toText($);return{changes:{from:U.from+Q,to:Y==X.from?U.to:U.from+K,insert:q},range:L.cursor(U.from+Q+q.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}var XX=new WeakMap;function Xj(Z){if(!Array.isArray(Z))return Z;let $=XX.get(Z);if(!$)XX.set(Z,$=Jj(Z));return $}var C9=l.define(),s3=l.define();class _X{constructor(Z){this.pattern=Z,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let $=0;$<Z.length;){let J=S0(Z,$),Y=a0(J);this.chars.push(J);let X=Z.slice($,$+Y),Q=X.toUpperCase();this.folded.push(S0(Q==X?X.toLowerCase():Q,0)),$+=Y}this.astral=Z.length!=this.chars.length}ret(Z,$){return this.score=Z,this.matched=$,this}match(Z){if(this.pattern.length==0)return this.ret(-100,[]);if(Z.length<this.pattern.length)return null;let{chars:$,folded:J,any:Y,precise:X,byWord:Q}=this;if($.length==1){let F=S0(Z,0),D=a0(F),M=D==Z.length?0:-100;if(F==$[0]);else if(F==J[0])M+=-200;else return null;return this.ret(M,[0,D])}let K=Z.indexOf(this.pattern);if(K==0)return this.ret(Z.length==this.pattern.length?0:-100,[0,this.pattern.length]);let U=$.length,q=0;if(K<0){for(let F=0,D=Math.min(Z.length,200);F<D&&q<U;){let M=S0(Z,F);if(M==$[q]||M==J[q])Y[q++]=F;F+=a0(M)}if(q<U)return null}let G=0,W=0,j=!1,_=0,z=-1,V=-1,O=/[a-z]/.test(Z),H=!0;for(let F=0,D=Math.min(Z.length,200),M=0;F<D&&W<U;){let A=S0(Z,F);if(K<0){if(G<U&&A==$[G])X[G++]=F;if(_<U)if(A==$[_]||A==J[_]){if(_==0)z=F;V=F+1,_++}else _=0}let B,w=A<255?A>=48&&A<=57||A>=97&&A<=122?2:A>=65&&A<=90?1:0:(B=_3(A))!=B.toLowerCase()?1:B!=B.toUpperCase()?2:0;if(!F||w==1&&O||M==0&&w!=0){if($[W]==A||J[W]==A&&(j=!0))Q[W++]=F;else if(Q.length)H=!1}M=w,F+=a0(A)}if(W==U&&Q[0]==0&&H)return this.result(-100+(j?-200:0),Q,Z);if(_==U&&z==0)return this.ret(-200-Z.length+(V==Z.length?0:-100),[0,V]);if(K>-1)return this.ret(-700-Z.length,[K,K+this.pattern.length]);if(_==U)return this.ret(-900-Z.length,[z,V]);if(W==U)return this.result(-100+(j?-200:0)+-700+(H?0:-1100),Q,Z);return $.length==2?null:this.result((Y[0]?-700:0)+-200+-1100,Y,Z)}result(Z,$,J){let Y=[],X=0;for(let Q of $){let K=Q+(this.astral?a0(S0(J,Q)):1);if(X&&Y[X-1]==Q)Y[X-1]=K;else Y[X++]=Q,Y[X++]=K}return this.ret(Z-J.length,Y)}}class zX{constructor(Z){this.pattern=Z,this.matched=[],this.score=0,this.folded=Z.toLowerCase()}match(Z){if(Z.length<this.pattern.length)return null;let $=Z.slice(0,this.pattern.length),J=$==this.pattern?0:$.toLowerCase()==this.folded?-200:null;if(J==null)return null;return this.matched=[0,$.length],this.score=J+(Z.length==this.pattern.length?0:-100),this}}var P0=S.define({combine(Z){return u0(Z,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Qj,filterStrict:!1,compareCompletions:($,J)=>($.sortText||$.label).localeCompare(J.sortText||J.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:($,J)=>$&&J,closeOnBlur:($,J)=>$&&J,icons:($,J)=>$&&J,tooltipClass:($,J)=>(Y)=>QX($(Y),J(Y)),optionClass:($,J)=>(Y)=>QX($(Y),J(Y)),addToOptions:($,J)=>$.concat(J),filterStrict:($,J)=>$||J})}});function QX(Z,$){return Z?$?Z+" "+$:Z:$}function Qj(Z,$,J,Y,X,Q){let K=Z.textDirection==Q0.RTL,U=K,q=!1,G="top",W,j,_=$.left-X.left,z=X.right-$.right,V=Y.right-Y.left,O=Y.bottom-Y.top;if(U&&_<Math.min(V,z))U=!1;else if(!U&&z<Math.min(V,_))U=!0;if(V<=(U?_:z))W=Math.max(X.top,Math.min(J.top,X.bottom-O))-$.top,j=Math.min(400,U?_:z);else{q=!0,j=Math.min(400,(K?$.right:X.right-$.left)-30);let D=X.bottom-$.bottom;if(D>=O||D>$.top)W=J.bottom-$.top;else G="bottom",W=$.bottom-J.top}let H=($.bottom-$.top)/Q.offsetHeight,F=($.right-$.left)/Q.offsetWidth;return{style:`${G}: ${W/H}px; max-width: ${j/F}px`,class:"cm-completionInfo-"+(q?K?"left-narrow":"right-narrow":U?"left":"right")}}function Kj(Z){let $=Z.addToOptions.slice();if(Z.icons)$.push({render(J){let Y=document.createElement("div");if(Y.classList.add("cm-completionIcon"),J.type)Y.classList.add(...J.type.split(/\s+/g).map((X)=>"cm-completionIcon-"+X));return Y.setAttribute("aria-hidden","true"),Y},position:20});return $.push({render(J,Y,X,Q){let K=document.createElement("span");K.className="cm-completionLabel";let U=J.displayLabel||J.label,q=0;for(let G=0;G<Q.length;){let W=Q[G++],j=Q[G++];if(W>q)K.appendChild(document.createTextNode(U.slice(q,W)));let _=K.appendChild(document.createElement("span"));_.appendChild(document.createTextNode(U.slice(W,j))),_.className="cm-completionMatchedText",q=j}if(q<U.length)K.appendChild(document.createTextNode(U.slice(q)));return K},position:50},{render(J){if(!J.detail)return null;let Y=document.createElement("span");return Y.className="cm-completionDetail",Y.textContent=J.detail,Y},position:80}),$.sort((J,Y)=>J.position-Y.position).map((J)=>J.render)}function e4(Z,$,J){if(Z<=J)return{from:0,to:Z};if($<0)$=0;if($<=Z>>1){let X=Math.floor($/J);return{from:X*J,to:(X+1)*J}}let Y=Math.floor((Z-$)/J);return{from:Z-(Y+1)*J,to:Z-Y*J}}class OX{constructor(Z,$,J){this.view=Z,this.stateField=$,this.applyCompletion=J,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:(U)=>this.placeInfo(U),key:this},this.space=null,this.currentClass="";let Y=Z.state.field($),{options:X,selected:Q}=Y.open,K=Z.state.facet(P0);this.optionContent=Kj(K),this.optionClass=K.optionClass,this.tooltipClass=K.tooltipClass,this.range=e4(X.length,Q,K.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(Z.state),this.dom.addEventListener("mousedown",(U)=>{let{options:q}=Z.state.field($).open;for(let G=U.target,W;G&&G!=this.dom;G=G.parentNode)if(G.nodeName=="LI"&&(W=/-(\d+)$/.exec(G.id))&&+W[1]<q.length){this.applyCompletion(Z,q[+W[1]]),U.preventDefault();return}}),this.dom.addEventListener("focusout",(U)=>{let q=Z.state.field(this.stateField,!1);if(q&&q.tooltip&&Z.state.facet(P0).closeOnBlur&&U.relatedTarget!=Z.contentDOM)Z.dispatch({effects:s3.of(null)})}),this.showOptions(X,Y.id)}mount(){this.updateSel()}showOptions(Z,$){if(this.list)this.list.remove();this.list=this.dom.appendChild(this.createListBox(Z,$,this.range)),this.list.addEventListener("scroll",()=>{if(this.info)this.view.requestMeasure(this.placeInfoReq)})}update(Z){var $;let J=Z.state.field(this.stateField),Y=Z.startState.field(this.stateField);if(this.updateTooltipClass(Z.state),J!=Y){let{options:X,selected:Q,disabled:K}=J.open;if(!Y.open||Y.open.options!=X)this.range=e4(X.length,Q,Z.state.facet(P0).maxRenderedOptions),this.showOptions(X,J.id);if(this.updateSel(),K!=(($=Y.open)===null||$===void 0?void 0:$.disabled))this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!K)}}updateTooltipClass(Z){let $=this.tooltipClass(Z);if($!=this.currentClass){for(let J of this.currentClass.split(" "))if(J)this.dom.classList.remove(J);for(let J of $.split(" "))if(J)this.dom.classList.add(J);this.currentClass=$}}positioned(Z){if(this.space=Z,this.info)this.view.requestMeasure(this.placeInfoReq)}updateSel(){let Z=this.view.state.field(this.stateField),$=Z.open;if($.selected>-1&&$.selected<this.range.from||$.selected>=this.range.to)this.range=e4($.options.length,$.selected,this.view.state.facet(P0).maxRenderedOptions),this.showOptions($.options,Z.id);let J=this.updateSelectedOption($.selected);if(J){this.destroyInfo();let{completion:Y}=$.options[$.selected],{info:X}=Y;if(!X)return;let Q=typeof X==="string"?document.createTextNode(X):X(Y);if(!Q)return;if("then"in Q)Q.then((K)=>{if(K&&this.view.state.field(this.stateField,!1)==Z)this.addInfoPane(K,Y)}).catch((K)=>h0(this.view.state,K,"completion info"));else this.addInfoPane(Q,Y),J.setAttribute("aria-describedby",this.info.id)}}addInfoPane(Z,$){this.destroyInfo();let J=this.info=document.createElement("div");if(J.className="cm-tooltip cm-completionInfo",J.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),Z.nodeType!=null)J.appendChild(Z),this.infoDestroy=null;else{let{dom:Y,destroy:X}=Z;J.appendChild(Y),this.infoDestroy=X||null}this.dom.appendChild(J),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(Z){let $=null;for(let J=this.list.firstChild,Y=this.range.from;J;J=J.nextSibling,Y++)if(J.nodeName!="LI"||!J.id)Y--;else if(Y==Z){if(!J.hasAttribute("aria-selected"))J.setAttribute("aria-selected","true"),$=J}else if(J.hasAttribute("aria-selected"))J.removeAttribute("aria-selected"),J.removeAttribute("aria-describedby");if($)qj(this.list,$);return $}measureInfo(){let Z=this.dom.querySelector("[aria-selected]");if(!Z||!this.info)return null;let $=this.dom.getBoundingClientRect(),J=this.info.getBoundingClientRect(),Y=Z.getBoundingClientRect(),X=this.space;if(!X){let Q=this.dom.ownerDocument.documentElement;X={left:0,top:0,right:Q.clientWidth,bottom:Q.clientHeight}}if(Y.top>Math.min(X.bottom,$.bottom)-10||Y.bottom<Math.max(X.top,$.top)+10)return null;return this.view.state.facet(P0).positionInfo(this.view,$,Y,J,X,this.dom)}placeInfo(Z){if(this.info)if(Z){if(Z.style)this.info.style.cssText=Z.style;this.info.className="cm-tooltip cm-completionInfo "+(Z.class||"")}else this.info.style.cssText="top: -1e6px"}createListBox(Z,$,J){let Y=document.createElement("ul");Y.id=$,Y.setAttribute("role","listbox"),Y.setAttribute("aria-expanded","true"),Y.setAttribute("aria-label",this.view.state.phrase("Completions")),Y.addEventListener("mousedown",(Q)=>{if(Q.target==Y)Q.preventDefault()});let X=null;for(let Q=J.from;Q<J.to;Q++){let{completion:K,match:U}=Z[Q],{section:q}=K;if(q){let j=typeof q=="string"?q:q.name;if(j!=X&&(Q>J.from||J.from==0))if(X=j,typeof q!="string"&&q.header)Y.appendChild(q.header(q));else{let _=Y.appendChild(document.createElement("completion-section"));_.textContent=j}}let G=Y.appendChild(document.createElement("li"));G.id=$+"-"+Q,G.setAttribute("role","option");let W=this.optionClass(K);if(W)G.className=W;for(let j of this.optionContent){let _=j(K,this.view.state,this.view,U);if(_)G.appendChild(_)}}if(J.from)Y.classList.add("cm-completionListIncompleteTop");if(J.to<Z.length)Y.classList.add("cm-completionListIncompleteBottom");return Y}destroyInfo(){if(this.info){if(this.infoDestroy)this.infoDestroy();this.info.remove(),this.info=null}}destroy(){this.destroyInfo()}}function Uj(Z,$){return(J)=>new OX(J,Z,$)}function qj(Z,$){let J=Z.getBoundingClientRect(),Y=$.getBoundingClientRect(),X=J.height/Z.offsetHeight;if(Y.top<J.top)Z.scrollTop-=(J.top-Y.top)/X;else if(Y.bottom>J.bottom)Z.scrollTop+=(Y.bottom-J.bottom)/X}function KX(Z){return(Z.boost||0)*100+(Z.apply?10:0)+(Z.info?5:0)+(Z.type?1:0)}function Gj(Z,$){let J=[],Y=null,X=null,Q=(W)=>{J.push(W);let{section:j}=W.completion;if(j){if(!Y)Y=[];let _=typeof j=="string"?j:j.name;if(!Y.some((z)=>z.name==_))Y.push(typeof j=="string"?{name:_}:j)}},K=$.facet(P0);for(let W of Z)if(W.hasResult()){let j=W.result.getMatch;if(W.result.filter===!1)for(let _ of W.result.options)Q(new J8(_,W.source,j?j(_):[],1e9-J.length));else{let _=$.sliceDoc(W.from,W.to),z,V=K.filterStrict?new zX(_):new _X(_);for(let O of W.result.options)if(z=V.match(O.label)){let H=!O.displayLabel?z.matched:j?j(O,z.matched):[],F=z.score+(O.boost||0);if(Q(new J8(O,W.source,H,F)),typeof O.section=="object"&&O.section.rank==="dynamic"){let{name:D}=O.section;if(!X)X=Object.create(null);X[D]=Math.max(F,X[D]||-1e9)}}}}if(Y){let W=Object.create(null),j=0,_=(z,V)=>{return(z.rank==="dynamic"&&V.rank==="dynamic"?X[V.name]-X[z.name]:0)||(typeof z.rank=="number"?z.rank:1e9)-(typeof V.rank=="number"?V.rank:1e9)||(z.name<V.name?-1:1)};for(let z of Y.sort(_))j-=1e5,W[z.name]=j;for(let z of J){let{section:V}=z.completion;if(V)z.score+=W[typeof V=="string"?V:V.name]}}let U=[],q=null,G=K.compareCompletions;for(let W of J.sort((j,_)=>_.score-j.score||G(j.completion,_.completion))){let j=W.completion;if(!q||q.label!=j.label||q.detail!=j.detail||q.type!=null&&j.type!=null&&q.type!=j.type||q.apply!=j.apply||q.boost!=j.boost)U.push(W);else if(KX(W.completion)>KX(q))U[U.length-1]=W;q=W.completion}return U}class $3{constructor(Z,$,J,Y,X,Q){this.options=Z,this.attrs=$,this.tooltip=J,this.timestamp=Y,this.selected=X,this.disabled=Q}setSelected(Z,$){return Z==this.selected||Z>=this.options.length?this:new $3(this.options,UX($,Z),this.tooltip,this.timestamp,Z,this.disabled)}static build(Z,$,J,Y,X,Q){if(Y&&!Q&&Z.some((q)=>q.isPending))return Y.setDisabled();let K=Gj(Z,$);if(!K.length)return Y&&Z.some((q)=>q.isPending)?Y.setDisabled():null;let U=$.facet(P0).selectOnOpen?0:-1;if(Y&&Y.selected!=U&&Y.selected!=-1){let q=Y.options[Y.selected].completion;for(let G=0;G<K.length;G++)if(K[G].completion==q){U=G;break}}return new $3(K,UX(J,U),{pos:Z.reduce((q,G)=>G.hasResult()?Math.min(q,G.from):q,1e8),create:Vj,above:X.aboveCursor},Y?Y.timestamp:Date.now(),U,!1)}map(Z){return new $3(this.options,this.attrs,{...this.tooltip,pos:Z.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new $3(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class T9{constructor(Z,$,J){this.active=Z,this.id=$,this.open=J}static start(){return new T9(zj,"cm-ac-"+Math.floor(Math.random()*2000000).toString(36),null)}update(Z){let{state:$}=Z,J=$.facet(P0),X=(J.override||$.languageDataAt("autocomplete",M2($)).map(Xj)).map((U)=>{return(this.active.find((G)=>G.source==U)||new _1(U,this.active.some((G)=>G.state!=0)?1:0)).update(Z,J)});if(X.length==this.active.length&&X.every((U,q)=>U==this.active[q]))X=this.active;let Q=this.open,K=Z.effects.some((U)=>U.is(X8));if(Q&&Z.docChanged)Q=Q.map(Z.changes);if(Z.selection||X.some((U)=>U.hasResult()&&Z.changes.touchesRange(U.from,U.to))||!Wj(X,this.active)||K)Q=$3.build(X,$,this.id,Q,J,K);else if(Q&&Q.disabled&&!X.some((U)=>U.isPending))Q=null;if(!Q&&X.every((U)=>!U.isPending)&&X.some((U)=>U.hasResult()))X=X.map((U)=>U.hasResult()?new _1(U.source,0):U);for(let U of Z.effects)if(U.is(HX))Q=Q&&Q.setSelected(U.value,this.id);return X==this.active&&Q==this.open?this:new T9(X,this.id,Q)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?jj:_j}}function Wj(Z,$){if(Z==$)return!0;for(let J=0,Y=0;;){while(J<Z.length&&!Z[J].hasResult())J++;while(Y<$.length&&!$[Y].hasResult())Y++;let X=J==Z.length,Q=Y==$.length;if(X||Q)return X==Q;if(Z[J++].result!=$[Y++].result)return!1}}var jj={"aria-autocomplete":"list"},_j={};function UX(Z,$){let J={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":Z};if($>-1)J["aria-activedescendant"]=Z+"-"+$;return J}var zj=[];function VX(Z,$){if(Z.isUserEvent("input.complete")){let Y=Z.annotation(jX);if(Y&&$.activateOnCompletion(Y))return 12}let J=Z.isUserEvent("input.type");return J&&$.activateOnTyping?5:J?1:Z.isUserEvent("delete.backward")?2:Z.selection?8:Z.docChanged?16:0}class _1{constructor(Z,$,J=!1){this.source=Z,this.state=$,this.explicit=J}hasResult(){return!1}get isPending(){return this.state==1}update(Z,$){let J=VX(Z,$),Y=this;if(J&8||J&16&&this.touches(Z))Y=new _1(Y.source,0);if(J&4&&Y.state==0)Y=new _1(this.source,1);Y=Y.updateFor(Z,J);for(let X of Z.effects)if(X.is(C9))Y=new _1(Y.source,1,X.value);else if(X.is(s3))Y=new _1(Y.source,0);else if(X.is(X8)){for(let Q of X.value)if(Q.source==Y.source)Y=Q}return Y}updateFor(Z,$){return this.map(Z.changes)}map(Z){return this}touches(Z){return Z.changes.touchesRange(M2(Z.state))}}class J3 extends _1{constructor(Z,$,J,Y,X,Q){super(Z,3,$);this.limit=J,this.result=Y,this.from=X,this.to=Q}hasResult(){return!0}updateFor(Z,$){var J;if(!($&3))return this.map(Z.changes);let Y=this.result;if(Y.map&&!Z.changes.empty)Y=Y.map(Y,Z.changes);let X=Z.changes.mapPos(this.from),Q=Z.changes.mapPos(this.to,1),K=M2(Z.state);if(K>Q||!Y||$&2&&(M2(Z.startState)==this.from||K<this.limit))return new _1(this.source,$&4?1:0);let U=Z.changes.mapPos(this.limit);if(Oj(Y.validFor,Z.state,X,Q))return new J3(this.source,this.explicit,U,Y,X,Q);if(Y.update&&(Y=Y.update(Y,X,Q,new Y8(Z.state,K,!1))))return new J3(this.source,this.explicit,U,Y,Y.from,(J=Y.to)!==null&&J!==void 0?J:M2(Z.state));return new _1(this.source,1,this.explicit)}map(Z){if(Z.empty)return this;if(!(this.result.map?this.result.map(this.result,Z):this.result))return new _1(this.source,0);return new J3(this.source,this.explicit,Z.mapPos(this.limit),this.result,Z.mapPos(this.from),Z.mapPos(this.to,1))}touches(Z){return Z.changes.touchesRange(this.from,this.to)}}function Oj(Z,$,J,Y){if(!Z)return!1;let X=$.sliceDoc(J,Y);return typeof Z=="function"?Z(X,J,Y,$):WX(Z,!0).test(X)}var X8=l.define({map(Z,$){return Z.map((J)=>J.map($))}}),HX=l.define(),n0=z0.define({create(){return T9.start()},update(Z,$){return Z.update($)},provide:(Z)=>[x3.from(Z,($)=>$.tooltip),P.contentAttributes.from(Z,($)=>$.attrs)]});function Q8(Z,$){let J=$.completion.apply||$.completion.label,Y=Z.state.field(n0).active.find((X)=>X.source==$.source);if(!(Y instanceof J3))return!1;if(typeof J=="string")Z.dispatch({...Yj(Z.state,J,Y.from,Y.to),annotations:jX.of($.completion)});else J(Z,$.completion,Y.from,Y.to);return!0}var Vj=Uj(n0,Q8);function P9(Z,$="option"){return(J)=>{let Y=J.state.field(n0,!1);if(!Y||!Y.open||Y.open.disabled||Date.now()-Y.open.timestamp<J.state.facet(P0).interactionDelay)return!1;let X=1,Q;if($=="page"&&(Q=j4(J,Y.open.tooltip)))X=Math.max(2,Math.floor(Q.dom.offsetHeight/Q.dom.querySelector("li").offsetHeight)-1);let{length:K}=Y.open.options,U=Y.open.selected>-1?Y.open.selected+X*(Z?1:-1):Z?0:K-1;if(U<0)U=$=="page"?0:K-1;else if(U>=K)U=$=="page"?K-1:0;return J.dispatch({effects:HX.of(U)}),!0}}var K8=(Z)=>{let $=Z.state.field(n0,!1);if(Z.state.readOnly||!$||!$.open||$.open.selected<0||$.open.disabled||Date.now()-$.open.timestamp<Z.state.facet(P0).interactionDelay)return!1;return Q8(Z,$.open.options[$.open.selected])},Z8=(Z)=>{if(!Z.state.field(n0,!1))return!1;return Z.dispatch({effects:C9.of(!0)}),!0},Hj=(Z)=>{let $=Z.state.field(n0,!1);if(!$||!$.active.some((J)=>J.state!=0))return!1;return Z.dispatch({effects:s3.of(null)}),!0};class NX{constructor(Z,$){this.active=Z,this.context=$,this.time=Date.now(),this.updates=[],this.done=void 0}}var Nj=50,Rj=1000,Fj=_0.fromClass(class{constructor(Z){this.view=Z,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let $ of Z.state.field(n0).active)if($.isPending)this.startQuery($)}update(Z){let $=Z.state.field(n0),J=Z.state.facet(P0);if(!Z.selectionSet&&!Z.docChanged&&Z.startState.field(n0)==$)return;let Y=Z.transactions.some((Q)=>{let K=VX(Q,J);return K&8||(Q.selection||Q.docChanged)&&!(K&3)});for(let Q=0;Q<this.running.length;Q++){let K=this.running[Q];if(Y||K.context.abortOnDocChange&&Z.docChanged||K.updates.length+Z.transactions.length>Nj&&Date.now()-K.time>Rj){for(let U of K.context.abortListeners)try{U()}catch(q){h0(this.view.state,q)}K.context.abortListeners=null,this.running.splice(Q--,1)}else K.updates.push(...Z.transactions)}if(this.debounceUpdate>-1)clearTimeout(this.debounceUpdate);if(Z.transactions.some((Q)=>Q.effects.some((K)=>K.is(C9))))this.pendingStart=!0;let X=this.pendingStart?50:J.activateOnTypingDelay;if(this.debounceUpdate=$.active.some((Q)=>Q.isPending&&!this.running.some((K)=>K.active.source==Q.source))?setTimeout(()=>this.startUpdate(),X):-1,this.composing!=0){for(let Q of Z.transactions)if(Q.isUserEvent("input.type"))this.composing=2;else if(this.composing==2&&Q.selection)this.composing=3}}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:Z}=this.view,$=Z.field(n0);for(let J of $.active)if(J.isPending&&!this.running.some((Y)=>Y.active.source==J.source))this.startQuery(J);if(this.running.length&&$.open&&$.open.disabled)this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(P0).updateSyncTime)}startQuery(Z){let{state:$}=this.view,J=M2($),Y=new Y8($,J,Z.explicit,this.view),X=new NX(Z,Y);this.running.push(X),Promise.resolve(Z.source(Y)).then((Q)=>{if(!X.context.aborted)X.done=Q||null,this.scheduleAccept()},(Q)=>{this.view.dispatch({effects:s3.of(null)}),h0(this.view.state,Q)})}scheduleAccept(){if(this.running.every((Z)=>Z.done!==void 0))this.accept();else if(this.debounceAccept<0)this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(P0).updateSyncTime)}accept(){var Z;if(this.debounceAccept>-1)clearTimeout(this.debounceAccept);this.debounceAccept=-1;let $=[],J=this.view.state.facet(P0),Y=this.view.state.field(n0);for(let X=0;X<this.running.length;X++){let Q=this.running[X];if(Q.done===void 0)continue;if(this.running.splice(X--,1),Q.done){let U=M2(Q.updates.length?Q.updates[0].startState:this.view.state),q=Math.min(U,Q.done.from+(Q.active.explicit?0:1)),G=new J3(Q.active.source,Q.active.explicit,q,Q.done,Q.done.from,(Z=Q.done.to)!==null&&Z!==void 0?Z:U);for(let W of Q.updates)G=G.update(W,J);if(G.hasResult()){$.push(G);continue}}let K=Y.active.find((U)=>U.source==Q.active.source);if(K&&K.isPending)if(Q.done==null){let U=new _1(Q.active.source,0);for(let q of Q.updates)U=U.update(q,J);if(!U.isPending)$.push(U)}else this.startQuery(K)}if($.length||Y.open&&Y.open.disabled)this.view.dispatch({effects:X8.of($)})}},{eventHandlers:{blur(Z){let $=this.view.state.field(n0,!1);if($&&$.tooltip&&this.view.state.facet(P0).closeOnBlur){let J=$.open&&j4(this.view,$.open.tooltip);if(!J||!J.dom.contains(Z.relatedTarget))setTimeout(()=>this.view.dispatch({effects:s3.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){if(this.composing==3)setTimeout(()=>this.view.dispatch({effects:C9.of(!1)}),20);this.composing=0}}}),Ij=typeof navigator=="object"&&/Win/.test(navigator.platform),Dj=R1.highest(P.domEventHandlers({keydown(Z,$){let J=$.state.field(n0,!1);if(!J||!J.open||J.open.disabled||J.open.selected<0||Z.key.length>1||Z.ctrlKey&&!(Ij&&Z.altKey)||Z.metaKey)return!1;let Y=J.open.options[J.open.selected],X=J.active.find((K)=>K.source==Y.source),Q=Y.completion.commitCharacters||X.result.commitCharacters;if(Q&&Q.indexOf(Z.key)>-1)Q8($,Y);return!1}})),Lj=P.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:0.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"Â·Â·Â·"',opacity:0.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'Æ’'"}},".cm-completionIcon-class":{"&:after":{content:"'â—‹'"}},".cm-completionIcon-interface":{"&:after":{content:"'â—Œ'"}},".cm-completionIcon-variable":{"&:after":{content:"'\uD835\uDC65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\uD835\uDC36'"}},".cm-completionIcon-type":{"&:after":{content:"'\uD835\uDC61'"}},".cm-completionIcon-enum":{"&:after":{content:"'âˆª'"}},".cm-completionIcon-property":{"&:after":{content:"'â–¡'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\uD83D\uDD11ï¸Ž'"}},".cm-completionIcon-namespace":{"&:after":{content:"'â–¢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});var n3={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},L2=l.define({map(Z,$){let J=$.mapPos(Z,-1,k0.TrackAfter);return J==null?void 0:J}}),U8=new class extends N1{};U8.startSide=1;U8.endSide=-1;var RX=z0.define({create(){return r.empty},update(Z,$){if(Z=Z.map($.changes),$.selection){let J=$.state.doc.lineAt($.selection.main.head);Z=Z.update({filter:(Y)=>Y>=J.from&&Y<=J.to})}for(let J of $.effects)if(J.is(L2))Z=Z.update({add:[U8.range(J.value,J.value+1)]});return Z}});function FX(){return[Aj,RX]}var $8="()[]{}<>Â«Â»Â»Â«ï¼»ï¼½ï½›ï½";function IX(Z){for(let $=0;$<$8.length;$+=2)if($8.charCodeAt($)==Z)return $8.charAt($+1);return _3(Z<128?Z:Z+1)}function DX(Z,$){return Z.languageDataAt("closeBrackets",$)[0]||n3}var Mj=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Aj=P.inputHandler.of((Z,$,J,Y)=>{if((Mj?Z.composing:Z.compositionStarted)||Z.state.readOnly)return!1;let X=Z.state.selection.main;if(Y.length>2||Y.length==2&&a0(S0(Y,0))==1||$!=X.from||J!=X.to)return!1;let Q=Ej(Z.state,Y);if(!Q)return!1;return Z.dispatch(Q),!0}),Bj=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let Y=DX(Z,Z.selection.main.head).brackets||n3.brackets,X=null,Q=Z.changeByRange((K)=>{if(K.empty){let U=Pj(Z.doc,K.head);for(let q of Y)if(q==U&&y9(Z.doc,K.head)==IX(S0(q,0)))return{changes:{from:K.head-q.length,to:K.head+q.length},range:L.cursor(K.head-q.length)}}return{range:X=K}});if(!X)$(Z.update(Q,{scrollIntoView:!0,userEvent:"delete.backward"}));return!X},LX=[{key:"Backspace",run:Bj}];function Ej(Z,$){let J=DX(Z,Z.selection.main.head),Y=J.brackets||n3.brackets;for(let X of Y){let Q=IX(S0(X,0));if($==X)return Q==X?yj(Z,X,Y.indexOf(X+X+X)>-1,J):Cj(Z,X,Q,J.before||n3.before);if($==Q&&MX(Z,Z.selection.main.from))return Tj(Z,X,Q)}return null}function MX(Z,$){let J=!1;return Z.field(RX).between(0,Z.doc.length,(Y)=>{if(Y==$)J=!0}),J}function y9(Z,$){let J=Z.sliceString($,$+2);return J.slice(0,a0(S0(J,0)))}function Pj(Z,$){let J=Z.sliceString($-2,$);return a0(S0(J,0))==J.length?J:J.slice(1)}function Cj(Z,$,J,Y){let X=null,Q=Z.changeByRange((K)=>{if(!K.empty)return{changes:[{insert:$,from:K.from},{insert:J,from:K.to}],effects:L2.of(K.to+$.length),range:L.range(K.anchor+$.length,K.head+$.length)};let U=y9(Z.doc,K.head);if(!U||/\s/.test(U)||Y.indexOf(U)>-1)return{changes:{insert:$+J,from:K.head},effects:L2.of(K.head+$.length),range:L.cursor(K.head+$.length)};return{range:X=K}});return X?null:Z.update(Q,{scrollIntoView:!0,userEvent:"input.type"})}function Tj(Z,$,J){let Y=null,X=Z.changeByRange((Q)=>{if(Q.empty&&y9(Z.doc,Q.head)==J)return{changes:{from:Q.head,to:Q.head+J.length,insert:J},range:L.cursor(Q.head+J.length)};return Y={range:Q}});return Y?null:Z.update(X,{scrollIntoView:!0,userEvent:"input.type"})}function yj(Z,$,J,Y){let X=Y.stringPrefixes||n3.stringPrefixes,Q=null,K=Z.changeByRange((U)=>{if(!U.empty)return{changes:[{insert:$,from:U.from},{insert:$,from:U.to}],effects:L2.of(U.to+$.length),range:L.range(U.anchor+$.length,U.head+$.length)};let q=U.head,G=y9(Z.doc,q),W;if(G==$){if(qX(Z,q))return{changes:{insert:$+$,from:q},effects:L2.of(q+$.length),range:L.cursor(q+$.length)};else if(MX(Z,q)){let _=J&&Z.sliceDoc(q,q+$.length*3)==$+$+$?$+$+$:$;return{changes:{from:q,to:q+_.length,insert:_},range:L.cursor(q+_.length)}}}else if(J&&Z.sliceDoc(q-2*$.length,q)==$+$&&(W=GX(Z,q-2*$.length,X))>-1&&qX(Z,W))return{changes:{insert:$+$+$+$,from:q},effects:L2.of(q+$.length),range:L.cursor(q+$.length)};else if(Z.charCategorizer(q)(G)!=K0.Word){if(GX(Z,q,X)>-1&&!bj(Z,q,$,X))return{changes:{insert:$+$,from:q},effects:L2.of(q+$.length),range:L.cursor(q+$.length)}}return{range:Q=U}});return Q?null:Z.update(K,{scrollIntoView:!0,userEvent:"input.type"})}function qX(Z,$){let J=E0(Z).resolveInner($+1);return J.parent&&J.from==$}function bj(Z,$,J,Y){let X=E0(Z).resolveInner($,-1),Q=Y.reduce((K,U)=>Math.max(K,U.length),0);for(let K=0;K<5;K++){let U=Z.sliceDoc(X.from,Math.min(X.to,X.from+J.length+Q)),q=U.indexOf(J);if(!q||q>-1&&Y.indexOf(U.slice(0,q))>-1){let W=X.firstChild;while(W&&W.from==X.from&&W.to-W.from>J.length+q){if(Z.sliceDoc(W.to-J.length,W.to)==J)return!1;W=W.firstChild}return!0}let G=X.to==$&&X.parent;if(!G)break;X=G}return!1}function GX(Z,$,J){let Y=Z.charCategorizer($);if(Y(Z.sliceDoc($-1,$))!=K0.Word)return $;for(let X of J){let Q=$-X.length;if(Z.sliceDoc(Q,$)==X&&Y(Z.sliceDoc(Q-1,Q))!=K0.Word)return Q}return-1}function b9(Z={}){return[Dj,n0,P0.of(Z),Fj,kj,Lj]}var q8=[{key:"Ctrl-Space",run:Z8},{mac:"Alt-`",run:Z8},{mac:"Alt-i",run:Z8},{key:"Escape",run:Hj},{key:"ArrowDown",run:P9(!0)},{key:"ArrowUp",run:P9(!1)},{key:"PageDown",run:P9(!0,"page")},{key:"PageUp",run:P9(!1,"page")},{key:"Enter",run:K8}],kj=R1.highest(N2.computeN([P0],(Z)=>Z.facet(P0).defaultKeymap?[q8]:[]));class G8{constructor(Z,$,J){this.from=Z,this.to=$,this.diagnostic=J}}class A2{constructor(Z,$,J){this.diagnostics=Z,this.panel=$,this.selected=J}static init(Z,$,J){let Y=J.facet(i3).markerFilter;if(Y)Z=Y(Z,J);let X=Z.slice().sort((_,z)=>_.from-z.from||_.to-z.to),Q=new r0,K=[],U=0,q=J.doc.iter(),G=0,W=J.doc.length;for(let _=0;;){let z=_==X.length?null:X[_];if(!z&&!K.length)break;let V,O;if(K.length)V=U,O=K.reduce((D,M)=>Math.min(D,M.to),z&&z.from>V?z.from:1e8);else{if(V=z.from,V>W)break;O=z.to,K.push(z),_++}while(_<X.length){let D=X[_];if(D.from==V&&(D.to>D.from||D.to==V))K.push(D),_++,O=Math.min(D.to,O);else{O=Math.min(D.from,O);break}}O=Math.min(O,W);let H=!1;if(K.some((D)=>D.from==V&&(D.to==O||O==W))){if(H=V==O,!H&&O-V<10){let D=V-(G+q.value.length);if(D>0)q.next(D),G=V;for(let M=V;;){if(M>=O){H=!0;break}if(!q.lineBreak&&G+q.value.length>M)break;M=G+q.value.length,G+=q.value.length,q.next()}}}let F=lj(K);if(H)Q.add(V,V,g.widget({widget:new bX(F),diagnostics:K.slice()}));else{let D=K.reduce((M,A)=>A.markClass?M+" "+A.markClass:M,"");Q.add(V,O,g.mark({class:"cm-lintRange cm-lintRange-"+F+D,diagnostics:K.slice(),inclusiveEnd:K.some((M)=>M.to>O)}))}if(U=O,U==W)break;for(let D=0;D<K.length;D++)if(K[D].to<=U)K.splice(D--,1)}let j=Q.finish();return new A2(j,$,Y3(j))}}function Y3(Z,$=null,J=0){let Y=null;return Z.between(J,1e9,(X,Q,{spec:K})=>{if($&&K.diagnostics.indexOf($)<0)return;if(!Y)Y=new G8(X,Q,$||K.diagnostics[0]);else if(K.diagnostics.indexOf(Y.diagnostic)<0)return!1;else Y=new G8(Y.from,Q,Y.diagnostic)}),Y}function Sj(Z,$){let J=$.pos,Y=$.end||J,X=Z.state.facet(i3).hideOn(Z,J,Y);if(X!=null)return X;let Q=Z.startState.doc.lineAt($.pos);return!!(Z.effects.some((K)=>K.is(EX))||Z.changes.touchesRange(Q.from,Math.max(Q.to,Y)))}function xj(Z,$){return Z.field($1,!1)?$:$.concat(l.appendConfig.of(dj))}var EX=l.define(),j8=l.define(),PX=l.define(),$1=z0.define({create(){return new A2(g.none,null,null)},update(Z,$){if($.docChanged&&Z.diagnostics.size){let J=Z.diagnostics.map($.changes),Y=null,X=Z.panel;if(Z.selected){let Q=$.changes.mapPos(Z.selected.from,1);Y=Y3(J,Z.selected.diagnostic,Q)||Y3(J,null,Q)}if(!J.size&&X&&$.state.facet(i3).autoPanel)X=null;Z=new A2(J,X,Y)}for(let J of $.effects)if(J.is(EX)){let Y=!$.state.facet(i3).autoPanel?Z.panel:J.value.length?r3.open:null;Z=A2.init(J.value,Y,$.state)}else if(J.is(j8))Z=new A2(Z.diagnostics,J.value?r3.open:null,Z.selected);else if(J.is(PX))Z=new A2(Z.diagnostics,Z.panel,J.value);return Z},provide:(Z)=>[H2.from(Z,($)=>$.panel),P.decorations.from(Z,($)=>$.diagnostics)]});var hj=g.mark({class:"cm-lintRange cm-lintRange-active"});function wj(Z,$,J){let{diagnostics:Y}=Z.state.field($1),X,Q=-1,K=-1;Y.between($-(J<0?1:0),$+(J>0?1:0),(q,G,{spec:W})=>{if($>=q&&$<=G&&(q==G||($>q||J>0)&&($<G||J<0)))return X=W.diagnostics,Q=q,K=G,!1});let U=Z.state.facet(i3).tooltipFilter;if(X&&U)X=U(X,Z.state);if(!X)return null;return{pos:Q,end:K,above:Z.state.doc.lineAt(Q).to<K,create(){return{dom:vj(Z,X)}}}}function vj(Z,$){return J0("ul",{class:"cm-tooltip-lint"},$.map((J)=>yX(Z,J,!1)))}var uj=(Z)=>{let $=Z.state.field($1,!1);if(!$||!$.panel)Z.dispatch({effects:xj(Z.state,[j8.of(!0)])});let J=h3(Z,r3.open);if(J)J.dom.querySelector(".cm-panel-lint ul").focus();return!0},AX=(Z)=>{let $=Z.state.field($1,!1);if(!$||!$.panel)return!1;return Z.dispatch({effects:j8.of(!1)}),!0},mj=(Z)=>{let $=Z.state.field($1,!1);if(!$)return!1;let J=Z.state.selection.main,Y=$.diagnostics.iter(J.to+1);if(!Y.value){if(Y=$.diagnostics.iter(0),!Y.value||Y.from==J.from&&Y.to==J.to)return!1}return Z.dispatch({selection:{anchor:Y.from,head:Y.to},scrollIntoView:!0}),!0};var CX=[{key:"Mod-Shift-m",run:uj,preventDefault:!0},{key:"F8",run:mj}];var i3=S.define({combine(Z){return{sources:Z.map(($)=>$.source).filter(($)=>$!=null),...u0(Z.map(($)=>$.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:BX,tooltipFilter:BX,needsRefresh:($,J)=>!$?J:!J?$:(Y)=>$(Y)||J(Y),hideOn:($,J)=>!$?J:!J?$:(Y,X,Q)=>$(Y,X,Q)||J(Y,X,Q),autoPanel:($,J)=>$||J})}}});function BX(Z,$){return!Z?$:!$?Z:(J,Y)=>$(Z(J,Y),Y)}function TX(Z){let $=[];if(Z)Z:for(let{name:J}of Z){for(let Y=0;Y<J.length;Y++){let X=J[Y];if(/[a-zA-Z]/.test(X)&&!$.some((Q)=>Q.toLowerCase()==X.toLowerCase())){$.push(X);continue Z}}$.push("")}return $}function yX(Z,$,J){var Y;let X=J?TX($.actions):[];return J0("li",{class:"cm-diagnostic cm-diagnostic-"+$.severity},J0("span",{class:"cm-diagnosticText"},$.renderMessage?$.renderMessage(Z):$.message),(Y=$.actions)===null||Y===void 0?void 0:Y.map((Q,K)=>{let U=!1,q=(z)=>{if(z.preventDefault(),U)return;U=!0;let V=Y3(Z.state.field($1).diagnostics,$);if(V)Q.apply(Z,V.from,V.to)},{name:G}=Q,W=X[K]?G.indexOf(X[K]):-1,j=W<0?G:[G.slice(0,W),J0("u",G.slice(W,W+1)),G.slice(W+1)],_=Q.markClass?" "+Q.markClass:"";return J0("button",{type:"button",class:"cm-diagnosticAction"+_,onclick:q,onmousedown:q,"aria-label":` Action: ${G}${W<0?"":` (access key "${X[K]})"`}.`},j)}),$.source&&J0("div",{class:"cm-diagnosticSource"},$.source))}class bX extends e0{constructor(Z){super();this.sev=Z}eq(Z){return Z.sev==this.sev}toDOM(){return J0("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class W8{constructor(Z,$){this.diagnostic=$,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=yX(Z,$,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class r3{constructor(Z){this.view=Z,this.items=[];let $=(Y)=>{if(Y.ctrlKey||Y.altKey||Y.metaKey)return;if(Y.keyCode==27)AX(this.view),this.view.focus();else if(Y.keyCode==38||Y.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(Y.keyCode==40||Y.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(Y.keyCode==36)this.moveSelection(0);else if(Y.keyCode==35)this.moveSelection(this.items.length-1);else if(Y.keyCode==13)this.view.focus();else if(Y.keyCode>=65&&Y.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:X}=this.items[this.selectedIndex],Q=TX(X.actions);for(let K=0;K<Q.length;K++)if(Q[K].toUpperCase().charCodeAt(0)==Y.keyCode){let U=Y3(this.view.state.field($1).diagnostics,X);if(U)X.actions[K].apply(Z,U.from,U.to)}}else return;Y.preventDefault()},J=(Y)=>{for(let X=0;X<this.items.length;X++)if(this.items[X].dom.contains(Y.target))this.moveSelection(X)};this.list=J0("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:$,onclick:J}),this.dom=J0("div",{class:"cm-panel-lint"},this.list,J0("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>AX(this.view)},"Ã—")),this.update()}get selectedIndex(){let Z=this.view.state.field($1).selected;if(!Z)return-1;for(let $=0;$<this.items.length;$++)if(this.items[$].diagnostic==Z.diagnostic)return $;return-1}update(){let{diagnostics:Z,selected:$}=this.view.state.field($1),J=0,Y=!1,X=null,Q=new Set;Z.between(0,this.view.state.doc.length,(K,U,{spec:q})=>{for(let G of q.diagnostics){if(Q.has(G))continue;Q.add(G);let W=-1,j;for(let _=J;_<this.items.length;_++)if(this.items[_].diagnostic==G){W=_;break}if(W<0)j=new W8(this.view,G),this.items.splice(J,0,j),Y=!0;else if(j=this.items[W],W>J)this.items.splice(J,W-J),Y=!0;if($&&j.diagnostic==$.diagnostic){if(!j.dom.hasAttribute("aria-selected"))j.dom.setAttribute("aria-selected","true"),X=j}else if(j.dom.hasAttribute("aria-selected"))j.dom.removeAttribute("aria-selected");J++}});while(J<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0))Y=!0,this.items.pop();if(this.items.length==0)this.items.push(new W8(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),Y=!0;if(X)this.list.setAttribute("aria-activedescendant",X.id),this.view.requestMeasure({key:this,read:()=>({sel:X.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:K,panel:U})=>{let q=U.height/this.list.offsetHeight;if(K.top<U.top)this.list.scrollTop-=(U.top-K.top)/q;else if(K.bottom>U.bottom)this.list.scrollTop+=(K.bottom-U.bottom)/q}});else if(this.selectedIndex<0)this.list.removeAttribute("aria-activedescendant");if(Y)this.sync()}sync(){let Z=this.list.firstChild;function $(){let J=Z;Z=J.nextSibling,J.remove()}for(let J of this.items)if(J.dom.parentNode==this.list){while(Z!=J.dom)$();Z=J.dom.nextSibling}else this.list.insertBefore(J.dom,Z);while(Z)$()}moveSelection(Z){if(this.selectedIndex<0)return;let $=this.view.state.field($1),J=Y3($.diagnostics,this.items[Z].diagnostic);if(!J)return;this.view.dispatch({selection:{anchor:J.from,head:J.to},scrollIntoView:!0,effects:PX.of(J)})}static open(Z){return new r3(Z)}}function gj(Z,$='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${$}>${encodeURIComponent(Z)}</svg>')`}function k9(Z){return gj(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${Z}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}var fj=P.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:0.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:k9("#d11")},".cm-lintRange-warning":{backgroundImage:k9("orange")},".cm-lintRange-info":{backgroundImage:k9("#999")},".cm-lintRange-hint":{backgroundImage:k9("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function pj(Z){return Z=="error"?4:Z=="warning"?3:Z=="info"?2:1}function lj(Z){let $="hint",J=1;for(let Y of Z){let X=pj(Y.severity);if(X>J)J=X,$=Y.severity}return $}var dj=[$1,P.decorations.compute([$1],(Z)=>{let{selected:$,panel:J}=Z.field($1);return!$||!J||$.from==$.to?g.none:g.set([hj.range($.from,$.to)])}),a$(wj,{hideOn:Sj}),fj];var kX=(()=>[YJ(),XJ(),l$(),WY(),gJ(),u$(),f$(),i.allowMultipleSelections.of(!0),bJ(),j9(lJ,{fallback:!0}),nJ(),FX(),b9(),n$(),i$(),s$(),iY(),N2.of([...LX,...R9,...$X,...OY,...wJ,...q8,...CX])])();function _8(Z){var $={as:"keyword",do:"keyword",else:"keyword",end:"keyword",exception:"keyword",fun:"keyword",functor:"keyword",if:"keyword",in:"keyword",include:"keyword",let:"keyword",of:"keyword",open:"keyword",rec:"keyword",struct:"keyword",then:"keyword",type:"keyword",val:"keyword",while:"keyword",with:"keyword"},J=Z.extraWords||{};for(var Y in J)if(J.hasOwnProperty(Y))$[Y]=Z.extraWords[Y];var X=[];for(var Q in $)X.push(Q);function K(W,j){var _=W.next();if(_==='"')return j.tokenize=U,j.tokenize(W,j);if(_==="{"){if(W.eat("|"))return j.longString=!0,j.tokenize=G,j.tokenize(W,j)}if(_==="("){if(W.match(/^\*(?!\))/))return j.commentLevel++,j.tokenize=q,j.tokenize(W,j)}if(_==="~"||_==="?")return W.eatWhile(/\w/),"variableName.special";if(_==="`")return W.eatWhile(/\w/),"quote";if(_==="/"&&Z.slashComments&&W.eat("/"))return W.skipToEnd(),"comment";if(/\d/.test(_)){if(_==="0"&&W.eat(/[bB]/))W.eatWhile(/[01]/);if(_==="0"&&W.eat(/[xX]/))W.eatWhile(/[0-9a-fA-F]/);if(_==="0"&&W.eat(/[oO]/))W.eatWhile(/[0-7]/);else{if(W.eatWhile(/[\d_]/),W.eat("."))W.eatWhile(/[\d]/);if(W.eat(/[eE]/))W.eatWhile(/[\d\-+]/)}return"number"}if(/[+\-*&%=<>!?|@\.~:]/.test(_))return"operator";if(/[\w\xa1-\uffff]/.test(_)){W.eatWhile(/[\w\xa1-\uffff]/);var z=W.current();return $.hasOwnProperty(z)?$[z]:"variable"}return null}function U(W,j){var _,z=!1,V=!1;while((_=W.next())!=null){if(_==='"'&&!V){z=!0;break}V=!V&&_==="\\"}if(z&&!V)j.tokenize=K;return"string"}function q(W,j){var _,z;while(j.commentLevel>0&&(z=W.next())!=null){if(_==="("&&z==="*")j.commentLevel++;if(_==="*"&&z===")")j.commentLevel--;_=z}if(j.commentLevel<=0)j.tokenize=K;return"comment"}function G(W,j){var _,z;while(j.longString&&(z=W.next())!=null){if(_==="|"&&z==="}")j.longString=!1;_=z}if(!j.longString)j.tokenize=K;return"string"}return{startState:function(){return{tokenize:K,commentLevel:0,longString:!1}},token:function(W,j){if(W.eatSpace())return null;return j.tokenize(W,j)},languageData:{autocomplete:X,commentTokens:{line:Z.slashComments?"//":void 0,block:{open:"(*",close:"*)"}}}}}var S9=_8({name:"ocaml",extraWords:{and:"keyword",assert:"keyword",begin:"keyword",class:"keyword",constraint:"keyword",done:"keyword",downto:"keyword",external:"keyword",function:"keyword",initializer:"keyword",lazy:"keyword",match:"keyword",method:"keyword",module:"keyword",mutable:"keyword",new:"keyword",nonrec:"keyword",object:"keyword",private:"keyword",sig:"keyword",to:"keyword",try:"keyword",value:"keyword",virtual:"keyword",when:"keyword",raise:"builtin",failwith:"builtin",true:"builtin",false:"builtin",asr:"builtin",land:"builtin",lor:"builtin",lsl:"builtin",lsr:"builtin",lxor:"builtin",mod:"builtin",or:"builtin",raise_notrace:"builtin",trace:"builtin",exit:"builtin",print_string:"builtin",print_endline:"builtin",int:"type",float:"type",bool:"type",char:"type",string:"type",unit:"type",List:"builtin"}}),rO=_8({name:"fsharp",extraWords:{abstract:"keyword",assert:"keyword",base:"keyword",begin:"keyword",class:"keyword",default:"keyword",delegate:"keyword","do!":"keyword",done:"keyword",downcast:"keyword",downto:"keyword",elif:"keyword",extern:"keyword",finally:"keyword",for:"keyword",function:"keyword",global:"keyword",inherit:"keyword",inline:"keyword",interface:"keyword",internal:"keyword",lazy:"keyword","let!":"keyword",match:"keyword",member:"keyword",module:"keyword",mutable:"keyword",namespace:"keyword",new:"keyword",null:"keyword",override:"keyword",private:"keyword",public:"keyword","return!":"keyword",return:"keyword",select:"keyword",static:"keyword",to:"keyword",try:"keyword",upcast:"keyword","use!":"keyword",use:"keyword",void:"keyword",when:"keyword","yield!":"keyword",yield:"keyword",atomic:"keyword",break:"keyword",checked:"keyword",component:"keyword",const:"keyword",constraint:"keyword",constructor:"keyword",continue:"keyword",eager:"keyword",event:"keyword",external:"keyword",fixed:"keyword",method:"keyword",mixin:"keyword",object:"keyword",parallel:"keyword",process:"keyword",protected:"keyword",pure:"keyword",sealed:"keyword",tailcall:"keyword",trait:"keyword",virtual:"keyword",volatile:"keyword",List:"builtin",Seq:"builtin",Map:"builtin",Set:"builtin",Option:"builtin",int:"builtin",string:"builtin",not:"builtin",true:"builtin",false:"builtin",raise:"builtin",failwith:"builtin"},slashComments:!0}),aO=_8({name:"sml",extraWords:{abstype:"keyword",and:"keyword",andalso:"keyword",case:"keyword",datatype:"keyword",fn:"keyword",handle:"keyword",infix:"keyword",infixr:"keyword",local:"keyword",nonfix:"keyword",op:"keyword",orelse:"keyword",raise:"keyword",withtype:"keyword",eqtype:"keyword",sharing:"keyword",sig:"keyword",signature:"keyword",structure:"keyword",where:"keyword",true:"keyword",false:"keyword",int:"builtin",real:"builtin",string:"builtin",char:"builtin",bool:"builtin"},slashComments:!0});var z8={version:"1.7.1",latte:{name:"Latte",emoji:"\uD83C\uDF3B",order:0,dark:!1,colors:{rosewater:{name:"Rosewater",order:0,hex:"#dc8a78",rgb:{r:220,g:138,b:120},hsl:{h:10.799999999999995,s:0.5882352941176472,l:0.6666666666666667},accent:!0},flamingo:{name:"Flamingo",order:1,hex:"#dd7878",rgb:{r:221,g:120,b:120},hsl:{h:0,s:0.5976331360946746,l:0.6686274509803922},accent:!0},pink:{name:"Pink",order:2,hex:"#ea76cb",rgb:{r:234,g:118,b:203},hsl:{h:316.0344827586207,s:0.7341772151898731,l:0.6901960784313725},accent:!0},mauve:{name:"Mauve",order:3,hex:"#8839ef",rgb:{r:136,g:57,b:239},hsl:{h:266.0439560439561,s:0.8504672897196262,l:0.5803921568627451},accent:!0},red:{name:"Red",order:4,hex:"#d20f39",rgb:{r:210,g:15,b:57},hsl:{h:347.0769230769231,s:0.8666666666666666,l:0.4411764705882353},accent:!0},maroon:{name:"Maroon",order:5,hex:"#e64553",rgb:{r:230,g:69,b:83},hsl:{h:354.78260869565213,s:0.76303317535545,l:0.5862745098039216},accent:!0},peach:{name:"Peach",order:6,hex:"#fe640b",rgb:{r:254,g:100,b:11},hsl:{h:21.975308641975307,s:0.9918367346938776,l:0.5196078431372549},accent:!0},yellow:{name:"Yellow",order:7,hex:"#df8e1d",rgb:{r:223,g:142,b:29},hsl:{h:34.948453608247426,s:0.7698412698412698,l:0.49411764705882355},accent:!0},green:{name:"Green",order:8,hex:"#40a02b",rgb:{r:64,g:160,b:43},hsl:{h:109.23076923076923,s:0.5763546798029556,l:0.39803921568627454},accent:!0},teal:{name:"Teal",order:9,hex:"#179299",rgb:{r:23,g:146,b:153},hsl:{h:183.23076923076923,s:0.7386363636363636,l:0.34509803921568627},accent:!0},sky:{name:"Sky",order:10,hex:"#04a5e5",rgb:{r:4,g:165,b:229},hsl:{h:197.0666666666667,s:0.965665236051502,l:0.45686274509803926},accent:!0},sapphire:{name:"Sapphire",order:11,hex:"#209fb5",rgb:{r:32,g:159,b:181},hsl:{h:188.85906040268458,s:0.6995305164319249,l:0.4176470588235294},accent:!0},blue:{name:"Blue",order:12,hex:"#1e66f5",rgb:{r:30,g:102,b:245},hsl:{h:219.90697674418607,s:0.9148936170212768,l:0.5392156862745098},accent:!0},lavender:{name:"Lavender",order:13,hex:"#7287fd",rgb:{r:114,g:135,b:253},hsl:{h:230.93525179856115,s:0.9720279720279721,l:0.7196078431372549},accent:!0},text:{name:"Text",order:14,hex:"#4c4f69",rgb:{r:76,g:79,b:105},hsl:{h:233.79310344827587,s:0.16022099447513813,l:0.3549019607843137},accent:!1},subtext1:{name:"Subtext 1",order:15,hex:"#5c5f77",rgb:{r:92,g:95,b:119},hsl:{h:233.33333333333334,s:0.1279620853080569,l:0.4137254901960784},accent:!1},subtext0:{name:"Subtext 0",order:16,hex:"#6c6f85",rgb:{r:108,g:111,b:133},hsl:{h:232.79999999999998,s:0.10373443983402494,l:0.4725490196078431},accent:!1},overlay2:{name:"Overlay 2",order:17,hex:"#7c7f93",rgb:{r:124,g:127,b:147},hsl:{h:232.17391304347825,s:0.09623430962343092,l:0.5313725490196078},accent:!1},overlay1:{name:"Overlay 1",order:18,hex:"#8c8fa1",rgb:{r:140,g:143,b:161},hsl:{h:231.42857142857144,s:0.10047846889952144,l:0.5901960784313726},accent:!1},overlay0:{name:"Overlay 0",order:19,hex:"#9ca0b0",rgb:{r:156,g:160,b:176},hsl:{h:228.00000000000003,s:0.11235955056179768,l:0.6509803921568628},accent:!1},surface2:{name:"Surface 2",order:20,hex:"#acb0be",rgb:{r:172,g:176,b:190},hsl:{h:226.6666666666667,s:0.12162162162162159,l:0.7098039215686275},accent:!1},surface1:{name:"Surface 1",order:21,hex:"#bcc0cc",rgb:{r:188,g:192,b:204},hsl:{h:225.00000000000003,s:0.13559322033898308,l:0.7686274509803922},accent:!1},surface0:{name:"Surface 0",order:22,hex:"#ccd0da",rgb:{r:204,g:208,b:218},hsl:{h:222.85714285714292,s:0.1590909090909089,l:0.8274509803921568},accent:!1},base:{name:"Base",order:23,hex:"#eff1f5",rgb:{r:239,g:241,b:245},hsl:{h:220.00000000000009,s:0.23076923076923136,l:0.9490196078431372},accent:!1},mantle:{name:"Mantle",order:24,hex:"#e6e9ef",rgb:{r:230,g:233,b:239},hsl:{h:220.00000000000006,s:0.21951219512195116,l:0.919607843137255},accent:!1},crust:{name:"Crust",order:25,hex:"#dce0e8",rgb:{r:220,g:224,b:232},hsl:{h:220.00000000000006,s:0.20689655172413762,l:0.8862745098039215},accent:!1}},ansiColors:{black:{name:"Black",order:0,normal:{name:"Black",hex:"#5c5f77",rgb:{r:92,g:95,b:119},hsl:{h:233.33333333333334,s:0.1279620853080569,l:0.4137254901960784},code:0},bright:{name:"Bright Black",hex:"#6c6f85",rgb:{r:108,g:111,b:133},hsl:{h:232.79999999999998,s:0.10373443983402494,l:0.4725490196078431},code:8}},red:{name:"Red",order:1,normal:{name:"Red",hex:"#d20f39",rgb:{r:210,g:15,b:57},hsl:{h:347.0769230769231,s:0.8666666666666666,l:0.4411764705882353},code:1},bright:{name:"Bright Red",hex:"#de293e",rgb:{r:222,g:41,b:62},hsl:{h:353.0386740331492,s:0.7327935222672065,l:0.515686274509804},code:9}},green:{name:"Green",order:2,normal:{name:"Green",hex:"#40a02b",rgb:{r:64,g:160,b:43},hsl:{h:109.23076923076923,s:0.5763546798029556,l:0.39803921568627454},code:2},bright:{name:"Bright Green",hex:"#49af3d",rgb:{r:73,g:175,b:61},hsl:{h:113.68421052631581,s:0.48305084745762705,l:0.4627450980392157},code:10}},yellow:{name:"Yellow",order:3,normal:{name:"Yellow",hex:"#df8e1d",rgb:{r:223,g:142,b:29},hsl:{h:34.948453608247426,s:0.7698412698412698,l:0.49411764705882355},code:3},bright:{name:"Bright Yellow",hex:"#eea02d",rgb:{r:238,g:160,b:45},hsl:{h:35.751295336787564,s:0.8502202643171807,l:0.5549019607843138},code:11}},blue:{name:"Blue",order:4,normal:{name:"Blue",hex:"#1e66f5",rgb:{r:30,g:102,b:245},hsl:{h:219.90697674418607,s:0.9148936170212768,l:0.5392156862745098},code:4},bright:{name:"Bright Blue",hex:"#456eff",rgb:{r:69,g:110,b:255},hsl:{h:226.77419354838707,s:1,l:0.6352941176470588},code:12}},magenta:{name:"Magenta",order:5,normal:{name:"Magenta",hex:"#ea76cb",rgb:{r:234,g:118,b:203},hsl:{h:316.0344827586207,s:0.7341772151898731,l:0.6901960784313725},code:5},bright:{name:"Bright Magenta",hex:"#fe85d8",rgb:{r:254,g:133,b:216},hsl:{h:318.8429752066116,s:0.983739837398374,l:0.7588235294117647},code:13}},cyan:{name:"Cyan",order:6,normal:{name:"Cyan",hex:"#179299",rgb:{r:23,g:146,b:153},hsl:{h:183.23076923076923,s:0.7386363636363636,l:0.34509803921568627},code:6},bright:{name:"Bright Cyan",hex:"#2d9fa8",rgb:{r:45,g:159,b:168},hsl:{h:184.39024390243904,s:0.5774647887323943,l:0.4176470588235294},code:14}},white:{name:"White",order:7,normal:{name:"White",hex:"#acb0be",rgb:{r:172,g:176,b:190},hsl:{h:226.6666666666667,s:0.12162162162162159,l:0.7098039215686275},code:7},bright:{name:"Bright White",hex:"#bcc0cc",rgb:{r:188,g:192,b:204},hsl:{h:225.00000000000003,s:0.13559322033898308,l:0.7686274509803922},code:15}}}},frappe:{name:"FrappÃ©",emoji:"\uD83E\uDEB4",order:1,dark:!0,colors:{rosewater:{name:"Rosewater",order:0,hex:"#f2d5cf",rgb:{r:242,g:213,b:207},hsl:{h:10.2857142857143,s:0.5737704918032784,l:0.8803921568627451},accent:!0},flamingo:{name:"Flamingo",order:1,hex:"#eebebe",rgb:{r:238,g:190,b:190},hsl:{h:0,s:0.5853658536585367,l:0.8392156862745098},accent:!0},pink:{name:"Pink",order:2,hex:"#f4b8e4",rgb:{r:244,g:184,b:228},hsl:{h:316,s:0.7317073170731713,l:0.8392156862745098},accent:!0},mauve:{name:"Mauve",order:3,hex:"#ca9ee6",rgb:{r:202,g:158,b:230},hsl:{h:276.66666666666663,s:0.5901639344262294,l:0.7607843137254902},accent:!0},red:{name:"Red",order:4,hex:"#e78284",rgb:{r:231,g:130,b:132},hsl:{h:358.8118811881188,s:0.6778523489932885,l:0.7078431372549019},accent:!0},maroon:{name:"Maroon",order:5,hex:"#ea999c",rgb:{r:234,g:153,b:156},hsl:{h:357.77777777777777,s:0.6585365853658534,l:0.7588235294117647},accent:!0},peach:{name:"Peach",order:6,hex:"#ef9f76",rgb:{r:239,g:159,b:118},hsl:{h:20.33057851239669,s:0.7908496732026143,l:0.7},accent:!0},yellow:{name:"Yellow",order:7,hex:"#e5c890",rgb:{r:229,g:200,b:144},hsl:{h:39.52941176470588,s:0.6204379562043796,l:0.7313725490196079},accent:!0},green:{name:"Green",order:8,hex:"#a6d189",rgb:{r:166,g:209,b:137},hsl:{h:95.83333333333331,s:0.4390243902439024,l:0.6784313725490196},accent:!0},teal:{name:"Teal",order:9,hex:"#81c8be",rgb:{r:129,g:200,b:190},hsl:{h:171.5492957746479,s:0.3922651933701657,l:0.6450980392156862},accent:!0},sky:{name:"Sky",order:10,hex:"#99d1db",rgb:{r:153,g:209,b:219},hsl:{h:189.09090909090907,s:0.47826086956521735,l:0.7294117647058823},accent:!0},sapphire:{name:"Sapphire",order:11,hex:"#85c1dc",rgb:{r:133,g:193,b:220},hsl:{h:198.62068965517244,s:0.5541401273885351,l:0.692156862745098},accent:!0},blue:{name:"Blue",order:12,hex:"#8caaee",rgb:{r:140,g:170,b:238},hsl:{h:221.6326530612245,s:0.7424242424242424,l:0.7411764705882353},accent:!0},lavender:{name:"Lavender",order:13,hex:"#babbf1",rgb:{r:186,g:187,b:241},hsl:{h:238.90909090909093,s:0.6626506024096385,l:0.8372549019607842},accent:!0},text:{name:"Text",order:14,hex:"#c6d0f5",rgb:{r:198,g:208,b:245},hsl:{h:227.2340425531915,s:0.7014925373134333,l:0.8686274509803922},accent:!1},subtext1:{name:"Subtext 1",order:15,hex:"#b5bfe2",rgb:{r:181,g:191,b:226},hsl:{h:226.66666666666669,s:0.43689320388349495,l:0.7980392156862746},accent:!1},subtext0:{name:"Subtext 0",order:16,hex:"#a5adce",rgb:{r:165,g:173,b:206},hsl:{h:228.29268292682926,s:0.2949640287769784,l:0.7274509803921569},accent:!1},overlay2:{name:"Overlay 2",order:17,hex:"#949cbb",rgb:{r:148,g:156,b:187},hsl:{h:227.69230769230768,s:0.22285714285714275,l:0.6568627450980392},accent:!1},overlay1:{name:"Overlay 1",order:18,hex:"#838ba7",rgb:{r:131,g:139,b:167},hsl:{h:226.66666666666669,s:0.16981132075471703,l:0.584313725490196},accent:!1},overlay0:{name:"Overlay 0",order:19,hex:"#737994",rgb:{r:115,g:121,b:148},hsl:{h:229.0909090909091,s:0.13360323886639683,l:0.515686274509804},accent:!1},surface2:{name:"Surface 2",order:20,hex:"#626880",rgb:{r:98,g:104,b:128},hsl:{h:228.00000000000003,s:0.1327433628318584,l:0.44313725490196076},accent:!1},surface1:{name:"Surface 1",order:21,hex:"#51576d",rgb:{r:81,g:87,b:109},hsl:{h:227.14285714285714,s:0.14736842105263157,l:0.37254901960784315},accent:!1},surface0:{name:"Surface 0",order:22,hex:"#414559",rgb:{r:65,g:69,b:89},hsl:{h:230.00000000000003,s:0.15584415584415584,l:0.30196078431372547},accent:!1},base:{name:"Base",order:23,hex:"#303446",rgb:{r:48,g:52,b:70},hsl:{h:229.0909090909091,s:0.18644067796610175,l:0.23137254901960785},accent:!1},mantle:{name:"Mantle",order:24,hex:"#292c3c",rgb:{r:41,g:44,b:60},hsl:{h:230.52631578947367,s:0.18811881188118806,l:0.19803921568627453},accent:!1},crust:{name:"Crust",order:25,hex:"#232634",rgb:{r:35,g:38,b:52},hsl:{h:229.41176470588238,s:0.19540229885057467,l:0.17058823529411765},accent:!1}},ansiColors:{black:{name:"Black",order:0,normal:{name:"Black",hex:"#51576d",rgb:{r:81,g:87,b:109},hsl:{h:227.14285714285714,s:0.14736842105263157,l:0.37254901960784315},code:0},bright:{name:"Bright Black",hex:"#626880",rgb:{r:98,g:104,b:128},hsl:{h:228.00000000000003,s:0.1327433628318584,l:0.44313725490196076},code:8}},red:{name:"Red",order:1,normal:{name:"Red",hex:"#e78284",rgb:{r:231,g:130,b:132},hsl:{h:358.8118811881188,s:0.6778523489932885,l:0.7078431372549019},code:1},bright:{name:"Bright Red",hex:"#e67172",rgb:{r:230,g:113,b:114},hsl:{h:359.4871794871795,s:0.7005988023952096,l:0.6725490196078432},code:9}},green:{name:"Green",order:2,normal:{name:"Green",hex:"#a6d189",rgb:{r:166,g:209,b:137},hsl:{h:95.83333333333331,s:0.4390243902439024,l:0.6784313725490196},code:2},bright:{name:"Bright Green",hex:"#8ec772",rgb:{r:142,g:199,b:114},hsl:{h:100.23529411764706,s:0.431472081218274,l:0.6137254901960785},code:10}},yellow:{name:"Yellow",order:3,normal:{name:"Yellow",hex:"#e5c890",rgb:{r:229,g:200,b:144},hsl:{h:39.52941176470588,s:0.6204379562043796,l:0.7313725490196079},code:3},bright:{name:"Bright Yellow",hex:"#d9ba73",rgb:{r:217,g:186,b:115},hsl:{h:41.764705882352935,s:0.5730337078651685,l:0.6509803921568628},code:11}},blue:{name:"Blue",order:4,normal:{name:"Blue",hex:"#8caaee",rgb:{r:140,g:170,b:238},hsl:{h:221.6326530612245,s:0.7424242424242424,l:0.7411764705882353},code:4},bright:{name:"Bright Blue",hex:"#7b9ef0",rgb:{r:123,g:158,b:240},hsl:{h:222.05128205128207,s:0.7959183673469388,l:0.711764705882353},code:12}},magenta:{name:"Magenta",order:5,normal:{name:"Magenta",hex:"#f4b8e4",rgb:{r:244,g:184,b:228},hsl:{h:316,s:0.7317073170731713,l:0.8392156862745098},code:5},bright:{name:"Bright Magenta",hex:"#f2a4db",rgb:{r:242,g:164,b:219},hsl:{h:317.6923076923077,s:0.7499999999999998,l:0.7960784313725491},code:13}},cyan:{name:"Cyan",order:6,normal:{name:"Cyan",hex:"#81c8be",rgb:{r:129,g:200,b:190},hsl:{h:171.5492957746479,s:0.3922651933701657,l:0.6450980392156862},code:6},bright:{name:"Bright Cyan",hex:"#5abfb5",rgb:{r:90,g:191,b:181},hsl:{h:174.05940594059405,s:0.44104803493449785,l:0.5509803921568628},code:14}},white:{name:"White",order:7,normal:{name:"White",hex:"#a5adce",rgb:{r:165,g:173,b:206},hsl:{h:228.29268292682926,s:0.2949640287769784,l:0.7274509803921569},code:7},bright:{name:"Bright White",hex:"#b5bfe2",rgb:{r:181,g:191,b:226},hsl:{h:226.66666666666669,s:0.43689320388349495,l:0.7980392156862746},code:15}}}},macchiato:{name:"Macchiato",emoji:"\uD83C\uDF3A",order:2,dark:!0,colors:{rosewater:{name:"Rosewater",order:0,hex:"#f4dbd6",rgb:{r:244,g:219,b:214},hsl:{h:9.999999999999963,s:0.5769230769230775,l:0.8980392156862745},accent:!0},flamingo:{name:"Flamingo",order:1,hex:"#f0c6c6",rgb:{r:240,g:198,b:198},hsl:{h:0,s:0.5833333333333333,l:0.8588235294117648},accent:!0},pink:{name:"Pink",order:2,hex:"#f5bde6",rgb:{r:245,g:189,b:230},hsl:{h:316.0714285714286,s:0.7368421052631583,l:0.8509803921568628},accent:!0},mauve:{name:"Mauve",order:3,hex:"#c6a0f6",rgb:{r:198,g:160,b:246},hsl:{h:266.51162790697674,s:0.8269230769230772,l:0.7960784313725491},accent:!0},red:{name:"Red",order:4,hex:"#ed8796",rgb:{r:237,g:135,b:150},hsl:{h:351.1764705882353,s:0.7391304347826088,l:0.7294117647058824},accent:!0},maroon:{name:"Maroon",order:5,hex:"#ee99a0",rgb:{r:238,g:153,b:160},hsl:{h:355.05882352941177,s:0.7142857142857143,l:0.7666666666666666},accent:!0},peach:{name:"Peach",order:6,hex:"#f5a97f",rgb:{r:245,g:169,b:127},hsl:{h:21.355932203389827,s:0.8550724637681162,l:0.7294117647058824},accent:!0},yellow:{name:"Yellow",order:7,hex:"#eed49f",rgb:{r:238,g:212,b:159},hsl:{h:40.253164556962034,s:0.6991150442477877,l:0.7784313725490196},accent:!0},green:{name:"Green",order:8,hex:"#a6da95",rgb:{r:166,g:218,b:149},hsl:{h:105.21739130434783,s:0.4825174825174825,l:0.7196078431372549},accent:!0},teal:{name:"Teal",order:9,hex:"#8bd5ca",rgb:{r:139,g:213,b:202},hsl:{h:171.08108108108107,s:0.46835443037974706,l:0.6901960784313725},accent:!0},sky:{name:"Sky",order:10,hex:"#91d7e3",rgb:{r:145,g:215,b:227},hsl:{h:188.78048780487802,s:0.5942028985507245,l:0.7294117647058823},accent:!0},sapphire:{name:"Sapphire",order:11,hex:"#7dc4e4",rgb:{r:125,g:196,b:228},hsl:{h:198.64077669902912,s:0.6560509554140128,l:0.692156862745098},accent:!0},blue:{name:"Blue",order:12,hex:"#8aadf4",rgb:{r:138,g:173,b:244},hsl:{h:220.188679245283,s:0.8281250000000003,l:0.7490196078431373},accent:!0},lavender:{name:"Lavender",order:13,hex:"#b7bdf8",rgb:{r:183,g:189,b:248},hsl:{h:234.46153846153848,s:0.8227848101265824,l:0.8450980392156863},accent:!0},text:{name:"Text",order:14,hex:"#cad3f5",rgb:{r:202,g:211,b:245},hsl:{h:227.4418604651163,s:0.6825396825396831,l:0.8764705882352941},accent:!1},subtext1:{name:"Subtext 1",order:15,hex:"#b8c0e0",rgb:{r:184,g:192,b:224},hsl:{h:228,s:0.39215686274509803,l:0.8},accent:!1},subtext0:{name:"Subtext 0",order:16,hex:"#a5adcb",rgb:{r:165,g:173,b:203},hsl:{h:227.36842105263156,s:0.2676056338028167,l:0.7215686274509804},accent:!1},overlay2:{name:"Overlay 2",order:17,hex:"#939ab7",rgb:{r:147,g:154,b:183},hsl:{h:228.33333333333331,s:0.2000000000000001,l:0.6470588235294117},accent:!1},overlay1:{name:"Overlay 1",order:18,hex:"#8087a2",rgb:{r:128,g:135,b:162},hsl:{h:227.6470588235294,s:0.1545454545454545,l:0.5686274509803921},accent:!1},overlay0:{name:"Overlay 0",order:19,hex:"#6e738d",rgb:{r:110,g:115,b:141},hsl:{h:230.32258064516128,s:0.12350597609561753,l:0.49215686274509807},accent:!1},surface2:{name:"Surface 2",order:20,hex:"#5b6078",rgb:{r:91,g:96,b:120},hsl:{h:229.65517241379308,s:0.13744075829383887,l:0.4137254901960784},accent:!1},surface1:{name:"Surface 1",order:21,hex:"#494d64",rgb:{r:73,g:77,b:100},hsl:{h:231.11111111111114,s:0.15606936416184972,l:0.3392156862745098},accent:!1},surface0:{name:"Surface 0",order:22,hex:"#363a4f",rgb:{r:54,g:58,b:79},hsl:{h:230.4,s:0.1879699248120301,l:0.2607843137254902},accent:!1},base:{name:"Base",order:23,hex:"#24273a",rgb:{r:36,g:39,b:58},hsl:{h:231.8181818181818,s:0.23404255319148934,l:0.1843137254901961},accent:!1},mantle:{name:"Mantle",order:24,hex:"#1e2030",rgb:{r:30,g:32,b:48},hsl:{h:233.33333333333334,s:0.23076923076923075,l:0.15294117647058825},accent:!1},crust:{name:"Crust",order:25,hex:"#181926",rgb:{r:24,g:25,b:38},hsl:{h:235.71428571428572,s:0.22580645161290322,l:0.12156862745098039},accent:!1}},ansiColors:{black:{name:"Black",order:0,normal:{name:"Black",hex:"#494d64",rgb:{r:73,g:77,b:100},hsl:{h:231.11111111111114,s:0.15606936416184972,l:0.3392156862745098},code:0},bright:{name:"Bright Black",hex:"#5b6078",rgb:{r:91,g:96,b:120},hsl:{h:229.65517241379308,s:0.13744075829383887,l:0.4137254901960784},code:8}},red:{name:"Red",order:1,normal:{name:"Red",hex:"#ed8796",rgb:{r:237,g:135,b:150},hsl:{h:351.1764705882353,s:0.7391304347826088,l:0.7294117647058824},code:1},bright:{name:"Bright Red",hex:"#ec7486",rgb:{r:236,g:116,b:134},hsl:{h:351,s:0.759493670886076,l:0.6901960784313725},code:9}},green:{name:"Green",order:2,normal:{name:"Green",hex:"#a6da95",rgb:{r:166,g:218,b:149},hsl:{h:105.21739130434783,s:0.4825174825174825,l:0.7196078431372549},code:2},bright:{name:"Bright Green",hex:"#8ccf7f",rgb:{r:140,g:207,b:127},hsl:{h:110.24999999999999,s:0.45454545454545453,l:0.6549019607843137},code:10}},yellow:{name:"Yellow",order:3,normal:{name:"Yellow",hex:"#eed49f",rgb:{r:238,g:212,b:159},hsl:{h:40.253164556962034,s:0.6991150442477877,l:0.7784313725490196},code:3},bright:{name:"Bright Yellow",hex:"#e1c682",rgb:{r:225,g:198,b:130},hsl:{h:42.94736842105264,s:0.6129032258064515,l:0.696078431372549},code:11}},blue:{name:"Blue",order:4,normal:{name:"Blue",hex:"#8aadf4",rgb:{r:138,g:173,b:244},hsl:{h:220.188679245283,s:0.8281250000000003,l:0.7490196078431373},code:4},bright:{name:"Bright Blue",hex:"#78a1f6",rgb:{r:120,g:161,b:246},hsl:{h:220.47619047619048,s:0.8750000000000002,l:0.7176470588235294},code:12}},magenta:{name:"Magenta",order:5,normal:{name:"Magenta",hex:"#f5bde6",rgb:{r:245,g:189,b:230},hsl:{h:316.0714285714286,s:0.7368421052631583,l:0.8509803921568628},code:5},bright:{name:"Bright Magenta",hex:"#f2a9dd",rgb:{r:242,g:169,b:221},hsl:{h:317.26027397260276,s:0.7373737373737372,l:0.8058823529411765},code:13}},cyan:{name:"Cyan",order:6,normal:{name:"Cyan",hex:"#8bd5ca",rgb:{r:139,g:213,b:202},hsl:{h:171.08108108108107,s:0.46835443037974706,l:0.6901960784313725},code:6},bright:{name:"Bright Cyan",hex:"#63cbc0",rgb:{r:99,g:203,b:192},hsl:{h:173.65384615384616,s:0.4999999999999998,l:0.592156862745098},code:14}},white:{name:"White",order:7,normal:{name:"White",hex:"#a5adcb",rgb:{r:165,g:173,b:203},hsl:{h:227.36842105263156,s:0.2676056338028167,l:0.7215686274509804},code:7},bright:{name:"Bright White",hex:"#b8c0e0",rgb:{r:184,g:192,b:224},hsl:{h:228,s:0.39215686274509803,l:0.8},code:15}}}},mocha:{name:"Mocha",emoji:"\uD83C\uDF3F",order:3,dark:!0,colors:{rosewater:{name:"Rosewater",order:0,hex:"#f5e0dc",rgb:{r:245,g:224,b:220},hsl:{h:9.599999999999968,s:0.555555555555556,l:0.911764705882353},accent:!0},flamingo:{name:"Flamingo",order:1,hex:"#f2cdcd",rgb:{r:242,g:205,b:205},hsl:{h:0,s:0.587301587301587,l:0.8764705882352941},accent:!0},pink:{name:"Pink",order:2,hex:"#f5c2e7",rgb:{r:245,g:194,b:231},hsl:{h:316.4705882352941,s:0.7183098591549301,l:0.8607843137254902},accent:!0},mauve:{name:"Mauve",order:3,hex:"#cba6f7",rgb:{r:203,g:166,b:247},hsl:{h:267.4074074074074,s:0.8350515463917528,l:0.8098039215686275},accent:!0},red:{name:"Red",order:4,hex:"#f38ba8",rgb:{r:243,g:139,b:168},hsl:{h:343.2692307692308,s:0.8124999999999998,l:0.7490196078431373},accent:!0},maroon:{name:"Maroon",order:5,hex:"#eba0ac",rgb:{r:235,g:160,b:172},hsl:{h:350.4,s:0.6521739130434779,l:0.7745098039215685},accent:!0},peach:{name:"Peach",order:6,hex:"#fab387",rgb:{r:250,g:179,b:135},hsl:{h:22.95652173913043,s:0.92,l:0.7549019607843137},accent:!0},yellow:{name:"Yellow",order:7,hex:"#f9e2af",rgb:{r:249,g:226,b:175},hsl:{h:41.35135135135135,s:0.8604651162790699,l:0.8313725490196078},accent:!0},green:{name:"Green",order:8,hex:"#a6e3a1",rgb:{r:166,g:227,b:161},hsl:{h:115.45454545454544,s:0.5409836065573769,l:0.7607843137254902},accent:!0},teal:{name:"Teal",order:9,hex:"#94e2d5",rgb:{r:148,g:226,b:213},hsl:{h:170.00000000000003,s:0.5735294117647057,l:0.7333333333333334},accent:!0},sky:{name:"Sky",order:10,hex:"#89dceb",rgb:{r:137,g:220,b:235},hsl:{h:189.18367346938774,s:0.7101449275362316,l:0.7294117647058823},accent:!0},sapphire:{name:"Sapphire",order:11,hex:"#74c7ec",rgb:{r:116,g:199,b:236},hsl:{h:198.5,s:0.759493670886076,l:0.6901960784313725},accent:!0},blue:{name:"Blue",order:12,hex:"#89b4fa",rgb:{r:137,g:180,b:250},hsl:{h:217.1681415929203,s:0.9186991869918699,l:0.7588235294117647},accent:!0},lavender:{name:"Lavender",order:13,hex:"#b4befe",rgb:{r:180,g:190,b:254},hsl:{h:231.89189189189187,s:0.9736842105263159,l:0.8509803921568628},accent:!0},text:{name:"Text",order:14,hex:"#cdd6f4",rgb:{r:205,g:214,b:244},hsl:{h:226.15384615384616,s:0.6393442622950825,l:0.8803921568627451},accent:!1},subtext1:{name:"Subtext 1",order:15,hex:"#bac2de",rgb:{r:186,g:194,b:222},hsl:{h:226.66666666666669,s:0.35294117647058837,l:0.8},accent:!1},subtext0:{name:"Subtext 0",order:16,hex:"#a6adc8",rgb:{r:166,g:173,b:200},hsl:{h:227.6470588235294,s:0.23611111111111102,l:0.7176470588235294},accent:!1},overlay2:{name:"Overlay 2",order:17,hex:"#9399b2",rgb:{r:147,g:153,b:178},hsl:{h:228.38709677419354,s:0.16756756756756758,l:0.6372549019607843},accent:!1},overlay1:{name:"Overlay 1",order:18,hex:"#7f849c",rgb:{r:127,g:132,b:156},hsl:{h:229.65517241379308,s:0.12775330396475776,l:0.5549019607843138},accent:!1},overlay0:{name:"Overlay 0",order:19,hex:"#6c7086",rgb:{r:108,g:112,b:134},hsl:{h:230.7692307692308,s:0.10743801652892565,l:0.4745098039215686},accent:!1},surface2:{name:"Surface 2",order:20,hex:"#585b70",rgb:{r:88,g:91,b:112},hsl:{h:232.5,s:0.12,l:0.39215686274509803},accent:!1},surface1:{name:"Surface 1",order:21,hex:"#45475a",rgb:{r:69,g:71,b:90},hsl:{h:234.2857142857143,s:0.13207547169811326,l:0.31176470588235294},accent:!1},surface0:{name:"Surface 0",order:22,hex:"#313244",rgb:{r:49,g:50,b:68},hsl:{h:236.84210526315792,s:0.16239316239316234,l:0.22941176470588237},accent:!1},base:{name:"Base",order:23,hex:"#1e1e2e",rgb:{r:30,g:30,b:46},hsl:{h:240,s:0.21052631578947367,l:0.14901960784313725},accent:!1},mantle:{name:"Mantle",order:24,hex:"#181825",rgb:{r:24,g:24,b:37},hsl:{h:240,s:0.2131147540983607,l:0.11960784313725491},accent:!1},crust:{name:"Crust",order:25,hex:"#11111b",rgb:{r:17,g:17,b:27},hsl:{h:240,s:0.22727272727272727,l:0.08627450980392157},accent:!1}},ansiColors:{black:{name:"Black",order:0,normal:{name:"Black",hex:"#45475a",rgb:{r:69,g:71,b:90},hsl:{h:234.2857142857143,s:0.13207547169811326,l:0.31176470588235294},code:0},bright:{name:"Bright Black",hex:"#585b70",rgb:{r:88,g:91,b:112},hsl:{h:232.5,s:0.12,l:0.39215686274509803},code:8}},red:{name:"Red",order:1,normal:{name:"Red",hex:"#f38ba8",rgb:{r:243,g:139,b:168},hsl:{h:343.2692307692308,s:0.8124999999999998,l:0.7490196078431373},code:1},bright:{name:"Bright Red",hex:"#f37799",rgb:{r:243,g:119,b:153},hsl:{h:343.54838709677415,s:0.8378378378378376,l:0.7098039215686274},code:9}},green:{name:"Green",order:2,normal:{name:"Green",hex:"#a6e3a1",rgb:{r:166,g:227,b:161},hsl:{h:115.45454545454544,s:0.5409836065573769,l:0.7607843137254902},code:2},bright:{name:"Bright Green",hex:"#89d88b",rgb:{r:137,g:216,b:139},hsl:{h:121.51898734177213,s:0.5031847133757963,l:0.692156862745098},code:10}},yellow:{name:"Yellow",order:3,normal:{name:"Yellow",hex:"#f9e2af",rgb:{r:249,g:226,b:175},hsl:{h:41.35135135135135,s:0.8604651162790699,l:0.8313725490196078},code:3},bright:{name:"Bright Yellow",hex:"#ebd391",rgb:{r:235,g:211,b:145},hsl:{h:44,s:0.692307692307692,l:0.7450980392156863},code:11}},blue:{name:"Blue",order:4,normal:{name:"Blue",hex:"#89b4fa",rgb:{r:137,g:180,b:250},hsl:{h:217.1681415929203,s:0.9186991869918699,l:0.7588235294117647},code:4},bright:{name:"Bright Blue",hex:"#74a8fc",rgb:{r:116,g:168,b:252},hsl:{h:217.05882352941174,s:0.9577464788732396,l:0.7215686274509804},code:12}},magenta:{name:"Magenta",order:5,normal:{name:"Magenta",hex:"#f5c2e7",rgb:{r:245,g:194,b:231},hsl:{h:316.4705882352941,s:0.7183098591549301,l:0.8607843137254902},code:5},bright:{name:"Bright Magenta",hex:"#f2aede",rgb:{r:242,g:174,b:222},hsl:{h:317.6470588235294,s:0.7234042553191488,l:0.8156862745098039},code:13}},cyan:{name:"Cyan",order:6,normal:{name:"Cyan",hex:"#94e2d5",rgb:{r:148,g:226,b:213},hsl:{h:170.00000000000003,s:0.5735294117647057,l:0.7333333333333334},code:6},bright:{name:"Bright Cyan",hex:"#6bd7ca",rgb:{r:107,g:215,b:202},hsl:{h:172.77777777777777,s:0.5744680851063831,l:0.6313725490196078},code:14}},white:{name:"White",order:7,normal:{name:"White",hex:"#a6adc8",rgb:{r:166,g:173,b:200},hsl:{h:227.6470588235294,s:0.23611111111111102,l:0.7176470588235294},code:7},bright:{name:"Bright White",hex:"#bac2de",rgb:{r:186,g:194,b:222},hsl:{h:226.66666666666669,s:0.35294117647058837,l:0.8},code:15}}}}};var x9=(Z)=>Object.entries(Z),{version:ZV,...cj}=z8,$V=z8.version,X3=x9(cj).reduce((Z,[$,J])=>{return Z[$]={...J,colorEntries:x9(J.colors),ansiColorEntries:x9(J.ansiColors)},Z},{}),JV=x9(X3);function h9(Z){let{colors:$,dark:J}=Z,Y=P.theme({"&":{color:$.text.hex,backgroundColor:$.base.hex},".cm-content":{caretColor:$.rosewater.hex},".cm-cursor, .cm-dropCursor":{borderLeftColor:$.rosewater.hex},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:$.surface2.hex},".cm-panels":{backgroundColor:$.mantle.hex,color:$.text.hex},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:`${$.blue.hex}59`,outline:`1px solid ${$.blue.hex}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:`${$.blue.hex}2f`},".cm-activeLine":{backgroundColor:$.surface0.hex},".cm-selectionMatch":{backgroundColor:`${$.surface2.hex}4d`},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:`${$.surface2.hex}47`,color:$.text.hex},".cm-gutters":{backgroundColor:$.base.hex,color:$.subtext0.hex,border:"none"},".cm-activeLineGutter":{backgroundColor:$.surface0.hex},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:$.overlay0.hex},".cm-tooltip":{border:"none",backgroundColor:$.surface0.hex},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:$.surface0.hex,borderBottomColor:$.surface0.hex},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:$.surface1.hex,color:$.text.hex}}},{dark:J}),X=r2.define([{tag:I.keyword,color:$.mauve.hex},{tag:[I.name,I.definition(I.name),I.deleted,I.character,I.macroName],color:$.text.hex},{tag:[I.function(I.variableName),I.function(I.propertyName),I.propertyName,I.labelName],color:$.blue.hex},{tag:[I.color,I.constant(I.name),I.standard(I.name)],color:$.peach.hex},{tag:[I.self,I.atom],color:$.red.hex},{tag:[I.typeName,I.className,I.changed,I.annotation,I.namespace],color:$.yellow.hex},{tag:[I.operator],color:$.sky.hex},{tag:[I.url,I.link],color:$.teal.hex},{tag:[I.escape,I.regexp],color:$.pink.hex},{tag:[I.meta,I.punctuation,I.separator,I.comment],color:$.overlay2.hex},{tag:I.strong,fontWeight:"bold"},{tag:I.emphasis,fontStyle:"italic"},{tag:I.strikethrough,textDecoration:"line-through"},{tag:I.link,color:$.blue.hex,textDecoration:"underline"},{tag:I.heading,fontWeight:"bold",color:$.blue.hex},{tag:[I.special(I.variableName)],color:$.lavender.hex},{tag:[I.bool,I.number],color:$.peach.hex},{tag:[I.processingInstruction,I.string,I.inserted],color:$.green.hex},{tag:I.invalid,color:$.red.hex}]);return[Y,j9(X)]}var SX=h9(X3.latte),qV=h9(X3.frappe),GV=h9(X3.macchiato),xX=h9(X3.mocha);var O8=new k2;function a3(Z){return Z?xX:SX}function Q3(Z,$=1000){let J=document.createElement("div");J.className="fixed bottom-4 right-4 bg-fg-primary text-bg-app px-4 py-2 rounded shadow-lg text-xs font-bold z-50",J.textContent=Z,document.body.appendChild(J),setTimeout(()=>J.remove(),$)}var Y2=null,K3=0,hX=0;function wX(Z,$){let J=document.getElementById("editor");if(!J)return;if(!Y2){let Y=window.matchMedia("(prefers-color-scheme: dark)").matches,X=i.create({doc:Z,extensions:[kX,b9(),N2.of([{key:"Tab",run:K8},{key:"Tab",run:()=>{let Q=Date.now();if(Q-hX>2000)K3=0;if(K3++,hX=Q,K3>=3)Q3("Press Esc + Tab to move focus out of editor",3000),K3=0;return!1}},...R9,pY,{key:"Mod-s",run:()=>{if($)$();return!0},preventDefault:!0}]),I2.define(S9),O8.of(a3(Y)),P.lineWrapping,P.theme({"&":{height:"100%",backgroundColor:"var(--bg-app)",color:"var(--fg-primary)"},".cm-scroller":{overflow:"auto",fontFamily:"var(--font-mono)"}}),P.domEventHandlers({keydown:(Q)=>{if(Q.key!=="Tab")K3=0},mousedown:()=>{K3=0}})]});Y2=new P({state:X,parent:J})}else{let Y=Y2.state.doc.toString();if(Y!==Z)Y2.dispatch({changes:{from:0,to:Y.length,insert:Z}})}}function vX(Z){if(Y2)Y2.dispatch({effects:O8.reconfigure(a3(Z))})}function w9(){return Y2?Y2.state.doc.toString():""}function H8(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var E2=H8();function dX(Z){E2=Z}var Z6={exec:()=>null};function Y0(Z,$=""){let J=typeof Z=="string"?Z:Z.source,Y={replace:(X,Q)=>{let K=typeof Q=="string"?Q:Q.source;return K=K.replace(l0.caret,"$1"),J=J.replace(X,K),Y},getRegex:()=>new RegExp(J,$)};return Y}var sj=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),l0={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:(Z)=>new RegExp(`^( {0,3}${Z})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}#`),htmlBeginRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}<(?:[a-z].*>|!--)`,"i")},nj=/^(?:[ \t]*(?:\n|$))+/,ij=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,rj=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,$6=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,aj=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,N8=/(?:[*+-]|\d{1,9}[.)])/,cX=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,sX=Y0(cX).replace(/bull/g,N8).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),oj=Y0(cX).replace(/bull/g,N8).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),R8=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,tj=/^[^\n]+/,F8=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,ej=Y0(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",F8).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Z_=Y0(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,N8).getRegex(),f9="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",I8=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,$_=Y0("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",I8).replace("tag",f9).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),nX=Y0(R8).replace("hr",$6).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",f9).getRegex(),J_=Y0(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",nX).getRegex(),D8={blockquote:J_,code:ij,def:ej,fences:rj,heading:aj,hr:$6,html:$_,lheading:sX,list:Z_,newline:nj,paragraph:nX,table:Z6,text:tj},uX=Y0("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",$6).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",f9).getRegex(),Y_={...D8,lheading:oj,table:uX,paragraph:Y0(R8).replace("hr",$6).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",uX).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",f9).getRegex()},X_={...D8,html:Y0(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",I8).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Z6,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Y0(R8).replace("hr",$6).replace("heading",` *#{1,6} *[^
]`).replace("lheading",sX).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Q_=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,K_=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,iX=/^( {2,}|\\)\n(?!\s*$)/,U_=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,p9=/[\p{P}\p{S}]/u,L8=/[\s\p{P}\p{S}]/u,rX=/[^\s\p{P}\p{S}]/u,q_=Y0(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,L8).getRegex(),aX=/(?!~)[\p{P}\p{S}]/u,G_=/(?!~)[\s\p{P}\p{S}]/u,W_=/(?:[^\s\p{P}\p{S}]|~)/u,j_=Y0(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",sj?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),oX=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,__=Y0(oX,"u").replace(/punct/g,p9).getRegex(),z_=Y0(oX,"u").replace(/punct/g,aX).getRegex(),tX="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",O_=Y0(tX,"gu").replace(/notPunctSpace/g,rX).replace(/punctSpace/g,L8).replace(/punct/g,p9).getRegex(),V_=Y0(tX,"gu").replace(/notPunctSpace/g,W_).replace(/punctSpace/g,G_).replace(/punct/g,aX).getRegex(),H_=Y0("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,rX).replace(/punctSpace/g,L8).replace(/punct/g,p9).getRegex(),N_=Y0(/\\(punct)/,"gu").replace(/punct/g,p9).getRegex(),R_=Y0(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),F_=Y0(I8).replace("(?:-->|$)","-->").getRegex(),I_=Y0("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",F_).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),u9=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,D_=Y0(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",u9).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),eX=Y0(/^!?\[(label)\]\[(ref)\]/).replace("label",u9).replace("ref",F8).getRegex(),ZQ=Y0(/^!?\[(ref)\](?:\[\])?/).replace("ref",F8).getRegex(),L_=Y0("reflink|nolink(?!\\()","g").replace("reflink",eX).replace("nolink",ZQ).getRegex(),mX=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,M8={_backpedal:Z6,anyPunctuation:N_,autolink:R_,blockSkip:j_,br:iX,code:K_,del:Z6,emStrongLDelim:__,emStrongRDelimAst:O_,emStrongRDelimUnd:H_,escape:Q_,link:D_,nolink:ZQ,punctuation:q_,reflink:eX,reflinkSearch:L_,tag:I_,text:U_,url:Z6},M_={...M8,link:Y0(/^!?\[(label)\]\((.*?)\)/).replace("label",u9).getRegex(),reflink:Y0(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",u9).getRegex()},V8={...M8,emStrongRDelimAst:V_,emStrongLDelim:z_,url:Y0(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",mX).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Y0(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",mX).getRegex()},A_={...V8,br:Y0(iX).replace("{2,}","*").getRegex(),text:Y0(V8.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},v9={normal:D8,gfm:Y_,pedantic:X_},o3={normal:M8,gfm:V8,breaks:A_,pedantic:M_},B_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},gX=(Z)=>B_[Z];function p1(Z,$){if($){if(l0.escapeTest.test(Z))return Z.replace(l0.escapeReplace,gX)}else if(l0.escapeTestNoEncode.test(Z))return Z.replace(l0.escapeReplaceNoEncode,gX);return Z}function fX(Z){try{Z=encodeURI(Z).replace(l0.percentDecode,"%")}catch{return null}return Z}function pX(Z,$){let J=Z.replace(l0.findPipe,(Q,K,U)=>{let q=!1,G=K;for(;--G>=0&&U[G]==="\\";)q=!q;return q?"|":" |"}),Y=J.split(l0.splitPipe),X=0;if(Y[0].trim()||Y.shift(),Y.length>0&&!Y.at(-1)?.trim()&&Y.pop(),$)if(Y.length>$)Y.splice($);else for(;Y.length<$;)Y.push("");for(;X<Y.length;X++)Y[X]=Y[X].trim().replace(l0.slashPipe,"|");return Y}function t3(Z,$,J){let Y=Z.length;if(Y===0)return"";let X=0;for(;X<Y;){let Q=Z.charAt(Y-X-1);if(Q===$&&!J)X++;else if(Q!==$&&J)X++;else break}return Z.slice(0,Y-X)}function E_(Z,$){if(Z.indexOf($[1])===-1)return-1;let J=0;for(let Y=0;Y<Z.length;Y++)if(Z[Y]==="\\")Y++;else if(Z[Y]===$[0])J++;else if(Z[Y]===$[1]&&(J--,J<0))return Y;return J>0?-2:-1}function lX(Z,$,J,Y,X){let Q=$.href,K=$.title||null,U=Z[1].replace(X.other.outputLinkReplace,"$1");Y.state.inLink=!0;let q={type:Z[0].charAt(0)==="!"?"image":"link",raw:J,href:Q,title:K,text:U,tokens:Y.inlineTokens(U)};return Y.state.inLink=!1,q}function P_(Z,$,J){let Y=Z.match(J.other.indentCodeCompensation);if(Y===null)return $;let X=Y[1];return $.split(`
`).map((Q)=>{let K=Q.match(J.other.beginningSpace);if(K===null)return Q;let[U]=K;return U.length>=X.length?Q.slice(X.length):Q}).join(`
`)}var m9=class{options;rules;lexer;constructor(Z){this.options=Z||E2}space(Z){let $=this.rules.block.newline.exec(Z);if($&&$[0].length>0)return{type:"space",raw:$[0]}}code(Z){let $=this.rules.block.code.exec(Z);if($){let J=$[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:$[0],codeBlockStyle:"indented",text:this.options.pedantic?J:t3(J,`
`)}}}fences(Z){let $=this.rules.block.fences.exec(Z);if($){let J=$[0],Y=P_(J,$[3]||"",this.rules);return{type:"code",raw:J,lang:$[2]?$[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):$[2],text:Y}}}heading(Z){let $=this.rules.block.heading.exec(Z);if($){let J=$[2].trim();if(this.rules.other.endingHash.test(J)){let Y=t3(J,"#");(this.options.pedantic||!Y||this.rules.other.endingSpaceChar.test(Y))&&(J=Y.trim())}return{type:"heading",raw:$[0],depth:$[1].length,text:J,tokens:this.lexer.inline(J)}}}hr(Z){let $=this.rules.block.hr.exec(Z);if($)return{type:"hr",raw:t3($[0],`
`)}}blockquote(Z){let $=this.rules.block.blockquote.exec(Z);if($){let J=t3($[0],`
`).split(`
`),Y="",X="",Q=[];for(;J.length>0;){let K=!1,U=[],q;for(q=0;q<J.length;q++)if(this.rules.other.blockquoteStart.test(J[q]))U.push(J[q]),K=!0;else if(!K)U.push(J[q]);else break;J=J.slice(q);let G=U.join(`
`),W=G.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");Y=Y?`${Y}
${G}`:G,X=X?`${X}
${W}`:W;let j=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(W,Q,!0),this.lexer.state.top=j,J.length===0)break;let _=Q.at(-1);if(_?.type==="code")break;if(_?.type==="blockquote"){let z=_,V=z.raw+`
`+J.join(`
`),O=this.blockquote(V);Q[Q.length-1]=O,Y=Y.substring(0,Y.length-z.raw.length)+O.raw,X=X.substring(0,X.length-z.text.length)+O.text;break}else if(_?.type==="list"){let z=_,V=z.raw+`
`+J.join(`
`),O=this.list(V);Q[Q.length-1]=O,Y=Y.substring(0,Y.length-_.raw.length)+O.raw,X=X.substring(0,X.length-z.raw.length)+O.raw,J=V.substring(Q.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:Y,tokens:Q,text:X}}}list(Z){let $=this.rules.block.list.exec(Z);if($){let J=$[1].trim(),Y=J.length>1,X={type:"list",raw:"",ordered:Y,start:Y?+J.slice(0,-1):"",loose:!1,items:[]};J=Y?`\\d{1,9}\\${J.slice(-1)}`:`\\${J}`,this.options.pedantic&&(J=Y?J:"[*+-]");let Q=this.rules.other.listItemRegex(J),K=!1;for(;Z;){let q=!1,G="",W="";if(!($=Q.exec(Z))||this.rules.block.hr.test(Z))break;G=$[0],Z=Z.substring(G.length);let j=$[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,(O)=>" ".repeat(3*O.length)),_=Z.split(`
`,1)[0],z=!j.trim(),V=0;if(this.options.pedantic?(V=2,W=j.trimStart()):z?V=$[1].length+1:(V=$[2].search(this.rules.other.nonSpaceChar),V=V>4?1:V,W=j.slice(V),V+=$[1].length),z&&this.rules.other.blankLine.test(_)&&(G+=_+`
`,Z=Z.substring(_.length+1),q=!0),!q){let O=this.rules.other.nextBulletRegex(V),H=this.rules.other.hrRegex(V),F=this.rules.other.fencesBeginRegex(V),D=this.rules.other.headingBeginRegex(V),M=this.rules.other.htmlBeginRegex(V);for(;Z;){let A=Z.split(`
`,1)[0],B;if(_=A,this.options.pedantic?(_=_.replace(this.rules.other.listReplaceNesting,"  "),B=_):B=_.replace(this.rules.other.tabCharGlobal,"    "),F.test(_)||D.test(_)||M.test(_)||O.test(_)||H.test(_))break;if(B.search(this.rules.other.nonSpaceChar)>=V||!_.trim())W+=`
`+B.slice(V);else{if(z||j.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||F.test(j)||D.test(j)||H.test(j))break;W+=`
`+_}!z&&!_.trim()&&(z=!0),G+=A+`
`,Z=Z.substring(A.length+1),j=B.slice(V)}}X.loose||(K?X.loose=!0:this.rules.other.doubleBlankLine.test(G)&&(K=!0)),X.items.push({type:"list_item",raw:G,task:!!this.options.gfm&&this.rules.other.listIsTask.test(W),loose:!1,text:W,tokens:[]}),X.raw+=G}let U=X.items.at(-1);if(U)U.raw=U.raw.trimEnd(),U.text=U.text.trimEnd();else return;X.raw=X.raw.trimEnd();for(let q of X.items){if(this.lexer.state.top=!1,q.tokens=this.lexer.blockTokens(q.text,[]),q.task){if(q.text=q.text.replace(this.rules.other.listReplaceTask,""),q.tokens[0]?.type==="text"||q.tokens[0]?.type==="paragraph"){q.tokens[0].raw=q.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),q.tokens[0].text=q.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let W=this.lexer.inlineQueue.length-1;W>=0;W--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[W].src)){this.lexer.inlineQueue[W].src=this.lexer.inlineQueue[W].src.replace(this.rules.other.listReplaceTask,"");break}}let G=this.rules.other.listTaskCheckbox.exec(q.raw);if(G){let W={type:"checkbox",raw:G[0]+" ",checked:G[0]!=="[ ]"};q.checked=W.checked,X.loose?q.tokens[0]&&["paragraph","text"].includes(q.tokens[0].type)&&"tokens"in q.tokens[0]&&q.tokens[0].tokens?(q.tokens[0].raw=W.raw+q.tokens[0].raw,q.tokens[0].text=W.raw+q.tokens[0].text,q.tokens[0].tokens.unshift(W)):q.tokens.unshift({type:"paragraph",raw:W.raw,text:W.raw,tokens:[W]}):q.tokens.unshift(W)}}if(!X.loose){let G=q.tokens.filter((j)=>j.type==="space"),W=G.length>0&&G.some((j)=>this.rules.other.anyLine.test(j.raw));X.loose=W}}if(X.loose)for(let q of X.items){q.loose=!0;for(let G of q.tokens)G.type==="text"&&(G.type="paragraph")}return X}}html(Z){let $=this.rules.block.html.exec(Z);if($)return{type:"html",block:!0,raw:$[0],pre:$[1]==="pre"||$[1]==="script"||$[1]==="style",text:$[0]}}def(Z){let $=this.rules.block.def.exec(Z);if($){let J=$[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),Y=$[2]?$[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",X=$[3]?$[3].substring(1,$[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):$[3];return{type:"def",tag:J,raw:$[0],href:Y,title:X}}}table(Z){let $=this.rules.block.table.exec(Z);if(!$||!this.rules.other.tableDelimiter.test($[2]))return;let J=pX($[1]),Y=$[2].replace(this.rules.other.tableAlignChars,"").split("|"),X=$[3]?.trim()?$[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],Q={type:"table",raw:$[0],header:[],align:[],rows:[]};if(J.length===Y.length){for(let K of Y)this.rules.other.tableAlignRight.test(K)?Q.align.push("right"):this.rules.other.tableAlignCenter.test(K)?Q.align.push("center"):this.rules.other.tableAlignLeft.test(K)?Q.align.push("left"):Q.align.push(null);for(let K=0;K<J.length;K++)Q.header.push({text:J[K],tokens:this.lexer.inline(J[K]),header:!0,align:Q.align[K]});for(let K of X)Q.rows.push(pX(K,Q.header.length).map((U,q)=>({text:U,tokens:this.lexer.inline(U),header:!1,align:Q.align[q]})));return Q}}lheading(Z){let $=this.rules.block.lheading.exec(Z);if($)return{type:"heading",raw:$[0],depth:$[2].charAt(0)==="="?1:2,text:$[1],tokens:this.lexer.inline($[1])}}paragraph(Z){let $=this.rules.block.paragraph.exec(Z);if($){let J=$[1].charAt($[1].length-1)===`
`?$[1].slice(0,-1):$[1];return{type:"paragraph",raw:$[0],text:J,tokens:this.lexer.inline(J)}}}text(Z){let $=this.rules.block.text.exec(Z);if($)return{type:"text",raw:$[0],text:$[0],tokens:this.lexer.inline($[0])}}escape(Z){let $=this.rules.inline.escape.exec(Z);if($)return{type:"escape",raw:$[0],text:$[1]}}tag(Z){let $=this.rules.inline.tag.exec(Z);if($)return!this.lexer.state.inLink&&this.rules.other.startATag.test($[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test($[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test($[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test($[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:$[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:$[0]}}link(Z){let $=this.rules.inline.link.exec(Z);if($){let J=$[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(J)){if(!this.rules.other.endAngleBracket.test(J))return;let Q=t3(J.slice(0,-1),"\\");if((J.length-Q.length)%2===0)return}else{let Q=E_($[2],"()");if(Q===-2)return;if(Q>-1){let K=($[0].indexOf("!")===0?5:4)+$[1].length+Q;$[2]=$[2].substring(0,Q),$[0]=$[0].substring(0,K).trim(),$[3]=""}}let Y=$[2],X="";if(this.options.pedantic){let Q=this.rules.other.pedanticHrefTitle.exec(Y);Q&&(Y=Q[1],X=Q[3])}else X=$[3]?$[3].slice(1,-1):"";return Y=Y.trim(),this.rules.other.startAngleBracket.test(Y)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(J)?Y=Y.slice(1):Y=Y.slice(1,-1)),lX($,{href:Y&&Y.replace(this.rules.inline.anyPunctuation,"$1"),title:X&&X.replace(this.rules.inline.anyPunctuation,"$1")},$[0],this.lexer,this.rules)}}reflink(Z,$){let J;if((J=this.rules.inline.reflink.exec(Z))||(J=this.rules.inline.nolink.exec(Z))){let Y=(J[2]||J[1]).replace(this.rules.other.multipleSpaceGlobal," "),X=$[Y.toLowerCase()];if(!X){let Q=J[0].charAt(0);return{type:"text",raw:Q,text:Q}}return lX(J,X,J[0],this.lexer,this.rules)}}emStrong(Z,$,J=""){let Y=this.rules.inline.emStrongLDelim.exec(Z);if(!Y||Y[3]&&J.match(this.rules.other.unicodeAlphaNumeric))return;if(!(Y[1]||Y[2])||!J||this.rules.inline.punctuation.exec(J)){let X=[...Y[0]].length-1,Q,K,U=X,q=0,G=Y[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(G.lastIndex=0,$=$.slice(-1*Z.length+X);(Y=G.exec($))!=null;){if(Q=Y[1]||Y[2]||Y[3]||Y[4]||Y[5]||Y[6],!Q)continue;if(K=[...Q].length,Y[3]||Y[4]){U+=K;continue}else if((Y[5]||Y[6])&&X%3&&!((X+K)%3)){q+=K;continue}if(U-=K,U>0)continue;K=Math.min(K,K+U+q);let W=[...Y[0]][0].length,j=Z.slice(0,X+Y.index+W+K);if(Math.min(X,K)%2){let z=j.slice(1,-1);return{type:"em",raw:j,text:z,tokens:this.lexer.inlineTokens(z)}}let _=j.slice(2,-2);return{type:"strong",raw:j,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(Z){let $=this.rules.inline.code.exec(Z);if($){let J=$[2].replace(this.rules.other.newLineCharGlobal," "),Y=this.rules.other.nonSpaceChar.test(J),X=this.rules.other.startingSpaceChar.test(J)&&this.rules.other.endingSpaceChar.test(J);return Y&&X&&(J=J.substring(1,J.length-1)),{type:"codespan",raw:$[0],text:J}}}br(Z){let $=this.rules.inline.br.exec(Z);if($)return{type:"br",raw:$[0]}}del(Z){let $=this.rules.inline.del.exec(Z);if($)return{type:"del",raw:$[0],text:$[2],tokens:this.lexer.inlineTokens($[2])}}autolink(Z){let $=this.rules.inline.autolink.exec(Z);if($){let J,Y;return $[2]==="@"?(J=$[1],Y="mailto:"+J):(J=$[1],Y=J),{type:"link",raw:$[0],text:J,href:Y,tokens:[{type:"text",raw:J,text:J}]}}}url(Z){let $;if($=this.rules.inline.url.exec(Z)){let J,Y;if($[2]==="@")J=$[0],Y="mailto:"+J;else{let X;do X=$[0],$[0]=this.rules.inline._backpedal.exec($[0])?.[0]??"";while(X!==$[0]);J=$[0],$[1]==="www."?Y="http://"+$[0]:Y=$[0]}return{type:"link",raw:$[0],text:J,href:Y,tokens:[{type:"text",raw:J,text:J}]}}}inlineText(Z){let $=this.rules.inline.text.exec(Z);if($){let J=this.lexer.state.inRawBlock;return{type:"text",raw:$[0],text:$[0],escaped:J}}}},P1=class Z{tokens;options;state;inlineQueue;tokenizer;constructor($){this.tokens=[],this.tokens.links=Object.create(null),this.options=$||E2,this.options.tokenizer=this.options.tokenizer||new m9,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let J={other:l0,block:v9.normal,inline:o3.normal};this.options.pedantic?(J.block=v9.pedantic,J.inline=o3.pedantic):this.options.gfm&&(J.block=v9.gfm,this.options.breaks?J.inline=o3.breaks:J.inline=o3.gfm),this.tokenizer.rules=J}static get rules(){return{block:v9,inline:o3}}static lex($,J){return new Z(J).lex($)}static lexInline($,J){return new Z(J).inlineTokens($)}lex($){$=$.replace(l0.carriageReturn,`
`),this.blockTokens($,this.tokens);for(let J=0;J<this.inlineQueue.length;J++){let Y=this.inlineQueue[J];this.inlineTokens(Y.src,Y.tokens)}return this.inlineQueue=[],this.tokens}blockTokens($,J=[],Y=!1){for(this.options.pedantic&&($=$.replace(l0.tabCharGlobal,"    ").replace(l0.spaceLine,""));$;){let X;if(this.options.extensions?.block?.some((K)=>(X=K.call({lexer:this},$,J))?($=$.substring(X.raw.length),J.push(X),!0):!1))continue;if(X=this.tokenizer.space($)){$=$.substring(X.raw.length);let K=J.at(-1);X.raw.length===1&&K!==void 0?K.raw+=`
`:J.push(X);continue}if(X=this.tokenizer.code($)){$=$.substring(X.raw.length);let K=J.at(-1);K?.type==="paragraph"||K?.type==="text"?(K.raw+=(K.raw.endsWith(`
`)?"":`
`)+X.raw,K.text+=`
`+X.text,this.inlineQueue.at(-1).src=K.text):J.push(X);continue}if(X=this.tokenizer.fences($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.heading($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.hr($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.blockquote($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.list($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.html($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.def($)){$=$.substring(X.raw.length);let K=J.at(-1);K?.type==="paragraph"||K?.type==="text"?(K.raw+=(K.raw.endsWith(`
`)?"":`
`)+X.raw,K.text+=`
`+X.raw,this.inlineQueue.at(-1).src=K.text):this.tokens.links[X.tag]||(this.tokens.links[X.tag]={href:X.href,title:X.title},J.push(X));continue}if(X=this.tokenizer.table($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.lheading($)){$=$.substring(X.raw.length),J.push(X);continue}let Q=$;if(this.options.extensions?.startBlock){let K=1/0,U=$.slice(1),q;this.options.extensions.startBlock.forEach((G)=>{q=G.call({lexer:this},U),typeof q=="number"&&q>=0&&(K=Math.min(K,q))}),K<1/0&&K>=0&&(Q=$.substring(0,K+1))}if(this.state.top&&(X=this.tokenizer.paragraph(Q))){let K=J.at(-1);Y&&K?.type==="paragraph"?(K.raw+=(K.raw.endsWith(`
`)?"":`
`)+X.raw,K.text+=`
`+X.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=K.text):J.push(X),Y=Q.length!==$.length,$=$.substring(X.raw.length);continue}if(X=this.tokenizer.text($)){$=$.substring(X.raw.length);let K=J.at(-1);K?.type==="text"?(K.raw+=(K.raw.endsWith(`
`)?"":`
`)+X.raw,K.text+=`
`+X.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=K.text):J.push(X);continue}if($){let K="Infinite loop on byte: "+$.charCodeAt(0);if(this.options.silent){console.error(K);break}else throw Error(K)}}return this.state.top=!0,J}inline($,J=[]){return this.inlineQueue.push({src:$,tokens:J}),J}inlineTokens($,J=[]){let Y=$,X=null;if(this.tokens.links){let q=Object.keys(this.tokens.links);if(q.length>0)for(;(X=this.tokenizer.rules.inline.reflinkSearch.exec(Y))!=null;)q.includes(X[0].slice(X[0].lastIndexOf("[")+1,-1))&&(Y=Y.slice(0,X.index)+"["+"a".repeat(X[0].length-2)+"]"+Y.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(X=this.tokenizer.rules.inline.anyPunctuation.exec(Y))!=null;)Y=Y.slice(0,X.index)+"++"+Y.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let Q;for(;(X=this.tokenizer.rules.inline.blockSkip.exec(Y))!=null;)Q=X[2]?X[2].length:0,Y=Y.slice(0,X.index+Q)+"["+"a".repeat(X[0].length-Q-2)+"]"+Y.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);Y=this.options.hooks?.emStrongMask?.call({lexer:this},Y)??Y;let K=!1,U="";for(;$;){K||(U=""),K=!1;let q;if(this.options.extensions?.inline?.some((W)=>(q=W.call({lexer:this},$,J))?($=$.substring(q.raw.length),J.push(q),!0):!1))continue;if(q=this.tokenizer.escape($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.tag($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.link($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.reflink($,this.tokens.links)){$=$.substring(q.raw.length);let W=J.at(-1);q.type==="text"&&W?.type==="text"?(W.raw+=q.raw,W.text+=q.text):J.push(q);continue}if(q=this.tokenizer.emStrong($,Y,U)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.codespan($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.br($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.del($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.autolink($)){$=$.substring(q.raw.length),J.push(q);continue}if(!this.state.inLink&&(q=this.tokenizer.url($))){$=$.substring(q.raw.length),J.push(q);continue}let G=$;if(this.options.extensions?.startInline){let W=1/0,j=$.slice(1),_;this.options.extensions.startInline.forEach((z)=>{_=z.call({lexer:this},j),typeof _=="number"&&_>=0&&(W=Math.min(W,_))}),W<1/0&&W>=0&&(G=$.substring(0,W+1))}if(q=this.tokenizer.inlineText(G)){$=$.substring(q.raw.length),q.raw.slice(-1)!=="_"&&(U=q.raw.slice(-1)),K=!0;let W=J.at(-1);W?.type==="text"?(W.raw+=q.raw,W.text+=q.text):J.push(q);continue}if($){let W="Infinite loop on byte: "+$.charCodeAt(0);if(this.options.silent){console.error(W);break}else throw Error(W)}}return J}},g9=class{options;parser;constructor(Z){this.options=Z||E2}space(Z){return""}code({text:Z,lang:$,escaped:J}){let Y=($||"").match(l0.notSpaceStart)?.[0],X=Z.replace(l0.endingNewline,"")+`
`;return Y?'<pre><code class="language-'+p1(Y)+'">'+(J?X:p1(X,!0))+`</code></pre>
`:"<pre><code>"+(J?X:p1(X,!0))+`</code></pre>
`}blockquote({tokens:Z}){return`<blockquote>
${this.parser.parse(Z)}</blockquote>
`}html({text:Z}){return Z}def(Z){return""}heading({tokens:Z,depth:$}){return`<h${$}>${this.parser.parseInline(Z)}</h${$}>
`}hr(Z){return`<hr>
`}list(Z){let{ordered:$,start:J}=Z,Y="";for(let K=0;K<Z.items.length;K++){let U=Z.items[K];Y+=this.listitem(U)}let X=$?"ol":"ul",Q=$&&J!==1?' start="'+J+'"':"";return"<"+X+Q+`>
`+Y+"</"+X+`>
`}listitem(Z){return`<li>${this.parser.parse(Z.tokens)}</li>
`}checkbox({checked:Z}){return"<input "+(Z?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:Z}){return`<p>${this.parser.parseInline(Z)}</p>
`}table(Z){let $="",J="";for(let X=0;X<Z.header.length;X++)J+=this.tablecell(Z.header[X]);$+=this.tablerow({text:J});let Y="";for(let X=0;X<Z.rows.length;X++){let Q=Z.rows[X];J="";for(let K=0;K<Q.length;K++)J+=this.tablecell(Q[K]);Y+=this.tablerow({text:J})}return Y&&(Y=`<tbody>${Y}</tbody>`),`<table>
<thead>
`+$+`</thead>
`+Y+`</table>
`}tablerow({text:Z}){return`<tr>
${Z}</tr>
`}tablecell(Z){let $=this.parser.parseInline(Z.tokens),J=Z.header?"th":"td";return(Z.align?`<${J} align="${Z.align}">`:`<${J}>`)+$+`</${J}>
`}strong({tokens:Z}){return`<strong>${this.parser.parseInline(Z)}</strong>`}em({tokens:Z}){return`<em>${this.parser.parseInline(Z)}</em>`}codespan({text:Z}){return`<code>${p1(Z,!0)}</code>`}br(Z){return"<br>"}del({tokens:Z}){return`<del>${this.parser.parseInline(Z)}</del>`}link({href:Z,title:$,tokens:J}){let Y=this.parser.parseInline(J),X=fX(Z);if(X===null)return Y;Z=X;let Q='<a href="'+Z+'"';return $&&(Q+=' title="'+p1($)+'"'),Q+=">"+Y+"</a>",Q}image({href:Z,title:$,text:J,tokens:Y}){Y&&(J=this.parser.parseInline(Y,this.parser.textRenderer));let X=fX(Z);if(X===null)return p1(J);Z=X;let Q=`<img src="${Z}" alt="${J}"`;return $&&(Q+=` title="${p1($)}"`),Q+=">",Q}text(Z){return"tokens"in Z&&Z.tokens?this.parser.parseInline(Z.tokens):("escaped"in Z)&&Z.escaped?Z.text:p1(Z.text)}},A8=class{strong({text:Z}){return Z}em({text:Z}){return Z}codespan({text:Z}){return Z}del({text:Z}){return Z}html({text:Z}){return Z}text({text:Z}){return Z}link({text:Z}){return""+Z}image({text:Z}){return""+Z}br(){return""}checkbox({raw:Z}){return Z}},C1=class Z{options;renderer;textRenderer;constructor($){this.options=$||E2,this.options.renderer=this.options.renderer||new g9,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new A8}static parse($,J){return new Z(J).parse($)}static parseInline($,J){return new Z(J).parseInline($)}parse($){let J="";for(let Y=0;Y<$.length;Y++){let X=$[Y];if(this.options.extensions?.renderers?.[X.type]){let K=X,U=this.options.extensions.renderers[K.type].call({parser:this},K);if(U!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(K.type)){J+=U||"";continue}}let Q=X;switch(Q.type){case"space":{J+=this.renderer.space(Q);break}case"hr":{J+=this.renderer.hr(Q);break}case"heading":{J+=this.renderer.heading(Q);break}case"code":{J+=this.renderer.code(Q);break}case"table":{J+=this.renderer.table(Q);break}case"blockquote":{J+=this.renderer.blockquote(Q);break}case"list":{J+=this.renderer.list(Q);break}case"checkbox":{J+=this.renderer.checkbox(Q);break}case"html":{J+=this.renderer.html(Q);break}case"def":{J+=this.renderer.def(Q);break}case"paragraph":{J+=this.renderer.paragraph(Q);break}case"text":{J+=this.renderer.text(Q);break}default:{let K='Token with "'+Q.type+'" type was not found.';if(this.options.silent)return console.error(K),"";throw Error(K)}}}return J}parseInline($,J=this.renderer){let Y="";for(let X=0;X<$.length;X++){let Q=$[X];if(this.options.extensions?.renderers?.[Q.type]){let U=this.options.extensions.renderers[Q.type].call({parser:this},Q);if(U!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Q.type)){Y+=U||"";continue}}let K=Q;switch(K.type){case"escape":{Y+=J.text(K);break}case"html":{Y+=J.html(K);break}case"link":{Y+=J.link(K);break}case"image":{Y+=J.image(K);break}case"checkbox":{Y+=J.checkbox(K);break}case"strong":{Y+=J.strong(K);break}case"em":{Y+=J.em(K);break}case"codespan":{Y+=J.codespan(K);break}case"br":{Y+=J.br(K);break}case"del":{Y+=J.del(K);break}case"text":{Y+=J.text(K);break}default:{let U='Token with "'+K.type+'" type was not found.';if(this.options.silent)return console.error(U),"";throw Error(U)}}}return Y}},e3=class{options;block;constructor(Z){this.options=Z||E2}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(Z){return Z}postprocess(Z){return Z}processAllTokens(Z){return Z}emStrongMask(Z){return Z}provideLexer(){return this.block?P1.lex:P1.lexInline}provideParser(){return this.block?C1.parse:C1.parseInline}},C_=class{defaults=H8();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=C1;Renderer=g9;TextRenderer=A8;Lexer=P1;Tokenizer=m9;Hooks=e3;constructor(...Z){this.use(...Z)}walkTokens(Z,$){let J=[];for(let Y of Z)switch(J=J.concat($.call(this,Y)),Y.type){case"table":{let X=Y;for(let Q of X.header)J=J.concat(this.walkTokens(Q.tokens,$));for(let Q of X.rows)for(let K of Q)J=J.concat(this.walkTokens(K.tokens,$));break}case"list":{let X=Y;J=J.concat(this.walkTokens(X.items,$));break}default:{let X=Y;this.defaults.extensions?.childTokens?.[X.type]?this.defaults.extensions.childTokens[X.type].forEach((Q)=>{let K=X[Q].flat(1/0);J=J.concat(this.walkTokens(K,$))}):X.tokens&&(J=J.concat(this.walkTokens(X.tokens,$)))}}return J}use(...Z){let $=this.defaults.extensions||{renderers:{},childTokens:{}};return Z.forEach((J)=>{let Y={...J};if(Y.async=this.defaults.async||Y.async||!1,J.extensions&&(J.extensions.forEach((X)=>{if(!X.name)throw Error("extension name required");if("renderer"in X){let Q=$.renderers[X.name];Q?$.renderers[X.name]=function(...K){let U=X.renderer.apply(this,K);return U===!1&&(U=Q.apply(this,K)),U}:$.renderers[X.name]=X.renderer}if("tokenizer"in X){if(!X.level||X.level!=="block"&&X.level!=="inline")throw Error("extension level must be 'block' or 'inline'");let Q=$[X.level];Q?Q.unshift(X.tokenizer):$[X.level]=[X.tokenizer],X.start&&(X.level==="block"?$.startBlock?$.startBlock.push(X.start):$.startBlock=[X.start]:X.level==="inline"&&($.startInline?$.startInline.push(X.start):$.startInline=[X.start]))}"childTokens"in X&&X.childTokens&&($.childTokens[X.name]=X.childTokens)}),Y.extensions=$),J.renderer){let X=this.defaults.renderer||new g9(this.defaults);for(let Q in J.renderer){if(!(Q in X))throw Error(`renderer '${Q}' does not exist`);if(["options","parser"].includes(Q))continue;let K=Q,U=J.renderer[K],q=X[K];X[K]=(...G)=>{let W=U.apply(X,G);return W===!1&&(W=q.apply(X,G)),W||""}}Y.renderer=X}if(J.tokenizer){let X=this.defaults.tokenizer||new m9(this.defaults);for(let Q in J.tokenizer){if(!(Q in X))throw Error(`tokenizer '${Q}' does not exist`);if(["options","rules","lexer"].includes(Q))continue;let K=Q,U=J.tokenizer[K],q=X[K];X[K]=(...G)=>{let W=U.apply(X,G);return W===!1&&(W=q.apply(X,G)),W}}Y.tokenizer=X}if(J.hooks){let X=this.defaults.hooks||new e3;for(let Q in J.hooks){if(!(Q in X))throw Error(`hook '${Q}' does not exist`);if(["options","block"].includes(Q))continue;let K=Q,U=J.hooks[K],q=X[K];e3.passThroughHooks.has(Q)?X[K]=(G)=>{if(this.defaults.async&&e3.passThroughHooksRespectAsync.has(Q))return(async()=>{let j=await U.call(X,G);return q.call(X,j)})();let W=U.call(X,G);return q.call(X,W)}:X[K]=(...G)=>{if(this.defaults.async)return(async()=>{let j=await U.apply(X,G);return j===!1&&(j=await q.apply(X,G)),j})();let W=U.apply(X,G);return W===!1&&(W=q.apply(X,G)),W}}Y.hooks=X}if(J.walkTokens){let X=this.defaults.walkTokens,Q=J.walkTokens;Y.walkTokens=function(K){let U=[];return U.push(Q.call(this,K)),X&&(U=U.concat(X.call(this,K))),U}}this.defaults={...this.defaults,...Y}}),this}setOptions(Z){return this.defaults={...this.defaults,...Z},this}lexer(Z,$){return P1.lex(Z,$??this.defaults)}parser(Z,$){return C1.parse(Z,$??this.defaults)}parseMarkdown(Z){return($,J)=>{let Y={...J},X={...this.defaults,...Y},Q=this.onError(!!X.silent,!!X.async);if(this.defaults.async===!0&&Y.async===!1)return Q(Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof $>"u"||$===null)return Q(Error("marked(): input parameter is undefined or null"));if(typeof $!="string")return Q(Error("marked(): input parameter is of type "+Object.prototype.toString.call($)+", string expected"));if(X.hooks&&(X.hooks.options=X,X.hooks.block=Z),X.async)return(async()=>{let K=X.hooks?await X.hooks.preprocess($):$,U=await(X.hooks?await X.hooks.provideLexer():Z?P1.lex:P1.lexInline)(K,X),q=X.hooks?await X.hooks.processAllTokens(U):U;X.walkTokens&&await Promise.all(this.walkTokens(q,X.walkTokens));let G=await(X.hooks?await X.hooks.provideParser():Z?C1.parse:C1.parseInline)(q,X);return X.hooks?await X.hooks.postprocess(G):G})().catch(Q);try{X.hooks&&($=X.hooks.preprocess($));let K=(X.hooks?X.hooks.provideLexer():Z?P1.lex:P1.lexInline)($,X);X.hooks&&(K=X.hooks.processAllTokens(K)),X.walkTokens&&this.walkTokens(K,X.walkTokens);let U=(X.hooks?X.hooks.provideParser():Z?C1.parse:C1.parseInline)(K,X);return X.hooks&&(U=X.hooks.postprocess(U)),U}catch(K){return Q(K)}}}onError(Z,$){return(J)=>{if(J.message+=`
Please report this to https://github.com/markedjs/marked.`,Z){let Y="<p>An error occurred:</p><pre>"+p1(J.message+"",!0)+"</pre>";return $?Promise.resolve(Y):Y}if($)return Promise.reject(J);throw J}}},B2=new C_;function X0(Z,$){return B2.parse(Z,$)}X0.options=X0.setOptions=function(Z){return B2.setOptions(Z),X0.defaults=B2.defaults,dX(X0.defaults),X0};X0.getDefaults=H8;X0.defaults=E2;X0.use=function(...Z){return B2.use(...Z),X0.defaults=B2.defaults,dX(X0.defaults),X0};X0.walkTokens=function(Z,$){return B2.walkTokens(Z,$)};X0.parseInline=B2.parseInline;X0.Parser=C1;X0.parser=C1.parse;X0.Renderer=g9;X0.TextRenderer=A8;X0.Lexer=P1;X0.lexer=P1.lex;X0.Tokenizer=m9;X0.Hooks=e3;X0.parse=X0;var{options:BV,setOptions:EV,use:PV,walkTokens:CV,parseInline:TV}=X0;var yV=C1.parse,bV=P1.lex;function P8(Z,$,J,Y,X,Q){this.indented=Z,this.column=$,this.type=J,this.info=Y,this.align=X,this.prev=Q}function l9(Z,$,J,Y){var X=Z.indented;if(Z.context&&Z.context.type=="statement"&&J!="statement")X=Z.context.indented;return Z.context=new P8(X,$,J,Y,null,Z.context)}function J6(Z){var $=Z.context.type;if($==")"||$=="]"||$=="}")Z.indented=Z.context.indented;return Z.context=Z.context.prev}function $Q(Z,$,J){if($.prevToken=="variable"||$.prevToken=="type")return!0;if(/\S(?:[^- ]>|[*\]])\s*$|\*$/.test(Z.string.slice(0,J)))return!0;if($.typeAtEndOfLine&&Z.column()==Z.indentation())return!0}function B8(Z){for(;;){if(!Z||Z.type=="top")return!0;if(Z.type=="}"&&Z.prev.info!="namespace")return!1;Z=Z.prev}}function J1(Z){var{statementIndentUnit:$,dontAlignCalls:J}=Z,Y=Z.keywords||{},X=Z.types||{},Q=Z.builtin||{},K=Z.blockKeywords||{},U=Z.defKeywords||{},q=Z.atoms||{},G=Z.hooks||{},W=Z.multiLineStrings,j=Z.indentStatements!==!1,_=Z.indentSwitch!==!1,z=Z.namespaceSeparator,V=Z.isPunctuationChar||/[\[\]{}\(\),;\:\.]/,O=Z.numberStart||/[\d\.]/,H=Z.number||/^(?:0x[a-f\d]+|0b[01]+|(?:\d+\.?\d*|\.\d+)(?:e[-+]?\d+)?)(u|ll?|l|f)?/i,F=Z.isOperatorChar||/[+\-*&%=<>!?|\/]/,D=Z.isIdentifierChar||/[\w\$_\xa1-\uffff]/,M=Z.isReservedIdentifier||!1,A,B;function w(T,C){var E=T.next();if(G[E]){var y=G[E](T,C);if(y!==!1)return y}if(E=='"'||E=="'")return C.tokenize=x(E),C.tokenize(T,C);if(O.test(E)){if(T.backUp(1),T.match(H))return"number";T.next()}if(V.test(E))return A=E,null;if(E=="/"){if(T.eat("*"))return C.tokenize=c,c(T,C);if(T.eat("/"))return T.skipToEnd(),"comment"}if(F.test(E)){while(!T.match(/^\/[\/*]/,!1)&&T.eat(F));return"operator"}if(T.eatWhile(D),z)while(T.match(z))T.eatWhile(D);var f=T.current();if(l1(Y,f)){if(l1(K,f))A="newstatement";if(l1(U,f))B=!0;return"keyword"}if(l1(X,f))return"type";if(l1(Q,f)||M&&M(f)){if(l1(K,f))A="newstatement";return"builtin"}if(l1(q,f))return"atom";return"variable"}function x(T){return function(C,E){var y=!1,f,t=!1;while((f=C.next())!=null){if(f==T&&!y){t=!0;break}y=!y&&f=="\\"}if(t||!(y||W))E.tokenize=null;return"string"}}function c(T,C){var E=!1,y;while(y=T.next()){if(y=="/"&&E){C.tokenize=null;break}E=y=="*"}return"comment"}function a(T,C){if(Z.typeFirstDefinitions&&T.eol()&&B8(C.context))C.typeAtEndOfLine=$Q(T,C,T.pos)}return{name:Z.name,startState:function(T){return{tokenize:null,context:new P8(-T,0,"top",null,!1),indented:0,startOfLine:!0,prevToken:null}},token:function(T,C){var E=C.context;if(T.sol()){if(E.align==null)E.align=!1;C.indented=T.indentation(),C.startOfLine=!0}if(T.eatSpace())return a(T,C),null;A=B=null;var y=(C.tokenize||w)(T,C);if(y=="comment"||y=="meta")return y;if(E.align==null)E.align=!0;if(A==";"||A==":"||A==","&&T.match(/^\s*(?:\/\/.*)?$/,!1))while(C.context.type=="statement")J6(C);else if(A=="{")l9(C,T.column(),"}");else if(A=="[")l9(C,T.column(),"]");else if(A=="(")l9(C,T.column(),")");else if(A=="}"){while(E.type=="statement")E=J6(C);if(E.type=="}")E=J6(C);while(E.type=="statement")E=J6(C)}else if(A==E.type)J6(C);else if(j&&((E.type=="}"||E.type=="top")&&A!=";"||E.type=="statement"&&A=="newstatement"))l9(C,T.column(),"statement",T.current());if(y=="variable"&&(C.prevToken=="def"||Z.typeFirstDefinitions&&$Q(T,C,T.start)&&B8(C.context)&&T.match(/^\s*\(/,!1)))y="def";if(G.token){var f=G.token(T,C,y);if(f!==void 0)y=f}if(y=="def"&&Z.styleDefs===!1)y="variable";return C.startOfLine=!1,C.prevToken=B?"def":y||A,a(T,C),y},indent:function(T,C,E){if(T.tokenize!=w&&T.tokenize!=null||T.typeAtEndOfLine&&B8(T.context))return null;var y=T.context,f=C&&C.charAt(0),t=f==y.type;if(y.type=="statement"&&f=="}")y=y.prev;if(Z.dontIndentStatements)while(y.type=="statement"&&Z.dontIndentStatements.test(y.info))y=y.prev;if(G.indent){var I0=G.indent(T,y,C,E.unit);if(typeof I0=="number")return I0}var T0=y.prev&&y.prev.info=="switch";if(Z.allmanIndentation&&/[{(]/.test(f)){while(y.type!="top"&&y.type!="}")y=y.prev;return y.indented}if(y.type=="statement")return y.indented+(f=="{"?0:$||E.unit);if(y.align&&(!J||y.type!=")"))return y.column+(t?0:1);if(y.type==")"&&!t)return y.indented+($||E.unit);return y.indented+(t?0:E.unit)+(!t&&T0&&!/^(?:case|default)\b/.test(C)?E.unit:0)},languageData:{indentOnInput:_?/^\s*(?:case .*?:|default:|\{\}?|\})$/:/^\s*[{}]$/,commentTokens:{line:"//",block:{open:"/*",close:"*/"}},autocomplete:Object.keys(Y).concat(Object.keys(X)).concat(Object.keys(Q)).concat(Object.keys(q)),...Z.languageData}}}function u(Z){var $={},J=Z.split(" ");for(var Y=0;Y<J.length;++Y)$[J[Y]]=!0;return $}function l1(Z,$){if(typeof Z==="function")return Z($);else return Z.propertyIsEnumerable($)}var X6="auto if break case register continue return default do sizeof static else struct switch extern typedef union for goto while enum const volatile inline restrict asm fortran",XQ="alignas alignof and and_eq audit axiom bitand bitor catch class compl concept constexpr const_cast decltype delete dynamic_cast explicit export final friend import module mutable namespace new noexcept not not_eq operator or or_eq override private protected public reinterpret_cast requires static_assert static_cast template this thread_local throw try typeid typename using virtual xor xor_eq",QQ="bycopy byref in inout oneway out self super atomic nonatomic retain copy readwrite readonly strong weak assign typeof nullable nonnull null_resettable _cmd @interface @implementation @end @protocol @encode @property @synthesize @dynamic @class @public @package @private @protected @required @optional @try @catch @finally @import @selector @encode @defs @synchronized @autoreleasepool @compatibility_alias @available",KQ="FOUNDATION_EXPORT FOUNDATION_EXTERN NS_INLINE NS_FORMAT_FUNCTION  NS_RETURNS_RETAINEDNS_ERROR_ENUM NS_RETURNS_NOT_RETAINED NS_RETURNS_INNER_POINTER NS_DESIGNATED_INITIALIZER NS_ENUM NS_OPTIONS NS_REQUIRES_NIL_TERMINATION NS_ASSUME_NONNULL_BEGIN NS_ASSUME_NONNULL_END NS_SWIFT_NAME NS_REFINED_FOR_SWIFT",T_=u("int long char short double float unsigned signed void bool"),y_=u("SEL instancetype id Class Protocol BOOL");function Q6(Z){return l1(T_,Z)||/.+_t$/.test(Z)}function UQ(Z){return Q6(Z)||l1(y_,Z)}var K6="case do else for if switch while struct enum union",c9="struct enum union";function Q2(Z,$){if(!$.startOfLine)return!1;for(var J,Y=null;J=Z.peek();){if(J=="\\"&&Z.match(/^.$/)){Y=Q2;break}else if(J=="/"&&Z.match(/^\/[\/\*]/,!1))break;Z.next()}return $.tokenize=Y,"meta"}function s9(Z,$){if($.prevToken=="type")return"type";return!1}function n9(Z){if(!Z||Z.length<2)return!1;if(Z[0]!="_")return!1;return Z[1]=="_"||Z[1]!==Z[1].toLowerCase()}function A0(Z){return Z.eatWhile(/[\w\.']/),"number"}function X2(Z,$){if(Z.backUp(1),Z.match(/^(?:R|u8R|uR|UR|LR)/)){var J=Z.match(/^"([^\s\\()]{0,16})\(/);if(!J)return!1;return $.cpp11RawStringDelim=J[1],$.tokenize=YQ,YQ(Z,$)}if(Z.match(/^(?:u8|u|U|L)/)){if(Z.match(/^["']/,!1))return"string";return!1}return Z.next(),!1}function qQ(Z){var $=/(\w+)::~?(\w+)$/.exec(Z);return $&&$[1]==$[2]}function JQ(Z,$){var J;while((J=Z.next())!=null)if(J=='"'&&!Z.eat('"')){$.tokenize=null;break}return"string"}function YQ(Z,$){var J=$.cpp11RawStringDelim.replace(/[^\w\s]/g,"\\$&"),Y=Z.match(new RegExp(".*?\\)"+J+'"'));if(Y)$.tokenize=null;else Z.skipToEnd();return"string"}var GQ=J1({name:"c",keywords:u(X6),types:Q6,blockKeywords:u(K6),defKeywords:u(c9),typeFirstDefinitions:!0,atoms:u("NULL true false"),isReservedIdentifier:n9,hooks:{"#":Q2,"*":s9}}),uV=J1({name:"cpp",keywords:u(X6+" "+XQ),types:Q6,blockKeywords:u(K6+" class try catch"),defKeywords:u(c9+" class namespace"),typeFirstDefinitions:!0,atoms:u("true false NULL nullptr"),dontIndentStatements:/^template$/,isIdentifierChar:/[\w\$_~\xa1-\uffff]/,isReservedIdentifier:n9,hooks:{"#":Q2,"*":s9,u:X2,U:X2,L:X2,R:X2,"0":A0,"1":A0,"2":A0,"3":A0,"4":A0,"5":A0,"6":A0,"7":A0,"8":A0,"9":A0,token:function(Z,$,J){if(J=="variable"&&Z.peek()=="("&&($.prevToken==";"||$.prevToken==null||$.prevToken=="}")&&qQ(Z.current()))return"def"}},namespaceSeparator:"::"}),mV=J1({name:"java",keywords:u("abstract assert break case catch class const continue default do else enum extends final finally for goto if implements import instanceof interface native new package private protected public return static strictfp super switch synchronized this throw throws transient try volatile while @interface"),types:u("var byte short int long float double boolean char void Boolean Byte Character Double Float Integer Long Number Object Short String StringBuffer StringBuilder Void"),blockKeywords:u("catch class do else finally for if switch try while"),defKeywords:u("class interface enum @interface"),typeFirstDefinitions:!0,atoms:u("true false null"),number:/^(?:0x[a-f\d_]+|0b[01_]+|(?:[\d_]+\.?\d*|\.\d+)(?:e[-+]?[\d_]+)?)(u|ll?|l|f)?/i,hooks:{"@":function(Z){if(Z.match("interface",!1))return!1;return Z.eatWhile(/[\w\$_]/),"meta"},'"':function(Z,$){if(!Z.match(/""$/))return!1;return $.tokenize=WQ,$.tokenize(Z,$)}}}),gV=J1({name:"csharp",keywords:u("abstract as async await base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in init interface internal is lock namespace new operator out override params private protected public readonly record ref required return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),types:u("Action Boolean Byte Char DateTime DateTimeOffset Decimal Double Func Guid Int16 Int32 Int64 Object SByte Single String Task TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),blockKeywords:u("catch class do else finally for foreach if struct switch try while"),defKeywords:u("class interface namespace record struct var"),typeFirstDefinitions:!0,atoms:u("true false null"),hooks:{"@":function(Z,$){if(Z.eat('"'))return $.tokenize=JQ,JQ(Z,$);return Z.eatWhile(/[\w\$_]/),"meta"}}});function WQ(Z,$){var J=!1;while(!Z.eol()){if(!J&&Z.match('"""')){$.tokenize=null;break}J=Z.next()=="\\"&&!J}return"string"}function Y6(Z){return function($,J){var Y;while(Y=$.next())if(Y=="*"&&$.eat("/"))if(Z==1){J.tokenize=null;break}else return J.tokenize=Y6(Z-1),J.tokenize($,J);else if(Y=="/"&&$.eat("*"))return J.tokenize=Y6(Z+1),J.tokenize($,J);return"comment"}}var fV=J1({name:"scala",keywords:u("abstract case catch class def do else extends final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try type val var while with yield _ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble"),types:u("AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Int Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),multiLineStrings:!0,blockKeywords:u("catch class enum do else finally for forSome if match switch try while"),defKeywords:u("class enum def object package trait type val var"),atoms:u("true false null"),indentStatements:!1,indentSwitch:!1,isOperatorChar:/[+\-*&%=<>!?|\/#:@]/,hooks:{"@":function(Z){return Z.eatWhile(/[\w\$_]/),"meta"},'"':function(Z,$){if(!Z.match('""'))return!1;return $.tokenize=WQ,$.tokenize(Z,$)},"'":function(Z){if(Z.match(/^(\\[^'\s]+|[^\\'])'/))return"character";return Z.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},"=":function(Z,$){var J=$.context;if(J.type=="}"&&J.align&&Z.eat(">"))return $.context=new P8(J.indented,J.column,J.type,J.info,null,J.prev),"operator";else return!1},"/":function(Z,$){if(!Z.eat("*"))return!1;return $.tokenize=Y6(1),$.tokenize(Z,$)}},languageData:{closeBrackets:{brackets:["(","[","{","'",'"','"""']}}});function b_(Z){return function($,J){var Y=!1,X,Q=!1;while(!$.eol()){if(!Z&&!Y&&$.match('"')){Q=!0;break}if(Z&&$.match('"""')){Q=!0;break}if(X=$.next(),!Y&&X=="$"&&$.match("{"))$.skipTo("}");Y=!Y&&X=="\\"&&!Z}if(Q||!Z)J.tokenize=null;return"string"}}var pV=J1({name:"kotlin",keywords:u("package as typealias class interface this super val operator var fun for is in This throw return annotation break continue object if else while do try when !in !is as? file import where by get set abstract enum open inner override private public internal protected catch finally out final vararg reified dynamic companion constructor init sealed field property receiver param sparam lateinit data inline noinline tailrec external annotation crossinline const operator infix suspend actual expect setparam"),types:u("Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void Annotation Any BooleanArray ByteArray Char CharArray DeprecationLevel DoubleArray Enum FloatArray Function Int IntArray Lazy LazyThreadSafetyMode LongArray Nothing ShortArray Unit"),intendSwitch:!1,indentStatements:!1,multiLineStrings:!0,number:/^(?:0x[a-f\d_]+|0b[01_]+|(?:[\d_]+(\.\d+)?|\.\d+)(?:e[-+]?[\d_]+)?)(ul?|l|f)?/i,blockKeywords:u("catch class do else finally for if where try while enum"),defKeywords:u("class val var object interface fun"),atoms:u("true false null this"),hooks:{"@":function(Z){return Z.eatWhile(/[\w\$_]/),"meta"},"*":function(Z,$){return $.prevToken=="."?"variable":"operator"},'"':function(Z,$){return $.tokenize=b_(Z.match('""')),$.tokenize(Z,$)},"/":function(Z,$){if(!Z.eat("*"))return!1;return $.tokenize=Y6(1),$.tokenize(Z,$)},indent:function(Z,$,J,Y){var X=J&&J.charAt(0);if((Z.prevToken=="}"||Z.prevToken==")")&&J=="")return Z.indented;if(Z.prevToken=="operator"&&J!="}"&&Z.context.type!="}"||Z.prevToken=="variable"&&X=="."||(Z.prevToken=="}"||Z.prevToken==")")&&X==".")return Y*2+$.indented;if($.align&&$.type=="}")return $.indented+(Z.context.type==(J||"").charAt(0)?0:Y)}},languageData:{closeBrackets:{brackets:["(","[","{","'",'"','"""']}}}),lV=J1({name:"shader",keywords:u("sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow const attribute uniform varying break continue discard return for while do if else struct in out inout"),types:u("float int bool void vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 mat2 mat3 mat4"),blockKeywords:u("for while do if else struct"),builtin:u("radians degrees sin cos tan asin acos atan pow exp log exp2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize ftransform faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not texture1D texture1DProj texture1DLod texture1DProjLod texture2D texture2DProj texture2DLod texture2DProjLod texture3D texture3DProj texture3DLod texture3DProjLod textureCube textureCubeLod shadow1D shadow2D shadow1DProj shadow2DProj shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod dFdx dFdy fwidth noise1 noise2 noise3 noise4"),atoms:u("true false gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_FogCoord gl_PointCoord gl_Position gl_PointSize gl_ClipVertex gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord gl_FragCoord gl_FrontFacing gl_FragData gl_FragDepth gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse gl_TextureMatrixTranspose gl_ModelViewMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixInverseTranspose gl_TextureMatrixInverseTranspose gl_NormalScale gl_DepthRange gl_ClipPlane gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel gl_FrontLightModelProduct gl_BackLightModelProduct gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ gl_FogParameters gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits gl_MaxDrawBuffers"),indentSwitch:!1,hooks:{"#":Q2}}),dV=J1({name:"nesc",keywords:u(X6+" as atomic async call command component components configuration event generic implementation includes interface module new norace nx_struct nx_union post provides signal task uses abstract extends"),types:Q6,blockKeywords:u(K6),atoms:u("null true false"),hooks:{"#":Q2}}),cV=J1({name:"objectivec",keywords:u(X6+" "+QQ),types:UQ,builtin:u(KQ),blockKeywords:u(K6+" @synthesize @try @catch @finally @autoreleasepool @synchronized"),defKeywords:u(c9+" @interface @implementation @protocol @class"),dontIndentStatements:/^@.*$/,typeFirstDefinitions:!0,atoms:u("YES NO NULL Nil nil true false nullptr"),isReservedIdentifier:n9,hooks:{"#":Q2,"*":s9}}),sV=J1({name:"objectivecpp",keywords:u(X6+" "+QQ+" "+XQ),types:UQ,builtin:u(KQ),blockKeywords:u(K6+" @synthesize @try @catch @finally @autoreleasepool @synchronized class try catch"),defKeywords:u(c9+" @interface @implementation @protocol @class class namespace"),dontIndentStatements:/^@.*$|^template$/,typeFirstDefinitions:!0,atoms:u("YES NO NULL Nil nil true false nullptr"),isReservedIdentifier:n9,hooks:{"#":Q2,"*":s9,u:X2,U:X2,L:X2,R:X2,"0":A0,"1":A0,"2":A0,"3":A0,"4":A0,"5":A0,"6":A0,"7":A0,"8":A0,"9":A0,token:function(Z,$,J){if(J=="variable"&&Z.peek()=="("&&($.prevToken==";"||$.prevToken==null||$.prevToken=="}")&&qQ(Z.current()))return"def"}},namespaceSeparator:"::"}),nV=J1({name:"squirrel",keywords:u("base break clone continue const default delete enum extends function in class foreach local resume return this throw typeof yield constructor instanceof static"),types:Q6,blockKeywords:u("case catch class else for foreach if switch try while"),defKeywords:u("function local class"),typeFirstDefinitions:!0,atoms:u("true false null"),hooks:{"#":Q2}}),d9=null;function jQ(Z){return function($,J){var Y=!1,X,Q=!1;while(!$.eol()){if(!Y&&$.match('"')&&(Z=="single"||$.match('""'))){Q=!0;break}if(!Y&&$.match("``")){d9=jQ(Z),Q=!0;break}X=$.next(),Y=Z=="single"&&!Y&&X=="\\"}if(Q)J.tokenize=null;return"string"}}var iV=J1({name:"ceylon",keywords:u("abstracts alias assembly assert assign break case catch class continue dynamic else exists extends finally for function given if import in interface is let module new nonempty object of out outer package return satisfies super switch then this throw try value void while"),types:function(Z){var $=Z.charAt(0);return $===$.toUpperCase()&&$!==$.toLowerCase()},blockKeywords:u("case catch class dynamic else finally for function if interface module new object switch try while"),defKeywords:u("class dynamic function interface module object package value"),builtin:u("abstract actual aliased annotation by default deprecated doc final formal late license native optional sealed see serializable shared suppressWarnings tagged throws variable"),isPunctuationChar:/[\[\]{}\(\),;\:\.`]/,isOperatorChar:/[+\-*&%=<>!?|^~:\/]/,numberStart:/[\d#$]/,number:/^(?:#[\da-fA-F_]+|\$[01_]+|[\d_]+[kMGTPmunpf]?|[\d_]+\.[\d_]+(?:[eE][-+]?\d+|[kMGTPmunpf]|)|)/i,multiLineStrings:!0,typeFirstDefinitions:!0,atoms:u("true false null larger smaller equal empty finished"),indentSwitch:!1,styleDefs:!1,hooks:{"@":function(Z){return Z.eatWhile(/[\w\$_]/),"meta"},'"':function(Z,$){return $.tokenize=jQ(Z.match('""')?"triple":"single"),$.tokenize(Z,$)},"`":function(Z,$){if(!d9||!Z.match("`"))return!1;return $.tokenize=d9,d9=null,$.tokenize(Z,$)},"'":function(Z){if(Z.match(/^(\\[^'\s]+|[^\\'])'/))return"string.special";return Z.eatWhile(/[\w\$_\xa1-\uffff]/),"atom"},token:function(Z,$,J){if((J=="variable"||J=="type")&&$.prevToken==".")return"variableName.special"}},languageData:{closeBrackets:{brackets:["(","[","{","'",'"','"""']}}});function k_(Z){(Z.interpolationStack||(Z.interpolationStack=[])).push(Z.tokenize)}function _Q(Z){return(Z.interpolationStack||(Z.interpolationStack=[])).pop()}function S_(Z){return Z.interpolationStack?Z.interpolationStack.length:0}function E8(Z,$,J,Y){var X=!1;if($.eat(Z))if($.eat(Z))X=!0;else return"string";function Q(K,U){var q=!1;while(!K.eol()){if(!Y&&!q&&K.peek()=="$")return k_(U),U.tokenize=x_,"string";var G=K.next();if(G==Z&&!q&&(!X||K.match(Z+Z))){U.tokenize=null;break}q=!Y&&!q&&G=="\\"}return"string"}return J.tokenize=Q,Q($,J)}function x_(Z,$){if(Z.eat("$"),Z.eat("{"))$.tokenize=null;else $.tokenize=h_;return null}function h_(Z,$){return Z.eatWhile(/[\w_]/),$.tokenize=_Q($),"variable"}var rV=J1({name:"dart",keywords:u("this super static final const abstract class extends external factory implements mixin get native set typedef with enum throw rethrow assert break case continue default in return new deferred async await covariant try catch finally do else for if switch while import library export part of show hide is as extension on yield late required sealed base interface when inline"),blockKeywords:u("try catch finally do else for if switch while"),builtin:u("void bool num int double dynamic var String Null Never"),atoms:u("true false null"),number:/^(?:0x[a-f\d_]+|(?:[\d_]+\.?[\d_]*|\.[\d_]+)(?:e[-+]?[\d_]+)?)/i,hooks:{"@":function(Z){return Z.eatWhile(/[\w\$_\.]/),"meta"},"'":function(Z,$){return E8("'",Z,$,!1)},'"':function(Z,$){return E8('"',Z,$,!1)},r:function(Z,$){var J=Z.peek();if(J=="'"||J=='"')return E8(Z.next(),Z,$,!0);return!1},"}":function(Z,$){if(S_($)>0)return $.tokenize=_Q($),null;return!1},"/":function(Z,$){if(!Z.eat("*"))return!1;return $.tokenize=Y6(1),$.tokenize(Z,$)},token:function(Z,$,J){if(J=="variable"){var Y=RegExp("^[_$]*[A-Z][a-zA-Z0-9_$]*$","g");if(Y.test(Z.current()))return"type"}}}});function zQ(){let Z={code({text:$,lang:J}){return`<div class="cm-static-code mb-4" data-lang="${J||""}">${$}</div>`}};X0.use({renderer:Z})}var OQ=(Z)=>{return X0.parse(Z)};function VQ(){let Z=window.matchMedia("(prefers-color-scheme: dark)").matches;document.querySelectorAll(".cm-static-code").forEach((J)=>{let Y=J.textContent||"",X=J.getAttribute("data-lang");J.textContent="",new P({state:i.create({doc:Y,extensions:[i.readOnly.of(!0),P.editable.of(!1),a3(Z),X==="ocaml"||!X?I2.define(S9):X==="c"||X==="clike"?I2.define(GQ):[],P.lineWrapping,P.theme({"&":{borderRadius:"4px",overflow:"hidden",backgroundColor:"var(--bg-app)"},".cm-scroller":{overflow:"visible"}})]}),parent:J})})}var k={description:{desktop:document.getElementById("ex-desc-desktop"),mobile:document.getElementById("ex-desc-mobile")},sidebar:{list:document.getElementById("sidebar-list"),toggle:document.getElementById("sidebar-toggle"),nav:document.getElementById("sidebar-nav")},editorConsolePanel:document.getElementById("editor-and-console-panel"),console:document.getElementById("console-output"),status:document.getElementById("status"),runBtn:document.getElementById("run-btn"),resetBtn:document.getElementById("reset-btn"),clearConsoleBtn:document.getElementById("clear-console-btn"),shortcutsBtn:document.getElementById("shortcuts-btn"),shortcuts:{modal:document.getElementById("shortcuts-modal"),closeBtn:document.getElementById("close-shortcuts-btn"),list:document.getElementById("shortcuts-list")},nav:{prev:document.getElementById("nav-prev"),next:document.getElementById("nav-next")},tabs:{problem:document.getElementById("tab-problem"),code:document.getElementById("tab-code")},resize:{paneProblem:document.getElementById("ex-desc-desktop"),paneConsole:document.getElementById("pane-console"),dragHDesktop:document.getElementById("drag-h-desktop"),dragVConsole:document.getElementById("drag-v-console")},progressContainer:document.getElementById("progress-container"),branding:{logo:document.getElementById("header-logo"),title:document.getElementById("header-title"),subtitle:document.getElementById("header-subtitle"),version:document.getElementById("app-version")}};var K2={element:document.getElementById("status"),setRunning(){if(!this.element)return;this.element.textContent="Running...",this.element.className="text-yellow-500 text-xs font-mono animate-pulse"},setPassed(){if(!this.element)return;this.element.textContent="PASSED",this.element.className="text-green-500 font-bold text-xs"},setFailed(){if(!this.element)return;this.element.textContent="FAILED",this.element.className="text-red-500 font-bold text-xs"},setError(){if(!this.element)return;this.element.textContent="ERROR",this.element.className="text-red-600 font-bold text-xs"},setReady(){if(!this.element)return;this.element.textContent="Ready",this.element.className="text-green-600 text-xs font-mono"}};var C8={};(function Z($,J,Y,X){var Q=!!($.Worker&&$.Blob&&$.Promise&&$.OffscreenCanvas&&$.OffscreenCanvasRenderingContext2D&&$.HTMLCanvasElement&&$.HTMLCanvasElement.prototype.transferControlToOffscreen&&$.URL&&$.URL.createObjectURL),K=typeof Path2D==="function"&&typeof DOMMatrix==="function",U=function(){if(!$.OffscreenCanvas)return!1;try{var R=new OffscreenCanvas(1,1),N=R.getContext("2d");N.fillRect(0,0,1,1);var v=R.transferToImageBitmap();N.createPattern(v,"no-repeat")}catch(m){return!1}return!0}();function q(){}function G(R){var N=J.exports.Promise,v=N!==void 0?N:$.Promise;if(typeof v==="function")return new v(R);return R(q,q),null}var W=function(R,N){return{transform:function(v){if(R)return v;if(N.has(v))return N.get(v);var m=new OffscreenCanvas(v.width,v.height),d=m.getContext("2d");return d.drawImage(v,0,0),N.set(v,m),m},clear:function(){N.clear()}}}(U,new Map),j=function(){var R=Math.floor(16.666666666666668),N,v,m={},d=0;if(typeof requestAnimationFrame==="function"&&typeof cancelAnimationFrame==="function")N=function(s){var n=Math.random();return m[n]=requestAnimationFrame(function p(e){if(d===e||d+R-1<e)d=e,delete m[n],s();else m[n]=requestAnimationFrame(p)}),n},v=function(s){if(m[s])cancelAnimationFrame(m[s])};else N=function(s){return setTimeout(s,R)},v=function(s){return clearTimeout(s)};return{frame:N,cancel:v}}(),_=function(){var R,N,v={};function m(d){function s(n,p){d.postMessage({options:n||{},callback:p})}d.init=function(p){var e=p.transferControlToOffscreen();d.postMessage({canvas:e},[e])},d.fire=function(p,e,q0){if(N)return s(p,null),N;var V0=Math.random().toString(36).slice(2);return N=G(function(W0){function H0(y0){if(y0.data.callback!==V0)return;delete v[V0],d.removeEventListener("message",H0),N=null,W.clear(),q0(),W0()}d.addEventListener("message",H0),s(p,V0),v[V0]=H0.bind(null,{data:{callback:V0}})}),N},d.reset=function(){d.postMessage({reset:!0});for(var p in v)v[p](),delete v[p]}}return function(){if(R)return R;if(!Y&&Q){var d=["var CONFETTI, SIZE = {}, module = {};","("+Z.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{R=new Worker(URL.createObjectURL(new Blob([d])))}catch(s){return typeof console<"u"&&typeof console.warn==="function"&&console.warn("\uD83C\uDF8A Could not load worker",s),null}m(R)}return R}}(),z={particleCount:50,angle:90,spread:45,startVelocity:45,decay:0.9,gravity:1,drift:0,ticks:200,x:0.5,y:0.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function V(R,N){return N?N(R):R}function O(R){return!(R===null||R===void 0)}function H(R,N,v){return V(R&&O(R[N])?R[N]:z[N],v)}function F(R){return R<0?0:Math.floor(R)}function D(R,N){return Math.floor(Math.random()*(N-R))+R}function M(R){return parseInt(R,16)}function A(R){return R.map(B)}function B(R){var N=String(R).replace(/[^0-9a-f]/gi,"");if(N.length<6)N=N[0]+N[0]+N[1]+N[1]+N[2]+N[2];return{r:M(N.substring(0,2)),g:M(N.substring(2,4)),b:M(N.substring(4,6))}}function w(R){var N=H(R,"origin",Object);return N.x=H(N,"x",Number),N.y=H(N,"y",Number),N}function x(R){R.width=document.documentElement.clientWidth,R.height=document.documentElement.clientHeight}function c(R){var N=R.getBoundingClientRect();R.width=N.width,R.height=N.height}function a(R){var N=document.createElement("canvas");return N.style.position="fixed",N.style.top="0px",N.style.left="0px",N.style.pointerEvents="none",N.style.zIndex=R,N}function T(R,N,v,m,d,s,n,p,e){R.save(),R.translate(N,v),R.rotate(s),R.scale(m,d),R.arc(0,0,1,n,p,e),R.restore()}function C(R){var N=R.angle*(Math.PI/180),v=R.spread*(Math.PI/180);return{x:R.x,y:R.y,wobble:Math.random()*10,wobbleSpeed:Math.min(0.11,Math.random()*0.1+0.05),velocity:R.startVelocity*0.5+Math.random()*R.startVelocity,angle2D:-N+(0.5*v-Math.random()*v),tiltAngle:(Math.random()*0.5+0.25)*Math.PI,color:R.color,shape:R.shape,tick:0,totalTicks:R.ticks,decay:R.decay,drift:R.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:R.gravity*3,ovalScalar:0.6,scalar:R.scalar,flat:R.flat}}function E(R,N){if(N.x+=Math.cos(N.angle2D)*N.velocity+N.drift,N.y+=Math.sin(N.angle2D)*N.velocity+N.gravity,N.velocity*=N.decay,N.flat)N.wobble=0,N.wobbleX=N.x+10*N.scalar,N.wobbleY=N.y+10*N.scalar,N.tiltSin=0,N.tiltCos=0,N.random=1;else N.wobble+=N.wobbleSpeed,N.wobbleX=N.x+10*N.scalar*Math.cos(N.wobble),N.wobbleY=N.y+10*N.scalar*Math.sin(N.wobble),N.tiltAngle+=0.1,N.tiltSin=Math.sin(N.tiltAngle),N.tiltCos=Math.cos(N.tiltAngle),N.random=Math.random()+2;var v=N.tick++/N.totalTicks,m=N.x+N.random*N.tiltCos,d=N.y+N.random*N.tiltSin,s=N.wobbleX+N.random*N.tiltCos,n=N.wobbleY+N.random*N.tiltSin;if(R.fillStyle="rgba("+N.color.r+", "+N.color.g+", "+N.color.b+", "+(1-v)+")",R.beginPath(),K&&N.shape.type==="path"&&typeof N.shape.path==="string"&&Array.isArray(N.shape.matrix))R.fill(T0(N.shape.path,N.shape.matrix,N.x,N.y,Math.abs(s-m)*0.1,Math.abs(n-d)*0.1,Math.PI/10*N.wobble));else if(N.shape.type==="bitmap"){var p=Math.PI/10*N.wobble,e=Math.abs(s-m)*0.1,q0=Math.abs(n-d)*0.1,V0=N.shape.bitmap.width*N.scalar,W0=N.shape.bitmap.height*N.scalar,H0=new DOMMatrix([Math.cos(p)*e,Math.sin(p)*e,-Math.sin(p)*q0,Math.cos(p)*q0,N.x,N.y]);H0.multiplySelf(new DOMMatrix(N.shape.matrix));var y0=R.createPattern(W.transform(N.shape.bitmap),"no-repeat");y0.setTransform(H0),R.globalAlpha=1-v,R.fillStyle=y0,R.fillRect(N.x-V0/2,N.y-W0/2,V0,W0),R.globalAlpha=1}else if(N.shape==="circle")R.ellipse?R.ellipse(N.x,N.y,Math.abs(s-m)*N.ovalScalar,Math.abs(n-d)*N.ovalScalar,Math.PI/10*N.wobble,0,2*Math.PI):T(R,N.x,N.y,Math.abs(s-m)*N.ovalScalar,Math.abs(n-d)*N.ovalScalar,Math.PI/10*N.wobble,0,2*Math.PI);else if(N.shape==="star"){var $0=Math.PI/2*3,d0=4*N.scalar,O1=8*N.scalar,V1=N.x,v1=N.y,U2=5,T1=Math.PI/U2;while(U2--)V1=N.x+Math.cos($0)*O1,v1=N.y+Math.sin($0)*O1,R.lineTo(V1,v1),$0+=T1,V1=N.x+Math.cos($0)*d0,v1=N.y+Math.sin($0)*d0,R.lineTo(V1,v1),$0+=T1}else R.moveTo(Math.floor(N.x),Math.floor(N.y)),R.lineTo(Math.floor(N.wobbleX),Math.floor(d)),R.lineTo(Math.floor(s),Math.floor(n)),R.lineTo(Math.floor(m),Math.floor(N.wobbleY));return R.closePath(),R.fill(),N.tick<N.totalTicks}function y(R,N,v,m,d){var s=N.slice(),n=R.getContext("2d"),p,e,q0=G(function(V0){function W0(){p=e=null,n.clearRect(0,0,m.width,m.height),W.clear(),d(),V0()}function H0(){if(Y&&!(m.width===X.width&&m.height===X.height))m.width=R.width=X.width,m.height=R.height=X.height;if(!m.width&&!m.height)v(R),m.width=R.width,m.height=R.height;if(n.clearRect(0,0,m.width,m.height),s=s.filter(function(y0){return E(n,y0)}),s.length)p=j.frame(H0);else W0()}p=j.frame(H0),e=W0});return{addFettis:function(V0){return s=s.concat(V0),q0},canvas:R,promise:q0,reset:function(){if(p)j.cancel(p);if(e)e()}}}function f(R,N){var v=!R,m=!!H(N||{},"resize"),d=!1,s=H(N,"disableForReducedMotion",Boolean),n=Q&&!!H(N||{},"useWorker"),p=n?_():null,e=v?x:c,q0=R&&p?!!R.__confetti_initialized:!1,V0=typeof matchMedia==="function"&&matchMedia("(prefers-reduced-motion)").matches,W0;function H0($0,d0,O1){var V1=H($0,"particleCount",F),v1=H($0,"angle",Number),U2=H($0,"spread",Number),T1=H($0,"startVelocity",Number),kQ=H($0,"decay",Number),SQ=H($0,"gravity",Number),xQ=H($0,"drift",Number),S8=H($0,"colors",A),hQ=H($0,"ticks",Number),x8=H($0,"shapes"),wQ=H($0,"scalar"),vQ=!!H($0,"flat"),h8=w($0),w8=V1,i9=[],uQ=R.width*h8.x,mQ=R.height*h8.y;while(w8--)i9.push(C({x:uQ,y:mQ,angle:v1,spread:U2,startVelocity:T1,color:S8[w8%S8.length],shape:x8[D(0,x8.length)],ticks:hQ,decay:kQ,gravity:SQ,drift:xQ,scalar:wQ,flat:vQ}));if(W0)return W0.addFettis(i9);return W0=y(R,i9,e,d0,O1),W0.promise}function y0($0){var d0=s||H($0,"disableForReducedMotion",Boolean),O1=H($0,"zIndex",Number);if(d0&&V0)return G(function(T1){T1()});if(v&&W0)R=W0.canvas;else if(v&&!R)R=a(O1),document.body.appendChild(R);if(m&&!q0)e(R);var V1={width:R.width,height:R.height};if(p&&!q0)p.init(R);if(q0=!0,p)R.__confetti_initialized=!0;function v1(){if(p){var T1={getBoundingClientRect:function(){if(!v)return R.getBoundingClientRect()}};e(T1),p.postMessage({resize:{width:T1.width,height:T1.height}});return}V1.width=V1.height=null}function U2(){if(W0=null,m)d=!1,$.removeEventListener("resize",v1);if(v&&R){if(document.body.contains(R))document.body.removeChild(R);R=null,q0=!1}}if(m&&!d)d=!0,$.addEventListener("resize",v1,!1);if(p)return p.fire($0,V1,U2);return H0($0,V1,U2)}return y0.reset=function(){if(p)p.reset();if(W0)W0.reset()},y0}var t;function I0(){if(!t)t=f(null,{useWorker:!0,resize:!0});return t}function T0(R,N,v,m,d,s,n){var p=new Path2D(R),e=new Path2D;e.addPath(p,new DOMMatrix(N));var q0=new Path2D;return q0.addPath(e,new DOMMatrix([Math.cos(n)*d,Math.sin(n)*d,-Math.sin(n)*s,Math.cos(n)*s,v,m])),q0}function Y1(R){if(!K)throw Error("path confetti are not supported in this browser");var N,v;if(typeof R==="string")N=R;else N=R.path,v=R.matrix;var m=new Path2D(N),d=document.createElement("canvas"),s=d.getContext("2d");if(!v){var n=1000,p=n,e=n,q0=0,V0=0,W0,H0;for(var y0=0;y0<n;y0+=2)for(var $0=0;$0<n;$0+=2)if(s.isPointInPath(m,y0,$0,"nonzero"))p=Math.min(p,y0),e=Math.min(e,$0),q0=Math.max(q0,y0),V0=Math.max(V0,$0);W0=q0-p,H0=V0-e;var d0=10,O1=Math.min(d0/W0,d0/H0);v=[O1,0,0,O1,-Math.round(W0/2+p)*O1,-Math.round(H0/2+e)*O1]}return{type:"path",path:N,matrix:v}}function B0(R){var N,v=1,m="#000000",d='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';if(typeof R==="string")N=R;else N=R.text,v="scalar"in R?R.scalar:v,d="fontFamily"in R?R.fontFamily:d,m="color"in R?R.color:m;var s=10*v,n=""+s+"px "+d,p=new OffscreenCanvas(s,s),e=p.getContext("2d");e.font=n;var q0=e.measureText(N),V0=Math.ceil(q0.actualBoundingBoxRight+q0.actualBoundingBoxLeft),W0=Math.ceil(q0.actualBoundingBoxAscent+q0.actualBoundingBoxDescent),H0=2,y0=q0.actualBoundingBoxLeft+H0,$0=q0.actualBoundingBoxAscent+H0;V0+=H0+H0,W0+=H0+H0,p=new OffscreenCanvas(V0,W0),e=p.getContext("2d"),e.font=n,e.fillStyle=m,e.fillText(N,y0,$0);var d0=1/v;return{type:"bitmap",bitmap:p.transferToImageBitmap(),matrix:[d0,0,0,d0,-V0*d0/2,-W0*d0/2]}}J.exports=function(){return I0().apply(this,arguments)},J.exports.reset=function(){I0().reset()},J.exports.create=f,J.exports.shapeFromPath=Y1,J.exports.shapeFromText=B0})(function(){if(typeof window<"u")return window;if(typeof self<"u")return self;return this||{}}(),C8,!1);var HQ=C8.exports,UH=C8.exports.create;function T8(Z,$){return Math.random()*($-Z)+Z}function NQ(){HQ({angle:T8(60,120),spread:T8(30,70),particleCount:T8(50,100),origin:{y:0.6}})}var RQ=`module Tests = struct
  let bool_check msg b =
    if b then
      Printf.printf "Test passed: %s\\n" msg
    else begin
      Printf.printf "Test failed: %s\\n" msg;
      failwith "Test failed"
    end

  let string_check to_str msg expected actual =
    if expected = actual then
      Printf.printf "Test passed: %s\\n" msg
    else begin
      Printf.printf "Test failed: %s\\nExpected: %s\\nActual:   %s\\n" msg (to_str expected) (to_str actual);
      failwith "Test failed"
    end
end;;`;var FQ={name:"ocaml",async isReady(){return!!(window.ocaml&&window.ocaml.run)},async run(Z,$=""){if(!window.ocaml||!window.ocaml.run)return{success:!1,output:"",error:"Compiler not ready"};let J=RQ+`
`+Z+`
`+$;try{let Y=window.ocaml.run(J),X=Y.out.replace(/module Tests :[\s\S]*?end\n/g,"");return{success:Y.success,output:X,error:Y.err}}catch(Y){return{success:!1,output:"",error:Y.message}}}};var U6=FQ;var C0={CHECK:`<svg xmlns="http://www.w3.org/2000/svg"
    width="14" height="14" viewBox="0 0 24 24" fill="none"
  stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"
  class="text-green-500">
  <polyline points="20 6 9 17 4 12"></polyline></svg>`,LEFT_ARROW:`<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
  stroke-width="5" stroke-linecap="round" stroke-linejoin="round">
  <path d="m15 18-6-6 6-6" /></svg>`,RIGHT_ARROW:`<svg width="18" height="18" style="display: block; transform: scale(-1,1)" viewBox="0 0 24 24" fill="none" stroke="currentColor"
  stroke-width="5" stroke-linecap="round" stroke-linejoin="round">
  <path d="m15 18-6-6 6-6" /></svg>`,PLAY:`<svg fill="currentColor" width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M18.54,9,8.88,3.46a3.42,3.42,0,0,0-5.13,3V17.58A3.42,3.42,0,0,0,7.17,21a3.43,3.43,0,0,0,1.71-.46L18.54,15a3.42,3.42,0,0,0,0-5.92Zm-1,4.19L7.88,18.81a1.44,1.44,0,0,1-1.42,0,1.42,1.42,0,0,1-.71-1.23V6.42a1.42,1.42,0,0,1,.71-1.23A1.51,1.51,0,0,1,7.17,5a1.54,1.54,0,0,1,.71.19l9.66,5.58a1.42,1.42,0,0,1,0,2.46Z"/>
  </svg>`,STOP:`<svg fill="currentColor" width="16" height="16" viewBox="-1 0 19 19" xmlns="http://www.w3.org/2000/svg"
    class="cf-icon-svg"><path d="M16.417 9.583A7.917 7.917 0 1 1 8.5 1.666a7.917 7.917 0 0 1 7.917 7.917zm-5.267 6.274a6.766 6.766 0 0 0 1.756-1.084L3.31 5.177a6.81 6.81 0 0 0 7.84 10.68zm3.624-3.624a6.808 6.808 0 0 0-10.68-7.84l9.596 9.596a6.77 6.77 0 0 0 1.084-1.756z"/>
  </svg>`,TRASH:`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    width="14" height="14" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve">
  <path fill="none" stroke="currentColor" stroke-width="2" stroke-miterlimit="10" d="M23,27H11c-1.1,0-2-0.9-2-2V8h16v17
  C25,26.1,24.1,27,23,27z"/>
  <line fill="none" stroke="currentColor" stroke-width="2" stroke-miterlimit="10" x1="27" y1="8" x2="7" y2="8"/>
  <path fill="none" stroke="currentColor" stroke-width="2" stroke-miterlimit="10" d="M14,8V6c0-0.6,0.4-1,1-1h4c0.6,0,1,0.4,1,1v2"/>
  <line fill="none" stroke="currentColor" stroke-width="2" stroke-miterlimit="10" x1="17" y1="23" x2="17" y2="12"/>
  <line fill="none" stroke="currentColor" stroke-width="2" stroke-miterlimit="10" x1="21" y1="23" x2="21" y2="12"/>
  <line fill="none" stroke="currentColor" stroke-width="2" stroke-miterlimit="10" x1="13" y1="23" x2="13" y2="12"/>
  </svg>`,MENU:`<svg fill="var(--fg-primary)" width="20" height="20" viewBox="0 0 16 16"
                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <title>icn/menu</title>
                    <path
                        d="M2 3h12a1 1 0 0 1 0 2H2a1 1 0 1 1 0-2zm0 4h12a1 1 0 0 1 0 2H2a1 1 0 1 1 0-2zm0 4h12a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"
                        id="a" />
                </svg>`,WHITE_CHECK:`<svg class="w-2.5 h-2.5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="4">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>`,CLOSE:`<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
  stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <line x1="18" y1="6" x2="6" y2="18"></line>
  <line x1="6" y1="6" x2="18" y2="18"></line></svg>`,KEYBOARD:'<svg fill="currentColor" width="20" height="20" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.21,13.29a.93.93,0,0,0-.33-.21,1,1,0,0,0-.76,0,.9.9,0,0,0-.54.54,1,1,0,1,0,1.84,0A1,1,0,0,0,6.21,13.29ZM13.5,11h1a1,1,0,0,0,0-2h-1a1,1,0,0,0,0,2Zm-4,0h1a1,1,0,0,0,0-2h-1a1,1,0,0,0,0,2Zm-3-2h-1a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2ZM20,5H4A3,3,0,0,0,1,8v8a3,3,0,0,0,3,3H20a3,3,0,0,0,3-3V8A3,3,0,0,0,20,5Zm1,11a1,1,0,0,1-1,1H4a1,1,0,0,1-1-1V8A1,1,0,0,1,4,7H20a1,1,0,0,1,1,1Zm-6-3H9a1,1,0,0,0,0,2h6a1,1,0,0,0,0-2Zm3.5-4h-1a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm.71,4.29a1,1,0,0,0-.33-.21,1,1,0,0,0-.76,0,.93.93,0,0,0-.33.21,1,1,0,0,0-.21.33A1,1,0,1,0,19.5,14a.84.84,0,0,0-.08-.38A1,1,0,0,0,19.21,13.29Z"/></svg>'};class IQ{isRunning=!1;isReady=!1;constructor(){this.setRunningState(!1),k.runBtn.innerHTML=`<span>${C0.STOP}</span><span>Run</span>`}async run(){if(this.isRunning)return;if(!await U6.isReady()){alert("Loading...");return}let{currentExerciseId:$,completedIds:J}=i0.getState(),Y=b0.find((X)=>X.id===$);if(!Y)return;this.setRunningState(!0),K2.setRunning(),k.console.textContent="";try{let X=w9();i0.getState().saveUserCode($,X);let Q=Y.testCode||"",K=await U6.run(X,Q);if(!K.success){this.handleFailure(K.error||"Unknown Error",K.output);return}if(k.console.textContent=K.output,K.output.includes("Test failed")||K.output.includes("Failure")){K2.setFailed();return}let U=Y.validate(X,K.output);if(U!==!0){K2.setFailed(),k.console.textContent+=`

${U}`;return}this.handleSuccess(Y.id,J)}catch(X){this.handleError(X.message)}finally{this.setRunningState(!1)}}handleFailure(Z,$){K2.setFailed(),k.console.textContent=$?$+`
`+Z:Z}handleError(Z){K2.setError(),k.console.textContent="Runtime Error: "+Z}handleSuccess(Z,$){K2.setPassed(),k.console.textContent+=`
ALL TESTS PASSED!`;let J=$.includes(Z);if(i0.getState().markComplete(Z),!J)NQ();else Q3("Passed!")}setRunningState(Z){if(this.isRunning=Z,k.runBtn.disabled=Z||!this.isReady,Z)k.runBtn.classList.add("run-btn-fill"),k.runBtn.innerHTML=`<span>${C0.STOP}</span><span>Run</span>`;else k.runBtn.classList.remove("run-btn-fill"),k.runBtn.innerHTML=`<span>${C0.PLAY}</span><span>Run</span>`}waitForCompiler(){let Z=setInterval(async()=>{if(await U6.isReady())this.isReady=!0,clearInterval(Z),K2.setReady(),k.runBtn.classList.remove("opacity-50","cursor-not-allowed"),this.setRunningState(!1)},500)}}var q6=new IQ;var z1={title:"Sowar",subtitle:"OCaml Exercises",version:"v0.1",project_url:"https://github.com/jitinnair1/sowar",author_url:"https://github.com/jitinnair1",logo_emoji:"ðŸª",headline:"Sowar | OCaml exercises",description:"Interactive OCaml exercises running purely in the browser.",keywords:"ocaml, functional programming, web-based compiler"};function DQ(){if(document.title=z1.headline||z1.title,k.branding.logo)if(z1.logo_image)k.branding.logo.innerHTML=`<img src="${z1.logo_image}" alt="Logo" class="h-8 w-auto" />`;else k.branding.logo.textContent=z1.logo_emoji||"\uD83D\uDC2A";if(k.branding.title)k.branding.title.textContent=z1.title;if(k.branding.subtitle)k.branding.subtitle.textContent=z1.subtitle;if(k.branding.version)k.branding.version.textContent=z1.version}function LQ(Z,$,J,Y){if(!Z)return;Z.innerHTML=$.map((X)=>{let Q=`<div class="px-2 py-1 pb-0 text-[10px] font-bold text-fg-muted uppercase">${X.title}</div>`,K=X.exercises.map((U)=>{let q=Y.includes(U.id);return`<div class="nav-item cursor-pointer p-2 pl-4 text-sm flex justify-between items-center transition-colors ${U.id===J?"bg-bg-surface text-fg-primary border-l-2 border-brand":"text-fg-muted hover:text-fg-primary"} ${q?"opacity-40":""}"
                        onclick="location.hash='#${U.id}'">
                      <span>${U.id} ${U.title}</span>
                      ${q?C0.CHECK:""}
                    </div>`}).join("");return Q+K}).join("")}function MQ(Z,$){if(!Z||!$)return;Z.innerHTML=C0.MENU,Z.addEventListener("click",()=>{$.classList.toggle("hidden"),$.classList.toggle("flex"),$.classList.toggle("lg:hidden"),$.classList.toggle("lg:flex")}),document.addEventListener("click",(J)=>{let Y=!$.classList.contains("hidden");if(window.innerWidth<1024&&Y){let Q=J.target,K=$.contains(Q),U=Z.contains(Q);if(!K&&!U)$.classList.toggle("hidden"),$.classList.toggle("flex"),$.classList.toggle("lg:hidden"),$.classList.toggle("lg:flex")}})}function AQ(Z,$,J,Y){if(!Z)return;let X=$.find((Q)=>Q.exercises.some((K)=>K.id===J));if(X){let Q=X.exercises.length,K=X.exercises.findIndex((U)=>!Y.includes(U.id));Z.innerHTML=X.exercises.map((U,q)=>{let G=Y.includes(U.id),W=q===K||K===-1&&!1,j=q===Q-1,_=U.id===J,z="border border-border-default bg-bg-surface",V="";if(W)z="border border-brand bg-bg-surface";if(G)z="border border-brand bg-brand",V=C0.WHITE_CHECK;if(_)z=`border border-brand ${G?"bg-brand":"bg-bg-surface"} shadow-[0_0_6px_3px_color-mix(in_srgb,var(--color-brand)_30%,transparent)]`;let O="";if(!j)O=`<div class="w-8 h-0.5 mx-0.5 rounded ${G?"bg-brand":"bg-border-default opacity-50"}"></div>`;return`
                <div class="relative flex items-center group cursor-pointer" onclick="location.hash='#${U.id}'" title="${U.title}">
                    <div class="w-4 h-4 rounded-full flex items-center justify-center transition-all duration-300 z-10 ${z}">
                        ${V}
                    </div>
                    ${O}
                    <!-- tooltip on hover -->
                    <div class="absolute -bottom-8 left-1/2 -translate-x-1/2 bg-bg-surface border border-border-default px-2 py-1 rounded text-[10px] whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity shadow-lg z-20 pointer-events-none">
                        ${U.title}
                    </div>
                </div>
            `}).join("")}}function y8(Z,$,J,Y=!1){if(!Z||!$)return;let X=!1,Q=0,K=0;Z.addEventListener("mousedown",(U)=>{X=!0,document.body.classList.add("resizing"),Q=J==="horizontal"?U.clientX:U.clientY,K=J==="horizontal"?$.offsetWidth:$.offsetHeight,document.body.style.userSelect="none",document.body.style.cursor=J==="horizontal"?"col-resize":"row-resize",Z.classList.add("bg-brand")}),document.addEventListener("mousemove",(U)=>{if(!X)return;let q=J==="horizontal"?U.clientX:U.clientY,G=Y?Q-q:q-Q,W=K+G;if(J==="horizontal"){if(W>200&&W<window.innerWidth*0.7)$.style.width=`${W}px`,$.style.flex="none"}else{let j=$.parentElement?.offsetHeight||window.innerHeight;if(W>100&&W<j*0.8)$.style.height=`${W}px`,$.style.flex="none"}}),document.addEventListener("mouseup",()=>{if(X)X=!1,document.body.classList.remove("resizing"),document.body.style.userSelect="",document.body.style.cursor="",Z.classList.remove("bg-brand")})}function BQ(Z,$,J,Y){if(!Z||!$||!J||!Y)return(Q)=>{};function X(Q){if(Q==="problem")J.classList.remove("hidden"),Y.classList.add("hidden"),Y.classList.remove("flex"),Z.classList.add("text-fg-primary","border-brand"),Z.classList.remove("text-fg-muted","border-transparent"),$.classList.add("text-fg-muted","border-transparent"),$.classList.remove("text-fg-primary","border-brand");else J.classList.add("hidden"),Y.classList.remove("hidden"),Y.classList.add("flex"),$.classList.add("text-fg-primary","border-brand"),$.classList.remove("text-fg-muted","border-transparent"),Z.classList.add("text-fg-muted","border-transparent"),Z.classList.remove("text-fg-primary","border-brand")}return Z.addEventListener("click",()=>X("problem")),$.addEventListener("click",()=>X("code")),X}function EQ(Z,$,J,Y){if(!Z||!$)return;Z.innerHTML=C0.LEFT_ARROW,$.innerHTML=C0.RIGHT_ARROW;function X(){let{currentExerciseId:K}=J.getState(),U=b0.findIndex((q)=>q.id===K);if(U<b0.length-1)window.location.hash="#"+b0[U+1].id,Y("problem")}function Q(){let{currentExerciseId:K}=J.getState(),U=b0.findIndex((q)=>q.id===K);if(U>0)window.location.hash="#"+b0[U-1].id,Y("problem")}return Z.addEventListener("click",Q),$.addEventListener("click",X),{updateNavState:(K)=>{let U=b0.findIndex((W)=>W.id===K),q=U>0,G=U<b0.length-1;Z.disabled=!q,$.disabled=!G}}}function PQ(Z,$,J){let Y=null;Z.innerHTML=$,Z.addEventListener("click",()=>{if(Y)clearTimeout(Y),Y=null,Z.innerHTML=$,J();else Z.innerHTML='<span class="text-xs font-bold tracking-wider">Discard changes? Click to confirm.</span>',Y=setTimeout(()=>{Y=null,Z.innerHTML=$},5000)})}function CQ(){let Z=document.getElementById("footer");if(!Z)return;Z.innerHTML=`
        <div class="flex flex-wrap justify-center items-center gap-4 sm:gap-8">
            <span class="text-xs text-fg-muted">
                <a href="${z1.project_url}" target="_blank">Star on GitHub</a>
            </span>
            <span class="text-xs text-fg-muted">
                <a href="${z1.project_url}/issues" target="_blank">Report an Error</a>
            </span>
            <span id="build-date" class="w-full sm:w-auto text-xs text-fg-muted order-last text-center">
              Last updated on February 13, 2026
            </span>
        </div>
    `}var u_=[{action:"Save Code",keys:["Cmd/Ctrl","S"]},{action:"Indent",keys:["Tab"]},{action:"Unindent",keys:["Shift","Tab"]},{action:"Focus Out",keys:["Esc","Tab"]}],m_=[{action:"Run Code",keys:["Shift","Enter"]},{action:"Previous Lesson",keys:["Cmd/Ctrl","["]},{action:"Next Lesson",keys:["Cmd/Ctrl","]"]},{action:"Show Shortcuts",keys:["?","or","F1"]}];function TQ(){if(k.shortcutsBtn)k.shortcutsBtn.innerHTML=C0.KEYBOARD;if(k.shortcuts.closeBtn)k.shortcuts.closeBtn.innerHTML=C0.CLOSE;g_(),k.shortcutsBtn?.addEventListener("click",b8),k.shortcuts.closeBtn?.addEventListener("click",G6),k.shortcuts.modal?.addEventListener("click",(Z)=>{if(Z.target===k.shortcuts.modal)G6()}),document.addEventListener("keydown",(Z)=>{if(Z.key==="Escape"&&k.shortcuts.modal&&!k.shortcuts.modal.classList.contains("hidden"))G6()}),document.addEventListener("keydown",(Z)=>{if(Z.shiftKey&&Z.key==="Enter"){if(Z.preventDefault(),!k.runBtn.disabled)q6.run()}if((Z.metaKey||Z.ctrlKey)&&Z.key==="["){if(Z.preventDefault(),k.nav.prev&&!k.nav.prev.disabled)k.nav.prev.click()}if((Z.metaKey||Z.ctrlKey)&&Z.key==="]"){if(Z.preventDefault(),k.nav.next&&!k.nav.next.disabled)k.nav.next.click()}if(Z.key==="F1")if(Z.preventDefault(),k.shortcuts.modal?.classList.contains("hidden"))b8();else G6();let $=document.activeElement;if(!($&&($.tagName==="INPUT"||$.tagName==="TEXTAREA"||$.isContentEditable))){if(Z.key==="?")if(Z.preventDefault(),k.shortcuts.modal?.classList.contains("hidden"))b8();else G6()}})}function g_(){if(!k.shortcuts.list)return;let Z=navigator.platform.toUpperCase().indexOf("MAC")>=0,$=(J,Y)=>{let X=Y.map((Q)=>{let K=Q.keys.map((U)=>{let q=U;if(U==="Cmd/Ctrl")q=Z?"âŒ˜":"Ctrl";if(U==="Enter")q="â†µ";if(U==="or")return'<span class="text-fg-muted text-xs mx-1">or</span>';return`<kbd class="bg-bg-app border border-border-default rounded px-1.5 py-0.5 text-xs font-mono text-fg-muted min-w-[20px] text-center inline-block">${q}</kbd>`}).reduce((U,q,G)=>{if(G===0)return q;let W=Q.keys[G-1],j=Q.keys[G];if(W==="or"||j==="or")return U+q;return U+'<span class="text-fg-muted text-xs mx-1">+</span>'+q},"");return`
                <div class="flex items-center justify-between py-3 border-b border-border-default last:border-0">
                    <span class="text-base text-fg-primary">${Q.action}</span>
                    <div class="flex items-center">
                        ${K}
                    </div>
                </div>
            `}).join("");return`
            <div class="flex flex-col gap-3">
                <h3 class="text-xs font-bold text-fg-muted uppercase tracking-wider pb-2 border-b border-border-default">${J}</h3>
                <div class="flex flex-col">
                    ${X}
                </div>
            </div>
        `};k.shortcuts.list.innerHTML=`
        <div class="grid grid-cols-1 md:grid-cols-2 gap-16">
            ${$("Editor",u_)}
            ${$("Navigation",m_)}
        </div>
    `}function b8(){k.shortcuts.modal?.classList.remove("hidden"),k.shortcuts.modal?.classList.add("flex")}function G6(){k.shortcuts.modal?.classList.add("hidden"),k.shortcuts.modal?.classList.remove("flex")}DQ();TQ();CQ();zQ();var f_=BQ(k.tabs.problem,k.tabs.code,k.description.mobile,k.editorConsolePanel),yQ=EQ(k.nav.prev,k.nav.next,i0,f_);MQ(k.sidebar.toggle,k.sidebar.nav);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(Z)=>{vX(Z.matches),k8()});var bQ=null;function k8(){let{currentExerciseId:Z,completedIds:$,userCode:J}=i0.getState(),Y=b0.find((q)=>q.id===Z);if(!Y)return;let X=OQ(Y.description),K=`<h1 class="text-3xl font-bold mb-6 text-fg-primary">${Y.id} ${Y.title}</h1>`+X;if(k.description.desktop)k.description.desktop.innerHTML=K;if(k.description.mobile)k.description.mobile.innerHTML=K;if(yQ)yQ.updateNavState(Z);VQ(),LQ(k.sidebar.list,W6,Z,$),AQ(k.progressContainer,W6,Z,$);let U=J[Z]||Y.initialCode;if(wX(U,()=>{i0.getState().saveUserCode(Z,w9()),Q3("Saved!")}),Z!==bQ)k.console.textContent="// Ready...",bQ=Z}i0.subscribe(k8);k.runBtn.addEventListener("click",()=>q6.run());if(k.resetBtn)PQ(k.resetBtn,C0.TRASH,()=>{let{currentExerciseId:Z}=i0.getState(),$=b0.find((J)=>J.id===Z);if(!$)return;i0.getState().saveUserCode(Z,$.initialCode)});if(k.clearConsoleBtn)k.clearConsoleBtn.innerHTML=C0.TRASH,k.clearConsoleBtn.addEventListener("click",()=>{if(k.console)k.console.textContent=""});window.addEventListener("hashchange",()=>{let Z=window.location.hash.slice(1);if(b0.find(($)=>$.id===Z))i0.getState().setCurrent(Z)});y8(k.resize.dragHDesktop,k.resize.paneProblem,"horizontal");y8(k.resize.dragVConsole,k.resize.paneConsole,"vertical",!0);q6.waitForCompiler();var p_=window.location.hash.slice(1)||b0[0].id;i0.getState().setCurrent(p_);k8();
