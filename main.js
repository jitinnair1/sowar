var q6=(Z)=>{let $,J=new Set,K=(G,W)=>{let j=typeof G==="function"?G($):G;if(!Object.is(j,$)){let _=$;$=(W!=null?W:typeof j!=="object"||j===null)?j:Object.assign({},$,j),J.forEach((z)=>z($,_))}},X=()=>$,Y={setState:K,getState:X,getInitialState:()=>q,subscribe:(G)=>{return J.add(G),()=>J.delete(G)}},q=$=Z(K,X,Y);return Y},G6=(Z)=>Z?q6(Z):q6;function SX(Z,$){let J;try{J=Z()}catch(X){return}return{getItem:(X)=>{var Q;let U=(q)=>{if(q===null)return null;return JSON.parse(q,$==null?void 0:$.reviver)},Y=(Q=J.getItem(X))!=null?Q:null;if(Y instanceof Promise)return Y.then(U);return U(Y)},setItem:(X,Q)=>J.setItem(X,JSON.stringify(Q,$==null?void 0:$.replacer)),removeItem:(X)=>J.removeItem(X)}}var B9=(Z)=>($)=>{try{let J=Z($);if(J instanceof Promise)return J;return{then(K){return B9(K)(J)},catch(K){return this}}}catch(J){return{then(K){return this},catch(K){return B9(K)(J)}}}},bX=(Z,$)=>(J,K,X)=>{let Q={storage:SX(()=>localStorage),partialize:(O)=>O,version:0,merge:(O,N)=>({...N,...O}),...$},U=!1,Y=new Set,q=new Set,G=Q.storage;if(!G)return Z((...O)=>{console.warn(`[zustand persist middleware] Unable to update item '${Q.name}', the given storage is currently unavailable.`),J(...O)},K,X);let W=()=>{let O=Q.partialize({...K()});return G.setItem(Q.name,{state:O,version:Q.version})},j=X.setState;X.setState=(O,N)=>{return j(O,N),W()};let _=Z((...O)=>{return J(...O),W()},K,X);X.getInitialState=()=>_;let z,V=()=>{var O,N;if(!G)return;U=!1,Y.forEach((A)=>{var L;return A((L=K())!=null?L:_)});let R=((N=Q.onRehydrateStorage)==null?void 0:N.call(Q,(O=K())!=null?O:_))||void 0;return B9(G.getItem.bind(G))(Q.name).then((A)=>{if(A)if(typeof A.version==="number"&&A.version!==Q.version){if(Q.migrate){let L=Q.migrate(A.state,A.version);if(L instanceof Promise)return L.then((E)=>[!0,E]);return[!0,L]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then((A)=>{var L;let[E,M]=A;if(z=Q.merge(M,(L=K())!=null?L:_),J(z,!0),E)return W()}).then(()=>{R==null||R(z,void 0),z=K(),U=!0,q.forEach((A)=>A(z))}).catch((A)=>{R==null||R(void 0,A)})};if(X.persist={setOptions:(O)=>{if(Q={...Q,...O},O.storage)G=O.storage},clearStorage:()=>{G==null||G.removeItem(Q.name)},getOptions:()=>Q,rehydrate:()=>V(),hasHydrated:()=>U,onHydrate:(O)=>{return Y.add(O),()=>{Y.delete(O)}},onFinishHydration:(O)=>{return q.add(O),()=>{q.delete(O)}}},!Q.skipHydration)V();return z||_},W6=bX;var j6=`This series of exercises takes you through the basic syntax and concepts of OCaml. All exercies can be run right here in your browser.

We start with the basics and build up to the more advanced concepts. The objective is to write a (very simple) clone of FFTW in OCaml.

(Fun fact, while FFTW is a C library, the core \`genfft\` part is written in OCaml)

If you're coming from C-styled languages, the functional style might take some time to get used to. But no worries, we'll get there. For now, let's start with the classic "Hello World" program.

In OCaml, the \`print_endline\` function is used to print to the console. So, to print a message you would use something like:

\`\`\`ocaml
print_endline "some message";;
\`\`\`
Now, when writing code in an OCaml script, you generally use a single semicolon (;) to sequence commands or simply rely on the compiler's structure.

However, in the in-browser environment (like we're using here), you must use double semicolons (;;) to signal to the interpreter that you have finished your expression and want it evaluated.

For exerices here though, you can simply use a single semicolon and skip the double semicolons (since we add them before running the code automatically for you). This bit of information was just for you to keep in mind for later.

Now, check if the code in the exercise window looks alright and fix it if needed. Then, you can user the \`Run\` button to run the code.

# Problem Statement

Use \`print_endline\` to print out "Hello, world!"

`;var _6=`print_endline "some message";;
`;var z6=`(* no tests needed here *)
`;var vX={id:"1.1",title:"Hello World",description:j6,initialCode:_6,testCode:z6,validate:(Z,$)=>{let J=$.toLowerCase();if(J.includes("hello")&&J.includes("world"))return!0;return"Expected output to contain: hello and world"}},O6=vX;var V6="Like most (good) languages, OCaml is a statically typed language. This means the compiler checks for type errors before your code ever runs. But unlike C or Java, instead of manually declaring the type of each variable, in OCaml, you can let the compiler infer the type of the variable for you.\n\n## Ints vs. Floats\n\nOcaml does this by a smart use of operators. For example, if you were adding two integers, you would use the standard operator:\n\n```ocaml\n1 + 2;;\n```\nBut, if you were adding an two floating point numbers, you would use the floating point operator:\n\n```ocaml\n1. +. 2.;;\n```\nNotice the `.` after the `+` operator. It tells the compiler that the operation is a floating point operation. f you try to use + with floats, or +. with ints, the compiler will complain.\n\nNow, to assign the result of such operation to a variable, we would use the let keyword. For example:\n\n```ocaml\nlet x = 1 + 2;;\n```\nSo think of the right hand side to be be an expression or a function that is evalauted and the result is then assigned to the variable on the left hand side (x in this case).\n\n## Functions\n\nThe `let` keyword can also be used to define functions. Typically in C-style languages you would define a function like this:\n\n```c\nfloat sum(float a, float b) {\n    return a + b;\n}\n```\nBut in OCaml, you could define a function like this:\n\n```ocaml\nlet sum a b = a +. b;;\n```\nHere `let` is the keyword that defines a function. Then, `sum` is the name of the function. Right after that, we have the arguments of the function i.e. `a` and `b` here.\n\nSo one way to read the function would be, the function `sum` takes two arguments `a` and `b` and the expression used to calculate the result is the one to the right of the `=` sign.\n\nOnce we define the function, we can use it like this:\n\n```ocaml\nlet x = sum 1. 2.;;\n```\nSo here, what we're doing is evaluate the function sum, which takes two arguments `1.` and `2.` and assigns the result to the variable `x`.\n\n# Problem Statement\n\nImplement a function average that takes two floating-point numbers and returns their average as a float.\n";var H6=`(* use the same function name and signature
   but fix the implementation *)

let average a b = (a + b);

(* do not edit below this line *)

let x = average 1. 2.;;`;var N6=`let () =
  let result = average 2. 5. in
  if result <> 3.5 then begin
    print_endline ("Test failed: average 2. 5. returned " ^ (string_of_float result) ^ " but expected 3.5");
    failwith "Test failed"
  end else
    print_endline "Test passed: average 2. 5. = 3.5";;`;var gX={id:"1.2",title:"Int, Float and Functions",description:V6,initialCode:H6,testCode:N6,validate:()=>{return!0}},I6=gX;var R6=`We looked at the \`let\` keyword earlier. But there's something fundamentally different about how OCaml treats functions compared to C-style languages.

Say you want to process a list of numbers - add 5 to some, multiply by 2 for others. In C with function pointers, you might write something like:

\`\`\`c
int add_five(int x) { return x + 5; }
int add_ten(int x) { return x + 10; }

void process(int* arr, int len, int (*fn)(int)) {
    for(int i = 0; i < len; i++) {
        arr[i] = fn(arr[i]);
    }
}

process(arr, len, add_five);
\`\`\`
But now, say you wanted to process the list with additional similar functions (likesay \`add_ten\`). For this, you'd have to write a new function that does this and then call it with \`process\` like this:

\`\`\`c
...
process(arr, len, add_five);

//now add ten
process(arr, len, add_ten);
\`\`\`

So what if you could build up  \`add_ten\` and \`add_five\` from a general \`add\` function?

## Currying

In OCaml, when you write something like:

\`\`\`ocaml
let sum x y = x + y;;
\`\`\`
Here, technically, \`sum\` is not a function that takes two arguments. It builds up like this: When you call \`sum 1 2\`, what actually happens is, \`sum 1\` returns a new function that adds 1 to its argument.

Now, that new function is immediately called with \`2\` as its argument which gives the result \`3\`.

This is called currying (names after Haskell Curry) and what this means is technically, every function in Ocaml takes exactly one argument. So multi-argument functions are essentially just syntactic sugar.

But why do this? What benefits does this give us?

## Partial Application

Since multi-argument functions are built up via currying, if we provide fewer argumnets than a function expects, we get a perfectly usable function back.

Again, we can compare this with C-styled languages. If we had a multi-argument function, we would need all argumnets to call it.

Well, this idea, called partial application can be useful in creating specialised functions without wrappers as we saw earlier.

If we already had \`add\` and \`multiply\` functions, we could we could create specialised functions by partail application like this:

\`\`\`ocaml
let add x y = x + y;;
let multiply x y = x * y;;

(* now we can create specialized functions *)
let add_five = add 5;;
let multiply_by_two = multiply 2;;
\`\`\`
Notice how although \`add\` requires two arguments, we can define \`add_five\` as a derived function of add but it just adds 5 to its input.

While this example is a bit silly, the point was to intoduce the way in which currying and partial application work.

# Problem Statement

Given two functions, \`add\` and \`multiply\`, create a function \`add_thirteen\` and a function \`multiply_by_17\`
`;var F6=`let add x y = x + y;;
let multiply x y = x * y;;

(* do not edit above *)


(* ?? your code goes in here *)


(* do not edit below *)

let num1 = add_thirteen 13;;
let num2 =  multiply_by_17 17;;
`;var D6=`(* This code is silently appended to the user's code *)
let () =
  let result1 = add_thirteen 7 in
  if result1 <> 20 then begin
    print_endline ("Test failed: add_thirteen 7 returned " ^ (string_of_int result1) ^ " but expected 20");
    failwith "Test failed"
  end else
    print_endline "✓ Test passed: add_thirteen 7 = 20";;

let () =
  let result2 = multiply_by_17 2 in
  if result2 <> 34 then begin
    print_endline ("Test failed: multiply_by_17 2 returned " ^ (string_of_int result2) ^ " but expected 34");
    failwith "Test failed"
  end else
    print_endline "✓ Test passed: multiply_by_17 2 = 34";;
`;var cX={id:"1.3",title:"Currying",description:R6,initialCode:F6,testCode:D6,validate:()=>!0},A6=cX;var h1=[O6,I6,A6];var o1=G6()(W6((Z,$)=>({currentExerciseId:h1[0]?.id||"1.1",completedIds:[],markComplete:(J)=>{let{completedIds:K}=$();if(!K.includes(J))Z({completedIds:[...K,J]})},setCurrent:(J)=>Z({currentExerciseId:J})}),{name:"sowar-storage"}));var P9=[],E6=[];(()=>{let Z="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(($)=>$?parseInt($,36):1);for(let $=0,J=0;$<Z.length;$++)($%2?E6:P9).push(J=J+Z[$])})();function sX(Z){if(Z<768)return!1;for(let $=0,J=P9.length;;){let K=$+J>>1;if(Z<P9[K])J=K;else if(Z>=E6[K])$=K+1;else return!0;if($==J)return!1}}function L6(Z){return Z>=127462&&Z<=127487}var M6=8205;function P6(Z,$,J=!0,K=!0){return(J?C6:nX)(Z,$,K)}function C6(Z,$,J){if($==Z.length)return $;if($&&T6(Z.charCodeAt($))&&y6(Z.charCodeAt($-1)))$--;let K=E9(Z,$);$+=B6(K);while($<Z.length){let X=E9(Z,$);if(K==M6||X==M6||J&&sX(X))$+=B6(X),K=X;else if(L6(X)){let Q=0,U=$-2;while(U>=0&&L6(E9(Z,U)))Q++,U-=2;if(Q%2==0)break;else $+=2}else break}return $}function nX(Z,$,J){while($>0){let K=C6(Z,$-2,J);if(K<$)return K;$--}return 0}function E9(Z,$){let J=Z.charCodeAt($);if(!y6(J)||$+1==Z.length)return J;let K=Z.charCodeAt($+1);if(!T6(K))return J;return(J-55296<<10)+(K-56320)+65536}function T6(Z){return Z>=56320&&Z<57344}function y6(Z){return Z>=55296&&Z<56320}function B6(Z){return Z<65536?1:2}class i{lineAt(Z){if(Z<0||Z>this.length)throw RangeError(`Invalid position ${Z} in document of length ${this.length}`);return this.lineInner(Z,!1,1,0)}line(Z){if(Z<1||Z>this.lines)throw RangeError(`Invalid line number ${Z} in ${this.lines}-line document`);return this.lineInner(Z,!0,1,0)}replace(Z,$,J){[Z,$]=I5(this,Z,$);let K=[];if(this.decompose(0,Z,K,2),J.length)J.decompose(0,J.length,K,3);return this.decompose($,this.length,K,1),L1.from(K,this.length-($-Z)+J.length)}append(Z){return this.replace(this.length,this.length,Z)}slice(Z,$=this.length){[Z,$]=I5(this,Z,$);let J=[];return this.decompose(Z,$,J,0),L1.from(J,$-Z)}eq(Z){if(Z==this)return!0;if(Z.length!=this.length||Z.lines!=this.lines)return!1;let $=this.scanIdentical(Z,1),J=this.length-this.scanIdentical(Z,-1),K=new H5(this),X=new H5(Z);for(let Q=$,U=$;;){if(K.next(Q),X.next(Q),Q=0,K.lineBreak!=X.lineBreak||K.done!=X.done||K.value!=X.value)return!1;if(U+=K.value.length,K.done||U>=J)return!0}}iter(Z=1){return new H5(this,Z)}iterRange(Z,$=this.length){return new m9(this,Z,$)}iterLines(Z,$){let J;if(Z==null)J=this.iter();else{if($==null)$=this.lines+1;let K=this.line(Z).from;J=this.iterRange(K,Math.max(K,$==this.lines+1?this.length:$<=1?0:this.line($-1).to))}return new u9(J)}toString(){return this.sliceString(0)}toJSON(){let Z=[];return this.flatten(Z),Z}constructor(){}static of(Z){if(Z.length==0)throw RangeError("A document must have at least one line");if(Z.length==1&&!Z[0])return i.empty;return Z.length<=32?new I0(Z):L1.from(I0.split(Z,[]))}}class I0 extends i{constructor(Z,$=iX(Z)){super();this.text=Z,this.length=$}get lines(){return this.text.length}get children(){return null}lineInner(Z,$,J,K){for(let X=0;;X++){let Q=this.text[X],U=K+Q.length;if(($?J:U)>=Z)return new h6(K,U,J,Q);K=U+1,J++}}decompose(Z,$,J,K){let X=Z<=0&&$>=this.length?this:new I0(k6(this.text,Z,$),Math.min($,this.length)-Math.max(0,Z));if(K&1){let Q=J.pop(),U=r7(X.text,Q.text.slice(),0,X.length);if(U.length<=32)J.push(new I0(U,Q.length+X.length));else{let Y=U.length>>1;J.push(new I0(U.slice(0,Y)),new I0(U.slice(Y)))}}else J.push(X)}replace(Z,$,J){if(!(J instanceof I0))return super.replace(Z,$,J);[Z,$]=I5(this,Z,$);let K=r7(this.text,r7(J.text,k6(this.text,0,Z)),$),X=this.length+J.length-($-Z);if(K.length<=32)return new I0(K,X);return L1.from(I0.split(K,[]),X)}sliceString(Z,$=this.length,J=`
`){[Z,$]=I5(this,Z,$);let K="";for(let X=0,Q=0;X<=$&&Q<this.text.length;Q++){let U=this.text[Q],Y=X+U.length;if(X>Z&&Q)K+=J;if(Z<Y&&$>X)K+=U.slice(Math.max(0,Z-X),$-X);X=Y+1}return K}flatten(Z){for(let $ of this.text)Z.push($)}scanIdentical(){return 0}static split(Z,$){let J=[],K=-1;for(let X of Z)if(J.push(X),K+=X.length+1,J.length==32)$.push(new I0(J,K)),J=[],K=-1;if(K>-1)$.push(new I0(J,K));return $}}class L1 extends i{constructor(Z,$){super();this.children=Z,this.length=$,this.lines=0;for(let J of Z)this.lines+=J.lines}lineInner(Z,$,J,K){for(let X=0;;X++){let Q=this.children[X],U=K+Q.length,Y=J+Q.lines-1;if(($?Y:U)>=Z)return Q.lineInner(Z,$,J,K);K=U+1,J=Y+1}}decompose(Z,$,J,K){for(let X=0,Q=0;Q<=$&&X<this.children.length;X++){let U=this.children[X],Y=Q+U.length;if(Z<=Y&&$>=Q){let q=K&((Q<=Z?1:0)|(Y>=$?2:0));if(Q>=Z&&Y<=$&&!q)J.push(U);else U.decompose(Z-Q,$-Q,J,q)}Q=Y+1}}replace(Z,$,J){if([Z,$]=I5(this,Z,$),J.lines<this.lines)for(let K=0,X=0;K<this.children.length;K++){let Q=this.children[K],U=X+Q.length;if(Z>=X&&$<=U){let Y=Q.replace(Z-X,$-X,J),q=this.lines-Q.lines+Y.lines;if(Y.lines<q>>4&&Y.lines>q>>6){let G=this.children.slice();return G[K]=Y,new L1(G,this.length-($-Z)+J.length)}return super.replace(X,U,Y)}X=U+1}return super.replace(Z,$,J)}sliceString(Z,$=this.length,J=`
`){[Z,$]=I5(this,Z,$);let K="";for(let X=0,Q=0;X<this.children.length&&Q<=$;X++){let U=this.children[X],Y=Q+U.length;if(Q>Z&&X)K+=J;if(Z<Y&&$>Q)K+=U.sliceString(Z-Q,$-Q,J);Q=Y+1}return K}flatten(Z){for(let $ of this.children)$.flatten(Z)}scanIdentical(Z,$){if(!(Z instanceof L1))return 0;let J=0,[K,X,Q,U]=$>0?[0,0,this.children.length,Z.children.length]:[this.children.length-1,Z.children.length-1,-1,-1];for(;;K+=$,X+=$){if(K==Q||X==U)return J;let Y=this.children[K],q=Z.children[X];if(Y!=q)return J+Y.scanIdentical(q,$);J+=Y.length+1}}static from(Z,$=Z.reduce((J,K)=>J+K.length+1,-1)){let J=0;for(let _ of Z)J+=_.lines;if(J<32){let _=[];for(let z of Z)z.flatten(_);return new I0(_,$)}let K=Math.max(32,J>>5),X=K<<1,Q=K>>1,U=[],Y=0,q=-1,G=[];function W(_){let z;if(_.lines>X&&_ instanceof L1)for(let V of _.children)W(V);else if(_.lines>Q&&(Y>Q||!Y))j(),U.push(_);else if(_ instanceof I0&&Y&&(z=G[G.length-1])instanceof I0&&_.lines+z.lines<=32)Y+=_.lines,q+=_.length+1,G[G.length-1]=new I0(z.text.concat(_.text),z.length+1+_.length);else{if(Y+_.lines>K)j();Y+=_.lines,q+=_.length+1,G.push(_)}}function j(){if(Y==0)return;U.push(G.length==1?G[0]:L1.from(G,q)),q=-1,Y=G.length=0}for(let _ of Z)W(_);return j(),U.length==1?U[0]:new L1(U,$)}}i.empty=new I0([""],0);function iX(Z){let $=-1;for(let J of Z)$+=J.length+1;return $}function r7(Z,$,J=0,K=1e9){for(let X=0,Q=0,U=!0;Q<Z.length&&X<=K;Q++){let Y=Z[Q],q=X+Y.length;if(q>=J){if(q>K)Y=Y.slice(0,K-X);if(X<J)Y=Y.slice(J-X);if(U)$[$.length-1]+=Y,U=!1;else $.push(Y)}X=q+1}return $}function k6(Z,$,J){return r7(Z,[""],$,J)}class H5{constructor(Z,$=1){this.dir=$,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[Z],this.offsets=[$>0?1:(Z instanceof I0?Z.text.length:Z.children.length)<<1]}nextInner(Z,$){this.done=this.lineBreak=!1;for(;;){let J=this.nodes.length-1,K=this.nodes[J],X=this.offsets[J],Q=X>>1,U=K instanceof I0?K.text.length:K.children.length;if(Q==($>0?U:0)){if(J==0)return this.done=!0,this.value="",this;if($>0)this.offsets[J-1]++;this.nodes.pop(),this.offsets.pop()}else if((X&1)==($>0?0:1)){if(this.offsets[J]+=$,Z==0)return this.lineBreak=!0,this.value=`
`,this;Z--}else if(K instanceof I0){let Y=K.text[Q+($<0?-1:0)];if(this.offsets[J]+=$,Y.length>Math.max(0,Z))return this.value=Z==0?Y:$>0?Y.slice(Z):Y.slice(0,Y.length-Z),this;Z-=Y.length}else{let Y=K.children[Q+($<0?-1:0)];if(Z>Y.length)Z-=Y.length,this.offsets[J]+=$;else{if($<0)this.offsets[J]--;this.nodes.push(Y),this.offsets.push($>0?1:(Y instanceof I0?Y.text.length:Y.children.length)<<1)}}}}next(Z=0){if(Z<0)this.nextInner(-Z,-this.dir),Z=this.value.length;return this.nextInner(Z,this.dir)}}class m9{constructor(Z,$,J){this.value="",this.done=!1,this.cursor=new H5(Z,$>J?-1:1),this.pos=$>J?Z.length:0,this.from=Math.min($,J),this.to=Math.max($,J)}nextInner(Z,$){if($<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;Z+=Math.max(0,$<0?this.pos-this.to:this.from-this.pos);let J=$<0?this.pos-this.from:this.to-this.pos;if(Z>J)Z=J;J-=Z;let{value:K}=this.cursor.next(Z);return this.pos+=(K.length+Z)*$,this.value=K.length<=J?K:$<0?K.slice(K.length-J):K.slice(0,J),this.done=!this.value,this}next(Z=0){if(Z<0)Z=Math.max(Z,this.from-this.pos);else if(Z>0)Z=Math.min(Z,this.to-this.pos);return this.nextInner(Z,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class u9{constructor(Z){this.inner=Z,this.afterBreak=!0,this.value="",this.done=!1}next(Z=0){let{done:$,lineBreak:J,value:K}=this.inner.next(Z);if($&&this.afterBreak)this.value="",this.afterBreak=!1;else if($)this.done=!0,this.value="";else if(J)if(this.afterBreak)this.value="";else this.afterBreak=!0,this.next();else this.value=K,this.afterBreak=!1;return this}get lineBreak(){return!1}}if(typeof Symbol<"u")i.prototype[Symbol.iterator]=function(){return this.iter()},H5.prototype[Symbol.iterator]=m9.prototype[Symbol.iterator]=u9.prototype[Symbol.iterator]=function(){return this};class h6{constructor(Z,$,J,K){this.from=Z,this.to=$,this.number=J,this.text=K}get length(){return this.to-this.from}}function I5(Z,$,J){return $=Math.max(0,Math.min(Z.length,$)),[$,Math.max($,Math.min(Z.length,J))]}function H0(Z,$,J=!0,K=!0){return P6(Z,$,J,K)}function aX(Z){return Z>=56320&&Z<57344}function rX(Z){return Z>=55296&&Z<56320}function P0(Z,$){let J=Z.charCodeAt($);if(!rX(J)||$+1==Z.length)return J;let K=Z.charCodeAt($+1);if(!aX(K))return J;return(J-55296<<10)+(K-56320)+65536}function $7(Z){if(Z<=65535)return String.fromCharCode(Z);return Z-=65536,String.fromCharCode((Z>>10)+55296,(Z&1023)+56320)}function c0(Z){return Z<65536?1:2}var T9=/\r\n?|\n/,E0=function(Z){return Z[Z.Simple=0]="Simple",Z[Z.TrackDel=1]="TrackDel",Z[Z.TrackBefore=2]="TrackBefore",Z[Z.TrackAfter=3]="TrackAfter",Z}(E0||(E0={}));class G1{constructor(Z){this.sections=Z}get length(){let Z=0;for(let $=0;$<this.sections.length;$+=2)Z+=this.sections[$];return Z}get newLength(){let Z=0;for(let $=0;$<this.sections.length;$+=2){let J=this.sections[$+1];Z+=J<0?this.sections[$]:J}return Z}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(Z){for(let $=0,J=0,K=0;$<this.sections.length;){let X=this.sections[$++],Q=this.sections[$++];if(Q<0)Z(J,K,X),K+=X;else K+=Q;J+=X}}iterChangedRanges(Z,$=!1){y9(this,Z,$)}get invertedDesc(){let Z=[];for(let $=0;$<this.sections.length;){let J=this.sections[$++],K=this.sections[$++];if(K<0)Z.push(J,K);else Z.push(K,J)}return new G1(Z)}composeDesc(Z){return this.empty?Z:Z.empty?this:v6(this,Z)}mapDesc(Z,$=!1){return Z.empty?this:k9(this,Z,$)}mapPos(Z,$=-1,J=E0.Simple){let K=0,X=0;for(let Q=0;Q<this.sections.length;){let U=this.sections[Q++],Y=this.sections[Q++],q=K+U;if(Y<0){if(q>Z)return X+(Z-K);X+=U}else{if(J!=E0.Simple&&q>=Z&&(J==E0.TrackDel&&K<Z&&q>Z||J==E0.TrackBefore&&K<Z||J==E0.TrackAfter&&q>Z))return null;if(q>Z||q==Z&&$<0&&!U)return Z==K||$<0?X:X+Y;X+=Y}K=q}if(Z>K)throw RangeError(`Position ${Z} is out of range for changeset of length ${K}`);return X}touchesRange(Z,$=Z){for(let J=0,K=0;J<this.sections.length&&K<=$;){let X=this.sections[J++],Q=this.sections[J++],U=K+X;if(Q>=0&&K<=$&&U>=Z)return K<Z&&U>$?"cover":!0;K=U}return!1}toString(){let Z="";for(let $=0;$<this.sections.length;){let J=this.sections[$++],K=this.sections[$++];Z+=(Z?" ":"")+J+(K>=0?":"+K:"")}return Z}toJSON(){return this.sections}static fromJSON(Z){if(!Array.isArray(Z)||Z.length%2||Z.some(($)=>typeof $!="number"))throw RangeError("Invalid JSON representation of ChangeDesc");return new G1(Z)}static create(Z){return new G1(Z)}}class R0 extends G1{constructor(Z,$){super(Z);this.inserted=$}apply(Z){if(this.length!=Z.length)throw RangeError("Applying change set to a document with the wrong length");return y9(this,($,J,K,X,Q)=>Z=Z.replace(K,K+(J-$),Q),!1),Z}mapDesc(Z,$=!1){return k9(this,Z,$,!0)}invert(Z){let $=this.sections.slice(),J=[];for(let K=0,X=0;K<$.length;K+=2){let Q=$[K],U=$[K+1];if(U>=0){$[K]=U,$[K+1]=Q;let Y=K>>1;while(J.length<Y)J.push(i.empty);J.push(Q?Z.slice(X,X+Q):i.empty)}X+=Q}return new R0($,J)}compose(Z){return this.empty?Z:Z.empty?this:v6(this,Z,!0)}map(Z,$=!1){return Z.empty?this:k9(this,Z,$,!0)}iterChanges(Z,$=!1){y9(this,Z,$)}get desc(){return G1.create(this.sections)}filter(Z){let $=[],J=[],K=[],X=new R5(this);Z:for(let Q=0,U=0;;){let Y=Q==Z.length?1e9:Z[Q++];while(U<Y||U==Y&&X.len==0){if(X.done)break Z;let G=Math.min(X.len,Y-U);k0(K,G,-1);let W=X.ins==-1?-1:X.off==0?X.ins:0;if(k0($,G,W),W>0)v1(J,$,X.text);X.forward(G),U+=G}let q=Z[Q++];while(U<q){if(X.done)break Z;let G=Math.min(X.len,q-U);k0($,G,-1),k0(K,G,X.ins==-1?-1:X.off==0?X.ins:0),X.forward(G),U+=G}}return{changes:new R0($,J),filtered:G1.create(K)}}toJSON(){let Z=[];for(let $=0;$<this.sections.length;$+=2){let J=this.sections[$],K=this.sections[$+1];if(K<0)Z.push(J);else if(K==0)Z.push([J]);else Z.push([J].concat(this.inserted[$>>1].toJSON()))}return Z}static of(Z,$,J){let K=[],X=[],Q=0,U=null;function Y(G=!1){if(!G&&!K.length)return;if(Q<$)k0(K,$-Q,-1);let W=new R0(K,X);U=U?U.compose(W.map(U)):W,K=[],X=[],Q=0}function q(G){if(Array.isArray(G))for(let W of G)q(W);else if(G instanceof R0){if(G.length!=$)throw RangeError(`Mismatched change set length (got ${G.length}, expected ${$})`);Y(),U=U?U.compose(G.map(U)):G}else{let{from:W,to:j=W,insert:_}=G;if(W>j||W<0||j>$)throw RangeError(`Invalid change range ${W} to ${j} (in doc of length ${$})`);let z=!_?i.empty:typeof _=="string"?i.of(_.split(J||T9)):_,V=z.length;if(W==j&&V==0)return;if(W<Q)Y();if(W>Q)k0(K,W-Q,-1);k0(K,j-W,V),v1(X,K,z),Q=j}}return q(Z),Y(!U),U}static empty(Z){return new R0(Z?[Z,-1]:[],[])}static fromJSON(Z){if(!Array.isArray(Z))throw RangeError("Invalid JSON representation of ChangeSet");let $=[],J=[];for(let K=0;K<Z.length;K++){let X=Z[K];if(typeof X=="number")$.push(X,-1);else if(!Array.isArray(X)||typeof X[0]!="number"||X.some((Q,U)=>U&&typeof Q!="string"))throw RangeError("Invalid JSON representation of ChangeSet");else if(X.length==1)$.push(X[0],0);else{while(J.length<K)J.push(i.empty);J[K]=i.of(X.slice(1)),$.push(X[0],J[K].length)}}return new R0($,J)}static createSet(Z,$){return new R0(Z,$)}}function k0(Z,$,J,K=!1){if($==0&&J<=0)return;let X=Z.length-2;if(X>=0&&J<=0&&J==Z[X+1])Z[X]+=$;else if(X>=0&&$==0&&Z[X]==0)Z[X+1]+=J;else if(K)Z[X]+=$,Z[X+1]+=J;else Z.push($,J)}function v1(Z,$,J){if(J.length==0)return;let K=$.length-2>>1;if(K<Z.length)Z[Z.length-1]=Z[Z.length-1].append(J);else{while(Z.length<K)Z.push(i.empty);Z.push(J)}}function y9(Z,$,J){let K=Z.inserted;for(let X=0,Q=0,U=0;U<Z.sections.length;){let Y=Z.sections[U++],q=Z.sections[U++];if(q<0)X+=Y,Q+=Y;else{let G=X,W=Q,j=i.empty;for(;;){if(G+=Y,W+=q,q&&K)j=j.append(K[U-2>>1]);if(J||U==Z.sections.length||Z.sections[U+1]<0)break;Y=Z.sections[U++],q=Z.sections[U++]}$(X,G,Q,W,j),X=G,Q=W}}}function k9(Z,$,J,K=!1){let X=[],Q=K?[]:null,U=new R5(Z),Y=new R5($);for(let q=-1;;)if(U.done&&Y.len||Y.done&&U.len)throw Error("Mismatched change set lengths");else if(U.ins==-1&&Y.ins==-1){let G=Math.min(U.len,Y.len);k0(X,G,-1),U.forward(G),Y.forward(G)}else if(Y.ins>=0&&(U.ins<0||q==U.i||U.off==0&&(Y.len<U.len||Y.len==U.len&&!J))){let G=Y.len;k0(X,Y.ins,-1);while(G){let W=Math.min(U.len,G);if(U.ins>=0&&q<U.i&&U.len<=W){if(k0(X,0,U.ins),Q)v1(Q,X,U.text);q=U.i}U.forward(W),G-=W}Y.next()}else if(U.ins>=0){let G=0,W=U.len;while(W)if(Y.ins==-1){let j=Math.min(W,Y.len);G+=j,W-=j,Y.forward(j)}else if(Y.ins==0&&Y.len<W)W-=Y.len,Y.next();else break;if(k0(X,G,q<U.i?U.ins:0),Q&&q<U.i)v1(Q,X,U.text);q=U.i,U.forward(U.len-W)}else if(U.done&&Y.done)return Q?R0.createSet(X,Q):G1.create(X);else throw Error("Mismatched change set lengths")}function v6(Z,$,J=!1){let K=[],X=J?[]:null,Q=new R5(Z),U=new R5($);for(let Y=!1;;)if(Q.done&&U.done)return X?R0.createSet(K,X):G1.create(K);else if(Q.ins==0)k0(K,Q.len,0,Y),Q.next();else if(U.len==0&&!U.done){if(k0(K,0,U.ins,Y),X)v1(X,K,U.text);U.next()}else if(Q.done||U.done)throw Error("Mismatched change set lengths");else{let q=Math.min(Q.len2,U.len),G=K.length;if(Q.ins==-1){let W=U.ins==-1?-1:U.off?0:U.ins;if(k0(K,q,W,Y),X&&W)v1(X,K,U.text)}else if(U.ins==-1){if(k0(K,Q.off?0:Q.len,q,Y),X)v1(X,K,Q.textBit(q))}else if(k0(K,Q.off?0:Q.len,U.off?0:U.ins,Y),X&&!U.off)v1(X,K,U.text);Y=(Q.ins>q||U.ins>=0&&U.len>q)&&(Y||K.length>G),Q.forward2(q),U.forward(q)}}class R5{constructor(Z){this.set=Z,this.i=0,this.next()}next(){let{sections:Z}=this.set;if(this.i<Z.length)this.len=Z[this.i++],this.ins=Z[this.i++];else this.len=0,this.ins=-2;this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:Z}=this.set,$=this.i-2>>1;return $>=Z.length?i.empty:Z[$]}textBit(Z){let{inserted:$}=this.set,J=this.i-2>>1;return J>=$.length&&!Z?i.empty:$[J].slice(this.off,Z==null?void 0:this.off+Z)}forward(Z){if(Z==this.len)this.next();else this.len-=Z,this.off+=Z}forward2(Z){if(this.ins==-1)this.forward(Z);else if(Z==this.ins)this.next();else this.ins-=Z,this.off+=Z}}class e1{constructor(Z,$,J){this.from=Z,this.to=$,this.flags=J}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let Z=this.flags&7;return Z==7?null:Z}get goalColumn(){let Z=this.flags>>6;return Z==16777215?void 0:Z}map(Z,$=-1){let J,K;if(this.empty)J=K=Z.mapPos(this.from,$);else J=Z.mapPos(this.from,1),K=Z.mapPos(this.to,-1);return J==this.from&&K==this.to?this:new e1(J,K,this.flags)}extend(Z,$=Z){if(Z<=this.anchor&&$>=this.anchor)return D.range(Z,$);let J=Math.abs(Z-this.anchor)>Math.abs($-this.anchor)?Z:$;return D.range(this.anchor,J)}eq(Z,$=!1){return this.anchor==Z.anchor&&this.head==Z.head&&this.goalColumn==Z.goalColumn&&(!$||!this.empty||this.assoc==Z.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(Z){if(!Z||typeof Z.anchor!="number"||typeof Z.head!="number")throw RangeError("Invalid JSON representation for SelectionRange");return D.range(Z.anchor,Z.head)}static create(Z,$,J){return new e1(Z,$,J)}}class D{constructor(Z,$){this.ranges=Z,this.mainIndex=$}map(Z,$=-1){if(Z.empty)return this;return D.create(this.ranges.map((J)=>J.map(Z,$)),this.mainIndex)}eq(Z,$=!1){if(this.ranges.length!=Z.ranges.length||this.mainIndex!=Z.mainIndex)return!1;for(let J=0;J<this.ranges.length;J++)if(!this.ranges[J].eq(Z.ranges[J],$))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new D([this.main],0)}addRange(Z,$=!0){return D.create([Z].concat(this.ranges),$?0:this.mainIndex+1)}replaceRange(Z,$=this.mainIndex){let J=this.ranges.slice();return J[$]=Z,D.create(J,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((Z)=>Z.toJSON()),main:this.mainIndex}}static fromJSON(Z){if(!Z||!Array.isArray(Z.ranges)||typeof Z.main!="number"||Z.main>=Z.ranges.length)throw RangeError("Invalid JSON representation for EditorSelection");return new D(Z.ranges.map(($)=>e1.fromJSON($)),Z.main)}static single(Z,$=Z){return new D([D.range(Z,$)],0)}static create(Z,$=0){if(Z.length==0)throw RangeError("A selection needs at least one range");for(let J=0,K=0;K<Z.length;K++){let X=Z[K];if(X.empty?X.from<=J:X.from<J)return D.normalized(Z.slice(),$);J=X.to}return new D(Z,$)}static cursor(Z,$=0,J,K){return e1.create(Z,Z,($==0?0:$<0?8:16)|(J==null?7:Math.min(6,J))|(K!==null&&K!==void 0?K:16777215)<<6)}static range(Z,$,J,K){let X=(J!==null&&J!==void 0?J:16777215)<<6|(K==null?7:Math.min(6,K));return $<Z?e1.create($,Z,48|X):e1.create(Z,$,($>Z?8:0)|X)}static normalized(Z,$=0){let J=Z[$];Z.sort((K,X)=>K.from-X.from),$=Z.indexOf(J);for(let K=1;K<Z.length;K++){let X=Z[K],Q=Z[K-1];if(X.empty?X.from<=Q.to:X.from<Q.to){let U=Q.from,Y=Math.max(X.to,Q.to);if(K<=$)$--;Z.splice(--K,2,X.anchor>X.head?D.range(Y,U):D.range(U,Y))}}return new D(Z,$)}}function m6(Z,$){for(let J of Z.ranges)if(J.to>$)throw RangeError("Selection points outside of document")}var f9=0;class C{constructor(Z,$,J,K,X){this.combine=Z,this.compareInput=$,this.compare=J,this.isStatic=K,this.id=f9++,this.default=Z([]),this.extensions=typeof X=="function"?X(this):X}get reader(){return this}static define(Z={}){return new C(Z.combine||(($)=>$),Z.compareInput||(($,J)=>$===J),Z.compare||(!Z.combine?g9:($,J)=>$===J),!!Z.static,Z.enables)}of(Z){return new o5([],this,0,Z)}compute(Z,$){if(this.isStatic)throw Error("Can't compute a static facet");return new o5(Z,this,1,$)}computeN(Z,$){if(this.isStatic)throw Error("Can't compute a static facet");return new o5(Z,this,2,$)}from(Z,$){if(!$)$=(J)=>J;return this.compute([Z],(J)=>$(J.field(Z)))}}function g9(Z,$){return Z==$||Z.length==$.length&&Z.every((J,K)=>J===$[K])}class o5{constructor(Z,$,J,K){this.dependencies=Z,this.facet=$,this.type=J,this.value=K,this.id=f9++}dynamicSlot(Z){var $;let J=this.value,K=this.facet.compareInput,X=this.id,Q=Z[X]>>1,U=this.type==2,Y=!1,q=!1,G=[];for(let W of this.dependencies)if(W=="doc")Y=!0;else if(W=="selection")q=!0;else if(((($=Z[W.id])!==null&&$!==void 0?$:1)&1)==0)G.push(Z[W.id]);return{create(W){return W.values[Q]=J(W),1},update(W,j){if(Y&&j.docChanged||q&&(j.docChanged||j.selection)||S9(W,G)){let _=J(W);if(U?!S6(_,W.values[Q],K):!K(_,W.values[Q]))return W.values[Q]=_,1}return 0},reconfigure:(W,j)=>{let _,z=j.config.address[X];if(z!=null){let V=e7(j,z);if(this.dependencies.every((O)=>{return O instanceof C?j.facet(O)===W.facet(O):O instanceof j0?j.field(O,!1)==W.field(O,!1):!0})||(U?S6(_=J(W),V,K):K(_=J(W),V)))return W.values[Q]=V,0}else _=J(W);return W.values[Q]=_,1}}}}function S6(Z,$,J){if(Z.length!=$.length)return!1;for(let K=0;K<Z.length;K++)if(!J(Z[K],$[K]))return!1;return!0}function S9(Z,$){let J=!1;for(let K of $)if(t5(Z,K)&1)J=!0;return J}function oX(Z,$,J){let K=J.map((q)=>Z[q.id]),X=J.map((q)=>q.type),Q=K.filter((q)=>!(q&1)),U=Z[$.id]>>1;function Y(q){let G=[];for(let W=0;W<K.length;W++){let j=e7(q,K[W]);if(X[W]==2)for(let _ of j)G.push(_);else G.push(j)}return $.combine(G)}return{create(q){for(let G of K)t5(q,G);return q.values[U]=Y(q),1},update(q,G){if(!S9(q,Q))return 0;let W=Y(q);if($.compare(W,q.values[U]))return 0;return q.values[U]=W,1},reconfigure(q,G){let W=S9(q,K),j=G.config.facets[$.id],_=G.facet($);if(j&&!W&&g9(J,j))return q.values[U]=_,0;let z=Y(q);if($.compare(z,_))return q.values[U]=_,0;return q.values[U]=z,1}}}var n7=C.define({static:!0});class j0{constructor(Z,$,J,K,X){this.id=Z,this.createF=$,this.updateF=J,this.compareF=K,this.spec=X,this.provides=void 0}static define(Z){let $=new j0(f9++,Z.create,Z.update,Z.compare||((J,K)=>J===K),Z);if(Z.provide)$.provides=Z.provide($);return $}create(Z){let $=Z.facet(n7).find((J)=>J.field==this);return(($===null||$===void 0?void 0:$.create)||this.createF)(Z)}slot(Z){let $=Z[this.id]>>1;return{create:(J)=>{return J.values[$]=this.create(J),1},update:(J,K)=>{let X=J.values[$],Q=this.updateF(X,K);if(this.compareF(X,Q))return 0;return J.values[$]=Q,1},reconfigure:(J,K)=>{let X=J.facet(n7),Q=K.facet(n7),U;if((U=X.find((Y)=>Y.field==this))&&U!=Q.find((Y)=>Y.field==this))return J.values[$]=U.create(J),1;if(K.config.address[this.id]!=null)return J.values[$]=K.field(this),0;return J.values[$]=this.create(J),1}}}init(Z){return[this,n7.of({field:this,create:Z})]}get extension(){return this}}var t1={lowest:4,low:3,default:2,high:1,highest:0};function r5(Z){return($)=>new p9($,Z)}var j1={highest:r5(t1.highest),high:r5(t1.high),default:r5(t1.default),low:r5(t1.low),lowest:r5(t1.lowest)};class p9{constructor(Z,$){this.inner=Z,this.prec=$}}class Z4{of(Z){return new o7(this,Z)}reconfigure(Z){return Z4.reconfigure.of({compartment:this,extension:Z})}get(Z){return Z.config.compartments.get(this)}}class o7{constructor(Z,$){this.compartment=Z,this.inner=$}}class t7{constructor(Z,$,J,K,X,Q){this.base=Z,this.compartments=$,this.dynamicSlots=J,this.address=K,this.staticValues=X,this.facets=Q,this.statusTemplate=[];while(this.statusTemplate.length<J.length)this.statusTemplate.push(0)}staticFacet(Z){let $=this.address[Z.id];return $==null?Z.default:this.staticValues[$>>1]}static resolve(Z,$,J){let K=[],X=Object.create(null),Q=new Map;for(let j of tX(Z,$,Q))if(j instanceof j0)K.push(j);else(X[j.facet.id]||(X[j.facet.id]=[])).push(j);let U=Object.create(null),Y=[],q=[];for(let j of K)U[j.id]=q.length<<1,q.push((_)=>j.slot(_));let G=J===null||J===void 0?void 0:J.config.facets;for(let j in X){let _=X[j],z=_[0].facet,V=G&&G[j]||[];if(_.every((O)=>O.type==0))if(U[z.id]=Y.length<<1|1,g9(V,_))Y.push(J.facet(z));else{let O=z.combine(_.map((N)=>N.value));Y.push(J&&z.compare(O,J.facet(z))?J.facet(z):O)}else{for(let O of _)if(O.type==0)U[O.id]=Y.length<<1|1,Y.push(O.value);else U[O.id]=q.length<<1,q.push((N)=>O.dynamicSlot(N));U[z.id]=q.length<<1,q.push((O)=>oX(O,z,_))}}let W=q.map((j)=>j(U));return new t7(Z,Q,W,U,Y,X)}}function tX(Z,$,J){let K=[[],[],[],[],[]],X=new Map;function Q(U,Y){let q=X.get(U);if(q!=null){if(q<=Y)return;let G=K[q].indexOf(U);if(G>-1)K[q].splice(G,1);if(U instanceof o7)J.delete(U.compartment)}if(X.set(U,Y),Array.isArray(U))for(let G of U)Q(G,Y);else if(U instanceof o7){if(J.has(U.compartment))throw RangeError("Duplicate use of compartment in extensions");let G=$.get(U.compartment)||U.inner;J.set(U.compartment,G),Q(G,Y)}else if(U instanceof p9)Q(U.inner,U.prec);else if(U instanceof j0){if(K[Y].push(U),U.provides)Q(U.provides,Y)}else if(U instanceof o5){if(K[Y].push(U),U.facet.extensions)Q(U.facet.extensions,t1.default)}else{let G=U.extension;if(!G)throw Error(`Unrecognized extension value in extension set (${U}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);Q(G,Y)}}return Q(Z,t1.default),K.reduce((U,Y)=>U.concat(Y))}function t5(Z,$){if($&1)return 2;let J=$>>1,K=Z.status[J];if(K==4)throw Error("Cyclic dependency between fields and/or facets");if(K&2)return K;Z.status[J]=4;let X=Z.computeSlot(Z,Z.config.dynamicSlots[J]);return Z.status[J]=2|X}function e7(Z,$){return $&1?Z.config.staticValues[$>>1]:Z.values[$>>1]}var u6=C.define(),b9=C.define({combine:(Z)=>Z.some(($)=>$),static:!0}),f6=C.define({combine:(Z)=>Z.length?Z[0]:void 0,static:!0}),g6=C.define(),p6=C.define(),d6=C.define(),l6=C.define({combine:(Z)=>Z.length?Z[0]:!1});class s0{constructor(Z,$){this.type=Z,this.value=$}static define(){return new c6}}class c6{of(Z){return new s0(this,Z)}}class s6{constructor(Z){this.map=Z}of(Z){return new v(this,Z)}}class v{constructor(Z,$){this.type=Z,this.value=$}map(Z){let $=this.type.map(this.value,Z);return $===void 0?void 0:$==this.value?this:new v(this.type,$)}is(Z){return this.type==Z}static define(Z={}){return new s6(Z.map||(($)=>$))}static mapEffects(Z,$){if(!Z.length)return Z;let J=[];for(let K of Z){let X=K.map($);if(X)J.push(X)}return J}}v.reconfigure=v.define();v.appendConfig=v.define();class V0{constructor(Z,$,J,K,X,Q){if(this.startState=Z,this.changes=$,this.selection=J,this.effects=K,this.annotations=X,this.scrollIntoView=Q,this._doc=null,this._state=null,J)m6(J,$.newLength);if(!X.some((U)=>U.type==V0.time))this.annotations=X.concat(V0.time.of(Date.now()))}static create(Z,$,J,K,X,Q){return new V0(Z,$,J,K,X,Q)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){if(!this._state)this.startState.applyTransaction(this);return this._state}annotation(Z){for(let $ of this.annotations)if($.type==Z)return $.value;return}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(Z){let $=this.annotation(V0.userEvent);return!!($&&($==Z||$.length>Z.length&&$.slice(0,Z.length)==Z&&$[Z.length]=="."))}}V0.time=s0.define();V0.userEvent=s0.define();V0.addToHistory=s0.define();V0.remote=s0.define();function eX(Z,$){let J=[];for(let K=0,X=0;;){let Q,U;if(K<Z.length&&(X==$.length||$[X]>=Z[K]))Q=Z[K++],U=Z[K++];else if(X<$.length)Q=$[X++],U=$[X++];else return J;if(!J.length||J[J.length-1]<Q)J.push(Q,U);else if(J[J.length-1]<U)J[J.length-1]=U}}function n6(Z,$,J){var K;let X,Q,U;if(J)X=$.changes,Q=R0.empty($.changes.length),U=Z.changes.compose($.changes);else X=$.changes.map(Z.changes),Q=Z.changes.mapDesc($.changes,!0),U=Z.changes.compose(X);return{changes:U,selection:$.selection?$.selection.map(Q):(K=Z.selection)===null||K===void 0?void 0:K.map(X),effects:v.mapEffects(Z.effects,X).concat(v.mapEffects($.effects,Q)),annotations:Z.annotations.length?Z.annotations.concat($.annotations):$.annotations,scrollIntoView:Z.scrollIntoView||$.scrollIntoView}}function x9(Z,$,J){let K=$.selection,X=N5($.annotations);if($.userEvent)X=X.concat(V0.userEvent.of($.userEvent));return{changes:$.changes instanceof R0?$.changes:R0.of($.changes||[],J,Z.facet(f6)),selection:K&&(K instanceof D?K:D.single(K.anchor,K.head)),effects:N5($.effects),annotations:X,scrollIntoView:!!$.scrollIntoView}}function i6(Z,$,J){let K=x9(Z,$.length?$[0]:{},Z.doc.length);if($.length&&$[0].filter===!1)J=!1;for(let Q=1;Q<$.length;Q++){if($[Q].filter===!1)J=!1;let U=!!$[Q].sequential;K=n6(K,x9(Z,$[Q],U?K.changes.newLength:Z.doc.length),U)}let X=V0.create(Z,K.changes,K.selection,K.effects,K.annotations,K.scrollIntoView);return $Q(J?ZQ(X):X)}function ZQ(Z){let $=Z.startState,J=!0;for(let X of $.facet(g6)){let Q=X(Z);if(Q===!1){J=!1;break}if(Array.isArray(Q))J=J===!0?Q:eX(J,Q)}if(J!==!0){let X,Q;if(J===!1)Q=Z.changes.invertedDesc,X=R0.empty($.doc.length);else{let U=Z.changes.filter(J);X=U.changes,Q=U.filtered.mapDesc(U.changes).invertedDesc}Z=V0.create($,X,Z.selection&&Z.selection.map(Q),v.mapEffects(Z.effects,Q),Z.annotations,Z.scrollIntoView)}let K=$.facet(p6);for(let X=K.length-1;X>=0;X--){let Q=K[X](Z);if(Q instanceof V0)Z=Q;else if(Array.isArray(Q)&&Q.length==1&&Q[0]instanceof V0)Z=Q[0];else Z=i6($,N5(Q),!1)}return Z}function $Q(Z){let $=Z.startState,J=$.facet(d6),K=Z;for(let X=J.length-1;X>=0;X--){let Q=J[X](Z);if(Q&&Object.keys(Q).length)K=n6(K,x9($,Q,Z.changes.newLength),!0)}return K==Z?Z:V0.create($,Z.changes,Z.selection,K.effects,K.annotations,K.scrollIntoView)}var JQ=[];function N5(Z){return Z==null?JQ:Array.isArray(Z)?Z:[Z]}var X0=function(Z){return Z[Z.Word=0]="Word",Z[Z.Space=1]="Space",Z[Z.Other=2]="Other",Z}(X0||(X0={})),KQ=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,w9;try{w9=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(Z){}function XQ(Z){if(w9)return w9.test(Z);for(let $=0;$<Z.length;$++){let J=Z[$];if(/\w/.test(J)||J>""&&(J.toUpperCase()!=J.toLowerCase()||KQ.test(J)))return!0}return!1}function QQ(Z){return($)=>{if(!/\S/.test($))return X0.Space;if(XQ($))return X0.Word;for(let J=0;J<Z.length;J++)if($.indexOf(Z[J])>-1)return X0.Word;return X0.Other}}class p{constructor(Z,$,J,K,X,Q){if(this.config=Z,this.doc=$,this.selection=J,this.values=K,this.status=Z.statusTemplate.slice(),this.computeSlot=X,Q)Q._state=this;for(let U=0;U<this.config.dynamicSlots.length;U++)t5(this,U<<1);this.computeSlot=null}field(Z,$=!0){let J=this.config.address[Z.id];if(J==null){if($)throw RangeError("Field is not present in this state");return}return t5(this,J),e7(this,J)}update(...Z){return i6(this,Z,!0)}applyTransaction(Z){let $=this.config,{base:J,compartments:K}=$;for(let U of Z.effects)if(U.is(Z4.reconfigure)){if($)K=new Map,$.compartments.forEach((Y,q)=>K.set(q,Y)),$=null;K.set(U.value.compartment,U.value.extension)}else if(U.is(v.reconfigure))$=null,J=U.value;else if(U.is(v.appendConfig))$=null,J=N5(J).concat(U.value);let X;if(!$)$=t7.resolve(J,K,this),X=new p($,this.doc,this.selection,$.dynamicSlots.map(()=>null),(Y,q)=>q.reconfigure(Y,this),null).values;else X=Z.startState.values.slice();let Q=Z.startState.facet(b9)?Z.newSelection:Z.newSelection.asSingle();new p($,Z.newDoc,Q,X,(U,Y)=>Y.update(U,Z),Z)}replaceSelection(Z){if(typeof Z=="string")Z=this.toText(Z);return this.changeByRange(($)=>({changes:{from:$.from,to:$.to,insert:Z},range:D.cursor($.from+Z.length)}))}changeByRange(Z){let $=this.selection,J=Z($.ranges[0]),K=this.changes(J.changes),X=[J.range],Q=N5(J.effects);for(let U=1;U<$.ranges.length;U++){let Y=Z($.ranges[U]),q=this.changes(Y.changes),G=q.map(K);for(let j=0;j<U;j++)X[j]=X[j].map(G);let W=K.mapDesc(q,!0);X.push(Y.range.map(W)),K=K.compose(G),Q=v.mapEffects(Q,G).concat(v.mapEffects(N5(Y.effects),W))}return{changes:K,selection:D.create(X,$.mainIndex),effects:Q}}changes(Z=[]){if(Z instanceof R0)return Z;return R0.of(Z,this.doc.length,this.facet(p.lineSeparator))}toText(Z){return i.of(Z.split(this.facet(p.lineSeparator)||T9))}sliceDoc(Z=0,$=this.doc.length){return this.doc.sliceString(Z,$,this.lineBreak)}facet(Z){let $=this.config.address[Z.id];if($==null)return Z.default;return t5(this,$),e7(this,$)}toJSON(Z){let $={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(Z)for(let J in Z){let K=Z[J];if(K instanceof j0&&this.config.address[K.id]!=null)$[J]=K.spec.toJSON(this.field(Z[J]),this)}return $}static fromJSON(Z,$={},J){if(!Z||typeof Z.doc!="string")throw RangeError("Invalid JSON representation for EditorState");let K=[];if(J){for(let X in J)if(Object.prototype.hasOwnProperty.call(Z,X)){let Q=J[X],U=Z[X];K.push(Q.init((Y)=>Q.spec.fromJSON(U,Y)))}}return p.create({doc:Z.doc,selection:D.fromJSON(Z.selection),extensions:$.extensions?K.concat([$.extensions]):K})}static create(Z={}){let $=t7.resolve(Z.extensions||[],new Map),J=Z.doc instanceof i?Z.doc:i.of((Z.doc||"").split($.staticFacet(p.lineSeparator)||T9)),K=!Z.selection?D.single(0):Z.selection instanceof D?Z.selection:D.single(Z.selection.anchor,Z.selection.head);if(m6(K,J.length),!$.staticFacet(b9))K=K.asSingle();return new p($,J,K,$.dynamicSlots.map(()=>null),(X,Q)=>Q.create(X),null)}get tabSize(){return this.facet(p.tabSize)}get lineBreak(){return this.facet(p.lineSeparator)||`
`}get readOnly(){return this.facet(l6)}phrase(Z,...$){for(let J of this.facet(p.phrases))if(Object.prototype.hasOwnProperty.call(J,Z)){Z=J[Z];break}if($.length)Z=Z.replace(/\$(\$|\d*)/g,(J,K)=>{if(K=="$")return"$";let X=+(K||1);return!X||X>$.length?J:$[X-1]});return Z}languageDataAt(Z,$,J=-1){let K=[];for(let X of this.facet(u6))for(let Q of X(this,$,J))if(Object.prototype.hasOwnProperty.call(Q,Z))K.push(Q[Z]);return K}charCategorizer(Z){let $=this.languageDataAt("wordChars",Z);return QQ($.length?$[0]:"")}wordAt(Z){let{text:$,from:J,length:K}=this.doc.lineAt(Z),X=this.charCategorizer(Z),Q=Z-J,U=Z-J;while(Q>0){let Y=H0($,Q,!1);if(X($.slice(Y,Q))!=X0.Word)break;Q=Y}while(U<K){let Y=H0($,U);if(X($.slice(U,Y))!=X0.Word)break;U=Y}return Q==U?null:D.range(Q+J,U+J)}}p.allowMultipleSelections=b9;p.tabSize=C.define({combine:(Z)=>Z.length?Z[0]:4});p.lineSeparator=f6;p.readOnly=l6;p.phrases=C.define({compare(Z,$){let J=Object.keys(Z),K=Object.keys($);return J.length==K.length&&J.every((X)=>Z[X]==$[X])}});p.languageData=u6;p.changeFilter=g6;p.transactionFilter=p6;p.transactionExtender=d6;Z4.reconfigure=v.define();function S0(Z,$,J={}){let K={};for(let X of Z)for(let Q of Object.keys(X)){let U=X[Q],Y=K[Q];if(Y===void 0)K[Q]=U;else if(Y===U||U===void 0);else if(Object.hasOwnProperty.call(J,Q))K[Q]=J[Q](Y,U);else throw Error("Config merge conflict for field "+Q)}for(let X in $)if(K[X]===void 0)K[X]=$[X];return K}class W1{eq(Z){return this==Z}range(Z,$=Z){return e5.create(Z,$,this)}}W1.prototype.startSide=W1.prototype.endSide=0;W1.prototype.point=!1;W1.prototype.mapMode=E0.TrackDel;function d9(Z,$){return Z==$||Z.constructor==$.constructor&&Z.eq($)}class e5{constructor(Z,$,J){this.from=Z,this.to=$,this.value=J}static create(Z,$,J){return new e5(Z,$,J)}}function h9(Z,$){return Z.from-$.from||Z.value.startSide-$.value.startSide}class l9{constructor(Z,$,J,K){this.from=Z,this.to=$,this.value=J,this.maxPoint=K}get length(){return this.to[this.to.length-1]}findIndex(Z,$,J,K=0){let X=J?this.to:this.from;for(let Q=K,U=X.length;;){if(Q==U)return Q;let Y=Q+U>>1,q=X[Y]-Z||(J?this.value[Y].endSide:this.value[Y].startSide)-$;if(Y==Q)return q>=0?Q:U;if(q>=0)U=Y;else Q=Y+1}}between(Z,$,J,K){for(let X=this.findIndex($,-1e9,!0),Q=this.findIndex(J,1e9,!1,X);X<Q;X++)if(K(this.from[X]+Z,this.to[X]+Z,this.value[X])===!1)return!1}map(Z,$){let J=[],K=[],X=[],Q=-1,U=-1;for(let Y=0;Y<this.value.length;Y++){let q=this.value[Y],G=this.from[Y]+Z,W=this.to[Y]+Z,j,_;if(G==W){let z=$.mapPos(G,q.startSide,q.mapMode);if(z==null)continue;if(j=_=z,q.startSide!=q.endSide){if(_=$.mapPos(G,q.endSide),_<j)continue}}else if(j=$.mapPos(G,q.startSide),_=$.mapPos(W,q.endSide),j>_||j==_&&q.startSide>0&&q.endSide<=0)continue;if((_-j||q.endSide-q.startSide)<0)continue;if(Q<0)Q=j;if(q.point)U=Math.max(U,_-j);J.push(q),K.push(j-Q),X.push(_-Q)}return{mapped:J.length?new l9(K,X,J,U):null,pos:Q}}}class d{constructor(Z,$,J,K){this.chunkPos=Z,this.chunk=$,this.nextLayer=J,this.maxPoint=K}static create(Z,$,J,K){return new d(Z,$,J,K)}get length(){let Z=this.chunk.length-1;return Z<0?0:Math.max(this.chunkEnd(Z),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let Z=this.nextLayer.size;for(let $ of this.chunk)Z+=$.value.length;return Z}chunkEnd(Z){return this.chunkPos[Z]+this.chunk[Z].length}update(Z){let{add:$=[],sort:J=!1,filterFrom:K=0,filterTo:X=this.length}=Z,Q=Z.filter;if($.length==0&&!Q)return this;if(J)$=$.slice().sort(h9);if(this.isEmpty)return $.length?d.of($):this;let U=new c9(this,null,-1).goto(0),Y=0,q=[],G=new l0;while(U.value||Y<$.length)if(Y<$.length&&(U.from-$[Y].from||U.startSide-$[Y].value.startSide)>=0){let W=$[Y++];if(!G.addInner(W.from,W.to,W.value))q.push(W)}else if(U.rangeIndex==1&&U.chunkIndex<this.chunk.length&&(Y==$.length||this.chunkEnd(U.chunkIndex)<$[Y].from)&&(!Q||K>this.chunkEnd(U.chunkIndex)||X<this.chunkPos[U.chunkIndex])&&G.addChunk(this.chunkPos[U.chunkIndex],this.chunk[U.chunkIndex]))U.nextChunk();else{if(!Q||K>U.to||X<U.from||Q(U.from,U.to,U.value)){if(!G.addInner(U.from,U.to,U.value))q.push(e5.create(U.from,U.to,U.value))}U.next()}return G.finishInner(this.nextLayer.isEmpty&&!q.length?d.empty:this.nextLayer.update({add:q,filter:Q,filterFrom:K,filterTo:X}))}map(Z){if(Z.empty||this.isEmpty)return this;let $=[],J=[],K=-1;for(let Q=0;Q<this.chunk.length;Q++){let U=this.chunkPos[Q],Y=this.chunk[Q],q=Z.touchesRange(U,U+Y.length);if(q===!1)K=Math.max(K,Y.maxPoint),$.push(Y),J.push(Z.mapPos(U));else if(q===!0){let{mapped:G,pos:W}=Y.map(U,Z);if(G)K=Math.max(K,G.maxPoint),$.push(G),J.push(W)}}let X=this.nextLayer.map(Z);return $.length==0?X:new d(J,$,X||d.empty,K)}between(Z,$,J){if(this.isEmpty)return;for(let K=0;K<this.chunk.length;K++){let X=this.chunkPos[K],Q=this.chunk[K];if($>=X&&Z<=X+Q.length&&Q.between(X,Z-X,$-X,J)===!1)return}this.nextLayer.between(Z,$,J)}iter(Z=0){return Z7.from([this]).goto(Z)}get isEmpty(){return this.nextLayer==this}static iter(Z,$=0){return Z7.from(Z).goto($)}static compare(Z,$,J,K,X=-1){let Q=Z.filter((W)=>W.maxPoint>0||!W.isEmpty&&W.maxPoint>=X),U=$.filter((W)=>W.maxPoint>0||!W.isEmpty&&W.maxPoint>=X),Y=b6(Q,U,J),q=new V5(Q,Y,X),G=new V5(U,Y,X);if(J.iterGaps((W,j,_)=>x6(q,W,G,j,_,K)),J.empty&&J.length==0)x6(q,0,G,0,0,K)}static eq(Z,$,J=0,K){if(K==null)K=999999999;let X=Z.filter((G)=>!G.isEmpty&&$.indexOf(G)<0),Q=$.filter((G)=>!G.isEmpty&&Z.indexOf(G)<0);if(X.length!=Q.length)return!1;if(!X.length)return!0;let U=b6(X,Q),Y=new V5(X,U,0).goto(J),q=new V5(Q,U,0).goto(J);for(;;){if(Y.to!=q.to||!v9(Y.active,q.active)||Y.point&&(!q.point||!d9(Y.point,q.point)))return!1;if(Y.to>K)return!0;Y.next(),q.next()}}static spans(Z,$,J,K,X=-1){let Q=new V5(Z,null,X).goto($),U=$,Y=Q.openStart;for(;;){let q=Math.min(Q.to,J);if(Q.point){let G=Q.activeForPoint(Q.to),W=Q.pointFrom<$?G.length+1:Q.point.startSide<0?G.length:Math.min(G.length,Y);K.point(U,q,Q.point,G,W,Q.pointRank),Y=Math.min(Q.openEnd(q),G.length)}else if(q>U)K.span(U,q,Q.active,Y),Y=Q.openEnd(q);if(Q.to>J)return Y+(Q.point&&Q.to>J?1:0);U=Q.to,Q.next()}}static of(Z,$=!1){let J=new l0;for(let K of Z instanceof e5?[Z]:$?UQ(Z):Z)J.add(K.from,K.to,K.value);return J.finish()}static join(Z){if(!Z.length)return d.empty;let $=Z[Z.length-1];for(let J=Z.length-2;J>=0;J--)for(let K=Z[J];K!=d.empty;K=K.nextLayer)$=new d(K.chunkPos,K.chunk,$,Math.max(K.maxPoint,$.maxPoint));return $}}d.empty=new d([],[],null,-1);function UQ(Z){if(Z.length>1)for(let $=Z[0],J=1;J<Z.length;J++){let K=Z[J];if(h9($,K)>0)return Z.slice().sort(h9);$=K}return Z}d.empty.nextLayer=d.empty;class l0{finishChunk(Z){if(this.chunks.push(new l9(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,Z)this.from=[],this.to=[],this.value=[]}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(Z,$,J){if(!this.addInner(Z,$,J))(this.nextLayer||(this.nextLayer=new l0)).add(Z,$,J)}addInner(Z,$,J){let K=Z-this.lastTo||J.startSide-this.last.endSide;if(K<=0&&(Z-this.lastFrom||J.startSide-this.last.startSide)<0)throw Error("Ranges must be added sorted by `from` position and `startSide`");if(K<0)return!1;if(this.from.length==250)this.finishChunk(!0);if(this.chunkStart<0)this.chunkStart=Z;if(this.from.push(Z-this.chunkStart),this.to.push($-this.chunkStart),this.last=J,this.lastFrom=Z,this.lastTo=$,this.value.push(J),J.point)this.maxPoint=Math.max(this.maxPoint,$-Z);return!0}addChunk(Z,$){if((Z-this.lastTo||$.value[0].startSide-this.last.endSide)<0)return!1;if(this.from.length)this.finishChunk(!0);this.setMaxPoint=Math.max(this.setMaxPoint,$.maxPoint),this.chunks.push($),this.chunkPos.push(Z);let J=$.value.length-1;return this.last=$.value[J],this.lastFrom=$.from[J]+Z,this.lastTo=$.to[J]+Z,!0}finish(){return this.finishInner(d.empty)}finishInner(Z){if(this.from.length)this.finishChunk(!1);if(this.chunks.length==0)return Z;let $=d.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(Z):Z,this.setMaxPoint);return this.from=null,$}}function b6(Z,$,J){let K=new Map;for(let Q of Z)for(let U=0;U<Q.chunk.length;U++)if(Q.chunk[U].maxPoint<=0)K.set(Q.chunk[U],Q.chunkPos[U]);let X=new Set;for(let Q of $)for(let U=0;U<Q.chunk.length;U++){let Y=K.get(Q.chunk[U]);if(Y!=null&&(J?J.mapPos(Y):Y)==Q.chunkPos[U]&&!(J===null||J===void 0?void 0:J.touchesRange(Y,Y+Q.chunk[U].length)))X.add(Q.chunk[U])}return X}class c9{constructor(Z,$,J,K=0){this.layer=Z,this.skip=$,this.minPoint=J,this.rank=K}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(Z,$=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(Z,$,!1),this}gotoInner(Z,$,J){while(this.chunkIndex<this.layer.chunk.length){let K=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(K)||this.layer.chunkEnd(this.chunkIndex)<Z||K.maxPoint<this.minPoint))break;this.chunkIndex++,J=!1}if(this.chunkIndex<this.layer.chunk.length){let K=this.layer.chunk[this.chunkIndex].findIndex(Z-this.layer.chunkPos[this.chunkIndex],$,!0);if(!J||this.rangeIndex<K)this.setRangeIndex(K)}this.next()}forward(Z,$){if((this.to-Z||this.endSide-$)<0)this.gotoInner(Z,$,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let Z=this.layer.chunkPos[this.chunkIndex],$=this.layer.chunk[this.chunkIndex],J=Z+$.from[this.rangeIndex];if(this.from=J,this.to=Z+$.to[this.rangeIndex],this.value=$.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(Z){if(Z==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)while(this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]))this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=Z}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(Z){return this.from-Z.from||this.startSide-Z.startSide||this.rank-Z.rank||this.to-Z.to||this.endSide-Z.endSide}}class Z7{constructor(Z){this.heap=Z}static from(Z,$=null,J=-1){let K=[];for(let X=0;X<Z.length;X++)for(let Q=Z[X];!Q.isEmpty;Q=Q.nextLayer)if(Q.maxPoint>=J)K.push(new c9(Q,$,J,X));return K.length==1?K[0]:new Z7(K)}get startSide(){return this.value?this.value.startSide:0}goto(Z,$=-1e9){for(let J of this.heap)J.goto(Z,$);for(let J=this.heap.length>>1;J>=0;J--)C9(this.heap,J);return this.next(),this}forward(Z,$){for(let J of this.heap)J.forward(Z,$);for(let J=this.heap.length>>1;J>=0;J--)C9(this.heap,J);if((this.to-Z||this.value.endSide-$)<0)this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let Z=this.heap[0];if(this.from=Z.from,this.to=Z.to,this.value=Z.value,this.rank=Z.rank,Z.value)Z.next();C9(this.heap,0)}}}function C9(Z,$){for(let J=Z[$];;){let K=($<<1)+1;if(K>=Z.length)break;let X=Z[K];if(K+1<Z.length&&X.compare(Z[K+1])>=0)X=Z[K+1],K++;if(J.compare(X)<0)break;Z[K]=J,Z[$]=X,$=K}}class V5{constructor(Z,$,J){this.minPoint=J,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Z7.from(Z,$,J)}goto(Z,$=-1e9){return this.cursor.goto(Z,$),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=Z,this.endSide=$,this.openStart=-1,this.next(),this}forward(Z,$){while(this.minActive>-1&&(this.activeTo[this.minActive]-Z||this.active[this.minActive].endSide-$)<0)this.removeActive(this.minActive);this.cursor.forward(Z,$)}removeActive(Z){i7(this.active,Z),i7(this.activeTo,Z),i7(this.activeRank,Z),this.minActive=w6(this.active,this.activeTo)}addActive(Z){let $=0,{value:J,to:K,rank:X}=this.cursor;while($<this.activeRank.length&&(X-this.activeRank[$]||K-this.activeTo[$])>0)$++;if(a7(this.active,$,J),a7(this.activeTo,$,K),a7(this.activeRank,$,X),Z)a7(Z,$,this.cursor.from);this.minActive=w6(this.active,this.activeTo)}next(){let Z=this.to,$=this.point;this.point=null;let J=this.openStart<0?[]:null;for(;;){let K=this.minActive;if(K>-1&&(this.activeTo[K]-this.cursor.from||this.active[K].endSide-this.cursor.startSide)<0){if(this.activeTo[K]>Z){this.to=this.activeTo[K],this.endSide=this.active[K].endSide;break}if(this.removeActive(K),J)i7(J,K)}else if(!this.cursor.value){this.to=this.endSide=1e9;break}else if(this.cursor.from>Z){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let X=this.cursor.value;if(!X.point)this.addActive(J),this.cursor.next();else if($&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=X,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=X.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}}if(J){this.openStart=0;for(let K=J.length-1;K>=0&&J[K]<Z;K--)this.openStart++}}activeForPoint(Z){if(!this.active.length)return this.active;let $=[];for(let J=this.active.length-1;J>=0;J--){if(this.activeRank[J]<this.pointRank)break;if(this.activeTo[J]>Z||this.activeTo[J]==Z&&this.active[J].endSide>=this.point.endSide)$.push(this.active[J])}return $.reverse()}openEnd(Z){let $=0;for(let J=this.activeTo.length-1;J>=0&&this.activeTo[J]>Z;J--)$++;return $}}function x6(Z,$,J,K,X,Q){Z.goto($),J.goto(K);let U=K+X,Y=K,q=K-$,G=!!Q.boundChange;for(let W=!1;;){let j=Z.to+q-J.to,_=j||Z.endSide-J.endSide,z=_<0?Z.to+q:J.to,V=Math.min(z,U);if(Z.point||J.point){if(!(Z.point&&J.point&&d9(Z.point,J.point)&&v9(Z.activeForPoint(Z.to),J.activeForPoint(J.to))))Q.comparePoint(Y,V,Z.point,J.point);W=!1}else{if(W)Q.boundChange(Y);if(V>Y&&!v9(Z.active,J.active))Q.compareRange(Y,V,Z.active,J.active);if(G&&V<U&&(j||Z.openEnd(z)!=J.openEnd(z)))W=!0}if(z>U)break;if(Y=z,_<=0)Z.next();if(_>=0)J.next()}}function v9(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++)if(Z[J]!=$[J]&&!d9(Z[J],$[J]))return!1;return!0}function i7(Z,$){for(let J=$,K=Z.length-1;J<K;J++)Z[J]=Z[J+1];Z.pop()}function a7(Z,$,J){for(let K=Z.length-1;K>=$;K--)Z[K+1]=Z[K];Z[$]=J}function w6(Z,$){let J=-1,K=1e9;for(let X=0;X<$.length;X++)if(($[X]-K||Z[X].endSide-Z[J].endSide)<0)J=X,K=$[X];return J}function k1(Z,$,J=Z.length){let K=0;for(let X=0;X<J&&X<Z.length;)if(Z.charCodeAt(X)==9)K+=$-K%$,X++;else K++,X=H0(Z,X);return K}function $4(Z,$,J,K){for(let X=0,Q=0;;){if(Q>=$)return X;if(X==Z.length)break;Q+=Z.charCodeAt(X)==9?J-Q%J:1,X=H0(Z,X)}return K===!0?-1:Z.length}var a6=typeof Symbol>"u"?"__"+"ͼ":Symbol.for("ͼ"),s9=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),r6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class _1{constructor(Z,$){this.rules=[];let{finish:J}=$||{};function K(Q){return/^@/.test(Q)?[Q]:Q.split(/,\s*/)}function X(Q,U,Y,q){let G=[],W=/^@(\w+)\b/.exec(Q[0]),j=W&&W[1]=="keyframes";if(W&&U==null)return Y.push(Q[0]+";");for(let _ in U){let z=U[_];if(/&/.test(_))X(_.split(/,\s*/).map((V)=>Q.map((O)=>V.replace(/&/,O))).reduce((V,O)=>V.concat(O)),z,Y);else if(z&&typeof z=="object"){if(!W)throw RangeError("The value of a property ("+_+") should be a primitive value.");X(K(_),z,G,j)}else if(z!=null)G.push(_.replace(/_.*/,"").replace(/[A-Z]/g,(V)=>"-"+V.toLowerCase())+": "+z+";")}if(G.length||j)Y.push((J&&!W&&!q?Q.map(J):Q).join(", ")+" {"+G.join(" ")+"}")}for(let Q in Z)X(K(Q),Z[Q],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let Z=r6[a6]||1;return r6[a6]=Z+1,"ͼ"+Z.toString(36)}static mount(Z,$,J){let K=Z[s9],X=J&&J.nonce;if(!K)K=new t6(Z,X);else if(X)K.setNonce(X);K.mount(Array.isArray($)?$:[$],Z)}}var o6=new Map;class t6{constructor(Z,$){let J=Z.ownerDocument||Z,K=J.defaultView;if(!Z.head&&Z.adoptedStyleSheets&&K.CSSStyleSheet){let X=o6.get(J);if(X)return Z[s9]=X;this.sheet=new K.CSSStyleSheet,o6.set(J,this)}else if(this.styleTag=J.createElement("style"),$)this.styleTag.setAttribute("nonce",$);this.modules=[],Z[s9]=this}mount(Z,$){let J=this.sheet,K=0,X=0;for(let Q=0;Q<Z.length;Q++){let U=Z[Q],Y=this.modules.indexOf(U);if(Y<X&&Y>-1)this.modules.splice(Y,1),X--,Y=-1;if(Y==-1){if(this.modules.splice(X++,0,U),J)for(let q=0;q<U.rules.length;q++)J.insertRule(U.rules[q],K++)}else{while(X<Y)K+=this.modules[X++].rules.length;K+=U.rules.length,X++}}if(J){if($.adoptedStyleSheets.indexOf(this.sheet)<0)$.adoptedStyleSheets=[this.sheet,...$.adoptedStyleSheets]}else{let Q="";for(let Y=0;Y<this.modules.length;Y++)Q+=this.modules[Y].getRules()+`
`;this.styleTag.textContent=Q;let U=$.head||$;if(this.styleTag.parentNode!=U)U.insertBefore(this.styleTag,U.firstChild)}}setNonce(Z){if(this.styleTag&&this.styleTag.getAttribute("nonce")!=Z)this.styleTag.setAttribute("nonce",Z)}}var S1={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},F5={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},YQ=typeof navigator<"u"&&/Mac/.test(navigator.platform),qQ=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(_0=0;_0<10;_0++)S1[48+_0]=S1[96+_0]=String(_0);var _0;for(_0=1;_0<=24;_0++)S1[_0+111]="F"+_0;var _0;for(_0=65;_0<=90;_0++)S1[_0]=String.fromCharCode(_0+32),F5[_0]=String.fromCharCode(_0);var _0;for(J7 in S1)if(!F5.hasOwnProperty(J7))F5[J7]=S1[J7];var J7;function e6(Z){var $=YQ&&Z.metaKey&&Z.shiftKey&&!Z.ctrlKey&&!Z.altKey||qQ&&Z.shiftKey&&Z.key&&Z.key.length==1||Z.key=="Unidentified",J=!$&&Z.key||(Z.shiftKey?F5:S1)[Z.keyCode]||Z.key||"Unidentified";if(J=="Esc")J="Escape";if(J=="Del")J="Delete";if(J=="Left")J="ArrowLeft";if(J=="Up")J="ArrowUp";if(J=="Right")J="ArrowRight";if(J=="Down")J="ArrowDown";return J}function o(){var Z=arguments[0];if(typeof Z=="string")Z=document.createElement(Z);var $=1,J=arguments[1];if(J&&typeof J=="object"&&J.nodeType==null&&!Array.isArray(J)){for(var K in J)if(Object.prototype.hasOwnProperty.call(J,K)){var X=J[K];if(typeof X=="string")Z.setAttribute(K,X);else if(X!=null)Z[K]=X}$++}for(;$<arguments.length;$++)Z2(Z,arguments[$]);return Z}function Z2(Z,$){if(typeof $=="string")Z.appendChild(document.createTextNode($));else if($==null);else if($.nodeType!=null)Z.appendChild($);else if(Array.isArray($))for(var J=0;J<$.length;J++)Z2(Z,$[J]);else throw RangeError("Unsupported child node: "+$)}var w0=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},J8=typeof document<"u"?document:{documentElement:{style:{}}},K8=/Edge\/(\d+)/.exec(w0.userAgent),f2=/MSIE \d/.test(w0.userAgent),X8=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(w0.userAgent),T4=!!(f2||X8||K8),$2=!T4&&/gecko\/(\d+)/i.test(w0.userAgent),n9=!T4&&/Chrome\/(\d+)/.exec(w0.userAgent),J2="webkitFontSmoothing"in J8.documentElement.style,Q8=!T4&&/Apple Computer/.test(w0.vendor),K2=Q8&&(/Mobile\/\w+/.test(w0.userAgent)||w0.maxTouchPoints>2),y={mac:K2||/Mac/.test(w0.platform),windows:/Win/.test(w0.platform),linux:/Linux|X11/.test(w0.platform),ie:T4,ie_version:f2?J8.documentMode||6:X8?+X8[1]:K8?+K8[1]:0,gecko:$2,gecko_version:$2?+(/Firefox\/(\d+)/.exec(w0.userAgent)||[0,0])[1]:0,chrome:!!n9,chrome_version:n9?+n9[1]:0,ios:K2,android:/Android\b/.test(w0.userAgent),webkit:J2,webkit_version:J2?+(/\bAppleWebKit\/(\d+)/.exec(w0.userAgent)||[0,0])[1]:0,safari:Q8,safari_version:Q8?+(/\bVersion\/(\d+(\.\d+)?)/.exec(w0.userAgent)||[0,0])[1]:0,tabSize:J8.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function P8(Z,$){for(let J in Z)if(J=="class"&&$.class)$.class+=" "+Z.class;else if(J=="style"&&$.style)$.style+=";"+Z.style;else $[J]=Z[J];return $}var F4=Object.create(null);function C8(Z,$,J){if(Z==$)return!0;if(!Z)Z=F4;if(!$)$=F4;let K=Object.keys(Z),X=Object.keys($);if(K.length-(J&&K.indexOf(J)>-1?1:0)!=X.length-(J&&X.indexOf(J)>-1?1:0))return!1;for(let Q of K)if(Q!=J&&(X.indexOf(Q)==-1||Z[Q]!==$[Q]))return!1;return!0}function GQ(Z,$){for(let J=Z.attributes.length-1;J>=0;J--){let K=Z.attributes[J].name;if($[K]==null)Z.removeAttribute(K)}for(let J in $){let K=$[J];if(J=="style")Z.style.cssText=K;else if(Z.getAttribute(J)!=K)Z.setAttribute(J,K)}}function X2(Z,$,J){let K=!1;if($){for(let X in $)if(!(J&&(X in J)))if(K=!0,X=="style")Z.style.cssText="";else Z.removeAttribute(X)}if(J){for(let X in J)if(!($&&$[X]==J[X]))if(K=!0,X=="style")Z.style.cssText=J[X];else Z.setAttribute(X,J[X])}return K}function WQ(Z){let $=Object.create(null);for(let J=0;J<Z.attributes.length;J++){let K=Z.attributes[J];$[K.name]=K.value}return $}class i0{eq(Z){return!1}updateDOM(Z,$){return!1}compare(Z){return this==Z||this.constructor==Z.constructor&&this.eq(Z)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(Z){return!0}coordsAt(Z,$,J){return null}get isHidden(){return!1}get editable(){return!1}destroy(Z){}}var y0=function(Z){return Z[Z.Text=0]="Text",Z[Z.WidgetBefore=1]="WidgetBefore",Z[Z.WidgetAfter=2]="WidgetAfter",Z[Z.WidgetRange=3]="WidgetRange",Z}(y0||(y0={}));class x extends W1{constructor(Z,$,J,K){super();this.startSide=Z,this.endSide=$,this.widget=J,this.spec=K}get heightRelevant(){return!1}static mark(Z){return new N7(Z)}static widget(Z){let $=Math.max(-1e4,Math.min(1e4,Z.side||0)),J=!!Z.block;return $+=J&&!Z.inlineOrder?$>0?300000000:-400000000:$>0?1e8:-1e8,new J5(Z,$,$,J,Z.widget||null,!1)}static replace(Z){let $=!!Z.block,J,K;if(Z.isBlockGap)J=-500000000,K=400000000;else{let{start:X,end:Q}=g2(Z,$);J=(X?$?-300000000:-1:500000000)-1,K=(Q?$?200000000:1:-600000000)+1}return new J5(Z,J,K,$,Z.widget||null,!0)}static line(Z){return new I7(Z)}static set(Z,$=!1){return d.of(Z,$)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}x.none=d.empty;class N7 extends x{constructor(Z){let{start:$,end:J}=g2(Z);super($?-1:500000000,J?1:-600000000,null,Z);this.tagName=Z.tagName||"span",this.attrs=Z.class&&Z.attributes?P8(Z.attributes,{class:Z.class}):Z.class?{class:Z.class}:Z.attributes||F4}eq(Z){return this==Z||Z instanceof N7&&this.tagName==Z.tagName&&C8(this.attrs,Z.attrs)}range(Z,$=Z){if(Z>=$)throw RangeError("Mark decorations may not be empty");return super.range(Z,$)}}N7.prototype.point=!1;class I7 extends x{constructor(Z){super(-200000000,-200000000,null,Z)}eq(Z){return Z instanceof I7&&this.spec.class==Z.spec.class&&C8(this.spec.attributes,Z.spec.attributes)}range(Z,$=Z){if($!=Z)throw RangeError("Line decoration ranges must be zero-length");return super.range(Z,$)}}I7.prototype.mapMode=E0.TrackBefore;I7.prototype.point=!0;class J5 extends x{constructor(Z,$,J,K,X,Q){super($,J,X,Z);this.block=K,this.isReplace=Q,this.mapMode=!K?E0.TrackDel:$<=0?E0.TrackBefore:E0.TrackAfter}get type(){return this.startSide!=this.endSide?y0.WidgetRange:this.startSide<=0?y0.WidgetBefore:y0.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(Z){return Z instanceof J5&&jQ(this.widget,Z.widget)&&this.block==Z.block&&this.startSide==Z.startSide&&this.endSide==Z.endSide}range(Z,$=Z){if(this.isReplace&&(Z>$||Z==$&&this.startSide>0&&this.endSide<=0))throw RangeError("Invalid range for replacement decoration");if(!this.isReplace&&$!=Z)throw RangeError("Widget decorations can only have zero-length ranges");return super.range(Z,$)}}J5.prototype.point=!0;function g2(Z,$=!1){let{inclusiveStart:J,inclusiveEnd:K}=Z;if(J==null)J=Z.inclusive;if(K==null)K=Z.inclusive;return{start:J!==null&&J!==void 0?J:$,end:K!==null&&K!==void 0?K:$}}function jQ(Z,$){return Z==$||!!(Z&&$&&Z.compare($))}function L5(Z,$,J,K=0){let X=J.length-1;if(X>=0&&J[X]+K>=Z)J[X]=Math.max(J[X],$);else J.push(Z,$)}class z7 extends W1{constructor(Z,$){super();this.tagName=Z,this.attributes=$}eq(Z){return Z==this||Z instanceof z7&&this.tagName==Z.tagName&&C8(this.attributes,Z.attributes)}static create(Z){return new z7(Z.tagName,Z.attributes||F4)}static set(Z,$=!1){return d.of(Z,$)}}z7.prototype.startSide=z7.prototype.endSide=-1;function E5(Z){let $;if(Z.nodeType==11)$=Z.getSelection?Z:Z.ownerDocument;else $=Z;return $.getSelection()}function U8(Z,$){return $?Z==$||Z.contains($.nodeType!=1?$.parentNode:$):!1}function G7(Z,$){if(!$.anchorNode)return!1;try{return U8(Z,$.anchorNode)}catch(J){return!1}}function j4(Z){if(Z.nodeType==3)return O7(Z,0,Z.nodeValue.length).getClientRects();else if(Z.nodeType==1)return Z.getClientRects();else return[]}function W7(Z,$,J,K){return J?Q2(Z,$,J,K,-1)||Q2(Z,$,J,K,1):!1}function f1(Z){for(var $=0;;$++)if(Z=Z.previousSibling,!Z)return $}function D4(Z){return Z.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(Z.nodeName)}function Q2(Z,$,J,K,X){for(;;){if(Z==J&&$==K)return!0;if($==(X<0?0:x1(Z))){if(Z.nodeName=="DIV")return!1;let Q=Z.parentNode;if(!Q||Q.nodeType!=1)return!1;$=f1(Z)+(X<0?0:1),Z=Q}else if(Z.nodeType==1){if(Z=Z.childNodes[$+(X<0?-1:0)],Z.nodeType==1&&Z.contentEditable=="false")return!1;$=X<0?x1(Z):0}else return!1}}function x1(Z){return Z.nodeType==3?Z.nodeValue.length:Z.childNodes.length}function A4(Z,$){let J=$?Z.left:Z.right;return{left:J,right:J,top:Z.top,bottom:Z.bottom}}function _Q(Z){let $=Z.visualViewport;if($)return{left:0,right:$.width,top:0,bottom:$.height};return{left:0,right:Z.innerWidth,top:0,bottom:Z.innerHeight}}function p2(Z,$){let J=$.width/Z.offsetWidth,K=$.height/Z.offsetHeight;if(J>0.995&&J<1.005||!isFinite(J)||Math.abs($.width-Z.offsetWidth)<1)J=1;if(K>0.995&&K<1.005||!isFinite(K)||Math.abs($.height-Z.offsetHeight)<1)K=1;return{scaleX:J,scaleY:K}}function zQ(Z,$,J,K,X,Q,U,Y){let q=Z.ownerDocument,G=q.defaultView||window;for(let W=Z,j=!1;W&&!j;)if(W.nodeType==1){let _,z=W==q.body,V=1,O=1;if(z)_=_Q(G);else{if(/^(fixed|sticky)$/.test(getComputedStyle(W).position))j=!0;if(W.scrollHeight<=W.clientHeight&&W.scrollWidth<=W.clientWidth){W=W.assignedSlot||W.parentNode;continue}let A=W.getBoundingClientRect();({scaleX:V,scaleY:O}=p2(W,A)),_={left:A.left,right:A.left+W.clientWidth*V,top:A.top,bottom:A.top+W.clientHeight*O}}let N=0,R=0;if(X=="nearest"){if($.top<_.top){if(R=$.top-(_.top+U),J>0&&$.bottom>_.bottom+R)R=$.bottom-_.bottom+U}else if($.bottom>_.bottom){if(R=$.bottom-_.bottom+U,J<0&&$.top-R<_.top)R=$.top-(_.top+U)}}else{let A=$.bottom-$.top,L=_.bottom-_.top;R=(X=="center"&&A<=L?$.top+A/2-L/2:X=="start"||X=="center"&&J<0?$.top-U:$.bottom-L+U)-_.top}if(K=="nearest"){if($.left<_.left){if(N=$.left-(_.left+Q),J>0&&$.right>_.right+N)N=$.right-_.right+Q}else if($.right>_.right){if(N=$.right-_.right+Q,J<0&&$.left<_.left+N)N=$.left-(_.left+Q)}}else N=(K=="center"?$.left+($.right-$.left)/2-(_.right-_.left)/2:K=="start"==Y?$.left-Q:$.right-(_.right-_.left)+Q)-_.left;if(N||R)if(z)G.scrollBy(N,R);else{let A=0,L=0;if(R){let E=W.scrollTop;W.scrollTop+=R/O,L=(W.scrollTop-E)*O}if(N){let E=W.scrollLeft;W.scrollLeft+=N/V,A=(W.scrollLeft-E)*V}if($={left:$.left-A,top:$.top-L,right:$.right-A,bottom:$.bottom-L},A&&Math.abs(A-N)<1)K="nearest";if(L&&Math.abs(L-R)<1)X="nearest"}if(z)break;if($.top<_.top||$.bottom>_.bottom||$.left<_.left||$.right>_.right)$={left:Math.max($.left,_.left),right:Math.min($.right,_.right),top:Math.max($.top,_.top),bottom:Math.min($.bottom,_.bottom)};W=W.assignedSlot||W.parentNode}else if(W.nodeType==11)W=W.host;else break}function OQ(Z){let $=Z.ownerDocument,J,K;for(let X=Z.parentNode;X;)if(X==$.body||J&&K)break;else if(X.nodeType==1){if(!K&&X.scrollHeight>X.clientHeight)K=X;if(!J&&X.scrollWidth>X.clientWidth)J=X;X=X.assignedSlot||X.parentNode}else if(X.nodeType==11)X=X.host;else break;return{x:J,y:K}}class d2{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(Z){return this.anchorNode==Z.anchorNode&&this.anchorOffset==Z.anchorOffset&&this.focusNode==Z.focusNode&&this.focusOffset==Z.focusOffset}setRange(Z){let{anchorNode:$,focusNode:J}=Z;this.set($,Math.min(Z.anchorOffset,$?x1($):0),J,Math.min(Z.focusOffset,J?x1(J):0))}set(Z,$,J,K){this.anchorNode=Z,this.anchorOffset=$,this.focusNode=J,this.focusOffset=K}}var Z5=null;if(y.safari&&y.safari_version>=26)Z5=!1;function l2(Z){if(Z.setActive)return Z.setActive();if(Z5)return Z.focus(Z5);let $=[];for(let J=Z;J;J=J.parentNode)if($.push(J,J.scrollTop,J.scrollLeft),J==J.ownerDocument)break;if(Z.focus(Z5==null?{get preventScroll(){return Z5={preventScroll:!0},!0}}:void 0),!Z5){Z5=!1;for(let J=0;J<$.length;){let K=$[J++],X=$[J++],Q=$[J++];if(K.scrollTop!=X)K.scrollTop=X;if(K.scrollLeft!=Q)K.scrollLeft=Q}}}var U2;function O7(Z,$,J=$){let K=U2||(U2=document.createRange());return K.setEnd(Z,J),K.setStart(Z,$),K}function M5(Z,$,J,K){let X={key:$,code:$,keyCode:J,which:J,cancelable:!0};if(K)({altKey:X.altKey,ctrlKey:X.ctrlKey,shiftKey:X.shiftKey,metaKey:X.metaKey}=K);let Q=new KeyboardEvent("keydown",X);Q.synthetic=!0,Z.dispatchEvent(Q);let U=new KeyboardEvent("keyup",X);return U.synthetic=!0,Z.dispatchEvent(U),Q.defaultPrevented||U.defaultPrevented}function VQ(Z){while(Z){if(Z&&(Z.nodeType==9||Z.nodeType==11&&Z.host))return Z;Z=Z.assignedSlot||Z.parentNode}return null}function HQ(Z,$){let{focusNode:J,focusOffset:K}=$;if(!J||$.anchorNode!=J||$.anchorOffset!=K)return!1;K=Math.min(K,x1(J));for(;;)if(K){if(J.nodeType!=1)return!1;let X=J.childNodes[K-1];if(X.contentEditable=="false")K--;else J=X,K=x1(J)}else if(J==Z)return!0;else K=f1(J),J=J.parentNode}function c2(Z){return Z.scrollTop>Math.max(1,Z.scrollHeight-Z.clientHeight-4)}function s2(Z,$){for(let J=Z,K=$;;)if(J.nodeType==3&&K>0)return{node:J,offset:K};else if(J.nodeType==1&&K>0){if(J.contentEditable=="false")return null;J=J.childNodes[K-1],K=x1(J)}else if(J.parentNode&&!D4(J))K=f1(J),J=J.parentNode;else return null}function n2(Z,$){for(let J=Z,K=$;;)if(J.nodeType==3&&K<J.nodeValue.length)return{node:J,offset:K};else if(J.nodeType==1&&K<J.childNodes.length){if(J.contentEditable=="false")return null;J=J.childNodes[K],K=0}else if(J.parentNode&&!D4(J))K=f1(J)+1,J=J.parentNode;else return null}class V1{constructor(Z,$,J=!0){this.node=Z,this.offset=$,this.precise=J}static before(Z,$){return new V1(Z.parentNode,f1(Z),$)}static after(Z,$){return new V1(Z.parentNode,f1(Z)+1,$)}}var J0=function(Z){return Z[Z.LTR=0]="LTR",Z[Z.RTL=1]="RTL",Z}(J0||(J0={})),K5=J0.LTR,T8=J0.RTL;function i2(Z){let $=[];for(let J=0;J<Z.length;J++)$.push(1<<+Z[J]);return $}var NQ=i2("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),IQ=i2("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Y8=Object.create(null),M1=[];for(let Z of["()","[]","{}"]){let $=Z.charCodeAt(0),J=Z.charCodeAt(1);Y8[$]=J,Y8[J]=-$}function a2(Z){return Z<=247?NQ[Z]:1424<=Z&&Z<=1524?2:1536<=Z&&Z<=1785?IQ[Z-1536]:1774<=Z&&Z<=2220?4:8192<=Z&&Z<=8204?256:64336<=Z&&Z<=65023?4:1}var RQ=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class B1{get dir(){return this.level%2?T8:K5}constructor(Z,$,J){this.from=Z,this.to=$,this.level=J}side(Z,$){return this.dir==$==Z?this.to:this.from}forward(Z,$){return Z==(this.dir==$)}static find(Z,$,J,K){let X=-1;for(let Q=0;Q<Z.length;Q++){let U=Z[Q];if(U.from<=$&&U.to>=$){if(U.level==J)return Q;if(X<0||(K!=0?K<0?U.from<$:U.to>$:Z[X].level>U.level))X=Q}}if(X<0)throw RangeError("Index out of range");return X}}function r2(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++){let K=Z[J],X=$[J];if(K.from!=X.from||K.to!=X.to||K.direction!=X.direction||!r2(K.inner,X.inner))return!1}return!0}var Q0=[];function FQ(Z,$,J,K,X){for(let Q=0;Q<=K.length;Q++){let U=Q?K[Q-1].to:$,Y=Q<K.length?K[Q].from:J,q=Q?256:X;for(let G=U,W=q,j=q;G<Y;G++){let _=a2(Z.charCodeAt(G));if(_==512)_=W;else if(_==8&&j==4)_=16;if(Q0[G]=_==4?2:_,_&7)j=_;W=_}for(let G=U,W=q,j=q;G<Y;G++){let _=Q0[G];if(_==128)if(G<Y-1&&W==Q0[G+1]&&W&24)_=Q0[G]=W;else Q0[G]=256;else if(_==64){let z=G+1;while(z<Y&&Q0[z]==64)z++;let V=G&&W==8||z<J&&Q0[z]==8?j==1?1:8:256;for(let O=G;O<z;O++)Q0[O]=V;G=z-1}else if(_==8&&j==1)Q0[G]=1;if(W=_,_&7)j=_}}}function DQ(Z,$,J,K,X){let Q=X==1?2:1;for(let U=0,Y=0,q=0;U<=K.length;U++){let G=U?K[U-1].to:$,W=U<K.length?K[U].from:J;for(let j=G,_,z,V;j<W;j++)if(z=Y8[_=Z.charCodeAt(j)])if(z<0){for(let O=Y-3;O>=0;O-=3)if(M1[O+1]==-z){let N=M1[O+2],R=N&2?X:!(N&4)?0:N&1?Q:X;if(R)Q0[j]=Q0[M1[O]]=R;Y=O;break}}else if(M1.length==189)break;else M1[Y++]=j,M1[Y++]=_,M1[Y++]=q;else if((V=Q0[j])==2||V==1){let O=V==X;q=O?0:1;for(let N=Y-3;N>=0;N-=3){let R=M1[N+2];if(R&2)break;if(O)M1[N+2]|=2;else{if(R&4)break;M1[N+2]|=4}}}}}function AQ(Z,$,J,K){for(let X=0,Q=K;X<=J.length;X++){let U=X?J[X-1].to:Z,Y=X<J.length?J[X].from:$;for(let q=U;q<Y;){let G=Q0[q];if(G==256){let W=q+1;for(;;)if(W==Y){if(X==J.length)break;W=J[X++].to,Y=X<J.length?J[X].from:$}else if(Q0[W]==256)W++;else break;let j=Q==1,_=(W<$?Q0[W]:K)==1,z=j==_?j?1:2:K;for(let V=W,O=X,N=O?J[O-1].to:Z;V>q;){if(V==N)V=J[--O].from,N=O?J[O-1].to:Z;Q0[--V]=z}q=W}else Q=G,q++}}}function q8(Z,$,J,K,X,Q,U){let Y=K%2?2:1;if(K%2==X%2)for(let q=$,G=0;q<J;){let W=!0,j=!1;if(G==Q.length||q<Q[G].from){let O=Q0[q];if(O!=Y)W=!1,j=O==16}let _=!W&&Y==1?[]:null,z=W?K:K+1,V=q;Z:for(;;)if(G<Q.length&&V==Q[G].from){if(j)break Z;let O=Q[G];if(!W)for(let N=O.to,R=G+1;;){if(N==J)break Z;if(R<Q.length&&Q[R].from==N)N=Q[R++].to;else if(Q0[N]==Y)break Z;else break}if(G++,_)_.push(O);else{if(O.from>q)U.push(new B1(q,O.from,z));let N=O.direction==K5!=!(z%2);G8(Z,N?K+1:K,X,O.inner,O.from,O.to,U),q=O.to}V=O.to}else if(V==J||(W?Q0[V]!=Y:Q0[V]==Y))break;else V++;if(_)q8(Z,q,V,K+1,X,_,U);else if(q<V)U.push(new B1(q,V,z));q=V}else for(let q=J,G=Q.length;q>$;){let W=!0,j=!1;if(!G||q>Q[G-1].to){let O=Q0[q-1];if(O!=Y)W=!1,j=O==16}let _=!W&&Y==1?[]:null,z=W?K:K+1,V=q;Z:for(;;)if(G&&V==Q[G-1].to){if(j)break Z;let O=Q[--G];if(!W)for(let N=O.from,R=G;;){if(N==$)break Z;if(R&&Q[R-1].to==N)N=Q[--R].from;else if(Q0[N-1]==Y)break Z;else break}if(_)_.push(O);else{if(O.to<q)U.push(new B1(O.to,q,z));let N=O.direction==K5!=!(z%2);G8(Z,N?K+1:K,X,O.inner,O.from,O.to,U),q=O.from}V=O.from}else if(V==$||(W?Q0[V-1]!=Y:Q0[V-1]==Y))break;else V--;if(_)q8(Z,V,q,K+1,X,_,U);else if(V<q)U.push(new B1(V,q,z));q=V}}function G8(Z,$,J,K,X,Q,U){let Y=$%2?2:1;FQ(Z,X,Q,K,Y),DQ(Z,X,Q,K,Y),AQ(X,Q,K,Y),q8(Z,X,Q,$,J,K,U)}function LQ(Z,$,J){if(!Z)return[new B1(0,0,$==T8?1:0)];if($==K5&&!J.length&&!RQ.test(Z))return o2(Z.length);if(J.length)while(Z.length>Q0.length)Q0[Q0.length]=256;let K=[],X=$==K5?0:1;return G8(Z,X,X,J,0,Z.length,K),K}function o2(Z){return[new B1(0,Z,0)]}var t2="";function MQ(Z,$,J,K,X){var Q;let U=K.head-Z.from,Y=B1.find($,U,(Q=K.bidiLevel)!==null&&Q!==void 0?Q:-1,K.assoc),q=$[Y],G=q.side(X,J);if(U==G){let _=Y+=X?1:-1;if(_<0||_>=$.length)return null;q=$[Y=_],U=q.side(!X,J),G=q.side(X,J)}let W=H0(Z.text,U,q.forward(X,J));if(W<q.from||W>q.to)W=G;t2=Z.text.slice(Math.min(U,W),Math.max(U,W));let j=Y==(X?$.length-1:0)?null:$[Y+(X?1:-1)];if(j&&W==G&&j.level+(X?0:1)<q.level)return D.cursor(j.side(!X,J)+Z.from,j.forward(X,J)?1:-1,j.level);return D.cursor(W+Z.from,q.forward(X,J)?-1:1,q.level)}function BQ(Z,$,J){for(let K=$;K<J;K++){let X=a2(Z.charCodeAt(K));if(X==1)return K5;if(X==2||X==4)return T8}return K5}var e2=C.define(),Z$=C.define(),$$=C.define(),J$=C.define(),W8=C.define(),K$=C.define(),X$=C.define(),y8=C.define(),k8=C.define(),Q$=C.define({combine:(Z)=>Z.some(($)=>$)}),U$=C.define({combine:(Z)=>Z.some(($)=>$)}),Y$=C.define();class B5{constructor(Z,$="nearest",J="nearest",K=5,X=5,Q=!1){this.range=Z,this.y=$,this.x=J,this.yMargin=K,this.xMargin=X,this.isSnapshot=Q}map(Z){return Z.empty?this:new B5(this.range.map(Z),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(Z){return this.range.to<=Z.doc.length?this:new B5(D.cursor(Z.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}var J4=v.define({map:(Z,$)=>Z.map($)}),q$=v.define();function T0(Z,$,J){let K=Z.facet(J$);if(K.length)K[0]($);else if(window.onerror&&window.onerror(String($),J,void 0,void 0,$));else if(J)console.error(J+":",$);else console.error($)}var b1=C.define({combine:(Z)=>Z.length?Z[0]:!0}),EQ=0,D5=C.define({combine(Z){return Z.filter(($,J)=>{for(let K=0;K<J;K++)if(Z[K].plugin==$.plugin)return!1;return!0})}});class W0{constructor(Z,$,J,K,X){this.id=Z,this.create=$,this.domEventHandlers=J,this.domEventObservers=K,this.baseExtensions=X(this),this.extension=this.baseExtensions.concat(D5.of({plugin:this,arg:void 0}))}of(Z){return this.baseExtensions.concat(D5.of({plugin:this,arg:Z}))}static define(Z,$){let{eventHandlers:J,eventObservers:K,provide:X,decorations:Q}=$||{};return new W0(EQ++,Z,J,K,(U)=>{let Y=[];if(Q)Y.push(y4.of((q)=>{let G=q.plugin(U);return G?Q(G):x.none}));if(X)Y.push(X(U));return Y})}static fromClass(Z,$){return W0.define((J,K)=>new Z(J,K),$)}}class _4{constructor(Z){this.spec=Z,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(Z){if(!this.value){if(this.spec)try{this.value=this.spec.plugin.create(Z,this.spec.arg)}catch($){T0(Z.state,$,"CodeMirror plugin crashed"),this.deactivate()}}else if(this.mustUpdate){let $=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update($)}catch(J){if(T0($.state,J,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(K){}this.deactivate()}}return this}destroy(Z){var $;if(($=this.value)===null||$===void 0?void 0:$.destroy)try{this.value.destroy()}catch(J){T0(Z.state,J,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}var G$=C.define(),S8=C.define(),y4=C.define(),W$=C.define(),b8=C.define(),R7=C.define(),j$=C.define();function Y2(Z,$){let J=Z.state.facet(j$);if(!J.length)return J;let K=J.map((Q)=>Q instanceof Function?Q(Z):Q),X=[];return d.spans(K,$.from,$.to,{point(){},span(Q,U,Y,q){let G=Q-$.from,W=U-$.from,j=X;for(let _=Y.length-1;_>=0;_--,q--){let z=Y[_].spec.bidiIsolate,V;if(z==null)z=BQ($.text,G,W);if(q>0&&j.length&&(V=j[j.length-1]).to==G&&V.direction==z)V.to=W,j=V.inner;else{let O={from:G,to:W,direction:z,inner:[]};j.push(O),j=O.inner}}}}),X}var _$=C.define();function x8(Z){let $=0,J=0,K=0,X=0;for(let Q of Z.state.facet(_$)){let U=Q(Z);if(U){if(U.left!=null)$=Math.max($,U.left);if(U.right!=null)J=Math.max(J,U.right);if(U.top!=null)K=Math.max(K,U.top);if(U.bottom!=null)X=Math.max(X,U.bottom)}}return{left:$,right:J,top:K,bottom:X}}var K7=C.define();class t0{constructor(Z,$,J,K){this.fromA=Z,this.toA=$,this.fromB=J,this.toB=K}join(Z){return new t0(Math.min(this.fromA,Z.fromA),Math.max(this.toA,Z.toA),Math.min(this.fromB,Z.fromB),Math.max(this.toB,Z.toB))}addToSet(Z){let $=Z.length,J=this;for(;$>0;$--){let K=Z[$-1];if(K.fromA>J.toA)continue;if(K.toA<J.fromA)break;J=J.join(K),Z.splice($-1,1)}return Z.splice($,0,J),Z}static extendWithRanges(Z,$){if($.length==0)return Z;let J=[];for(let K=0,X=0,Q=0;;){let U=K<Z.length?Z[K].fromB:1e9,Y=X<$.length?$[X]:1e9,q=Math.min(U,Y);if(q==1e9)break;let G=q+Q,W=q,j=G;for(;;)if(X<$.length&&$[X]<=W){let _=$[X+1];X+=2,W=Math.max(W,_);for(let z=K;z<Z.length&&Z[z].fromB<=W;z++)Q=Z[z].toA-Z[z].toB;j=Math.max(j,_+Q)}else if(K<Z.length&&Z[K].fromB<=W){let _=Z[K++];W=Math.max(W,_.toB),j=Math.max(j,_.toA),Q=_.toA-_.toB}else break;J.push(new t0(G,j,q,W))}return J}}class L4{constructor(Z,$,J){this.view=Z,this.state=$,this.transactions=J,this.flags=0,this.startState=Z.state,this.changes=R0.empty(this.startState.doc.length);for(let X of J)this.changes=this.changes.compose(X.changes);let K=[];this.changes.iterChangedRanges((X,Q,U,Y)=>K.push(new t0(X,Q,U,Y))),this.changedRanges=K}static create(Z,$,J){return new L4(Z,$,J)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((Z)=>Z.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var PQ=[];class F0{constructor(Z,$,J=0){this.dom=Z,this.length=$,this.flags=J,this.parent=null,Z.cmTile=this}get breakAfter(){return this.flags&1}get children(){return PQ}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(Z){if(this.flags|=2,this.flags&4){this.flags&=-5;let $=this.domAttrs;if($)GQ(this.dom,$)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(Z){this.dom=Z,Z.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(Z,$=this.posAtStart){let J=$;for(let K of this.children){if(K==Z)return J;J+=K.length+K.breakAfter}throw RangeError("Invalid child in posBefore")}posAfter(Z){return this.posBefore(Z)+Z.length}covers(Z){return!0}coordsIn(Z,$){return null}domPosFor(Z,$){let J=f1(this.dom),K=this.length?Z>0:$>0;return new V1(this.parent.dom,J+(K?1:0),Z==0||Z==this.length)}markDirty(Z){if(this.flags&=-3,Z)this.flags|=4;if(this.parent&&this.parent.flags&2)this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let Z=this;Z;Z=Z.parent)if(Z instanceof D7)return Z;return null}static get(Z){return Z.cmTile}}class F7 extends F0{constructor(Z){super(Z,0);this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(Z){this.children.push(Z),Z.parent=this}sync(Z){if(this.flags&2)return;super.sync(Z);let $=this.dom,J=null,K,X=(Z===null||Z===void 0?void 0:Z.node)==$?Z:null,Q=0;for(let U of this.children){if(U.sync(Z),Q+=U.length+U.breakAfter,K=J?J.nextSibling:$.firstChild,X&&K!=U.dom)X.written=!0;if(U.dom.parentNode==$)while(K&&K!=U.dom)K=q2(K);else $.insertBefore(U.dom,K);J=U.dom}if(K=J?J.nextSibling:$.firstChild,X&&K)X.written=!0;while(K)K=q2(K);this.length=Q}}function q2(Z){let $=Z.nextSibling;return Z.parentNode.removeChild(Z),$}class D7 extends F7{constructor(Z,$){super($);this.view=Z}owns(Z){for(;Z;Z=Z.parent)if(Z==this)return!0;return!1}isBlock(){return!0}nearest(Z){for(;;){if(!Z)return null;let $=F0.get(Z);if($&&this.owns($))return $;Z=Z.parentNode}}blockTiles(Z){for(let $=[],J=this,K=0,X=0;;)if(K==J.children.length){if(!$.length)return;if(J=J.parent,J.breakAfter)X++;K=$.pop()}else{let Q=J.children[K++];if(Q instanceof u1)$.push(K),J=Q,K=0;else{let U=X+Q.length,Y=Z(Q,X);if(Y!==void 0)return Y;X=U+Q.breakAfter}}}resolveBlock(Z,$){let J,K=-1,X,Q=-1;if(this.blockTiles((U,Y)=>{let q=Y+U.length;if(Z>=Y&&Z<=q){if(U.isWidget()&&$>=-1&&$<=1){if(U.flags&32)return!0;if(U.flags&16)J=void 0}if((Y<Z||Z==q&&($<-1?U.length:U.covers(1)))&&(!J||!U.isWidget()&&J.isWidget()))J=U,K=Z-Y;if((q>Z||Z==Y&&($>1?U.length:U.covers(-1)))&&(!X||!U.isWidget()&&X.isWidget()))X=U,Q=Z-Y}}),!J&&!X)throw Error("No tile at position "+Z);return J&&$<0||!X?{tile:J,offset:K}:{tile:X,offset:Q}}}class u1 extends F7{constructor(Z,$){super(Z);this.wrapper=$}isBlock(){return!0}covers(Z){if(!this.children.length)return!1;return Z<0?this.children[0].covers(-1):this.lastChild.covers(1)}get domAttrs(){return this.wrapper.attributes}static of(Z,$){let J=new u1($||document.createElement(Z.tagName),Z);if(!$)J.flags|=4;return J}}class P5 extends F7{constructor(Z,$){super(Z);this.attrs=$}isLine(){return!0}static start(Z,$,J){let K=new P5($||document.createElement("div"),Z);if(!$||!J)K.flags|=4;return K}get domAttrs(){return this.attrs}resolveInline(Z,$,J){let K=null,X=-1,Q=null,U=-1;function Y(G,W){for(let j=0,_=0;j<G.children.length&&_<=W;j++){let z=G.children[j],V=_+z.length;if(V>=W){if(z.isComposite())Y(z,W-_);else if((!Q||Q.isHidden&&($>0||J&&TQ(Q,z)))&&(V>W||z.flags&32))Q=z,U=W-_;else if(_<W||z.flags&16&&!z.isHidden)K=z,X=W-_}_=V}}Y(this,Z);let q=($<0?K:Q)||K||Q;return q?{tile:q,offset:q==K?X:U}:null}coordsIn(Z,$){let J=this.resolveInline(Z,$,!0);if(!J)return CQ(this);return J.tile.coordsIn(Math.max(0,J.offset),$)}domIn(Z,$){let J=this.resolveInline(Z,$);if(J){let{tile:K,offset:X}=J;if(this.dom.contains(K.dom)){if(K.isText())return new V1(K.dom,Math.min(K.dom.nodeValue.length,X));return K.domPosFor(X,K.flags&16?1:K.flags&32?-1:$)}let Q=J.tile.parent,U=!1;for(let Y of Q.children){if(U)return new V1(Y.dom,0);if(Y==J.tile)U=!0}}return new V1(this.dom,0)}}function CQ(Z){let $=Z.dom.lastChild;if(!$)return Z.dom.getBoundingClientRect();let J=j4($);return J[J.length-1]||null}function TQ(Z,$){let J=Z.coordsIn(0,1),K=$.coordsIn(0,1);return J&&K&&K.top<J.bottom}class f0 extends F7{constructor(Z,$){super(Z);this.mark=$}get domAttrs(){return this.mark.attrs}static of(Z,$){let J=new f0($||document.createElement(Z.tagName),Z);if(!$)J.flags|=4;return J}}class $5 extends F0{constructor(Z,$){super(Z,$.length);this.text=$}sync(Z){if(this.flags&2)return;if(super.sync(Z),this.dom.nodeValue!=this.text){if(Z&&Z.node==this.dom)Z.written=!0;this.dom.nodeValue=this.text}}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(Z,$){let J=this.dom.nodeValue.length;if(Z>J)Z=J;let K=Z,X=Z,Q=0;if(Z==0&&$<0||Z==J&&$>=0){if(!(y.chrome||y.gecko)){if(Z)K--,Q=1;else if(X<J)X++,Q=-1}}else if($<0)K--;else if(X<J)X++;let U=O7(this.dom,K,X).getClientRects();if(!U.length)return null;let Y=U[(Q?Q<0:$>=0)?0:U.length-1];if(y.safari&&!Q&&Y.width==0)Y=Array.prototype.find.call(U,(q)=>q.width)||Y;return Q?A4(Y,Q<0):Y||null}static of(Z,$){let J=new $5($||document.createTextNode(Z),Z);if(!$)J.flags|=2;return J}}class X5 extends F0{constructor(Z,$,J,K){super(Z,$,K);this.widget=J}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(Z){if(this.flags&48)return!1;return(this.flags&(Z<0?64:128))>0}coordsIn(Z,$){return this.coordsInWidget(Z,$,!1)}coordsInWidget(Z,$,J){let K=this.widget.coordsAt(this.dom,Z,$);if(K)return K;if(J)return A4(this.dom.getBoundingClientRect(),this.length?Z==0:$<=0);else{let X=this.dom.getClientRects(),Q=null;if(!X.length)return null;let U=this.flags&16?!0:this.flags&32?!1:Z>0;for(let Y=U?X.length-1:0;;Y+=U?-1:1)if(Q=X[Y],Z>0?Y==0:Y==X.length-1||Q.top<Q.bottom)break;return A4(Q,!U)}}get overrideDOMText(){if(!this.length)return i.empty;let{root:Z}=this;if(!Z)return i.empty;let $=this.posAtStart;return Z.view.state.doc.slice($,$+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(Z,$,J,K,X){if(!X){if(X=Z.toDOM($),!Z.editable)X.contentEditable="false"}return new X5(X,J,Z,K)}}class V7 extends F0{constructor(Z){let $=document.createElement("img");$.className="cm-widgetBuffer",$.setAttribute("aria-hidden","true");super($,0,Z)}get isHidden(){return!0}get overrideDOMText(){return i.empty}coordsIn(Z){return this.dom.getBoundingClientRect()}}class z${constructor(Z){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=Z}advance(Z,$,J){let{tile:K,index:X,beforeBreak:Q,parents:U}=this;while(Z||$>0)if(!K.isComposite())if(X==K.length)Q=!!K.breakAfter,{tile:K,index:X}=U.pop(),X++;else if(!Z)break;else{let Y=Math.min(Z,K.length-X);if(J)J.skip(K,X,X+Y);Z-=Y,X+=Y}else if(Q){if(!Z)break;if(J)J.break();Z--,Q=!1}else if(X==K.children.length){if(!Z&&!U.length)break;if(J)J.leave(K);Q=!!K.breakAfter,{tile:K,index:X}=U.pop(),X++}else{let Y=K.children[X],q=Y.breakAfter;if(($>0?Y.length<=Z:Y.length<Z)&&(!J||J.skip(Y,0,Y.length)!==!1||!Y.isComposite))Q=!!q,X++,Z-=Y.length;else if(U.push({tile:K,index:X}),K=Y,X=0,J&&Y.isComposite())J.enter(Y)}return this.tile=K,this.index=X,this.beforeBreak=Q,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class O${constructor(Z,$,J,K){this.from=Z,this.to=$,this.wrapper=J,this.rank=K}}class V${constructor(Z,$,J){this.cache=Z,this.root=$,this.blockWrappers=J,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(Z,$,J,K){var X;this.flushBuffer();let Q=this.ensureMarks($,J),U=Q.lastChild;if(U&&U.isText()&&!(U.flags&8)){this.cache.reused.set(U,2);let Y=Q.children[Q.children.length-1]=new $5(U.dom,U.text+Z);Y.parent=Q}else Q.append(K||$5.of(Z,(X=this.cache.find($5))===null||X===void 0?void 0:X.dom));this.pos+=Z.length,this.afterWidget=null}addComposition(Z,$){let J=this.curLine;if(J.dom!=$.line.dom)J.setDOM(this.cache.reused.has($.line)?i9($.line.dom):$.line.dom),this.cache.reused.set($.line,2);let K=J;for(let U=$.marks.length-1;U>=0;U--){let Y=$.marks[U],q=K.lastChild;if(q instanceof f0&&q.mark.eq(Y.mark)){if(q.dom!=Y.dom)q.setDOM(i9(Y.dom));K=q}else{if(this.cache.reused.get(Y)){let W=F0.get(Y.dom);if(W)W.setDOM(i9(Y.dom))}let G=f0.of(Y.mark,Y.dom);K.append(G),K=G}this.cache.reused.set(Y,2)}let X=F0.get(Z.text);if(X)this.cache.reused.set(X,2);let Q=new $5(Z.text,Z.text.nodeValue);Q.flags|=8,K.append(Q)}addInlineWidget(Z,$,J){let K=this.afterWidget&&Z.flags&48&&(this.afterWidget.flags&48)==(Z.flags&48);if(!K)this.flushBuffer();let X=this.ensureMarks($,J);if(!K&&!(Z.flags&16))X.append(this.getBuffer(1));X.append(Z),this.pos+=Z.length,this.afterWidget=Z}addMark(Z,$,J){this.flushBuffer(),this.ensureMarks($,J).append(Z),this.pos+=Z.length,this.afterWidget=null}addBlockWidget(Z){this.getBlockPos().append(Z),this.pos+=Z.length,this.lastBlock=Z,this.endLine()}continueWidget(Z){let $=this.afterWidget||this.lastBlock;$.length+=Z,this.pos+=Z}addLineStart(Z,$){var J;if(!Z)Z=R$;let K=P5.start(Z,$||((J=this.cache.find(P5))===null||J===void 0?void 0:J.dom),!!$);this.getBlockPos().append(this.lastBlock=this.curLine=K)}addLine(Z){this.getBlockPos().append(Z),this.pos+=Z.length,this.lastBlock=Z,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(Z){if(!this.blockPosCovered())this.addLineStart(Z)}ensureLine(Z){if(!this.curLine)this.addLineStart(Z)}ensureMarks(Z,$){var J;let K=this.curLine;for(let X=Z.length-1;X>=0;X--){let Q=Z[X],U;if($>0&&(U=K.lastChild)&&U instanceof f0&&U.mark.eq(Q))K=U,$--;else{let Y=f0.of(Q,(J=this.cache.find(f0,(q)=>q.mark.eq(Q)))===null||J===void 0?void 0:J.dom);K.append(Y),K=Y,$=0}}return K}endLine(){if(this.curLine){this.flushBuffer();let Z=this.curLine.lastChild;if(!Z||!G2(this.curLine,!1)||Z.dom.nodeName!="BR"&&Z.isWidget()&&!(y.ios&&G2(this.curLine,!0)))this.curLine.append(this.cache.findWidget(a9,0,32)||new X5(a9.toDOM(),0,a9,32));this.curLine=this.afterWidget=null}}updateBlockWrappers(){if(this.wrapperPos>this.pos+1e4)this.blockWrappers.goto(this.pos),this.wrappers.length=0;for(let Z=this.wrappers.length-1;Z>=0;Z--)if(this.wrappers[Z].to<this.pos)this.wrappers.splice(Z,1);for(let Z=this.blockWrappers;Z.value&&Z.from<=this.pos;Z.next())if(Z.to>=this.pos){let $=new O$(Z.from,Z.to,Z.value,Z.rank),J=this.wrappers.length;while(J>0&&(this.wrappers[J-1].rank-$.rank||this.wrappers[J-1].to-$.to)<0)J--;this.wrappers.splice(J,0,$)}this.wrapperPos=this.pos}getBlockPos(){var Z;this.updateBlockWrappers();let $=this.root;for(let J of this.wrappers){let K=$.lastChild;if(J.from<this.pos&&K instanceof u1&&K.wrapper.eq(J.wrapper))$=K;else{let X=u1.of(J.wrapper,(Z=this.cache.find(u1,(Q)=>Q.wrapper.eq(J.wrapper)))===null||Z===void 0?void 0:Z.dom);$.append(X),$=X}}return $}blockPosCovered(){let Z=this.lastBlock;return Z!=null&&!Z.breakAfter&&(!Z.isWidget()||(Z.flags&160)>0)}getBuffer(Z){let $=2|(Z<0?16:32),J=this.cache.find(V7,void 0,1);if(J)J.flags=$;return J||new V7($)}flushBuffer(){if(this.afterWidget&&!(this.afterWidget.flags&32))this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null}}class H${constructor(Z){this.skipCount=0,this.text="",this.textOff=0,this.cursor=Z.iter()}skip(Z){if(this.textOff+Z<=this.text.length)this.textOff+=Z;else this.skipCount+=Z-(this.text.length-this.textOff),this.text="",this.textOff=0}next(Z){if(this.textOff==this.text.length){let{value:K,lineBreak:X,done:Q}=this.cursor.next(this.skipCount);if(this.skipCount=0,Q)throw Error("Ran out of text content when drawing inline views");this.text=K;let U=this.textOff=Math.min(Z,K.length);return X?null:K.slice(0,U)}let $=Math.min(this.text.length,this.textOff+Z),J=this.text.slice(this.textOff,$);return this.textOff=$,J}}var M4=[X5,P5,$5,f0,V7,u1,D7];for(let Z=0;Z<M4.length;Z++)M4[Z].bucket=Z;class N${constructor(Z){this.view=Z,this.buckets=M4.map(()=>[]),this.index=M4.map(()=>0),this.reused=new Map}add(Z){let $=Z.constructor.bucket,J=this.buckets[$];if(J.length<6)J.push(Z);else J[this.index[$]=(this.index[$]+1)%6]=Z}find(Z,$,J=2){let K=Z.bucket,X=this.buckets[K],Q=this.index[K];for(let U=X.length-1;U>=0;U--){let Y=(U+Q)%X.length,q=X[Y];if((!$||$(q))&&!this.reused.has(q)){if(X.splice(Y,1),Y<Q)this.index[K]--;return this.reused.set(q,J),q}}return null}findWidget(Z,$,J){let K=this.buckets[0];if(K.length)for(let X=0,Q=0;;X++){if(X==K.length){if(Q)return null;Q=1,X=0}let U=K[X];if(!this.reused.has(U)&&(Q==0?U.widget.compare(Z):U.widget.constructor==Z.constructor&&Z.updateDOM(U.dom,this.view))){if(K.splice(X,1),X<this.index[0])this.index[0]--;if(U.widget==Z&&U.length==$&&(U.flags&497)==J)return this.reused.set(U,1),U;else return this.reused.set(U,2),new X5(U.dom,$,Z,U.flags&-498|J)}}}reuse(Z){return this.reused.set(Z,1),Z}maybeReuse(Z,$=2){if(this.reused.has(Z))return;return this.reused.set(Z,$),Z.dom}clear(){for(let Z=0;Z<this.buckets.length;Z++)this.buckets[Z].length=this.index[Z]=0}}class I${constructor(Z,$,J,K,X){this.view=Z,this.decorations=K,this.disallowBlockEffectsFor=X,this.openWidget=!1,this.openMarks=0,this.cache=new N$(Z),this.text=new H$(Z.state.doc),this.builder=new V$(this.cache,new D7(Z,Z.contentDOM),d.iter(J)),this.cache.reused.set($,2),this.old=new z$($),this.reuseWalker={skip:(Q,U,Y)=>{if(this.cache.add(Q),Q.isComposite())return!1},enter:(Q)=>this.cache.add(Q),leave:()=>{},break:()=>{}}}run(Z,$){let J=$&&this.getCompositionContext($.text);for(let K=0,X=0,Q=0;;){let U=Q<Z.length?Z[Q++]:null,Y=U?U.fromA:this.old.root.length;if(Y>K){let q=Y-K;this.preserve(q,!Q,!U),K=Y,X+=q}if(!U)break;if($&&U.fromA<=$.range.fromA&&U.toA>=$.range.toA)this.forward(U.fromA,$.range.fromA,$.range.fromA<$.range.toA?1:-1),this.emit(X,$.range.fromB),this.cache.clear(),this.builder.addComposition($,J),this.text.skip($.range.toB-$.range.fromB),this.forward($.range.fromA,U.toA),this.emit($.range.toB,U.toB);else this.forward(U.fromA,U.toA),this.emit(X,U.toB);X=U.toB,K=U.toA}if(this.builder.curLine)this.builder.endLine();return this.builder.root}preserve(Z,$,J){let K=SQ(this.old),X=this.openMarks;this.old.advance(Z,J?1:-1,{skip:(Q,U,Y)=>{if(Q.isWidget())if(this.openWidget)this.builder.continueWidget(Y-U);else{let q=Y>0||U<Q.length?X5.of(Q.widget,this.view,Y-U,Q.flags&496,this.cache.maybeReuse(Q)):this.cache.reuse(Q);if(q.flags&256)q.flags&=-2,this.builder.addBlockWidget(q);else this.builder.ensureLine(null),this.builder.addInlineWidget(q,K,X),X=K.length}else if(Q.isText()){if(this.builder.ensureLine(null),!U&&Y==Q.length)this.builder.addText(Q.text,K,X,this.cache.reuse(Q));else this.cache.add(Q),this.builder.addText(Q.text.slice(U,Y),K,X);X=K.length}else if(Q.isLine())Q.flags&=-2,this.cache.reused.set(Q,1),this.builder.addLine(Q);else if(Q instanceof V7)this.cache.add(Q);else if(Q instanceof f0)this.builder.ensureLine(null),this.builder.addMark(Q,K,X),this.cache.reused.set(Q,1),X=K.length;else return!1;this.openWidget=!1},enter:(Q)=>{if(Q.isLine())this.builder.addLineStart(Q.attrs,this.cache.maybeReuse(Q));else if(this.cache.add(Q),Q instanceof f0)K.unshift(Q.mark);this.openWidget=!1},leave:(Q)=>{if(Q.isLine()){if(K.length)K.length=X=0}else if(Q instanceof f0)K.shift(),X=Math.min(X,K.length)},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(Z)}emit(Z,$){let J=null,K=this.builder,X=0,Q=d.spans(this.decorations,Z,$,{point:(U,Y,q,G,W,j)=>{if(q instanceof J5){if(this.disallowBlockEffectsFor[j]){if(q.block)throw RangeError("Block decorations may not be specified via plugins");if(Y>this.view.state.doc.lineAt(U).to)throw RangeError("Decorations that replace line breaks may not be specified via plugins")}if(X=G.length,W>G.length)K.continueWidget(Y-U);else{let _=q.widget||(q.block?Q5.block:Q5.inline),z=yQ(q),V=this.cache.findWidget(_,Y-U,z)||X5.of(_,this.view,Y-U,z);if(q.block){if(q.startSide>0)K.addLineStartIfNotCovered(J);K.addBlockWidget(V)}else K.ensureLine(J),K.addInlineWidget(V,G,W)}J=null}else J=kQ(J,q);if(Y>U)this.text.skip(Y-U)},span:(U,Y,q,G)=>{for(let W=U;W<Y;){let j=this.text.next(Math.min(512,Y-W));if(j==null)K.addLineStartIfNotCovered(J),K.addBreak(),W++;else K.ensureLine(J),K.addText(j,q,G),W+=j.length;J=null}}});K.addLineStartIfNotCovered(J),this.openWidget=Q>X,this.openMarks=Q}forward(Z,$,J=1){if($-Z<=10)this.old.advance($-Z,J,this.reuseWalker);else this.old.advance(5,-1,this.reuseWalker),this.old.advance($-Z-10,-1),this.old.advance(5,J,this.reuseWalker)}getCompositionContext(Z){let $=[],J=null;for(let K=Z.parentNode;;K=K.parentNode){let X=F0.get(K);if(K==this.view.contentDOM)break;if(X instanceof f0)$.push(X);else if(X===null||X===void 0?void 0:X.isLine())J=X;else if(K.nodeName=="DIV"&&!J&&K!=this.view.contentDOM)J=new P5(K,R$);else $.push(f0.of(new N7({tagName:K.nodeName.toLowerCase(),attributes:WQ(K)}),K))}return{line:J,marks:$}}}function G2(Z,$){let J=(K)=>{for(let X of K.children)if(($?X.isText():X.length)||J(X))return!0;return!1};return J(Z)}function yQ(Z){let $=Z.isReplace?(Z.startSide<0?64:0)|(Z.endSide>0?128:0):Z.startSide>0?32:16;if(Z.block)$|=256;return $}var R$={class:"cm-line"};function kQ(Z,$){let J=$.spec.attributes,K=$.spec.class;if(!J&&!K)return Z;if(!Z)Z={class:"cm-line"};if(J)P8(J,Z);if(K)Z.class+=" "+K;return Z}function SQ(Z){let $=[];for(let J=Z.parents.length;J>1;J--){let K=J==Z.parents.length?Z.tile:Z.parents[J].tile;if(K instanceof f0)$.push(K.mark)}return $}function i9(Z){let $=F0.get(Z);if($)$.setDOM(Z.cloneNode());return Z}class Q5 extends i0{constructor(Z){super();this.tag=Z}eq(Z){return Z.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(Z){return Z.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Q5.inline=new Q5("span");Q5.block=new Q5("div");var a9=new class extends i0{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class j8{constructor(Z){this.view=Z,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=x.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new D7(Z,Z.contentDOM),this.updateInner([new t0(0,0,0,Z.state.doc.length)],null)}update(Z){var $;let J=Z.changedRanges;if(this.minWidth>0&&J.length)if(!J.every(({fromA:G,toA:W})=>W<this.minWidthFrom||G>this.minWidthTo))this.minWidth=this.minWidthFrom=this.minWidthTo=0;else this.minWidthFrom=Z.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=Z.changes.mapPos(this.minWidthTo,1);this.updateEditContextFormatting(Z);let K=-1;if(this.view.inputState.composing>=0&&!this.view.observer.editContext){if(($=this.domChanged)===null||$===void 0?void 0:$.newSel)K=this.domChanged.newSel.head;else if(!fQ(Z.changes,this.hasComposition)&&!Z.selectionSet)K=Z.state.selection.main.head}let X=K>-1?xQ(this.view,Z.changes,K):null;if(this.domChanged=null,this.hasComposition){let{from:G,to:W}=this.hasComposition;J=new t0(G,W,Z.changes.mapPos(G,-1),Z.changes.mapPos(W,1)).addToSet(J.slice())}if(this.hasComposition=X?{from:X.range.fromB,to:X.range.toB}:null,(y.ie||y.chrome)&&!X&&Z&&Z.state.doc.lines!=Z.startState.doc.lines)this.forceSelection=!0;let Q=this.decorations,U=this.blockWrappers;this.updateDeco();let Y=vQ(Q,this.decorations,Z.changes);if(Y.length)J=t0.extendWithRanges(J,Y);let q=mQ(U,this.blockWrappers,Z.changes);if(q.length)J=t0.extendWithRanges(J,q);if(X&&!J.some((G)=>G.fromA<=X.range.fromA&&G.toA>=X.range.toA))J=X.range.addToSet(J.slice());if(this.tile.flags&2&&J.length==0)return!1;else{if(this.updateInner(J,X),Z.transactions.length)this.lastUpdate=Date.now();return!0}}updateInner(Z,$){this.view.viewState.mustMeasureContent=!0;let{observer:J}=this.view;J.ignore(()=>{if($||Z.length){let Q=this.tile,U=new I$(this.view,Q,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=U.run(Z,$),_8(Q,U.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let X=y.chrome||y.ios?{node:J.selectionRange.focusNode,written:!1}:void 0;if(this.tile.sync(X),X&&(X.written||J.selectionRange.focusNode!=X.node||!this.tile.dom.contains(X.node)))this.forceSelection=!0;this.tile.dom.style.height=""});let K=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length){for(let X of this.tile.children)if(X.isWidget()&&X.widget instanceof z4)K.push(X.dom)}J.updateGaps(K)}updateEditContextFormatting(Z){this.editContextFormatting=this.editContextFormatting.map(Z.changes);for(let $ of Z.transactions)for(let J of $.effects)if(J.is(q$))this.editContextFormatting=J.value}updateSelection(Z=!1,$=!1){if(Z||!this.view.observer.selectionRange.focusNode)this.view.observer.readSelectionRange();let{dom:J}=this.tile,K=this.view.root.activeElement,X=K==J,Q=!X&&!(this.view.state.facet(b1)||J.tabIndex>-1)&&G7(J,this.view.observer.selectionRange)&&!(K&&J.contains(K));if(!(X||$||Q))return;let U=this.forceSelection;this.forceSelection=!1;let Y=this.view.state.selection.main,q,G;if(Y.empty)G=q=this.inlineDOMNearPos(Y.anchor,Y.assoc||1);else G=this.inlineDOMNearPos(Y.head,Y.head==Y.from?1:-1),q=this.inlineDOMNearPos(Y.anchor,Y.anchor==Y.from?1:-1);if(y.gecko&&Y.empty&&!this.hasComposition&&bQ(q)){let j=document.createTextNode("");this.view.observer.ignore(()=>q.node.insertBefore(j,q.node.childNodes[q.offset]||null)),q=G=new V1(j,0),U=!0}let W=this.view.observer.selectionRange;if(U||!W.focusNode||(!W7(q.node,q.offset,W.anchorNode,W.anchorOffset)||!W7(G.node,G.offset,W.focusNode,W.focusOffset))&&!this.suppressWidgetCursorChange(W,Y))this.view.observer.ignore(()=>{if(y.android&&y.chrome&&J.contains(W.focusNode)&&uQ(W.focusNode,J))J.blur(),J.focus({preventScroll:!0});let j=E5(this.view.root);if(!j);else if(Y.empty){if(y.gecko){let _=wQ(q.node,q.offset);if(_&&_!=3){let z=(_==1?s2:n2)(q.node,q.offset);if(z)q=new V1(z.node,z.offset)}}if(j.collapse(q.node,q.offset),Y.bidiLevel!=null&&j.caretBidiLevel!==void 0)j.caretBidiLevel=Y.bidiLevel}else if(j.extend){j.collapse(q.node,q.offset);try{j.extend(G.node,G.offset)}catch(_){}}else{let _=document.createRange();if(Y.anchor>Y.head)[q,G]=[G,q];_.setEnd(G.node,G.offset),_.setStart(q.node,q.offset),j.removeAllRanges(),j.addRange(_)}if(Q&&this.view.root.activeElement==J){if(J.blur(),K)K.focus()}}),this.view.observer.setSelectionRange(q,G);this.impreciseAnchor=q.precise?null:new V1(W.anchorNode,W.anchorOffset),this.impreciseHead=G.precise?null:new V1(W.focusNode,W.focusOffset)}suppressWidgetCursorChange(Z,$){return this.hasComposition&&$.empty&&W7(Z.focusNode,Z.focusOffset,Z.anchorNode,Z.anchorOffset)&&this.posFromDOM(Z.focusNode,Z.focusOffset)==$.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:Z}=this,$=Z.state.selection.main,J=E5(Z.root),{anchorNode:K,anchorOffset:X}=Z.observer.selectionRange;if(!J||!$.empty||!$.assoc||!J.modify)return;let Q=this.lineAt($.head,$.assoc);if(!Q)return;let U=Q.posAtStart;if($.head==U||$.head==U+Q.length)return;let Y=this.coordsAt($.head,-1),q=this.coordsAt($.head,1);if(!Y||!q||Y.bottom>q.top)return;let G=this.domAtPos($.head+$.assoc,$.assoc);J.collapse(G.node,G.offset),J.modify("move",$.assoc<0?"forward":"backward","lineboundary"),Z.observer.readSelectionRange();let W=Z.observer.selectionRange;if(Z.docView.posFromDOM(W.anchorNode,W.anchorOffset)!=$.from)J.collapse(K,X)}posFromDOM(Z,$){let J=this.tile.nearest(Z);if(!J)return this.tile.dom.compareDocumentPosition(Z)&2?0:this.view.state.doc.length;let K=J.posAtStart;if(J.isComposite()){let X;if(Z==J.dom)X=J.dom.childNodes[$];else{let Q=x1(Z)==0?0:$==0?-1:1;for(;;){let U=Z.parentNode;if(U==J.dom)break;if(Q==0&&U.firstChild!=U.lastChild)if(Z==U.firstChild)Q=-1;else Q=1;Z=U}if(Q<0)X=Z;else X=Z.nextSibling}if(X==J.dom.firstChild)return K;while(X&&!F0.get(X))X=X.nextSibling;if(!X)return K+J.length;for(let Q=0,U=K;;Q++){let Y=J.children[Q];if(Y.dom==X)return U;U+=Y.length+Y.breakAfter}}else if(J.isText())return Z==J.dom?K+$:K+($?J.length:0);else return K}domAtPos(Z,$){let{tile:J,offset:K}=this.tile.resolveBlock(Z,$);if(J.isWidget())return J.domPosFor(Z,$);return J.domIn(K,$)}inlineDOMNearPos(Z,$){let J,K=-1,X=!1,Q,U=-1,Y=!1;if(this.tile.blockTiles((q,G)=>{if(q.isWidget()){if(q.flags&32&&G>=Z)return!0;if(q.flags&16)X=!0}else{let W=G+q.length;if(G<=Z)J=q,K=Z-G,X=W<Z;if(W>=Z&&!Q)Q=q,U=Z-G,Y=G>Z;if(G>Z&&Q)return!0}}),!J&&!Q)return this.domAtPos(Z,$);if(X&&Q)J=null;else if(Y&&J)Q=null;return J&&$<0||!Q?J.domIn(K,$):Q.domIn(U,$)}coordsAt(Z,$){let{tile:J,offset:K}=this.tile.resolveBlock(Z,$);if(J.isWidget()){if(J.widget instanceof z4)return null;return J.coordsInWidget(K,$,!0)}return J.coordsIn(K,$)}lineAt(Z,$){let{tile:J}=this.tile.resolveBlock(Z,$);return J.isLine()?J:null}coordsForChar(Z){let{tile:$,offset:J}=this.tile.resolveBlock(Z,1);if(!$.isLine())return null;function K(X,Q){if(X.isComposite())for(let U of X.children){if(U.length>=Q){let Y=K(U,Q);if(Y)return Y}if(Q-=U.length,Q<0)break}else if(X.isText()&&Q<X.length){let U=H0(X.text,Q);if(U==Q)return null;let Y=O7(X.dom,Q,U).getClientRects();for(let q=0;q<Y.length;q++){let G=Y[q];if(q==Y.length-1||G.top<G.bottom&&G.left<G.right)return G}}return null}return K($,J)}measureVisibleLineHeights(Z){let $=[],{from:J,to:K}=Z,X=this.view.contentDOM.clientWidth,Q=X>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,U=-1,Y=this.view.textDirection==J0.LTR,q=0,G=(W,j,_)=>{for(let z=0;z<W.children.length;z++){if(j>K)break;let V=W.children[z],O=j+V.length,N=V.dom.getBoundingClientRect(),{height:R}=N;if(_&&!z)q+=N.top-_.top;if(V instanceof u1){if(O>J)G(V,j,N)}else if(j>=J){if(q>0)$.push(-q);if($.push(R+q),q=0,Q){let A=V.dom.lastChild,L=A?j4(A):[];if(L.length){let E=L[L.length-1],M=Y?E.right-N.left:N.right-E.left;if(M>U)U=M,this.minWidth=X,this.minWidthFrom=j,this.minWidthTo=O}}}if(_&&z==W.children.length-1)q+=_.bottom-N.bottom;j=O+V.breakAfter}};return G(this.tile,0,null),$}textDirectionAt(Z){let{tile:$}=this.tile.resolveBlock(Z,1);return getComputedStyle($.dom).direction=="rtl"?J0.RTL:J0.LTR}measureTextSize(){let Z=this.tile.blockTiles((Q)=>{if(Q.isLine()&&Q.children.length&&Q.length<=20){let U=0,Y;for(let q of Q.children){if(!q.isText()||/[^ -~]/.test(q.text))return;let G=j4(q.dom);if(G.length!=1)return;U+=G[0].width,Y=G[0].height}if(U)return{lineHeight:Q.dom.getBoundingClientRect().height,charWidth:U/Q.length,textHeight:Y}}});if(Z)return Z;let $=document.createElement("div"),J,K,X;return $.className="cm-line",$.style.width="99999px",$.style.position="absolute",$.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild($);let Q=j4($.firstChild)[0];J=$.getBoundingClientRect().height,K=Q&&Q.width?Q.width/27:7,X=Q&&Q.height?Q.height:J,$.remove()}),{lineHeight:J,charWidth:K,textHeight:X}}computeBlockGapDeco(){let Z=[],$=this.view.viewState;for(let J=0,K=0;;K++){let X=K==$.viewports.length?null:$.viewports[K],Q=X?X.from-1:this.view.state.doc.length;if(Q>J){let U=($.lineBlockAt(Q).bottom-$.lineBlockAt(J).top)/this.view.scaleY;Z.push(x.replace({widget:new z4(U),block:!0,inclusive:!0,isBlockGap:!0}).range(J,Q))}if(!X)break;J=X.to+1}return x.set(Z)}updateDeco(){let Z=1,$=this.view.state.facet(y4).map((X)=>{return(this.dynamicDecorationMap[Z++]=typeof X=="function")?X(this.view):X}),J=!1,K=this.view.state.facet(b8).map((X,Q)=>{let U=typeof X=="function";if(U)J=!0;return U?X(this.view):X});if(K.length)this.dynamicDecorationMap[Z++]=J,$.push(d.join(K));this.decorations=[this.editContextFormatting,...$,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];while(Z<this.decorations.length)this.dynamicDecorationMap[Z++]=!1;this.blockWrappers=this.view.state.facet(W$).map((X)=>typeof X=="function"?X(this.view):X)}scrollIntoView(Z){if(Z.isSnapshot){let q=this.view.viewState.lineBlockAt(Z.range.head);this.view.scrollDOM.scrollTop=q.top-Z.yMargin,this.view.scrollDOM.scrollLeft=Z.xMargin;return}for(let q of this.view.state.facet(Y$))try{if(q(this.view,Z.range,Z))return!0}catch(G){T0(this.view.state,G,"scroll handler")}let{range:$}=Z,J=this.coordsAt($.head,$.empty?$.assoc:$.head>$.anchor?-1:1),K;if(!J)return;if(!$.empty&&(K=this.coordsAt($.anchor,$.anchor>$.head?-1:1)))J={left:Math.min(J.left,K.left),top:Math.min(J.top,K.top),right:Math.max(J.right,K.right),bottom:Math.max(J.bottom,K.bottom)};let X=x8(this.view),Q={left:J.left-X.left,top:J.top-X.top,right:J.right+X.right,bottom:J.bottom+X.bottom},{offsetWidth:U,offsetHeight:Y}=this.view.scrollDOM;zQ(this.view.scrollDOM,Q,$.head<$.anchor?-1:1,Z.x,Z.y,Math.max(Math.min(Z.xMargin,U),-U),Math.max(Math.min(Z.yMargin,Y),-Y),this.view.textDirection==J0.LTR)}lineHasWidget(Z){let $=(J)=>J.isWidget()||J.children.some($);return $(this.tile.resolveBlock(Z,1).tile)}destroy(){_8(this.tile)}}function _8(Z,$){let J=$===null||$===void 0?void 0:$.get(Z);if(J!=1){if(J==null)Z.destroy();for(let K of Z.children)_8(K,$)}}function bQ(Z){return Z.node.nodeType==1&&Z.node.firstChild&&(Z.offset==0||Z.node.childNodes[Z.offset-1].contentEditable=="false")&&(Z.offset==Z.node.childNodes.length||Z.node.childNodes[Z.offset].contentEditable=="false")}function F$(Z,$){let J=Z.observer.selectionRange;if(!J.focusNode)return null;let K=s2(J.focusNode,J.focusOffset),X=n2(J.focusNode,J.focusOffset),Q=K||X;if(X&&K&&X.node!=K.node){let Y=F0.get(X.node);if(!Y||Y.isText()&&Y.text!=X.node.nodeValue)Q=X;else if(Z.docView.lastCompositionAfterCursor){let q=F0.get(K.node);if(!(!q||q.isText()&&q.text!=K.node.nodeValue))Q=X}}if(Z.docView.lastCompositionAfterCursor=Q!=K,!Q)return null;let U=$-Q.offset;return{from:U,to:U+Q.node.nodeValue.length,node:Q.node}}function xQ(Z,$,J){let K=F$(Z,J);if(!K)return null;let{node:X,from:Q,to:U}=K,Y=X.nodeValue;if(/[\n\r]/.test(Y))return null;if(Z.state.doc.sliceString(K.from,K.to)!=Y)return null;let q=$.invertedDesc;return{range:new t0(q.mapPos(Q),q.mapPos(U),Q,U),text:X}}function wQ(Z,$){if(Z.nodeType!=1)return 0;return($&&Z.childNodes[$-1].contentEditable=="false"?1:0)|($<Z.childNodes.length&&Z.childNodes[$].contentEditable=="false"?2:0)}var hQ=class{constructor(){this.changes=[]}compareRange($,J){L5($,J,this.changes)}comparePoint($,J){L5($,J,this.changes)}boundChange($){L5($,$,this.changes)}};function vQ(Z,$,J){let K=new hQ;return d.compare(Z,$,J,K),K.changes}class D${constructor(){this.changes=[]}compareRange(Z,$){L5(Z,$,this.changes)}comparePoint(){}boundChange(Z){L5(Z,Z,this.changes)}}function mQ(Z,$,J){let K=new D$;return d.compare(Z,$,J,K),K.changes}function uQ(Z,$){for(let J=Z;J&&J!=$;J=J.assignedSlot||J.parentNode)if(J.nodeType==1&&J.contentEditable=="false")return!0;return!1}function fQ(Z,$){let J=!1;if($)Z.iterChangedRanges((K,X)=>{if(K<$.to&&X>$.from)J=!0});return J}class z4 extends i0{constructor(Z){super();this.height=Z}toDOM(){let Z=document.createElement("div");return Z.className="cm-gap",this.updateDOM(Z),Z}eq(Z){return Z.height==this.height}updateDOM(Z){return Z.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function gQ(Z,$,J=1){let K=Z.charCategorizer($),X=Z.doc.lineAt($),Q=$-X.from;if(X.length==0)return D.cursor($);if(Q==0)J=1;else if(Q==X.length)J=-1;let U=Q,Y=Q;if(J<0)U=H0(X.text,Q,!1);else Y=H0(X.text,Q);let q=K(X.text.slice(U,Y));while(U>0){let G=H0(X.text,U,!1);if(K(X.text.slice(G,U))!=q)break;U=G}while(Y<X.length){let G=H0(X.text,Y);if(K(X.text.slice(Y,G))!=q)break;Y=G}return D.range(U+X.from,Y+X.from)}function pQ(Z,$,J,K,X){let Q=Math.round((K-$.left)*Z.defaultCharacterWidth);if(Z.lineWrapping&&J.height>Z.defaultLineHeight*1.5){let Y=Z.viewState.heightOracle.textHeight,q=Math.floor((X-J.top-(Z.defaultLineHeight-Y)*0.5)/Y);Q+=q*Z.viewState.heightOracle.lineLength}let U=Z.state.sliceDoc(J.from,J.to);return J.from+$4(U,Q,Z.state.tabSize)}function z8(Z,$,J){let K=Z.lineBlockAt($);if(Array.isArray(K.type)){let X;for(let Q of K.type){if(Q.from>$)break;if(Q.to<$)continue;if(Q.from<$&&Q.to>$)return Q;if(!X||Q.type==y0.Text&&(X.type!=Q.type||(J<0?Q.from<$:Q.to>$)))X=Q}return X||K}return K}function dQ(Z,$,J,K){let X=z8(Z,$.head,$.assoc||-1),Q=!K||X.type!=y0.Text||!(Z.lineWrapping||X.widgetLineBreaks)?null:Z.coordsAtPos($.assoc<0&&$.head>X.from?$.head-1:$.head);if(Q){let U=Z.dom.getBoundingClientRect(),Y=Z.textDirectionAt(X.from),q=Z.posAtCoords({x:J==(Y==J0.LTR)?U.right-1:U.left+1,y:(Q.top+Q.bottom)/2});if(q!=null)return D.cursor(q,J?-1:1)}return D.cursor(J?X.to:X.from,J?-1:1)}function W2(Z,$,J,K){let X=Z.state.doc.lineAt($.head),Q=Z.bidiSpans(X),U=Z.textDirectionAt(X.from);for(let Y=$,q=null;;){let G=MQ(X,Q,U,Y,J),W=t2;if(!G){if(X.number==(J?Z.state.doc.lines:1))return Y;W=`
`,X=Z.state.doc.line(X.number+(J?1:-1)),Q=Z.bidiSpans(X),G=Z.visualLineSide(X,!J)}if(!q){if(!K)return G;q=K(W)}else if(!q(W))return Y;Y=G}}function lQ(Z,$,J){let K=Z.state.charCategorizer($),X=K(J);return(Q)=>{let U=K(Q);if(X==X0.Space)X=U;return X==U}}function cQ(Z,$,J,K){let X=$.head,Q=J?1:-1;if(X==(J?Z.state.doc.length:0))return D.cursor(X,$.assoc);let U=$.goalColumn,Y,q=Z.contentDOM.getBoundingClientRect(),G=Z.coordsAtPos(X,$.assoc||-1),W=Z.documentTop;if(G){if(U==null)U=G.left-q.left;Y=Q<0?G.top:G.bottom}else{let V=Z.viewState.lineBlockAt(X);if(U==null)U=Math.min(q.right-q.left,Z.defaultCharacterWidth*(X-V.from));Y=(Q<0?V.top:V.bottom)+W}let j=q.left+U,_=K!==null&&K!==void 0?K:Z.viewState.heightOracle.textHeight>>1,z=O8(Z,{x:j,y:Y+_*Q},!1,Q);return D.cursor(z.pos,z.assoc,void 0,U)}function j7(Z,$,J){for(;;){let K=0;for(let X of Z)X.between($-1,$+1,(Q,U,Y)=>{if($>Q&&$<U){let q=K||J||($-Q<U-$?-1:1);$=q<0?Q:U,K=q}});if(!K)return $}}function A$(Z,$){let J=null;for(let K=0;K<$.ranges.length;K++){let X=$.ranges[K],Q=null;if(X.empty){let U=j7(Z,X.from,0);if(U!=X.from)Q=D.cursor(U,-1)}else{let U=j7(Z,X.from,-1),Y=j7(Z,X.to,1);if(U!=X.from||Y!=X.to)Q=D.range(X.from==X.anchor?U:Y,X.from==X.head?U:Y)}if(Q){if(!J)J=$.ranges.slice();J[K]=Q}}return J?D.create(J,$.mainIndex):$}function r9(Z,$,J){let K=j7(Z.state.facet(R7).map((X)=>X(Z)),J.from,$.head>J.from?-1:1);return K==J.from?J:D.cursor(K,K<J.from?1:-1)}class z1{constructor(Z,$){this.pos=Z,this.assoc=$}}function O8(Z,$,J,K){let X=Z.contentDOM.getBoundingClientRect(),Q=X.top+Z.viewState.paddingTop,{x:U,y:Y}=$,q=Y-Q,G;for(;;){if(q<0)return new z1(0,1);if(q>Z.viewState.docHeight)return new z1(Z.state.doc.length,-1);if(G=Z.elementAtHeight(q),K==null)break;if(G.type==y0.Text){let _=Z.docView.coordsAt(K<0?G.from:G.to,K);if(_&&(K<0?_.top<=q+Q:_.bottom>=q+Q))break}let j=Z.viewState.heightOracle.textHeight/2;q=K>0?G.bottom+j:G.top-j}if(Z.viewport.from>=G.to||Z.viewport.to<=G.from){if(J)return null;if(G.type==y0.Text){let j=pQ(Z,X,G,U,Y);return new z1(j,j==G.from?1:-1)}}if(G.type!=y0.Text)return q<(G.top+G.bottom)/2?new z1(G.from,1):new z1(G.to,-1);let W=Z.docView.lineAt(G.from,2);if(!W||W.length!=G.length)W=Z.docView.lineAt(G.from,-2);return L$(Z,W,G.from,U,Y)}function L$(Z,$,J,K,X){let Q=-1,U=null,Y=1e9,q=1e9,G=X,W=X,j=(_,z)=>{for(let V=0;V<_.length;V++){let O=_[V];if(O.top==O.bottom)continue;let N=O.left>K?O.left-K:O.right<K?K-O.right:0,R=O.top>X?O.top-X:O.bottom<X?X-O.bottom:0;if(O.top<=W&&O.bottom>=G)G=Math.min(O.top,G),W=Math.max(O.bottom,W),R=0;if(Q<0||(R-q||N-Y)<0)if(Q>=0&&q&&Y<N&&U.top<=W-2&&U.bottom>=G+2)q=0;else Q=z,Y=N,q=R,U=O}};if($.isText()){for(let z=0;z<$.length;){let V=H0($.text,z);if(j(O7($.dom,z,V).getClientRects(),z),!Y&&!q)break;z=V}return K>(U.left+U.right)/2==(j2(Z,Q+J)==J0.LTR)?new z1(J+H0($.text,Q),-1):new z1(J+Q,1)}else{if(!$.length)return new z1(J,1);for(let O=0;O<$.children.length;O++){let N=$.children[O];if(N.flags&48)continue;let R=(N.dom.nodeType==1?N.dom:O7(N.dom,0,N.length)).getClientRects();if(j(R,O),!Y&&!q)break}let _=$.children[Q],z=$.posBefore(_,J);if(_.isComposite()||_.isText())return L$(Z,_,z,Math.max(U.left,Math.min(U.right,K)),X);return K>(U.left+U.right)/2==(j2(Z,Q+J)==J0.LTR)?new z1(z+_.length,-1):new z1(z,1)}}function j2(Z,$){let J=Z.state.doc.lineAt($);return Z.bidiSpans(J)[B1.find(Z.bidiSpans(J),$-J.from,-1,1)].dir}var X7="￿";class M${constructor(Z,$){this.points=Z,this.view=$,this.text="",this.lineSeparator=$.state.facet(p.lineSeparator)}append(Z){this.text+=Z}lineBreak(){this.text+=X7}readRange(Z,$){if(!Z)return this;let J=Z.parentNode;for(let K=Z;;){this.findPointBefore(J,K);let X=this.text.length;this.readNode(K);let Q=F0.get(K),U=K.nextSibling;if(U==$){if((Q===null||Q===void 0?void 0:Q.breakAfter)&&!U&&J!=this.view.contentDOM)this.lineBreak();break}let Y=F0.get(U);if((Q&&Y?Q.breakAfter:(Q?Q.breakAfter:D4(K))||D4(U)&&(K.nodeName!="BR"||(Q===null||Q===void 0?void 0:Q.isWidget()))&&this.text.length>X)&&!nQ(U,$))this.lineBreak();K=U}return this.findPointBefore(J,$),this}readTextNode(Z){let $=Z.nodeValue;for(let J of this.points)if(J.node==Z)J.pos=this.text.length+Math.min(J.offset,$.length);for(let J=0,K=this.lineSeparator?null:/\r\n?|\n/g;;){let X=-1,Q=1,U;if(this.lineSeparator)X=$.indexOf(this.lineSeparator,J),Q=this.lineSeparator.length;else if(U=K.exec($))X=U.index,Q=U[0].length;if(this.append($.slice(J,X<0?$.length:X)),X<0)break;if(this.lineBreak(),Q>1){for(let Y of this.points)if(Y.node==Z&&Y.pos>this.text.length)Y.pos-=Q-1}J=X+Q}}readNode(Z){let $=F0.get(Z),J=$&&$.overrideDOMText;if(J!=null){this.findPointInside(Z,J.length);for(let K=J.iter();!K.next().done;)if(K.lineBreak)this.lineBreak();else this.append(K.value)}else if(Z.nodeType==3)this.readTextNode(Z);else if(Z.nodeName=="BR"){if(Z.nextSibling)this.lineBreak()}else if(Z.nodeType==1)this.readRange(Z.firstChild,null)}findPointBefore(Z,$){for(let J of this.points)if(J.node==Z&&Z.childNodes[J.offset]==$)J.pos=this.text.length}findPointInside(Z,$){for(let J of this.points)if(Z.nodeType==3?J.node==Z:Z.contains(J.node))J.pos=this.text.length+(sQ(Z,J.node,J.offset)?$:0)}}function sQ(Z,$,J){for(;;){if(!$||J<x1($))return!1;if($==Z)return!0;J=f1($)+1,$=$.parentNode}}function nQ(Z,$){let J;for(;;Z=Z.nextSibling){if(Z==$||!Z)break;let K=F0.get(Z);if(!(K===null||K===void 0?void 0:K.isWidget()))return!1;if(K)(J||(J=[])).push(K)}if(J)for(let K of J){let X=K.overrideDOMText;if(X===null||X===void 0?void 0:X.length)return!1}return!0}class V8{constructor(Z,$){this.node=Z,this.offset=$,this.pos=-1}}class B${constructor(Z,$,J,K){this.typeOver=K,this.bounds=null,this.text="",this.domChanged=$>-1;let{impreciseHead:X,impreciseAnchor:Q}=Z.docView;if(Z.state.readOnly&&$>-1)this.newSel=null;else if($>-1&&(this.bounds=E$(Z.docView.tile,$,J,0))){let U=X||Q?[]:aQ(Z),Y=new M$(U,Z);Y.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=Y.text,this.newSel=rQ(U,this.bounds.from)}else{let U=Z.observer.selectionRange,Y=X&&X.node==U.focusNode&&X.offset==U.focusOffset||!U8(Z.contentDOM,U.focusNode)?Z.state.selection.main.head:Z.docView.posFromDOM(U.focusNode,U.focusOffset),q=Q&&Q.node==U.anchorNode&&Q.offset==U.anchorOffset||!U8(Z.contentDOM,U.anchorNode)?Z.state.selection.main.anchor:Z.docView.posFromDOM(U.anchorNode,U.anchorOffset),G=Z.viewport;if((y.ios||y.chrome)&&Z.state.selection.main.empty&&Y!=q&&(G.from>0||G.to<Z.state.doc.length)){let W=Math.min(Y,q),j=Math.max(Y,q),_=G.from-W,z=G.to-j;if((_==0||_==1||W==0)&&(z==0||z==-1||j==Z.state.doc.length))Y=0,q=Z.state.doc.length}if(Z.inputState.composing>-1&&Z.state.selection.ranges.length>1)this.newSel=Z.state.selection.replaceRange(D.range(q,Y));else this.newSel=D.single(q,Y)}}}function E$(Z,$,J,K){if(Z.isComposite()){let X=-1,Q=-1,U=-1,Y=-1;for(let q=0,G=K,W=K;q<Z.children.length;q++){let j=Z.children[q],_=G+j.length;if(G<$&&_>J)return E$(j,$,J,G);if(_>=$&&X==-1)X=q,Q=G;if(G>J&&j.dom.parentNode==Z.dom){U=q,Y=W;break}W=_,G=_+j.breakAfter}return{from:Q,to:Y<0?K+Z.length:Y,startDOM:(X?Z.children[X-1].dom.nextSibling:null)||Z.dom.firstChild,endDOM:U<Z.children.length&&U>=0?Z.children[U].dom:null}}else if(Z.isText())return{from:K,to:K+Z.length,startDOM:Z.dom,endDOM:Z.dom.nextSibling};else return null}function P$(Z,$){let J,{newSel:K}=$,X=Z.state.selection.main,Q=Z.inputState.lastKeyTime>Date.now()-100?Z.inputState.lastKeyCode:-1;if($.bounds){let{from:U,to:Y}=$.bounds,q=X.from,G=null;if(Q===8||y.android&&$.text.length<Y-U)q=X.to,G="end";let W=C$(Z.state.doc.sliceString(U,Y,X7),$.text,q-U,G);if(W){if(y.chrome&&Q==13&&W.toB==W.from+2&&$.text.slice(W.from,W.toB)==X7+X7)W.toB--;J={from:U+W.from,to:U+W.toA,insert:i.of($.text.slice(W.from,W.toB).split(X7))}}}else if(K&&(!Z.hasFocus&&Z.state.facet(b1)||B4(K,X)))K=null;if(!J&&!K)return!1;if(!J&&$.typeOver&&!X.empty&&K&&K.main.empty)J={from:X.from,to:X.to,insert:Z.state.doc.slice(X.from,X.to)};else if((y.mac||y.android)&&J&&J.from==J.to&&J.from==X.head-1&&/^\. ?$/.test(J.insert.toString())&&Z.contentDOM.getAttribute("autocorrect")=="off"){if(K&&J.insert.length==2)K=D.single(K.main.anchor-1,K.main.head-1);J={from:J.from,to:J.to,insert:i.of([J.insert.toString().replace("."," ")])}}else if(J&&J.from>=X.from&&J.to<=X.to&&(J.from!=X.from||J.to!=X.to)&&X.to-X.from-(J.to-J.from)<=4)J={from:X.from,to:X.to,insert:Z.state.doc.slice(X.from,J.from).append(J.insert).append(Z.state.doc.slice(J.to,X.to))};else if(Z.state.doc.lineAt(X.from).to<X.to&&Z.docView.lineHasWidget(X.to)&&Z.inputState.insertingTextAt>Date.now()-50)J={from:X.from,to:X.to,insert:Z.state.toText(Z.inputState.insertingText)};else if(y.chrome&&J&&J.from==J.to&&J.from==X.head&&J.insert.toString()==`
 `&&Z.lineWrapping){if(K)K=D.single(K.main.anchor-1,K.main.head-1);J={from:X.from,to:X.to,insert:i.of([" "])}}if(J)return w8(Z,J,K,Q);else if(K&&!B4(K,X)){let U=!1,Y="select";if(Z.inputState.lastSelectionTime>Date.now()-50){if(Z.inputState.lastSelectionOrigin=="select")U=!0;if(Y=Z.inputState.lastSelectionOrigin,Y=="select.pointer")K=A$(Z.state.facet(R7).map((q)=>q(Z)),K)}return Z.dispatch({selection:K,scrollIntoView:U,userEvent:Y}),!0}else return!1}function w8(Z,$,J,K=-1){if(y.ios&&Z.inputState.flushIOSKey($))return!0;let X=Z.state.selection.main;if(y.android&&($.to==X.to&&($.from==X.from||$.from==X.from-1&&Z.state.sliceDoc($.from,X.from)==" ")&&$.insert.length==1&&$.insert.lines==2&&M5(Z.contentDOM,"Enter",13)||($.from==X.from-1&&$.to==X.to&&$.insert.length==0||K==8&&$.insert.length<$.to-$.from&&$.to>X.head)&&M5(Z.contentDOM,"Backspace",8)||$.from==X.from&&$.to==X.to+1&&$.insert.length==0&&M5(Z.contentDOM,"Delete",46)))return!0;let Q=$.insert.toString();if(Z.inputState.composing>=0)Z.inputState.composing++;let U,Y=()=>U||(U=iQ(Z,$,J));if(!Z.state.facet(K$).some((q)=>q(Z,$.from,$.to,Q,Y)))Z.dispatch(Y());return!0}function iQ(Z,$,J){let K,X=Z.state,Q=X.selection.main,U=-1;if($.from==$.to&&$.from<Q.from||$.from>Q.to){let q=$.from<Q.from?-1:1,G=q<0?Q.from:Q.to,W=j7(X.facet(R7).map((j)=>j(Z)),G,q);if($.from==W)U=W}if(U>-1)K={changes:$,selection:D.cursor($.from+$.insert.length,-1)};else if($.from>=Q.from&&$.to<=Q.to&&$.to-$.from>=(Q.to-Q.from)/3&&(!J||J.main.empty&&J.main.from==$.from+$.insert.length)&&Z.inputState.composing<0){let q=Q.from<$.from?X.sliceDoc(Q.from,$.from):"",G=Q.to>$.to?X.sliceDoc($.to,Q.to):"";K=X.replaceSelection(Z.state.toText(q+$.insert.sliceString(0,void 0,Z.state.lineBreak)+G))}else{let q=X.changes($),G=J&&J.main.to<=q.newLength?J.main:void 0;if(X.selection.ranges.length>1&&(Z.inputState.composing>=0||Z.inputState.compositionPendingChange)&&$.to<=Q.to+10&&$.to>=Q.to-10){let W=Z.state.sliceDoc($.from,$.to),j,_=J&&F$(Z,J.main.head);if(_){let V=$.insert.length-($.to-$.from);j={from:_.from,to:_.to-V}}else j=Z.state.doc.lineAt(Q.head);let z=Q.to-$.to;K=X.changeByRange((V)=>{if(V.from==Q.from&&V.to==Q.to)return{changes:q,range:G||V.map(q)};let O=V.to-z,N=O-W.length;if(Z.state.sliceDoc(N,O)!=W||O>=j.from&&N<=j.to)return{range:V};let R=X.changes({from:N,to:O,insert:$.insert}),A=V.to-Q.to;return{changes:R,range:!G?V.map(R):D.range(Math.max(0,G.anchor+A),Math.max(0,G.head+A))}})}else K={changes:q,selection:G&&X.selection.replaceRange(G)}}let Y="input.type";if(Z.composing||Z.inputState.compositionPendingChange&&Z.inputState.compositionEndedAt>Date.now()-50){if(Z.inputState.compositionPendingChange=!1,Y+=".compose",Z.inputState.compositionFirstChange)Y+=".start",Z.inputState.compositionFirstChange=!1}return X.update(K,{userEvent:Y,scrollIntoView:!0})}function C$(Z,$,J,K){let X=Math.min(Z.length,$.length),Q=0;while(Q<X&&Z.charCodeAt(Q)==$.charCodeAt(Q))Q++;if(Q==X&&Z.length==$.length)return null;let U=Z.length,Y=$.length;while(U>0&&Y>0&&Z.charCodeAt(U-1)==$.charCodeAt(Y-1))U--,Y--;if(K=="end"){let q=Math.max(0,Q-Math.min(U,Y));J-=U+q-Q}if(U<Q&&Z.length<$.length){let q=J<=Q&&J>=U?Q-J:0;Q-=q,Y=Q+(Y-U),U=Q}else if(Y<Q){let q=J<=Q&&J>=Y?Q-J:0;Q-=q,U=Q+(U-Y),Y=Q}return{from:Q,toA:U,toB:Y}}function aQ(Z){let $=[];if(Z.root.activeElement!=Z.contentDOM)return $;let{anchorNode:J,anchorOffset:K,focusNode:X,focusOffset:Q}=Z.observer.selectionRange;if(J){if($.push(new V8(J,K)),X!=J||Q!=K)$.push(new V8(X,Q))}return $}function rQ(Z,$){if(Z.length==0)return null;let J=Z[0].pos,K=Z.length==2?Z[1].pos:J;return J>-1&&K>-1?D.single(J+$,K+$):null}function B4(Z,$){return $.head==Z.main.head&&$.anchor==Z.main.anchor}class T${setSelectionOrigin(Z){this.lastSelectionOrigin=Z,this.lastSelectionTime=Date.now()}constructor(Z){if(this.view=Z,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=Z.hasFocus,y.safari)Z.contentDOM.addEventListener("input",()=>null);if(y.gecko)WU(Z.contentDOM.ownerDocument)}handleEvent(Z){if(!KU(this.view,Z)||this.ignoreDuringComposition(Z))return;if(Z.type=="keydown"&&this.keydown(Z))return;if(this.view.updateState!=0)Promise.resolve().then(()=>this.runHandlers(Z.type,Z));else this.runHandlers(Z.type,Z)}runHandlers(Z,$){let J=this.handlers[Z];if(J){for(let K of J.observers)K(this.view,$);for(let K of J.handlers){if($.defaultPrevented)break;if(K(this.view,$)){$.preventDefault();break}}}}ensureHandlers(Z){let $=oQ(Z),J=this.handlers,K=this.view.contentDOM;for(let X in $)if(X!="scroll"){let Q=!$[X].handlers.length,U=J[X];if(U&&Q!=!U.handlers.length)K.removeEventListener(X,this.handleEvent),U=null;if(!U)K.addEventListener(X,this.handleEvent,{passive:Q})}for(let X in J)if(X!="scroll"&&!$[X])K.removeEventListener(X,this.handleEvent);this.handlers=$}keydown(Z){if(this.lastKeyCode=Z.keyCode,this.lastKeyTime=Date.now(),Z.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&Z.keyCode!=27&&k$.indexOf(Z.keyCode)<0)this.tabFocusMode=-1;if(y.android&&y.chrome&&!Z.synthetic&&(Z.keyCode==13||Z.keyCode==8))return this.view.observer.delayAndroidKey(Z.key,Z.keyCode),!0;let $;if(y.ios&&!Z.synthetic&&!Z.altKey&&!Z.metaKey&&(($=y$.find((J)=>J.keyCode==Z.keyCode))&&!Z.ctrlKey||tQ.indexOf(Z.key)>-1&&Z.ctrlKey&&!Z.shiftKey))return this.pendingIOSKey=$||Z,setTimeout(()=>this.flushIOSKey(),250),!0;if(Z.keyCode!=229)this.view.observer.forceFlush();return!1}flushIOSKey(Z){let $=this.pendingIOSKey;if(!$)return!1;if($.key=="Enter"&&Z&&Z.from<Z.to&&/^\S+$/.test(Z.insert.toString()))return!1;return this.pendingIOSKey=void 0,M5(this.view.contentDOM,$.key,$.keyCode,$ instanceof KeyboardEvent?$:void 0)}ignoreDuringComposition(Z){if(!/^key/.test(Z.type)||Z.synthetic)return!1;if(this.composing>0)return!0;if(y.safari&&!y.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)return this.compositionPendingKey=!1,!0;return!1}startMouseSelection(Z){if(this.mouseSelection)this.mouseSelection.destroy();this.mouseSelection=Z}update(Z){if(this.view.observer.update(Z),this.mouseSelection)this.mouseSelection.update(Z);if(this.draggedContent&&Z.docChanged)this.draggedContent=this.draggedContent.map(Z.changes);if(Z.transactions.length)this.lastKeyCode=this.lastSelectionTime=0}destroy(){if(this.mouseSelection)this.mouseSelection.destroy()}}function _2(Z,$){return(J,K)=>{try{return $.call(Z,K,J)}catch(X){T0(J.state,X)}}}function oQ(Z){let $=Object.create(null);function J(K){return $[K]||($[K]={observers:[],handlers:[]})}for(let K of Z){let X=K.spec,Q=X&&X.plugin.domEventHandlers,U=X&&X.plugin.domEventObservers;if(Q)for(let Y in Q){let q=Q[Y];if(q)J(Y).handlers.push(_2(K.value,q))}if(U)for(let Y in U){let q=U[Y];if(q)J(Y).observers.push(_2(K.value,q))}}for(let K in H1)J(K).handlers.push(H1[K]);for(let K in e0)J(K).observers.push(e0[K]);return $}var y$=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],tQ="dthko",k$=[16,17,18,20,91,92,224,225],K4=6;function X4(Z){return Math.max(0,Z)*0.7+8}function eQ(Z,$){return Math.max(Math.abs(Z.clientX-$.clientX),Math.abs(Z.clientY-$.clientY))}class S${constructor(Z,$,J,K){this.view=Z,this.startEvent=$,this.style=J,this.mustSelect=K,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=$,this.scrollParents=OQ(Z.contentDOM),this.atoms=Z.state.facet(R7).map((Q)=>Q(Z));let X=Z.contentDOM.ownerDocument;X.addEventListener("mousemove",this.move=this.move.bind(this)),X.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=$.shiftKey,this.multiple=Z.state.facet(p.allowMultipleSelections)&&ZU(Z,$),this.dragging=JU(Z,$)&&w$($)==1?null:!1}start(Z){if(this.dragging===!1)this.select(Z)}move(Z){if(Z.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&eQ(this.startEvent,Z)<10)return;this.select(this.lastEvent=Z);let $=0,J=0,K=0,X=0,Q=this.view.win.innerWidth,U=this.view.win.innerHeight;if(this.scrollParents.x)({left:K,right:Q}=this.scrollParents.x.getBoundingClientRect());if(this.scrollParents.y)({top:X,bottom:U}=this.scrollParents.y.getBoundingClientRect());let Y=x8(this.view);if(Z.clientX-Y.left<=K+K4)$=-X4(K-Z.clientX);else if(Z.clientX+Y.right>=Q-K4)$=X4(Z.clientX-Q);if(Z.clientY-Y.top<=X+K4)J=-X4(X-Z.clientY);else if(Z.clientY+Y.bottom>=U-K4)J=X4(Z.clientY-U);this.setScrollSpeed($,J)}up(Z){if(this.dragging==null)this.select(this.lastEvent);if(!this.dragging)Z.preventDefault();this.destroy()}destroy(){this.setScrollSpeed(0,0);let Z=this.view.contentDOM.ownerDocument;Z.removeEventListener("mousemove",this.move),Z.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(Z,$){if(this.scrollSpeed={x:Z,y:$},Z||$){if(this.scrolling<0)this.scrolling=setInterval(()=>this.scroll(),50)}else if(this.scrolling>-1)clearInterval(this.scrolling),this.scrolling=-1}scroll(){let{x:Z,y:$}=this.scrollSpeed;if(Z&&this.scrollParents.x)this.scrollParents.x.scrollLeft+=Z,Z=0;if($&&this.scrollParents.y)this.scrollParents.y.scrollTop+=$,$=0;if(Z||$)this.view.win.scrollBy(Z,$);if(this.dragging===!1)this.select(this.lastEvent)}select(Z){let{view:$}=this,J=A$(this.atoms,this.style.get(Z,this.extend,this.multiple));if(this.mustSelect||!J.eq($.state.selection,this.dragging===!1))this.view.dispatch({selection:J,userEvent:"select.pointer"});this.mustSelect=!1}update(Z){if(Z.transactions.some(($)=>$.isUserEvent("input.type")))this.destroy();else if(this.style.update(Z))setTimeout(()=>this.select(this.lastEvent),20)}}function ZU(Z,$){let J=Z.state.facet(e2);return J.length?J[0]($):y.mac?$.metaKey:$.ctrlKey}function $U(Z,$){let J=Z.state.facet(Z$);return J.length?J[0]($):y.mac?!$.altKey:!$.ctrlKey}function JU(Z,$){let{main:J}=Z.state.selection;if(J.empty)return!1;let K=E5(Z.root);if(!K||K.rangeCount==0)return!0;let X=K.getRangeAt(0).getClientRects();for(let Q=0;Q<X.length;Q++){let U=X[Q];if(U.left<=$.clientX&&U.right>=$.clientX&&U.top<=$.clientY&&U.bottom>=$.clientY)return!0}return!1}function KU(Z,$){if(!$.bubbles)return!0;if($.defaultPrevented)return!1;for(let J=$.target,K;J!=Z.contentDOM;J=J.parentNode)if(!J||J.nodeType==11||(K=F0.get(J))&&K.isWidget()&&!K.isHidden&&K.widget.ignoreEvent($))return!1;return!0}var H1=Object.create(null),e0=Object.create(null),b$=y.ie&&y.ie_version<15||y.ios&&y.webkit_version<604;function XU(Z){let $=Z.dom.parentNode;if(!$)return;let J=$.appendChild(document.createElement("textarea"));J.style.cssText="position: fixed; left: -10000px; top: 10px",J.focus(),setTimeout(()=>{Z.focus(),J.remove(),x$(Z,J.value)},50)}function k4(Z,$,J){for(let K of Z.facet($))J=K(J,Z);return J}function x$(Z,$){$=k4(Z.state,y8,$);let{state:J}=Z,K,X=1,Q=J.toText($),U=Q.lines==J.selection.ranges.length;if(H8!=null&&J.selection.ranges.every((q)=>q.empty)&&H8==Q.toString()){let q=-1;K=J.changeByRange((G)=>{let W=J.doc.lineAt(G.from);if(W.from==q)return{range:G};q=W.from;let j=J.toText((U?Q.line(X++).text:$)+J.lineBreak);return{changes:{from:W.from,insert:j},range:D.cursor(G.from+j.length)}})}else if(U)K=J.changeByRange((q)=>{let G=Q.line(X++);return{changes:{from:q.from,to:q.to,insert:G.text},range:D.cursor(q.from+G.length)}});else K=J.replaceSelection(Q);Z.dispatch(K,{userEvent:"input.paste",scrollIntoView:!0})}e0.scroll=(Z)=>{Z.inputState.lastScrollTop=Z.scrollDOM.scrollTop,Z.inputState.lastScrollLeft=Z.scrollDOM.scrollLeft};H1.keydown=(Z,$)=>{if(Z.inputState.setSelectionOrigin("select"),$.keyCode==27&&Z.inputState.tabFocusMode!=0)Z.inputState.tabFocusMode=Date.now()+2000;return!1};e0.touchstart=(Z,$)=>{Z.inputState.lastTouchTime=Date.now(),Z.inputState.setSelectionOrigin("select.pointer")};e0.touchmove=(Z)=>{Z.inputState.setSelectionOrigin("select.pointer")};H1.mousedown=(Z,$)=>{if(Z.observer.flush(),Z.inputState.lastTouchTime>Date.now()-2000)return!1;let J=null;for(let K of Z.state.facet($$))if(J=K(Z,$),J)break;if(!J&&$.button==0)J=UU(Z,$);if(J){let K=!Z.hasFocus;if(Z.inputState.startMouseSelection(new S$(Z,$,J,K)),K)Z.observer.ignore(()=>{l2(Z.contentDOM);let Q=Z.root.activeElement;if(Q&&!Q.contains(Z.contentDOM))Q.blur()});let X=Z.inputState.mouseSelection;if(X)return X.start($),X.dragging===!1}else Z.inputState.setSelectionOrigin("select.pointer");return!1};function z2(Z,$,J,K){if(K==1)return D.cursor($,J);else if(K==2)return gQ(Z.state,$,J);else{let X=Z.docView.lineAt($,J),Q=Z.state.doc.lineAt(X?X.posAtEnd:$),U=X?X.posAtStart:Q.from,Y=X?X.posAtEnd:Q.to;if(Y<Z.state.doc.length&&Y==Q.to)Y++;return D.range(U,Y)}}var QU=y.ie&&y.ie_version<=11,O2=null,V2=0,H2=0;function w$(Z){if(!QU)return Z.detail;let $=O2,J=H2;return O2=Z,H2=Date.now(),V2=!$||J>Date.now()-400&&Math.abs($.clientX-Z.clientX)<2&&Math.abs($.clientY-Z.clientY)<2?(V2+1)%3:1}function UU(Z,$){let J=Z.posAndSideAtCoords({x:$.clientX,y:$.clientY},!1),K=w$($),X=Z.state.selection;return{update(Q){if(Q.docChanged)J.pos=Q.changes.mapPos(J.pos),X=X.map(Q.changes)},get(Q,U,Y){let q=Z.posAndSideAtCoords({x:Q.clientX,y:Q.clientY},!1),G,W=z2(Z,q.pos,q.assoc,K);if(J.pos!=q.pos&&!U){let j=z2(Z,J.pos,J.assoc,K),_=Math.min(j.from,W.from),z=Math.max(j.to,W.to);W=_<W.from?D.range(_,z):D.range(z,_)}if(U)return X.replaceRange(X.main.extend(W.from,W.to));else if(Y&&K==1&&X.ranges.length>1&&(G=YU(X,q.pos)))return G;else if(Y)return X.addRange(W);else return D.create([W])}}}function YU(Z,$){for(let J=0;J<Z.ranges.length;J++){let{from:K,to:X}=Z.ranges[J];if(K<=$&&X>=$)return D.create(Z.ranges.slice(0,J).concat(Z.ranges.slice(J+1)),Z.mainIndex==J?0:Z.mainIndex-(Z.mainIndex>J?1:0))}return null}H1.dragstart=(Z,$)=>{let{selection:{main:J}}=Z.state;if($.target.draggable){let X=Z.docView.tile.nearest($.target);if(X&&X.isWidget()){let Q=X.posAtStart,U=Q+X.length;if(Q>=J.to||U<=J.from)J=D.range(Q,U)}}let{inputState:K}=Z;if(K.mouseSelection)K.mouseSelection.dragging=!0;if(K.draggedContent=J,$.dataTransfer)$.dataTransfer.setData("Text",k4(Z.state,k8,Z.state.sliceDoc(J.from,J.to))),$.dataTransfer.effectAllowed="copyMove";return!1};H1.dragend=(Z)=>{return Z.inputState.draggedContent=null,!1};function N2(Z,$,J,K){if(J=k4(Z.state,y8,J),!J)return;let X=Z.posAtCoords({x:$.clientX,y:$.clientY},!1),{draggedContent:Q}=Z.inputState,U=K&&Q&&$U(Z,$)?{from:Q.from,to:Q.to}:null,Y={from:X,insert:J},q=Z.state.changes(U?[U,Y]:Y);Z.focus(),Z.dispatch({changes:q,selection:{anchor:q.mapPos(X,-1),head:q.mapPos(X,1)},userEvent:U?"move.drop":"input.drop"}),Z.inputState.draggedContent=null}H1.drop=(Z,$)=>{if(!$.dataTransfer)return!1;if(Z.state.readOnly)return!0;let J=$.dataTransfer.files;if(J&&J.length){let K=Array(J.length),X=0,Q=()=>{if(++X==J.length)N2(Z,$,K.filter((U)=>U!=null).join(Z.state.lineBreak),!1)};for(let U=0;U<J.length;U++){let Y=new FileReader;Y.onerror=Q,Y.onload=()=>{if(!/[\x00-\x08\x0e-\x1f]{2}/.test(Y.result))K[U]=Y.result;Q()},Y.readAsText(J[U])}return!0}else{let K=$.dataTransfer.getData("Text");if(K)return N2(Z,$,K,!0),!0}return!1};H1.paste=(Z,$)=>{if(Z.state.readOnly)return!0;Z.observer.flush();let J=b$?null:$.clipboardData;if(J)return x$(Z,J.getData("text/plain")||J.getData("text/uri-list")),!0;else return XU(Z),!1};function qU(Z,$){let J=Z.dom.parentNode;if(!J)return;let K=J.appendChild(document.createElement("textarea"));K.style.cssText="position: fixed; left: -10000px; top: 10px",K.value=$,K.focus(),K.selectionEnd=$.length,K.selectionStart=0,setTimeout(()=>{K.remove(),Z.focus()},50)}function GU(Z){let $=[],J=[],K=!1;for(let X of Z.selection.ranges)if(!X.empty)$.push(Z.sliceDoc(X.from,X.to)),J.push(X);if(!$.length){let X=-1;for(let{from:Q}of Z.selection.ranges){let U=Z.doc.lineAt(Q);if(U.number>X)$.push(U.text),J.push({from:U.from,to:Math.min(Z.doc.length,U.to+1)});X=U.number}K=!0}return{text:k4(Z,k8,$.join(Z.lineBreak)),ranges:J,linewise:K}}var H8=null;H1.copy=H1.cut=(Z,$)=>{let J=E5(Z.root);if(J&&!G7(Z.contentDOM,J))return!1;let{text:K,ranges:X,linewise:Q}=GU(Z.state);if(!K&&!Q)return!1;if(H8=Q?K:null,$.type=="cut"&&!Z.state.readOnly)Z.dispatch({changes:X,scrollIntoView:!0,userEvent:"delete.cut"});let U=b$?null:$.clipboardData;if(U)return U.clearData(),U.setData("text/plain",K),!0;else return qU(Z,K),!1};var h$=s0.define();function v$(Z,$){let J=[];for(let K of Z.facet(X$)){let X=K(Z,$);if(X)J.push(X)}return J.length?Z.update({effects:J,annotations:h$.of(!0)}):null}function m$(Z){setTimeout(()=>{let $=Z.hasFocus;if($!=Z.inputState.notifiedFocused){let J=v$(Z.state,$);if(J)Z.dispatch(J);else Z.update([])}},10)}e0.focus=(Z)=>{if(Z.inputState.lastFocusTime=Date.now(),!Z.scrollDOM.scrollTop&&(Z.inputState.lastScrollTop||Z.inputState.lastScrollLeft))Z.scrollDOM.scrollTop=Z.inputState.lastScrollTop,Z.scrollDOM.scrollLeft=Z.inputState.lastScrollLeft;m$(Z)};e0.blur=(Z)=>{Z.observer.clearSelectionRange(),m$(Z)};e0.compositionstart=e0.compositionupdate=(Z)=>{if(Z.observer.editContext)return;if(Z.inputState.compositionFirstChange==null)Z.inputState.compositionFirstChange=!0;if(Z.inputState.composing<0)Z.inputState.composing=0};e0.compositionend=(Z)=>{if(Z.observer.editContext)return;if(Z.inputState.composing=-1,Z.inputState.compositionEndedAt=Date.now(),Z.inputState.compositionPendingKey=!0,Z.inputState.compositionPendingChange=Z.observer.pendingRecords().length>0,Z.inputState.compositionFirstChange=null,y.chrome&&y.android)Z.observer.flushSoon();else if(Z.inputState.compositionPendingChange)Promise.resolve().then(()=>Z.observer.flush());else setTimeout(()=>{if(Z.inputState.composing<0&&Z.docView.hasComposition)Z.update([])},50)};e0.contextmenu=(Z)=>{Z.inputState.lastContextMenu=Date.now()};H1.beforeinput=(Z,$)=>{var J,K;if($.inputType=="insertText"||$.inputType=="insertCompositionText")Z.inputState.insertingText=$.data,Z.inputState.insertingTextAt=Date.now();if($.inputType=="insertReplacementText"&&Z.observer.editContext){let Q=(J=$.dataTransfer)===null||J===void 0?void 0:J.getData("text/plain"),U=$.getTargetRanges();if(Q&&U.length){let Y=U[0],q=Z.posAtDOM(Y.startContainer,Y.startOffset),G=Z.posAtDOM(Y.endContainer,Y.endOffset);return w8(Z,{from:q,to:G,insert:Z.state.toText(Q)},null),!0}}let X;if(y.chrome&&y.android&&(X=y$.find((Q)=>Q.inputType==$.inputType))){if(Z.observer.delayAndroidKey(X.key,X.keyCode),X.key=="Backspace"||X.key=="Delete"){let Q=((K=window.visualViewport)===null||K===void 0?void 0:K.height)||0;setTimeout(()=>{var U;if((((U=window.visualViewport)===null||U===void 0?void 0:U.height)||0)>Q+10&&Z.hasFocus)Z.contentDOM.blur(),Z.focus()},100)}}if(y.ios&&$.inputType=="deleteContentForward")Z.observer.flushSoon();if(y.safari&&$.inputType=="insertText"&&Z.inputState.composing>=0)setTimeout(()=>e0.compositionend(Z,$),20);return!1};var I2=new Set;function WU(Z){if(!I2.has(Z))I2.add(Z),Z.addEventListener("copy",()=>{}),Z.addEventListener("cut",()=>{})}var R2=["pre-wrap","normal","pre-line","break-spaces"],C5=!1;function F2(){C5=!1}class u${constructor(Z){this.lineWrapping=Z,this.doc=i.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(Z,$){let J=this.doc.lineAt($).number-this.doc.lineAt(Z).number+1;if(this.lineWrapping)J+=Math.max(0,Math.ceil(($-Z-J*this.lineLength*0.5)/this.lineLength));return this.lineHeight*J}heightForLine(Z){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((Z-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight}setDoc(Z){return this.doc=Z,this}mustRefreshForWrapping(Z){return R2.indexOf(Z)>-1!=this.lineWrapping}mustRefreshForHeights(Z){let $=!1;for(let J=0;J<Z.length;J++){let K=Z[J];if(K<0)J++;else if(!this.heightSamples[Math.floor(K*10)])$=!0,this.heightSamples[Math.floor(K*10)]=!0}return $}refresh(Z,$,J,K,X,Q){let U=R2.indexOf(Z)>-1,Y=Math.abs($-this.lineHeight)>0.3||this.lineWrapping!=U||Math.abs(J-this.charWidth)>0.1;if(this.lineWrapping=U,this.lineHeight=$,this.charWidth=J,this.textHeight=K,this.lineLength=X,Y){this.heightSamples={};for(let q=0;q<Q.length;q++){let G=Q[q];if(G<0)q++;else this.heightSamples[Math.floor(G*10)]=!0}}return Y}}class f${constructor(Z,$){this.from=Z,this.heights=$,this.index=0}get more(){return this.index<this.heights.length}}class O1{constructor(Z,$,J,K,X){this.from=Z,this.length=$,this.top=J,this.height=K,this._content=X}get type(){return typeof this._content=="number"?y0.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof J5?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(Z){let $=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(Z._content)?Z._content:[Z]);return new O1(this.from,this.length+Z.length,this.top,this.height+Z.height,$)}}var Y0=function(Z){return Z[Z.ByPos=0]="ByPos",Z[Z.ByHeight=1]="ByHeight",Z[Z.ByPosNoHeight=2]="ByPosNoHeight",Z}(Y0||(Y0={})),O4=0.001;class h0{constructor(Z,$,J=2){this.length=Z,this.height=$,this.flags=J}get outdated(){return(this.flags&2)>0}set outdated(Z){this.flags=(Z?2:0)|this.flags&-3}setHeight(Z){if(this.height!=Z){if(Math.abs(this.height-Z)>O4)C5=!0;this.height=Z}}replace(Z,$,J){return h0.of(J)}decomposeLeft(Z,$){$.push(this)}decomposeRight(Z,$){$.push(this)}applyChanges(Z,$,J,K){let X=this,Q=J.doc;for(let U=K.length-1;U>=0;U--){let{fromA:Y,toA:q,fromB:G,toB:W}=K[U],j=X.lineAt(Y,Y0.ByPosNoHeight,J.setDoc($),0,0),_=j.to>=q?j:X.lineAt(q,Y0.ByPosNoHeight,J,0,0);W+=_.to-q,q=_.to;while(U>0&&j.from<=K[U-1].toA)if(Y=K[U-1].fromA,G=K[U-1].fromB,U--,Y<j.from)j=X.lineAt(Y,Y0.ByPosNoHeight,J,0,0);G+=j.from-Y,Y=j.from;let z=v8.build(J.setDoc(Q),Z,G,W);X=E4(X,X.replace(Y,q,z))}return X.updateHeight(J,0)}static empty(){return new n0(0,0,0)}static of(Z){if(Z.length==1)return Z[0];let $=0,J=Z.length,K=0,X=0;for(;;)if($==J)if(K>X*2){let U=Z[$-1];if(U.break)Z.splice(--$,1,U.left,null,U.right);else Z.splice(--$,1,U.left,U.right);J+=1+U.break,K-=U.size}else if(X>K*2){let U=Z[J];if(U.break)Z.splice(J,1,U.left,null,U.right);else Z.splice(J,1,U.left,U.right);J+=2+U.break,X-=U.size}else break;else if(K<X){let U=Z[$++];if(U)K+=U.size}else{let U=Z[--J];if(U)X+=U.size}let Q=0;if(Z[$-1]==null)Q=1,$--;else if(Z[$]==null)Q=1,J++;return new g$(h0.of(Z.slice(0,$)),Q,h0.of(Z.slice(J)))}}function E4(Z,$){if(Z==$)return Z;if(Z.constructor!=$.constructor)C5=!0;return $}h0.prototype.size=1;var jU=x.replace({});class h8 extends h0{constructor(Z,$,J){super(Z,$);this.deco=J,this.spaceAbove=0}mainBlock(Z,$){return new O1($,this.length,Z+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(Z,$,J,K){return this.spaceAbove&&Z<J+this.spaceAbove?new O1(K,0,J,this.spaceAbove,jU):this.mainBlock(J,K)}lineAt(Z,$,J,K,X){let Q=this.mainBlock(K,X);return this.spaceAbove?this.blockAt(0,J,K,X).join(Q):Q}forEachLine(Z,$,J,K,X,Q){if(Z<=X+this.length&&$>=X)Q(this.lineAt(0,Y0.ByPos,J,K,X))}setMeasuredHeight(Z){let $=Z.heights[Z.index++];if($<0)this.spaceAbove=-$,$=Z.heights[Z.index++];else this.spaceAbove=0;this.setHeight($)}updateHeight(Z,$=0,J=!1,K){if(K&&K.from<=$&&K.more)this.setMeasuredHeight(K);return this.outdated=!1,this}toString(){return`block(${this.length})`}}class n0 extends h8{constructor(Z,$,J){super(Z,$,null);this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=J}mainBlock(Z,$){return new O1($,this.length,Z+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(Z,$,J){let K=J[0];if(J.length==1&&(K instanceof n0||K instanceof C0&&K.flags&4)&&Math.abs(this.length-K.length)<10){if(K instanceof C0)K=new n0(K.length,this.height,this.spaceAbove);else K.height=this.height;if(!this.outdated)K.outdated=!1;return K}else return h0.of(J)}updateHeight(Z,$=0,J=!1,K){if(K&&K.from<=$&&K.more)this.setMeasuredHeight(K);else if(J||this.outdated)this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,Z.heightForLine(this.length-this.collapsed))+this.breaks*Z.lineHeight);return this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class C0 extends h0{constructor(Z){super(Z,0)}heightMetrics(Z,$){let J=Z.doc.lineAt($).number,K=Z.doc.lineAt($+this.length).number,X=K-J+1,Q,U=0;if(Z.lineWrapping){let Y=Math.min(this.height,Z.lineHeight*X);if(Q=Y/X,this.length>X+1)U=(this.height-Y)/(this.length-X-1)}else Q=this.height/X;return{firstLine:J,lastLine:K,perLine:Q,perChar:U}}blockAt(Z,$,J,K){let{firstLine:X,lastLine:Q,perLine:U,perChar:Y}=this.heightMetrics($,K);if($.lineWrapping){let q=K+(Z<$.lineHeight?0:Math.round(Math.max(0,Math.min(1,(Z-J)/this.height))*this.length)),G=$.doc.lineAt(q),W=U+G.length*Y,j=Math.max(J,Z-W/2);return new O1(G.from,G.length,j,W,0)}else{let q=Math.max(0,Math.min(Q-X,Math.floor((Z-J)/U))),{from:G,length:W}=$.doc.line(X+q);return new O1(G,W,J+U*q,U,0)}}lineAt(Z,$,J,K,X){if($==Y0.ByHeight)return this.blockAt(Z,J,K,X);if($==Y0.ByPosNoHeight){let{from:_,to:z}=J.doc.lineAt(Z);return new O1(_,z-_,0,0,0)}let{firstLine:Q,perLine:U,perChar:Y}=this.heightMetrics(J,X),q=J.doc.lineAt(Z),G=U+q.length*Y,W=q.number-Q,j=K+U*W+Y*(q.from-X-W);return new O1(q.from,q.length,Math.max(K,Math.min(j,K+this.height-G)),G,0)}forEachLine(Z,$,J,K,X,Q){Z=Math.max(Z,X),$=Math.min($,X+this.length);let{firstLine:U,perLine:Y,perChar:q}=this.heightMetrics(J,X);for(let G=Z,W=K;G<=$;){let j=J.doc.lineAt(G);if(G==Z){let z=j.number-U;W+=Y*z+q*(Z-X-z)}let _=Y+q*j.length;Q(new O1(j.from,j.length,W,_,0)),W+=_,G=j.to+1}}replace(Z,$,J){let K=this.length-$;if(K>0){let X=J[J.length-1];if(X instanceof C0)J[J.length-1]=new C0(X.length+K);else J.push(null,new C0(K-1))}if(Z>0){let X=J[0];if(X instanceof C0)J[0]=new C0(Z+X.length);else J.unshift(new C0(Z-1),null)}return h0.of(J)}decomposeLeft(Z,$){$.push(new C0(Z-1),null)}decomposeRight(Z,$){$.push(null,new C0(this.length-Z-1))}updateHeight(Z,$=0,J=!1,K){let X=$+this.length;if(K&&K.from<=$+this.length&&K.more){let Q=[],U=Math.max($,K.from),Y=-1;if(K.from>$)Q.push(new C0(K.from-$-1).updateHeight(Z,$));while(U<=X&&K.more){let G=Z.doc.lineAt(U).length;if(Q.length)Q.push(null);let W=K.heights[K.index++],j=0;if(W<0)j=-W,W=K.heights[K.index++];if(Y==-1)Y=W;else if(Math.abs(W-Y)>=O4)Y=-2;let _=new n0(G,W,j);_.outdated=!1,Q.push(_),U+=G+1}if(U<=X)Q.push(null,new C0(X-U).updateHeight(Z,U));let q=h0.of(Q);if(Y<0||Math.abs(q.height-this.height)>=O4||Math.abs(Y-this.heightMetrics(Z,$).perLine)>=O4)C5=!0;return E4(this,q)}else if(J||this.outdated)this.setHeight(Z.heightForGap($,$+this.length)),this.outdated=!1;return this}toString(){return`gap(${this.length})`}}class g$ extends h0{constructor(Z,$,J){super(Z.length+$+J.length,Z.height+J.height,$|(Z.outdated||J.outdated?2:0));this.left=Z,this.right=J,this.size=Z.size+J.size}get break(){return this.flags&1}blockAt(Z,$,J,K){let X=J+this.left.height;return Z<X?this.left.blockAt(Z,$,J,K):this.right.blockAt(Z,$,X,K+this.left.length+this.break)}lineAt(Z,$,J,K,X){let Q=K+this.left.height,U=X+this.left.length+this.break,Y=$==Y0.ByHeight?Z<Q:Z<U,q=Y?this.left.lineAt(Z,$,J,K,X):this.right.lineAt(Z,$,J,Q,U);if(this.break||(Y?q.to<U:q.from>U))return q;let G=$==Y0.ByPosNoHeight?Y0.ByPosNoHeight:Y0.ByPos;if(Y)return q.join(this.right.lineAt(U,G,J,Q,U));else return this.left.lineAt(U,G,J,K,X).join(q)}forEachLine(Z,$,J,K,X,Q){let U=K+this.left.height,Y=X+this.left.length+this.break;if(this.break){if(Z<Y)this.left.forEachLine(Z,$,J,K,X,Q);if($>=Y)this.right.forEachLine(Z,$,J,U,Y,Q)}else{let q=this.lineAt(Y,Y0.ByPos,J,K,X);if(Z<q.from)this.left.forEachLine(Z,q.from-1,J,K,X,Q);if(q.to>=Z&&q.from<=$)Q(q);if($>q.to)this.right.forEachLine(q.to+1,$,J,U,Y,Q)}}replace(Z,$,J){let K=this.left.length+this.break;if($<K)return this.balanced(this.left.replace(Z,$,J),this.right);if(Z>this.left.length)return this.balanced(this.left,this.right.replace(Z-K,$-K,J));let X=[];if(Z>0)this.decomposeLeft(Z,X);let Q=X.length;for(let U of J)X.push(U);if(Z>0)D2(X,Q-1);if($<this.length){let U=X.length;this.decomposeRight($,X),D2(X,U)}return h0.of(X)}decomposeLeft(Z,$){let J=this.left.length;if(Z<=J)return this.left.decomposeLeft(Z,$);if($.push(this.left),this.break){if(J++,Z>=J)$.push(null)}if(Z>J)this.right.decomposeLeft(Z-J,$)}decomposeRight(Z,$){let J=this.left.length,K=J+this.break;if(Z>=K)return this.right.decomposeRight(Z-K,$);if(Z<J)this.left.decomposeRight(Z,$);if(this.break&&Z<K)$.push(null);$.push(this.right)}balanced(Z,$){if(Z.size>2*$.size||$.size>2*Z.size)return h0.of(this.break?[Z,null,$]:[Z,$]);return this.left=E4(this.left,Z),this.right=E4(this.right,$),this.setHeight(Z.height+$.height),this.outdated=Z.outdated||$.outdated,this.size=Z.size+$.size,this.length=Z.length+this.break+$.length,this}updateHeight(Z,$=0,J=!1,K){let{left:X,right:Q}=this,U=$+X.length+this.break,Y=null;if(K&&K.from<=$+X.length&&K.more)Y=X=X.updateHeight(Z,$,J,K);else X.updateHeight(Z,$,J);if(K&&K.from<=U+Q.length&&K.more)Y=Q=Q.updateHeight(Z,U,J,K);else Q.updateHeight(Z,U,J);if(Y)return this.balanced(X,Q);return this.height=this.left.height+this.right.height,this.outdated=!1,this}toString(){return this.left+(this.break?" ":"-")+this.right}}function D2(Z,$){let J,K;if(Z[$]==null&&(J=Z[$-1])instanceof C0&&(K=Z[$+1])instanceof C0)Z.splice($-1,3,new C0(J.length+1+K.length))}var _U=5;class v8{constructor(Z,$){this.pos=Z,this.oracle=$,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=Z}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(Z,$){if(this.lineStart>-1){let J=Math.min($,this.lineEnd),K=this.nodes[this.nodes.length-1];if(K instanceof n0)K.length+=J-this.pos;else if(J>this.pos||!this.isCovered)this.nodes.push(new n0(J-this.pos,-1,0));if(this.writtenTo=J,$>J)this.nodes.push(null),this.writtenTo++,this.lineStart=-1}this.pos=$}point(Z,$,J){if(Z<$||J.heightRelevant){let K=J.widget?J.widget.estimatedHeight:0,X=J.widget?J.widget.lineBreaks:0;if(K<0)K=this.oracle.lineHeight;let Q=$-Z;if(J.block)this.addBlock(new h8(Q,K,J));else if(Q||X||K>=_U)this.addLineDeco(K,X,Q)}else if($>Z)this.span(Z,$);if(this.lineEnd>-1&&this.lineEnd<this.pos)this.lineEnd=this.oracle.doc.lineAt(this.pos).to}enterLine(){if(this.lineStart>-1)return;let{from:Z,to:$}=this.oracle.doc.lineAt(this.pos);if(this.lineStart=Z,this.lineEnd=$,this.writtenTo<Z){if(this.writtenTo<Z-1||this.nodes[this.nodes.length-1]==null)this.nodes.push(this.blankContent(this.writtenTo,Z-1));this.nodes.push(null)}if(this.pos>Z)this.nodes.push(new n0(this.pos-Z,-1,0));this.writtenTo=this.pos}blankContent(Z,$){let J=new C0($-Z);if(this.oracle.doc.lineAt(Z).to==$)J.flags|=4;return J}ensureLine(){this.enterLine();let Z=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(Z instanceof n0)return Z;let $=new n0(0,-1,0);return this.nodes.push($),$}addBlock(Z){this.enterLine();let $=Z.deco;if($&&$.startSide>0&&!this.isCovered)this.ensureLine();if(this.nodes.push(Z),this.writtenTo=this.pos=this.pos+Z.length,$&&$.endSide>0)this.covering=Z}addLineDeco(Z,$,J){let K=this.ensureLine();K.length+=J,K.collapsed+=J,K.widgetHeight=Math.max(K.widgetHeight,Z),K.breaks+=$,this.writtenTo=this.pos=this.pos+J}finish(Z){let $=this.nodes.length==0?null:this.nodes[this.nodes.length-1];if(this.lineStart>-1&&!($ instanceof n0)&&!this.isCovered)this.nodes.push(new n0(0,-1,0));else if(this.writtenTo<this.pos||$==null)this.nodes.push(this.blankContent(this.writtenTo,this.pos));let J=Z;for(let K of this.nodes){if(K instanceof n0)K.updateHeight(this.oracle,J);J+=K?K.length:1}return this.nodes}static build(Z,$,J,K){let X=new v8(J,Z);return d.spans($,J,K,X,0),X.finish(J)}}function zU(Z,$,J){let K=new p$;return d.compare(Z,$,J,K,0),K.changes}class p${constructor(){this.changes=[]}compareRange(){}comparePoint(Z,$,J,K){if(Z<$||J&&J.heightRelevant||K&&K.heightRelevant)L5(Z,$,this.changes,5)}}function OU(Z,$){let J=Z.getBoundingClientRect(),K=Z.ownerDocument,X=K.defaultView||window,Q=Math.max(0,J.left),U=Math.min(X.innerWidth,J.right),Y=Math.max(0,J.top),q=Math.min(X.innerHeight,J.bottom);for(let G=Z.parentNode;G&&G!=K.body;)if(G.nodeType==1){let W=G,j=window.getComputedStyle(W);if((W.scrollHeight>W.clientHeight||W.scrollWidth>W.clientWidth)&&j.overflow!="visible"){let _=W.getBoundingClientRect();Q=Math.max(Q,_.left),U=Math.min(U,_.right),Y=Math.max(Y,_.top),q=Math.min(G==Z.parentNode?X.innerHeight:q,_.bottom)}G=j.position=="absolute"||j.position=="fixed"?W.offsetParent:W.parentNode}else if(G.nodeType==11)G=G.host;else break;return{left:Q-J.left,right:Math.max(Q,U)-J.left,top:Y-(J.top+$),bottom:Math.max(Y,q)-(J.top+$)}}function VU(Z){let $=Z.getBoundingClientRect(),J=Z.ownerDocument.defaultView||window;return $.left<J.innerWidth&&$.right>0&&$.top<J.innerHeight&&$.bottom>0}function HU(Z,$){let J=Z.getBoundingClientRect();return{left:0,right:J.right-J.left,top:$,bottom:J.bottom-(J.top+$)}}class V4{constructor(Z,$,J,K){this.from=Z,this.to=$,this.size=J,this.displaySize=K}static same(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++){let K=Z[J],X=$[J];if(K.from!=X.from||K.to!=X.to||K.size!=X.size)return!1}return!0}draw(Z,$){return x.replace({widget:new d$(this.displaySize*($?Z.scaleY:Z.scaleX),$)}).range(this.from,this.to)}}class d$ extends i0{constructor(Z,$){super();this.size=Z,this.vertical=$}eq(Z){return Z.size==this.size&&Z.vertical==this.vertical}toDOM(){let Z=document.createElement("div");if(this.vertical)Z.style.height=this.size+"px";else Z.style.width=this.size+"px",Z.style.height="2px",Z.style.display="inline-block";return Z}get estimatedHeight(){return this.vertical?this.size:-1}}class N8{constructor(Z){this.state=Z,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=A2,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=J0.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let $=Z.facet(S8).some((J)=>typeof J!="function"&&J.class=="cm-lineWrapping");this.heightOracle=new u$($),this.stateDeco=L2(Z),this.heightMap=h0.empty().applyChanges(this.stateDeco,i.empty,this.heightOracle.setDoc(Z.doc),[new t0(0,0,0,Z.doc.length)]);for(let J=0;J<2;J++)if(this.viewport=this.getViewport(0,null),!this.updateForViewport())break;this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=x.set(this.lineGaps.map((J)=>J.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let Z=[this.viewport],{main:$}=this.state.selection;for(let J=0;J<=1;J++){let K=J?$.head:$.anchor;if(!Z.some(({from:X,to:Q})=>K>=X&&K<=Q)){let{from:X,to:Q}=this.lineBlockAt(K);Z.push(new Q7(X,Q))}}return this.viewports=Z.sort((J,K)=>J.from-K.from),this.updateScaler()}updateScaler(){let Z=this.scaler;return this.scaler=this.heightMap.height<=7000000?A2:new m8(this.heightOracle,this.heightMap,this.viewports),Z.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(Z)=>{this.viewportLines.push(U7(Z,this.scaler))})}update(Z,$=null){this.state=Z.state;let J=this.stateDeco;this.stateDeco=L2(this.state);let K=Z.changedRanges,X=t0.extendWithRanges(K,zU(J,this.stateDeco,Z?Z.changes:R0.empty(this.state.doc.length))),Q=this.heightMap.height,U=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);if(F2(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,Z.startState.doc,this.heightOracle.setDoc(this.state.doc),X),this.heightMap.height!=Q||C5)Z.flags|=2;if(U)this.scrollAnchorPos=Z.changes.mapPos(U.from,-1),this.scrollAnchorHeight=U.top;else this.scrollAnchorPos=-1,this.scrollAnchorHeight=Q;let Y=X.length?this.mapViewport(this.viewport,Z.changes):this.viewport;if($&&($.range.head<Y.from||$.range.head>Y.to)||!this.viewportIsAppropriate(Y))Y=this.getViewport(0,$);let q=Y.from!=this.viewport.from||Y.to!=this.viewport.to;if(this.viewport=Y,Z.flags|=this.updateForViewport(),q||!Z.changes.empty||Z.flags&2)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>4000)this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,Z.changes)));if(Z.flags|=this.computeVisibleRanges(Z.changes),$)this.scrollTarget=$;if(!this.mustEnforceCursorAssoc&&(Z.selectionSet||Z.focusChanged)&&Z.view.lineWrapping&&Z.state.selection.main.empty&&Z.state.selection.main.assoc&&!Z.state.facet(U$))this.mustEnforceCursorAssoc=!0}measure(Z){let $=Z.contentDOM,J=window.getComputedStyle($),K=this.heightOracle,X=J.whiteSpace;this.defaultTextDirection=J.direction=="rtl"?J0.RTL:J0.LTR;let Q=this.heightOracle.mustRefreshForWrapping(X)||this.mustMeasureContent,U=$.getBoundingClientRect(),Y=Q||this.mustMeasureContent||this.contentDOMHeight!=U.height;this.contentDOMHeight=U.height,this.mustMeasureContent=!1;let q=0,G=0;if(U.width&&U.height){let{scaleX:L,scaleY:E}=p2($,U);if(L>0.005&&Math.abs(this.scaleX-L)>0.005||E>0.005&&Math.abs(this.scaleY-E)>0.005)this.scaleX=L,this.scaleY=E,q|=16,Q=Y=!0}let W=(parseInt(J.paddingTop)||0)*this.scaleY,j=(parseInt(J.paddingBottom)||0)*this.scaleY;if(this.paddingTop!=W||this.paddingBottom!=j)this.paddingTop=W,this.paddingBottom=j,q|=18;if(this.editorWidth!=Z.scrollDOM.clientWidth){if(K.lineWrapping)Y=!0;this.editorWidth=Z.scrollDOM.clientWidth,q|=16}let _=Z.scrollDOM.scrollTop*this.scaleY;if(this.scrollTop!=_)this.scrollAnchorHeight=-1,this.scrollTop=_;this.scrolledToBottom=c2(Z.scrollDOM);let z=(this.printing?HU:OU)($,this.paddingTop),V=z.top-this.pixelViewport.top,O=z.bottom-this.pixelViewport.bottom;this.pixelViewport=z;let N=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(N!=this.inView){if(this.inView=N,N)Y=!0}if(!this.inView&&!this.scrollTarget&&!VU(Z.dom))return 0;let R=U.width;if(this.contentDOMWidth!=R||this.editorHeight!=Z.scrollDOM.clientHeight)this.contentDOMWidth=U.width,this.editorHeight=Z.scrollDOM.clientHeight,q|=16;if(Y){let L=Z.docView.measureVisibleLineHeights(this.viewport);if(K.mustRefreshForHeights(L))Q=!0;if(Q||K.lineWrapping&&Math.abs(R-this.contentDOMWidth)>K.charWidth){let{lineHeight:E,charWidth:M,textHeight:S}=Z.docView.measureTextSize();if(Q=E>0&&K.refresh(X,E,M,S,Math.max(5,R/M),L),Q)Z.docView.minWidth=0,q|=16}if(V>0&&O>0)G=Math.max(V,O);else if(V<0&&O<0)G=Math.min(V,O);F2();for(let E of this.viewports){let M=E.from==this.viewport.from?L:Z.docView.measureVisibleLineHeights(E);this.heightMap=(Q?h0.empty().applyChanges(this.stateDeco,i.empty,this.heightOracle,[new t0(0,0,0,Z.state.doc.length)]):this.heightMap).updateHeight(K,0,Q,new f$(E.from,M))}if(C5)q|=2}let A=!this.viewportIsAppropriate(this.viewport,G)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);if(A){if(q&2)q|=this.updateScaler();this.viewport=this.getViewport(G,this.scrollTarget),q|=this.updateForViewport()}if(q&2||A)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>4000)this.updateLineGaps(this.ensureLineGaps(Q?[]:this.lineGaps,Z));if(q|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc)this.mustEnforceCursorAssoc=!1,Z.docView.enforceCursorAssoc();return q}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(Z,$){let J=0.5-Math.max(-0.5,Math.min(0.5,Z/1000/2)),K=this.heightMap,X=this.heightOracle,{visibleTop:Q,visibleBottom:U}=this,Y=new Q7(K.lineAt(Q-J*1000,Y0.ByHeight,X,0,0).from,K.lineAt(U+(1-J)*1000,Y0.ByHeight,X,0,0).to);if($){let{head:q}=$.range;if(q<Y.from||q>Y.to){let G=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),W=K.lineAt(q,Y0.ByPos,X,0,0),j;if($.y=="center")j=(W.top+W.bottom)/2-G/2;else if($.y=="start"||$.y=="nearest"&&q<Y.from)j=W.top;else j=W.bottom-G;Y=new Q7(K.lineAt(j-500,Y0.ByHeight,X,0,0).from,K.lineAt(j+G+500,Y0.ByHeight,X,0,0).to)}}return Y}mapViewport(Z,$){let J=$.mapPos(Z.from,-1),K=$.mapPos(Z.to,1);return new Q7(this.heightMap.lineAt(J,Y0.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(K,Y0.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:Z,to:$},J=0){if(!this.inView)return!0;let{top:K}=this.heightMap.lineAt(Z,Y0.ByPos,this.heightOracle,0,0),{bottom:X}=this.heightMap.lineAt($,Y0.ByPos,this.heightOracle,0,0),{visibleTop:Q,visibleBottom:U}=this;return(Z==0||K<=Q-Math.max(10,Math.min(-J,250)))&&($==this.state.doc.length||X>=U+Math.max(10,Math.min(J,250)))&&(K>Q-2000&&X<U+2000)}mapLineGaps(Z,$){if(!Z.length||$.empty)return Z;let J=[];for(let K of Z)if(!$.touchesRange(K.from,K.to))J.push(new V4($.mapPos(K.from),$.mapPos(K.to),K.size,K.displaySize));return J}ensureLineGaps(Z,$){let J=this.heightOracle.lineWrapping,K=J?1e4:2000,X=K>>1,Q=K<<1;if(this.defaultTextDirection!=J0.LTR&&!J)return[];let U=[],Y=(G,W,j,_)=>{if(W-G<X)return;let z=this.state.selection.main,V=[z.from];if(!z.empty)V.push(z.to);for(let N of V)if(N>G&&N<W){Y(G,N-10,j,_),Y(N+10,W,j,_);return}let O=IU(Z,(N)=>N.from>=j.from&&N.to<=j.to&&Math.abs(N.from-G)<X&&Math.abs(N.to-W)<X&&!V.some((R)=>N.from<R&&N.to>R));if(!O){if(W<j.to&&$&&J&&$.visibleRanges.some((A)=>A.from<=W&&A.to>=W)){let A=$.moveToLineBoundary(D.cursor(W),!1,!0).head;if(A>G)W=A}let N=this.gapSize(j,G,W,_),R=J||N<2000000?N:2000000;O=new V4(G,W,N,R)}U.push(O)},q=(G)=>{if(G.length<Q||G.type!=y0.Text)return;let W=NU(G.from,G.to,this.stateDeco);if(W.total<Q)return;let j=this.scrollTarget?this.scrollTarget.range.head:null,_,z;if(J){let V=K/this.heightOracle.lineLength*this.heightOracle.lineHeight,O,N;if(j!=null){let R=U4(W,j),A=((this.visibleBottom-this.visibleTop)/2+V)/G.height;O=R-A,N=R+A}else O=(this.visibleTop-G.top-V)/G.height,N=(this.visibleBottom-G.top+V)/G.height;_=Q4(W,O),z=Q4(W,N)}else{let V=W.total*this.heightOracle.charWidth,O=K*this.heightOracle.charWidth,N=0;if(V>2000000){for(let M of Z)if(M.from>=G.from&&M.from<G.to&&M.size!=M.displaySize&&M.from*this.heightOracle.charWidth+N<this.pixelViewport.left)N=M.size-M.displaySize}let R=this.pixelViewport.left+N,A=this.pixelViewport.right+N,L,E;if(j!=null){let M=U4(W,j),S=((A-R)/2+O)/V;L=M-S,E=M+S}else L=(R-O)/V,E=(A+O)/V;_=Q4(W,L),z=Q4(W,E)}if(_>G.from)Y(G.from,_,G,W);if(z<G.to)Y(z,G.to,G,W)};for(let G of this.viewportLines)if(Array.isArray(G.type))G.type.forEach(q);else q(G);return U}gapSize(Z,$,J,K){let X=U4(K,J)-U4(K,$);if(this.heightOracle.lineWrapping)return Z.height*X;else return K.total*this.heightOracle.charWidth*X}updateLineGaps(Z){if(!V4.same(Z,this.lineGaps))this.lineGaps=Z,this.lineGapDeco=x.set(Z.map(($)=>$.draw(this,this.heightOracle.lineWrapping)))}computeVisibleRanges(Z){let $=this.stateDeco;if(this.lineGaps.length)$=$.concat(this.lineGapDeco);let J=[];d.spans($,this.viewport.from,this.viewport.to,{span(X,Q){J.push({from:X,to:Q})},point(){}},20);let K=0;if(J.length!=this.visibleRanges.length)K=12;else for(let X=0;X<J.length&&!(K&8);X++){let Q=this.visibleRanges[X],U=J[X];if(Q.from!=U.from||Q.to!=U.to){if(K|=4,!(Z&&Z.mapPos(Q.from,-1)==U.from&&Z.mapPos(Q.to,1)==U.to))K|=8}}return this.visibleRanges=J,K}lineBlockAt(Z){return Z>=this.viewport.from&&Z<=this.viewport.to&&this.viewportLines.find(($)=>$.from<=Z&&$.to>=Z)||U7(this.heightMap.lineAt(Z,Y0.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(Z){return Z>=this.viewportLines[0].top&&Z<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(($)=>$.top<=Z&&$.bottom>=Z)||U7(this.heightMap.lineAt(this.scaler.fromDOM(Z),Y0.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(Z){let $=this.lineBlockAtHeight(Z+8);return $.from>=this.viewport.from||this.viewportLines[0].top-Z>200?$:this.viewportLines[0]}elementAtHeight(Z){return U7(this.heightMap.blockAt(this.scaler.fromDOM(Z),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Q7{constructor(Z,$){this.from=Z,this.to=$}}function NU(Z,$,J){let K=[],X=Z,Q=0;if(d.spans(J,Z,$,{span(){},point(U,Y){if(U>X)K.push({from:X,to:U}),Q+=U-X;X=Y}},20),X<$)K.push({from:X,to:$}),Q+=$-X;return{total:Q,ranges:K}}function Q4({total:Z,ranges:$},J){if(J<=0)return $[0].from;if(J>=1)return $[$.length-1].to;let K=Math.floor(Z*J);for(let X=0;;X++){let{from:Q,to:U}=$[X],Y=U-Q;if(K<=Y)return Q+K;K-=Y}}function U4(Z,$){let J=0;for(let{from:K,to:X}of Z.ranges){if($<=X){J+=$-K;break}J+=X-K}return J/Z.total}function IU(Z,$){for(let J of Z)if($(J))return J;return}var A2={toDOM(Z){return Z},fromDOM(Z){return Z},scale:1,eq(Z){return Z==this}};function L2(Z){let $=Z.facet(y4).filter((K)=>typeof K!="function"),J=Z.facet(b8).filter((K)=>typeof K!="function");if(J.length)$.push(d.join(J));return $}class m8{constructor(Z,$,J){let K=0,X=0,Q=0;this.viewports=J.map(({from:U,to:Y})=>{let q=$.lineAt(U,Y0.ByPos,Z,0,0).top,G=$.lineAt(Y,Y0.ByPos,Z,0,0).bottom;return K+=G-q,{from:U,to:Y,top:q,bottom:G,domTop:0,domBottom:0}}),this.scale=(7000000-K)/($.height-K);for(let U of this.viewports)U.domTop=Q+(U.top-X)*this.scale,Q=U.domBottom=U.domTop+(U.bottom-U.top),X=U.bottom}toDOM(Z){for(let $=0,J=0,K=0;;$++){let X=$<this.viewports.length?this.viewports[$]:null;if(!X||Z<X.top)return K+(Z-J)*this.scale;if(Z<=X.bottom)return X.domTop+(Z-X.top);J=X.bottom,K=X.domBottom}}fromDOM(Z){for(let $=0,J=0,K=0;;$++){let X=$<this.viewports.length?this.viewports[$]:null;if(!X||Z<X.domTop)return J+(Z-K)/this.scale;if(Z<=X.domBottom)return X.top+(Z-X.domTop);J=X.bottom,K=X.domBottom}}eq(Z){if(!(Z instanceof m8))return!1;return this.scale==Z.scale&&this.viewports.length==Z.viewports.length&&this.viewports.every(($,J)=>$.from==Z.viewports[J].from&&$.to==Z.viewports[J].to)}}function U7(Z,$){if($.scale==1)return Z;let J=$.toDOM(Z.top),K=$.toDOM(Z.bottom);return new O1(Z.from,Z.length,J,K-J,Array.isArray(Z._content)?Z._content.map((X)=>U7(X,$)):Z._content)}var Y4=C.define({combine:(Z)=>Z.join(" ")}),I8=C.define({combine:(Z)=>Z.indexOf(!0)>-1}),R8=_1.newName(),l$=_1.newName(),c$=_1.newName(),s$={"&light":"."+l$,"&dark":"."+c$};function F8(Z,$,J){return new _1($,{finish(K){return/&/.test(K)?K.replace(/&\w*/,(X)=>{if(X=="&")return Z;if(!J||!J[X])throw RangeError(`Unsupported selector: ${X}`);return J[X]}):Z+" "+K}})}var RU=F8("."+R8,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},s$),FU={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},o9=y.ie&&y.ie_version<=11;class n${constructor(Z){if(this.view=Z,this.active=!1,this.editContext=null,this.selectionRange=new d2,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=Z.contentDOM,this.observer=new MutationObserver(($)=>{for(let J of $)this.queue.push(J);if((y.ie&&y.ie_version<=11||y.ios&&Z.composing)&&$.some((J)=>J.type=="childList"&&J.removedNodes.length||J.type=="characterData"&&J.oldValue.length>J.target.nodeValue.length))this.flushSoon();else this.flush()}),window.EditContext&&y.android&&Z.constructor.EDIT_CONTEXT!==!1&&!(y.chrome&&y.chrome_version<126)){if(this.editContext=new i$(Z),Z.state.facet(b1))Z.contentDOM.editContext=this.editContext.editContext}if(o9)this.onCharData=($)=>{this.queue.push({target:$.target,type:"characterData",oldValue:$.prevValue}),this.flushSoon()};if(this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia)this.printQuery=window.matchMedia("print");if(typeof ResizeObserver=="function")this.resizeScroll=new ResizeObserver(()=>{var $;if((($=this.view.docView)===null||$===void 0?void 0:$.lastUpdate)<Date.now()-75)this.onResize()}),this.resizeScroll.observe(Z.scrollDOM);if(this.addWindowListeners(this.win=Z.win),this.start(),typeof IntersectionObserver=="function")this.intersection=new IntersectionObserver(($)=>{if(this.parentCheck<0)this.parentCheck=setTimeout(this.listenForScroll.bind(this),1000);if($.length>0&&$[$.length-1].intersectionRatio>0!=this.intersecting){if(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView)this.onScrollChanged(document.createEvent("Event"))}},{threshold:[0,0.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(($)=>{if($.length>0&&$[$.length-1].intersectionRatio>0)this.onScrollChanged(document.createEvent("Event"))},{});this.listenForScroll(),this.readSelectionRange()}onScrollChanged(Z){if(this.view.inputState.runHandlers("scroll",Z),this.intersecting)this.view.measure()}onScroll(Z){if(this.intersecting)this.flush(!1);if(this.editContext)this.view.requestMeasure(this.editContext.measureReq);this.onScrollChanged(Z)}onResize(){if(this.resizeTimeout<0)this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50)}onPrint(Z){if((Z.type=="change"||!Z.type)&&!Z.matches)return;this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(Z){if(this.gapIntersection&&(Z.length!=this.gaps.length||this.gaps.some(($,J)=>$!=Z[J]))){this.gapIntersection.disconnect();for(let $ of Z)this.gapIntersection.observe($);this.gaps=Z}}onSelectionChange(Z){let $=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:J}=this,K=this.selectionRange;if(J.state.facet(b1)?J.root.activeElement!=this.dom:!G7(this.dom,K))return;let X=K.anchorNode&&J.docView.tile.nearest(K.anchorNode);if(X&&X.isWidget()&&X.widget.ignoreEvent(Z)){if(!$)this.selectionChanged=!1;return}if((y.ie&&y.ie_version<=11||y.android&&y.chrome)&&!J.state.selection.main.empty&&K.focusNode&&W7(K.focusNode,K.focusOffset,K.anchorNode,K.anchorOffset))this.flushSoon();else this.flush(!1)}readSelectionRange(){let{view:Z}=this,$=E5(Z.root);if(!$)return!1;let J=y.safari&&Z.root.nodeType==11&&Z.root.activeElement==this.dom&&DU(this.view,$)||$;if(!J||this.selectionRange.eq(J))return!1;let K=G7(this.dom,J);if(K&&!this.selectionChanged&&Z.inputState.lastFocusTime>Date.now()-200&&Z.inputState.lastTouchTime<Date.now()-300&&HQ(this.dom,J))return this.view.inputState.lastFocusTime=0,Z.docView.updateSelection(),!1;if(this.selectionRange.setRange(J),K)this.selectionChanged=!0;return!0}setSelectionRange(Z,$){this.selectionRange.set(Z.node,Z.offset,$.node,$.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let Z=0,$=null;for(let J=this.dom;J;)if(J.nodeType==1){if(!$&&Z<this.scrollTargets.length&&this.scrollTargets[Z]==J)Z++;else if(!$)$=this.scrollTargets.slice(0,Z);if($)$.push(J);J=J.assignedSlot||J.parentNode}else if(J.nodeType==11)J=J.host;else break;if(Z<this.scrollTargets.length&&!$)$=this.scrollTargets.slice(0,Z);if($){for(let J of this.scrollTargets)J.removeEventListener("scroll",this.onScroll);for(let J of this.scrollTargets=$)J.addEventListener("scroll",this.onScroll)}}ignore(Z){if(!this.active)return Z();try{return this.stop(),Z()}finally{this.start(),this.clear()}}start(){if(this.active)return;if(this.observer.observe(this.dom,FU),o9)this.dom.addEventListener("DOMCharacterDataModified",this.onCharData);this.active=!0}stop(){if(!this.active)return;if(this.active=!1,this.observer.disconnect(),o9)this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData)}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(Z,$){var J;if(!this.delayedAndroidKey){let K=()=>{let X=this.delayedAndroidKey;if(X){if(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=X.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&X.force)M5(this.dom,X.key,X.keyCode)}};this.flushingAndroidKey=this.view.win.requestAnimationFrame(K)}if(!this.delayedAndroidKey||Z=="Enter")this.delayedAndroidKey={key:Z,keyCode:$,force:this.lastChange<Date.now()-50||!!((J=this.delayedAndroidKey)===null||J===void 0?void 0:J.force)}}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){if(this.delayedFlush<0)this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()})}forceFlush(){if(this.delayedFlush>=0)this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1;this.flush()}pendingRecords(){for(let Z of this.observer.takeRecords())this.queue.push(Z);return this.queue}processRecords(){let Z=this.pendingRecords();if(Z.length)this.queue=[];let $=-1,J=-1,K=!1;for(let X of Z){let Q=this.readMutation(X);if(!Q)continue;if(Q.typeOver)K=!0;if($==-1)({from:$,to:J}=Q);else $=Math.min(Q.from,$),J=Math.max(Q.to,J)}return{from:$,to:J,typeOver:K}}readChange(){let{from:Z,to:$,typeOver:J}=this.processRecords(),K=this.selectionChanged&&G7(this.dom,this.selectionRange);if(Z<0&&!K)return null;if(Z>-1)this.lastChange=Date.now();this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let X=new B$(this.view,Z,$,J);return this.view.docView.domChanged={newSel:X.newSel?X.newSel.main:null},X}flush(Z=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;if(Z)this.readSelectionRange();let $=this.readChange();if(!$)return this.view.requestMeasure(),!1;let J=this.view.state,K=P$(this.view,$);if(this.view.state==J&&($.domChanged||$.newSel&&!B4(this.view.state.selection,$.newSel.main)))this.view.update([]);return K}readMutation(Z){let $=this.view.docView.tile.nearest(Z.target);if(!$||$.isWidget())return null;if($.markDirty(Z.type=="attributes"),Z.type=="childList"){let J=M2($,Z.previousSibling||Z.target.previousSibling,-1),K=M2($,Z.nextSibling||Z.target.nextSibling,1);return{from:J?$.posAfter(J):$.posAtStart,to:K?$.posBefore(K):$.posAtEnd,typeOver:!1}}else if(Z.type=="characterData")return{from:$.posAtStart,to:$.posAtEnd,typeOver:Z.target.nodeValue==Z.oldValue};else return null}setWindow(Z){if(Z!=this.win)this.removeWindowListeners(this.win),this.win=Z,this.addWindowListeners(this.win)}addWindowListeners(Z){if(Z.addEventListener("resize",this.onResize),this.printQuery)if(this.printQuery.addEventListener)this.printQuery.addEventListener("change",this.onPrint);else this.printQuery.addListener(this.onPrint);else Z.addEventListener("beforeprint",this.onPrint);Z.addEventListener("scroll",this.onScroll),Z.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(Z){if(Z.removeEventListener("scroll",this.onScroll),Z.removeEventListener("resize",this.onResize),this.printQuery)if(this.printQuery.removeEventListener)this.printQuery.removeEventListener("change",this.onPrint);else this.printQuery.removeListener(this.onPrint);else Z.removeEventListener("beforeprint",this.onPrint);Z.document.removeEventListener("selectionchange",this.onSelectionChange)}update(Z){if(this.editContext){if(this.editContext.update(Z),Z.startState.facet(b1)!=Z.state.facet(b1))Z.view.contentDOM.editContext=Z.state.facet(b1)?this.editContext.editContext:null}}destroy(){var Z,$,J;this.stop(),(Z=this.intersection)===null||Z===void 0||Z.disconnect(),($=this.gapIntersection)===null||$===void 0||$.disconnect(),(J=this.resizeScroll)===null||J===void 0||J.disconnect();for(let K of this.scrollTargets)K.removeEventListener("scroll",this.onScroll);if(this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext)this.view.contentDOM.editContext=null,this.editContext.destroy()}}function M2(Z,$,J){while($){let K=F0.get($);if(K&&K.parent==Z)return K;let X=$.parentNode;$=X!=Z.dom?X:J>0?$.nextSibling:$.previousSibling}return null}function B2(Z,$){let{startContainer:J,startOffset:K,endContainer:X,endOffset:Q}=$,U=Z.docView.domAtPos(Z.state.selection.main.anchor,1);if(W7(U.node,U.offset,X,Q))[J,K,X,Q]=[X,Q,J,K];return{anchorNode:J,anchorOffset:K,focusNode:X,focusOffset:Q}}function DU(Z,$){if($.getComposedRanges){let X=$.getComposedRanges(Z.root)[0];if(X)return B2(Z,X)}let J=null;function K(X){X.preventDefault(),X.stopImmediatePropagation(),J=X.getTargetRanges()[0]}return Z.contentDOM.addEventListener("beforeinput",K,!0),Z.dom.ownerDocument.execCommand("indent"),Z.contentDOM.removeEventListener("beforeinput",K,!0),J?B2(Z,J):null}class i${constructor(Z){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(Z.state);let $=this.editContext=new window.EditContext({text:Z.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,Z.state.selection.main.anchor))),selectionEnd:this.toContextPos(Z.state.selection.main.head)});this.handlers.textupdate=(J)=>{let K=Z.state.selection.main,{anchor:X,head:Q}=K,U=this.toEditorPos(J.updateRangeStart),Y=this.toEditorPos(J.updateRangeEnd);if(Z.inputState.composing>=0&&!this.composing)this.composing={contextBase:J.updateRangeStart,editorBase:U,drifted:!1};let q=Y-U>J.text.length;if(U==this.from&&X<this.from)U=X;else if(Y==this.to&&X>this.to)Y=X;let G=C$(Z.state.sliceDoc(U,Y),J.text,(q?K.from:K.to)-U,q?"end":null);if(!G){let j=D.single(this.toEditorPos(J.selectionStart),this.toEditorPos(J.selectionEnd));if(!B4(j,K))Z.dispatch({selection:j,userEvent:"select"});return}let W={from:G.from+U,to:G.toA+U,insert:i.of(J.text.slice(G.from,G.toB).split(`
`))};if((y.mac||y.android)&&W.from==Q-1&&/^\. ?$/.test(J.text)&&Z.contentDOM.getAttribute("autocorrect")=="off")W={from:U,to:Y,insert:i.of([J.text.replace("."," ")])};if(this.pendingContextChange=W,!Z.state.readOnly){let j=this.to-this.from+(W.to-W.from+W.insert.length);w8(Z,W,D.single(this.toEditorPos(J.selectionStart,j),this.toEditorPos(J.selectionEnd,j)))}if(this.pendingContextChange)this.revertPending(Z.state),this.setSelection(Z.state);if(W.from<W.to&&!W.insert.length&&Z.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test($.text.slice(Math.max(0,J.updateRangeStart-1),Math.min($.text.length,J.updateRangeStart+1))))this.handlers.compositionend(J)},this.handlers.characterboundsupdate=(J)=>{let K=[],X=null;for(let Q=this.toEditorPos(J.rangeStart),U=this.toEditorPos(J.rangeEnd);Q<U;Q++){let Y=Z.coordsForChar(Q);X=Y&&new DOMRect(Y.left,Y.top,Y.right-Y.left,Y.bottom-Y.top)||X||new DOMRect,K.push(X)}$.updateCharacterBounds(J.rangeStart,K)},this.handlers.textformatupdate=(J)=>{let K=[];for(let X of J.getTextFormats()){let{underlineStyle:Q,underlineThickness:U}=X;if(!/none/i.test(Q)&&!/none/i.test(U)){let Y=this.toEditorPos(X.rangeStart),q=this.toEditorPos(X.rangeEnd);if(Y<q){let G=`text-decoration: underline ${/^[a-z]/.test(Q)?Q+" ":Q=="Dashed"?"dashed ":Q=="Squiggle"?"wavy ":""}${/thin/i.test(U)?1:2}px`;K.push(x.mark({attributes:{style:G}}).range(Y,q))}}}Z.dispatch({effects:q$.of(x.set(K))})},this.handlers.compositionstart=()=>{if(Z.inputState.composing<0)Z.inputState.composing=0,Z.inputState.compositionFirstChange=!0},this.handlers.compositionend=()=>{if(Z.inputState.composing=-1,Z.inputState.compositionFirstChange=null,this.composing){let{drifted:J}=this.composing;if(this.composing=null,J)this.reset(Z.state)}};for(let J in this.handlers)$.addEventListener(J,this.handlers[J]);this.measureReq={read:(J)=>{this.editContext.updateControlBounds(J.contentDOM.getBoundingClientRect());let K=E5(J.root);if(K&&K.rangeCount)this.editContext.updateSelectionBounds(K.getRangeAt(0).getBoundingClientRect())}}}applyEdits(Z){let $=0,J=!1,K=this.pendingContextChange;if(Z.changes.iterChanges((X,Q,U,Y,q)=>{if(J)return;let G=q.length-(Q-X);if(K&&Q>=K.to)if(K.from==X&&K.to==Q&&K.insert.eq(q)){K=this.pendingContextChange=null,$+=G,this.to+=G;return}else K=null,this.revertPending(Z.state);if(X+=$,Q+=$,Q<=this.from)this.from+=G,this.to+=G;else if(X<this.to){if(X<this.from||Q>this.to||this.to-this.from+q.length>30000){J=!0;return}this.editContext.updateText(this.toContextPos(X),this.toContextPos(Q),q.toString()),this.to+=G}$+=G}),K&&!J)this.revertPending(Z.state);return!J}update(Z){let $=this.pendingContextChange,J=Z.startState.selection.main;if(this.composing&&(this.composing.drifted||!Z.changes.touchesRange(J.from,J.to)&&Z.transactions.some((K)=>!K.isUserEvent("input.type")&&K.changes.touchesRange(this.from,this.to))))this.composing.drifted=!0,this.composing.editorBase=Z.changes.mapPos(this.composing.editorBase);else if(!this.applyEdits(Z)||!this.rangeIsValid(Z.state))this.pendingContextChange=null,this.reset(Z.state);else if(Z.docChanged||Z.selectionSet||$)this.setSelection(Z.state);if(Z.geometryChanged||Z.docChanged||Z.selectionSet)Z.view.requestMeasure(this.measureReq)}resetRange(Z){let{head:$}=Z.selection.main;this.from=Math.max(0,$-1e4),this.to=Math.min(Z.doc.length,$+1e4)}reset(Z){this.resetRange(Z),this.editContext.updateText(0,this.editContext.text.length,Z.doc.sliceString(this.from,this.to)),this.setSelection(Z)}revertPending(Z){let $=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos($.from),this.toContextPos($.from+$.insert.length),Z.doc.sliceString($.from,$.to))}setSelection(Z){let{main:$}=Z.selection,J=this.toContextPos(Math.max(this.from,Math.min(this.to,$.anchor))),K=this.toContextPos($.head);if(this.editContext.selectionStart!=J||this.editContext.selectionEnd!=K)this.editContext.updateSelection(J,K)}rangeIsValid(Z){let{head:$}=Z.selection.main;return!(this.from>0&&$-this.from<500||this.to<Z.doc.length&&this.to-$<500||this.to-this.from>30000)}toEditorPos(Z,$=this.to-this.from){Z=Math.min(Z,$);let J=this.composing;return J&&J.drifted?J.editorBase+(Z-J.contextBase):Z+this.from}toContextPos(Z){let $=this.composing;return $&&$.drifted?$.contextBase+(Z-$.editorBase):Z-this.from}destroy(){for(let Z in this.handlers)this.editContext.removeEventListener(Z,this.handlers[Z])}}class B{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(Z={}){var $;if(this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),Z.parent)Z.parent.appendChild(this.dom);let{dispatch:J}=Z;if(this.dispatchTransactions=Z.dispatchTransactions||J&&((K)=>K.forEach((X)=>J(X,this)))||((K)=>this.update(K)),this.dispatch=this.dispatch.bind(this),this._root=Z.root||VQ(Z.parent)||document,this.viewState=new N8(Z.state||p.create(Z)),Z.scrollTo&&Z.scrollTo.is(J4))this.viewState.scrollTarget=Z.scrollTo.value.clip(this.viewState.state);this.plugins=this.state.facet(D5).map((K)=>new _4(K));for(let K of this.plugins)K.update(this);if(this.observer=new n$(this),this.inputState=new T$(this),this.inputState.ensureHandlers(this.plugins),this.docView=new j8(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),($=document.fonts)===null||$===void 0?void 0:$.ready)document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...Z){let $=Z.length==1&&Z[0]instanceof V0?Z:Z.length==1&&Array.isArray(Z[0])?Z[0]:[this.state.update(...Z)];this.dispatchTransactions($,this)}update(Z){if(this.updateState!=0)throw Error("Calls to EditorView.update are not allowed while an update is in progress");let $=!1,J=!1,K,X=this.state;for(let j of Z){if(j.startState!=X)throw RangeError("Trying to update state with a transaction that doesn't start from the previous state.");X=j.state}if(this.destroyed){this.viewState.state=X;return}let Q=this.hasFocus,U=0,Y=null;if(Z.some((j)=>j.annotation(h$)))this.inputState.notifiedFocused=Q,U=1;else if(Q!=this.inputState.notifiedFocused){if(this.inputState.notifiedFocused=Q,Y=v$(X,Q),!Y)U=1}let q=this.observer.delayedAndroidKey,G=null;if(q){if(this.observer.clearDelayedAndroidKey(),G=this.observer.readChange(),G&&!this.state.doc.eq(X.doc)||!this.state.selection.eq(X.selection))G=null}else this.observer.clear();if(X.facet(p.phrases)!=this.state.facet(p.phrases))return this.setState(X);K=L4.create(this,X,Z),K.flags|=U;let W=this.viewState.scrollTarget;try{this.updateState=2;for(let j of Z){if(W)W=W.map(j.changes);if(j.scrollIntoView){let{main:_}=j.state.selection;W=new B5(_.empty?_:D.cursor(_.head,_.head>_.anchor?-1:1))}for(let _ of j.effects)if(_.is(J4))W=_.value.clip(this.state)}if(this.viewState.update(K,W),this.bidiCache=P4.update(this.bidiCache,K.changes),!K.empty)this.updatePlugins(K),this.inputState.update(K);if($=this.docView.update(K),this.state.facet(K7)!=this.styleModules)this.mountStyles();J=this.updateAttrs(),this.showAnnouncements(Z),this.docView.updateSelection($,Z.some((j)=>j.isUserEvent("select.pointer")))}finally{this.updateState=0}if(K.startState.facet(Y4)!=K.state.facet(Y4))this.viewState.mustMeasureContent=!0;if($||J||W||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)this.requestMeasure();if($)this.docViewUpdate();if(!K.empty)for(let j of this.state.facet(W8))try{j(K)}catch(_){T0(this.state,_,"update listener")}if(Y||G)Promise.resolve().then(()=>{if(Y&&this.state==Y.startState)this.dispatch(Y);if(G){if(!P$(this,G)&&q.force)M5(this.contentDOM,q.key,q.keyCode)}})}setState(Z){if(this.updateState!=0)throw Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=Z;return}this.updateState=2;let $=this.hasFocus;try{for(let J of this.plugins)J.destroy(this);this.viewState=new N8(Z),this.plugins=Z.facet(D5).map((J)=>new _4(J)),this.pluginMap.clear();for(let J of this.plugins)J.update(this);this.docView.destroy(),this.docView=new j8(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}if($)this.focus();this.requestMeasure()}updatePlugins(Z){let $=Z.startState.facet(D5),J=Z.state.facet(D5);if($!=J){let K=[];for(let X of J){let Q=$.indexOf(X);if(Q<0)K.push(new _4(X));else{let U=this.plugins[Q];U.mustUpdate=Z,K.push(U)}}for(let X of this.plugins)if(X.mustUpdate!=Z)X.destroy(this);this.plugins=K,this.pluginMap.clear()}else for(let K of this.plugins)K.mustUpdate=Z;for(let K=0;K<this.plugins.length;K++)this.plugins[K].update(this);if($!=J)this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let Z of this.plugins){let $=Z.value;if($&&$.docViewUpdate)try{$.docViewUpdate(this)}catch(J){T0(this.state,J,"doc view update listener")}}}measure(Z=!0){if(this.destroyed)return;if(this.measureScheduled>-1)this.win.cancelAnimationFrame(this.measureScheduled);if(this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}if(this.measureScheduled=0,Z)this.observer.forceFlush();let $=null,J=this.scrollDOM,K=J.scrollTop*this.scaleY,{scrollAnchorPos:X,scrollAnchorHeight:Q}=this.viewState;if(Math.abs(K-this.viewState.scrollTop)>1)Q=-1;this.viewState.scrollAnchorHeight=-1;try{for(let U=0;;U++){if(Q<0)if(c2(J))X=-1,Q=this.viewState.heightMap.height;else{let _=this.viewState.scrollAnchorAt(K);X=_.from,Q=_.top}this.updateState=1;let Y=this.viewState.measure(this);if(!Y&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(U>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let q=[];if(!(Y&4))[this.measureRequests,q]=[q,this.measureRequests];let G=q.map((_)=>{try{return _.read(this)}catch(z){return T0(this.state,z),E2}}),W=L4.create(this,this.state,[]),j=!1;if(W.flags|=Y,!$)$=W;else $.flags|=Y;if(this.updateState=2,!W.empty){if(this.updatePlugins(W),this.inputState.update(W),this.updateAttrs(),j=this.docView.update(W),j)this.docViewUpdate()}for(let _=0;_<q.length;_++)if(G[_]!=E2)try{let z=q[_];if(z.write)z.write(G[_],this)}catch(z){T0(this.state,z)}if(j)this.docView.updateSelection(!0);if(!W.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,Q=-1;continue}else{let z=(X<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(X).top)-Q;if(z>1||z<-1){K=K+z,J.scrollTop=K/this.scaleY,Q=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if($&&!$.empty)for(let U of this.state.facet(W8))U($)}get themeClasses(){return R8+" "+(this.state.facet(I8)?c$:l$)+" "+this.state.facet(Y4)}updateAttrs(){let Z=P2(this,G$,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),$={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:!this.state.facet(b1)?"false":"true",class:"cm-content",style:`${y.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};if(this.state.readOnly)$["aria-readonly"]="true";P2(this,S8,$);let J=this.observer.ignore(()=>{let K=X2(this.contentDOM,this.contentAttrs,$),X=X2(this.dom,this.editorAttrs,Z);return K||X});return this.editorAttrs=Z,this.contentAttrs=$,J}showAnnouncements(Z){let $=!0;for(let J of Z)for(let K of J.effects)if(K.is(B.announce)){if($)this.announceDOM.textContent="";$=!1;let X=this.announceDOM.appendChild(document.createElement("div"));X.textContent=K.value}}mountStyles(){this.styleModules=this.state.facet(K7);let Z=this.state.facet(B.cspNonce);_1.mount(this.root,this.styleModules.concat(RU).reverse(),Z?{nonce:Z}:void 0)}readMeasured(){if(this.updateState==2)throw Error("Reading the editor layout isn't allowed during an update");if(this.updateState==0&&this.measureScheduled>-1)this.measure(!1)}requestMeasure(Z){if(this.measureScheduled<0)this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure());if(Z){if(this.measureRequests.indexOf(Z)>-1)return;if(Z.key!=null){for(let $=0;$<this.measureRequests.length;$++)if(this.measureRequests[$].key===Z.key){this.measureRequests[$]=Z;return}}this.measureRequests.push(Z)}}plugin(Z){let $=this.pluginMap.get(Z);if($===void 0||$&&$.plugin!=Z)this.pluginMap.set(Z,$=this.plugins.find((J)=>J.plugin==Z)||null);return $&&$.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(Z){return this.readMeasured(),this.viewState.elementAtHeight(Z)}lineBlockAtHeight(Z){return this.readMeasured(),this.viewState.lineBlockAtHeight(Z)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(Z){return this.viewState.lineBlockAt(Z)}get contentHeight(){return this.viewState.contentHeight}moveByChar(Z,$,J){return r9(this,Z,W2(this,Z,$,J))}moveByGroup(Z,$){return r9(this,Z,W2(this,Z,$,(J)=>lQ(this,Z.head,J)))}visualLineSide(Z,$){let J=this.bidiSpans(Z),K=this.textDirectionAt(Z.from),X=J[$?J.length-1:0];return D.cursor(X.side($,K)+Z.from,X.forward(!$,K)?1:-1)}moveToLineBoundary(Z,$,J=!0){return dQ(this,Z,$,J)}moveVertically(Z,$,J){return r9(this,Z,cQ(this,Z,$,J))}domAtPos(Z,$=1){return this.docView.domAtPos(Z,$)}posAtDOM(Z,$=0){return this.docView.posFromDOM(Z,$)}posAtCoords(Z,$=!0){this.readMeasured();let J=O8(this,Z,$);return J&&J.pos}posAndSideAtCoords(Z,$=!0){return this.readMeasured(),O8(this,Z,$)}coordsAtPos(Z,$=1){this.readMeasured();let J=this.docView.coordsAt(Z,$);if(!J||J.left==J.right)return J;let K=this.state.doc.lineAt(Z),X=this.bidiSpans(K),Q=X[B1.find(X,Z-K.from,-1,$)];return A4(J,Q.dir==J0.LTR==$>0)}coordsForChar(Z){return this.readMeasured(),this.docView.coordsForChar(Z)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(Z){if(!this.state.facet(Q$)||Z<this.viewport.from||Z>this.viewport.to)return this.textDirection;return this.readMeasured(),this.docView.textDirectionAt(Z)}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(Z){if(Z.length>AU)return o2(Z.length);let $=this.textDirectionAt(Z.from),J;for(let X of this.bidiCache)if(X.from==Z.from&&X.dir==$&&(X.fresh||r2(X.isolates,J=Y2(this,Z))))return X.order;if(!J)J=Y2(this,Z);let K=LQ(Z.text,$,J);return this.bidiCache.push(new P4(Z.from,Z.to,$,J,!0,K)),K}get hasFocus(){var Z;return(this.dom.ownerDocument.hasFocus()||y.safari&&((Z=this.inputState)===null||Z===void 0?void 0:Z.lastContextMenu)>Date.now()-30000)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{l2(this.contentDOM),this.docView.updateSelection()})}setRoot(Z){if(this._root!=Z)this._root=Z,this.observer.setWindow((Z.nodeType==9?Z:Z.ownerDocument).defaultView||window),this.mountStyles()}destroy(){if(this.root.activeElement==this.contentDOM)this.contentDOM.blur();for(let Z of this.plugins)Z.destroy(this);if(this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1)this.win.cancelAnimationFrame(this.measureScheduled);this.destroyed=!0}static scrollIntoView(Z,$={}){return J4.of(new B5(typeof Z=="number"?D.cursor(Z):Z,$.y,$.x,$.yMargin,$.xMargin))}scrollSnapshot(){let{scrollTop:Z,scrollLeft:$}=this.scrollDOM,J=this.viewState.scrollAnchorAt(Z);return J4.of(new B5(D.cursor(J.from),"start","start",J.top-Z,$,!0))}setTabFocusMode(Z){if(Z==null)this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1;else if(typeof Z=="boolean")this.inputState.tabFocusMode=Z?0:-1;else if(this.inputState.tabFocusMode!=0)this.inputState.tabFocusMode=Date.now()+Z}static domEventHandlers(Z){return W0.define(()=>({}),{eventHandlers:Z})}static domEventObservers(Z){return W0.define(()=>({}),{eventObservers:Z})}static theme(Z,$){let J=_1.newName(),K=[Y4.of(J),K7.of(F8(`.${J}`,Z))];if($&&$.dark)K.push(I8.of(!0));return K}static baseTheme(Z){return j1.lowest(K7.of(F8("."+R8,Z,s$)))}static findFromDOM(Z){var $;let J=Z.querySelector(".cm-content"),K=J&&F0.get(J)||F0.get(Z);return(($=K===null||K===void 0?void 0:K.root)===null||$===void 0?void 0:$.view)||null}}B.styleModule=K7;B.inputHandler=K$;B.clipboardInputFilter=y8;B.clipboardOutputFilter=k8;B.scrollHandler=Y$;B.focusChangeEffect=X$;B.perLineTextDirection=Q$;B.exceptionSink=J$;B.updateListener=W8;B.editable=b1;B.mouseSelectionStyle=$$;B.dragMovesSelection=Z$;B.clickAddsSelectionRange=e2;B.decorations=y4;B.blockWrappers=W$;B.outerDecorations=b8;B.atomicRanges=R7;B.bidiIsolatedRanges=j$;B.scrollMargins=_$;B.darkTheme=I8;B.cspNonce=C.define({combine:(Z)=>Z.length?Z[0]:""});B.contentAttributes=S8;B.editorAttributes=G$;B.lineWrapping=B.contentAttributes.of({class:"cm-lineWrapping"});B.announce=v.define();var AU=4096,E2={};class P4{constructor(Z,$,J,K,X,Q){this.from=Z,this.to=$,this.dir=J,this.isolates=K,this.fresh=X,this.order=Q}static update(Z,$){if($.empty&&!Z.some((X)=>X.fresh))return Z;let J=[],K=Z.length?Z[Z.length-1].dir:J0.LTR;for(let X=Math.max(0,Z.length-10);X<Z.length;X++){let Q=Z[X];if(Q.dir==K&&!$.touchesRange(Q.from,Q.to))J.push(new P4($.mapPos(Q.from,1),$.mapPos(Q.to,-1),Q.dir,Q.isolates,!1,Q.order))}return J}}function P2(Z,$,J){for(let K=Z.state.facet($),X=K.length-1;X>=0;X--){let Q=K[X],U=typeof Q=="function"?Q(Z):Q;if(U)P8(U,J)}return J}var LU=y.mac?"mac":y.windows?"win":y.linux?"linux":"key";function MU(Z,$){let J=Z.split(/-(?!$)/),K=J[J.length-1];if(K=="Space")K=" ";let X,Q,U,Y;for(let q=0;q<J.length-1;++q){let G=J[q];if(/^(cmd|meta|m)$/i.test(G))Y=!0;else if(/^a(lt)?$/i.test(G))X=!0;else if(/^(c|ctrl|control)$/i.test(G))Q=!0;else if(/^s(hift)?$/i.test(G))U=!0;else if(/^mod$/i.test(G))if($=="mac")Y=!0;else Q=!0;else throw Error("Unrecognized modifier name: "+G)}if(X)K="Alt-"+K;if(Q)K="Ctrl-"+K;if(Y)K="Meta-"+K;if(U)K="Shift-"+K;return K}function q4(Z,$,J){if($.altKey)Z="Alt-"+Z;if($.ctrlKey)Z="Ctrl-"+Z;if($.metaKey)Z="Meta-"+Z;if(J!==!1&&$.shiftKey)Z="Shift-"+Z;return Z}var BU=j1.default(B.domEventHandlers({keydown(Z,$){return o$(a$($.state),Z,$,"editor")}})),A7=C.define({enables:BU}),C2=new WeakMap;function a$(Z){let $=Z.facet(A7),J=C2.get($);if(!J)C2.set($,J=PU($.reduce((K,X)=>K.concat(X),[])));return J}function r$(Z,$,J){return o$(a$(Z.state),$,Z,J)}var m1=null,EU=4000;function PU(Z,$=LU){let J=Object.create(null),K=Object.create(null),X=(U,Y)=>{let q=K[U];if(q==null)K[U]=Y;else if(q!=Y)throw Error("Key binding "+U+" is used both as a regular binding and as a multi-stroke prefix")},Q=(U,Y,q,G,W)=>{var j,_;let z=J[U]||(J[U]=Object.create(null)),V=Y.split(/ (?!$)/).map((R)=>MU(R,$));for(let R=1;R<V.length;R++){let A=V.slice(0,R).join(" ");if(X(A,!0),!z[A])z[A]={preventDefault:!0,stopPropagation:!1,run:[(L)=>{let E=m1={view:L,prefix:A,scope:U};return setTimeout(()=>{if(m1==E)m1=null},EU),!0}]}}let O=V.join(" ");X(O,!1);let N=z[O]||(z[O]={preventDefault:!1,stopPropagation:!1,run:((_=(j=z._any)===null||j===void 0?void 0:j.run)===null||_===void 0?void 0:_.slice())||[]});if(q)N.run.push(q);if(G)N.preventDefault=!0;if(W)N.stopPropagation=!0};for(let U of Z){let Y=U.scope?U.scope.split(" "):["editor"];if(U.any)for(let G of Y){let W=J[G]||(J[G]=Object.create(null));if(!W._any)W._any={preventDefault:!1,stopPropagation:!1,run:[]};let{any:j}=U;for(let _ in W)W[_].run.push((z)=>j(z,D8))}let q=U[$]||U.key;if(!q)continue;for(let G of Y)if(Q(G,q,U.run,U.preventDefault,U.stopPropagation),U.shift)Q(G,"Shift-"+q,U.shift,U.preventDefault,U.stopPropagation)}return J}var D8=null;function o$(Z,$,J,K){D8=$;let X=e6($),Q=P0(X,0),U=c0(Q)==X.length&&X!=" ",Y="",q=!1,G=!1,W=!1;if(m1&&m1.view==J&&m1.scope==K){if(Y=m1.prefix+" ",k$.indexOf($.keyCode)<0)G=!0,m1=null}let j=new Set,_=(N)=>{if(N){for(let R of N.run)if(!j.has(R)){if(j.add(R),R(J)){if(N.stopPropagation)W=!0;return!0}}if(N.preventDefault){if(N.stopPropagation)W=!0;G=!0}}return!1},z=Z[K],V,O;if(z){if(_(z[Y+q4(X,$,!U)]))q=!0;else if(U&&($.altKey||$.metaKey||$.ctrlKey)&&!(y.windows&&$.ctrlKey&&$.altKey)&&!(y.mac&&$.altKey&&!($.ctrlKey||$.metaKey))&&(V=S1[$.keyCode])&&V!=X){if(_(z[Y+q4(V,$,!0)]))q=!0;else if($.shiftKey&&(O=F5[$.keyCode])!=X&&O!=V&&_(z[Y+q4(O,$,!1)]))q=!0}else if(U&&$.shiftKey&&_(z[Y+q4(X,$,!0)]))q=!0;if(!q&&_(z._any))q=!0}if(G)q=!0;if(q&&W)$.stopPropagation();return D8=null,q}class L7{constructor(Z,$,J,K,X){this.className=Z,this.left=$,this.top=J,this.width=K,this.height=X}draw(){let Z=document.createElement("div");return Z.className=this.className,this.adjust(Z),Z}update(Z,$){if($.className!=this.className)return!1;return this.adjust(Z),!0}adjust(Z){if(Z.style.left=this.left+"px",Z.style.top=this.top+"px",this.width!=null)Z.style.width=this.width+"px";Z.style.height=this.height+"px"}eq(Z){return this.left==Z.left&&this.top==Z.top&&this.width==Z.width&&this.height==Z.height&&this.className==Z.className}static forRange(Z,$,J){if(J.empty){let K=Z.coordsAtPos(J.head,J.assoc||1);if(!K)return[];let X=t$(Z);return[new L7($,K.left-X.left,K.top-X.top,null,K.bottom-K.top)]}else return CU(Z,$,J)}}function t$(Z){let $=Z.scrollDOM.getBoundingClientRect();return{left:(Z.textDirection==J0.LTR?$.left:$.right-Z.scrollDOM.clientWidth*Z.scaleX)-Z.scrollDOM.scrollLeft*Z.scaleX,top:$.top-Z.scrollDOM.scrollTop*Z.scaleY}}function T2(Z,$,J,K){let X=Z.coordsAtPos($,J*2);if(!X)return K;let Q=Z.dom.getBoundingClientRect(),U=(X.top+X.bottom)/2,Y=Z.posAtCoords({x:Q.left+1,y:U}),q=Z.posAtCoords({x:Q.right-1,y:U});if(Y==null||q==null)return K;return{from:Math.max(K.from,Math.min(Y,q)),to:Math.min(K.to,Math.max(Y,q))}}function CU(Z,$,J){if(J.to<=Z.viewport.from||J.from>=Z.viewport.to)return[];let K=Math.max(J.from,Z.viewport.from),X=Math.min(J.to,Z.viewport.to),Q=Z.textDirection==J0.LTR,U=Z.contentDOM,Y=U.getBoundingClientRect(),q=t$(Z),G=U.querySelector(".cm-line"),W=G&&window.getComputedStyle(G),j=Y.left+(W?parseInt(W.paddingLeft)+Math.min(0,parseInt(W.textIndent)):0),_=Y.right-(W?parseInt(W.paddingRight):0),z=z8(Z,K,1),V=z8(Z,X,-1),O=z.type==y0.Text?z:null,N=V.type==y0.Text?V:null;if(O&&(Z.lineWrapping||z.widgetLineBreaks))O=T2(Z,K,1,O);if(N&&(Z.lineWrapping||V.widgetLineBreaks))N=T2(Z,X,-1,N);if(O&&N&&O.from==N.from&&O.to==N.to)return A(L(J.from,J.to,O));else{let M=O?L(J.from,null,O):E(z,!1),S=N?L(null,J.to,N):E(V,!0),T=[];if((O||z).to<(N||V).from-(O&&N?1:0)||z.widgetLineBreaks>1&&M.bottom+Z.defaultLineHeight/2<S.top)T.push(R(j,M.bottom,_,S.top));else if(M.bottom<S.top&&Z.elementAtHeight((M.bottom+S.top)/2).type==y0.Text)M.bottom=S.top=(M.bottom+S.top)/2;return A(M).concat(T).concat(A(S))}function R(M,S,T,f){return new L7($,M-q.left,S-q.top,T-M,f-S)}function A({top:M,bottom:S,horizontal:T}){let f=[];for(let s=0;s<T.length;s+=2)f.push(R(T[s],M,T[s+1],S));return f}function L(M,S,T){let f=1e9,s=-1e9,K0=[];function c(a,$0,A0,x0,o0){let D0=Z.coordsAtPos(a,a==T.to?-2:2),I=Z.coordsAtPos(A0,A0==T.from?2:-2);if(!D0||!I)return;if(f=Math.min(D0.top,I.top,f),s=Math.max(D0.bottom,I.bottom,s),o0==J0.LTR)K0.push(Q&&$0?j:D0.left,Q&&x0?_:I.right);else K0.push(!Q&&x0?j:I.left,!Q&&$0?_:D0.right)}let w=M!==null&&M!==void 0?M:T.from,e=S!==null&&S!==void 0?S:T.to;for(let a of Z.visibleRanges)if(a.to>w&&a.from<e)for(let $0=Math.max(a.from,w),A0=Math.min(a.to,e);;){let x0=Z.state.doc.lineAt($0);for(let o0 of Z.bidiSpans(x0)){let D0=o0.from+x0.from,I=o0.to+x0.from;if(D0>=A0)break;if(I>$0)c(Math.max(D0,$0),M==null&&D0<=w,Math.min(I,A0),S==null&&I>=e,o0.dir)}if($0=x0.to+1,$0>=A0)break}if(K0.length==0)c(w,M==null,e,S==null,Z.textDirection);return{top:f,bottom:s,horizontal:K0}}function E(M,S){let T=Y.top+(S?M.top:M.bottom);return{top:T,bottom:T,horizontal:[]}}}function TU(Z,$){return Z.constructor==$.constructor&&Z.eq($)}class e${constructor(Z,$){if(this.view=Z,this.layer=$,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=Z.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),$.above)this.dom.classList.add("cm-layer-above");if($.class)this.dom.classList.add($.class);if(this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(Z.state),Z.requestMeasure(this.measureReq),$.mount)$.mount(this.dom,Z)}update(Z){if(Z.startState.facet(H4)!=Z.state.facet(H4))this.setOrder(Z.state);if(this.layer.update(Z,this.dom)||Z.geometryChanged)this.scale(),Z.view.requestMeasure(this.measureReq)}docViewUpdate(Z){if(this.layer.updateOnDocViewUpdate!==!1)Z.requestMeasure(this.measureReq)}setOrder(Z){let $=0,J=Z.facet(H4);while($<J.length&&J[$]!=this.layer)$++;this.dom.style.zIndex=String((this.layer.above?150:-1)-$)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:Z,scaleY:$}=this.view;if(Z!=this.scaleX||$!=this.scaleY)this.scaleX=Z,this.scaleY=$,this.dom.style.transform=`scale(${1/Z}, ${1/$})`}draw(Z){if(Z.length!=this.drawn.length||Z.some(($,J)=>!TU($,this.drawn[J]))){let $=this.dom.firstChild,J=0;for(let K of Z)if(K.update&&$&&K.constructor&&this.drawn[J].constructor&&K.update($,this.drawn[J]))$=$.nextSibling,J++;else this.dom.insertBefore(K.draw(),$);while($){let K=$.nextSibling;$.remove(),$=K}if(this.drawn=Z,y.safari&&y.safari_version>=26)this.dom.style.display=this.dom.firstChild?"":"none"}}destroy(){if(this.layer.destroy)this.layer.destroy(this.dom,this.view);this.dom.remove()}}var H4=C.define();function Z3(Z){return[W0.define(($)=>new e$($,Z)),H4.of(Z)]}var H7=C.define({combine(Z){return S0(Z,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:($,J)=>Math.min($,J),drawRangeCursor:($,J)=>$||J})}});function $3(Z={}){return[H7.of(Z),yU,kU,SU,U$.of(!0)]}function J3(Z){return Z.startState.facet(H7)!=Z.state.facet(H7)}var yU=Z3({above:!0,markers(Z){let{state:$}=Z,J=$.facet(H7),K=[];for(let X of $.selection.ranges){let Q=X==$.selection.main;if(X.empty||J.drawRangeCursor){let U=Q?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",Y=X.empty?X:D.cursor(X.head,X.head>X.anchor?-1:1);for(let q of L7.forRange(Z,U,Y))K.push(q)}}return K},update(Z,$){if(Z.transactions.some((K)=>K.selection))$.style.animationName=$.style.animationName=="cm-blink"?"cm-blink2":"cm-blink";let J=J3(Z);if(J)y2(Z.state,$);return Z.docChanged||Z.selectionSet||J},mount(Z,$){y2($.state,Z)},class:"cm-cursorLayer"});function y2(Z,$){$.style.animationDuration=Z.facet(H7).cursorBlinkRate+"ms"}var kU=Z3({above:!1,markers(Z){return Z.state.selection.ranges.map(($)=>$.empty?[]:L7.forRange(Z,"cm-selectionBackground",$)).reduce(($,J)=>$.concat(J))},update(Z,$){return Z.docChanged||Z.selectionSet||Z.viewportChanged||J3(Z)},class:"cm-selectionLayer"}),SU=j1.highest(B.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),K3=v.define({map(Z,$){return Z==null?null:$.mapPos(Z)}}),Y7=j0.define({create(){return null},update(Z,$){if(Z!=null)Z=$.changes.mapPos(Z);return $.effects.reduce((J,K)=>K.is(K3)?K.value:J,Z)}}),bU=W0.fromClass(class{constructor(Z){this.view=Z,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(Z){var $;let J=Z.state.field(Y7);if(J==null){if(this.cursor!=null)($=this.cursor)===null||$===void 0||$.remove(),this.cursor=null}else{if(!this.cursor)this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor";if(Z.startState.field(Y7)!=J||Z.docChanged||Z.geometryChanged)this.view.requestMeasure(this.measureReq)}}readPos(){let{view:Z}=this,$=Z.state.field(Y7),J=$!=null&&Z.coordsAtPos($);if(!J)return null;let K=Z.scrollDOM.getBoundingClientRect();return{left:J.left-K.left+Z.scrollDOM.scrollLeft*Z.scaleX,top:J.top-K.top+Z.scrollDOM.scrollTop*Z.scaleY,height:J.bottom-J.top}}drawCursor(Z){if(this.cursor){let{scaleX:$,scaleY:J}=this.view;if(Z)this.cursor.style.left=Z.left/$+"px",this.cursor.style.top=Z.top/J+"px",this.cursor.style.height=Z.height/J+"px";else this.cursor.style.left="-100000px"}}destroy(){if(this.cursor)this.cursor.remove()}setDropPos(Z){if(this.view.state.field(Y7)!=Z)this.view.dispatch({effects:K3.of(Z)})}},{eventObservers:{dragover(Z){this.setDropPos(this.view.posAtCoords({x:Z.clientX,y:Z.clientY}))},dragleave(Z){if(Z.target==this.view.contentDOM||!this.view.contentDOM.contains(Z.relatedTarget))this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function X3(){return[Y7,bU]}function k2(Z,$,J,K,X){$.lastIndex=0;for(let Q=Z.iterRange(J,K),U=J,Y;!Q.next().done;U+=Q.value.length)if(!Q.lineBreak)while(Y=$.exec(Q.value))X(U+Y.index,Y)}function xU(Z,$){let J=Z.visibleRanges;if(J.length==1&&J[0].from==Z.viewport.from&&J[0].to==Z.viewport.to)return J;let K=[];for(let{from:X,to:Q}of J)if(X=Math.max(Z.state.doc.lineAt(X).from,X-$),Q=Math.min(Z.state.doc.lineAt(Q).to,Q+$),K.length&&K[K.length-1].to>=X)K[K.length-1].to=Q;else K.push({from:X,to:Q});return K}class Q3{constructor(Z){let{regexp:$,decoration:J,decorate:K,boundary:X,maxLength:Q=1000}=Z;if(!$.global)throw RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=$,K)this.addMatch=(U,Y,q,G)=>K(G,q,q+U[0].length,U,Y);else if(typeof J=="function")this.addMatch=(U,Y,q,G)=>{let W=J(U,Y,q);if(W)G(q,q+U[0].length,W)};else if(J)this.addMatch=(U,Y,q,G)=>G(q,q+U[0].length,J);else throw RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=X,this.maxLength=Q}createDeco(Z){let $=new l0,J=$.add.bind($);for(let{from:K,to:X}of xU(Z,this.maxLength))k2(Z.state.doc,this.regexp,K,X,(Q,U)=>this.addMatch(U,Z,Q,J));return $.finish()}updateDeco(Z,$){let J=1e9,K=-1;if(Z.docChanged)Z.changes.iterChanges((X,Q,U,Y)=>{if(Y>=Z.view.viewport.from&&U<=Z.view.viewport.to)J=Math.min(U,J),K=Math.max(Y,K)});if(Z.viewportMoved||K-J>1000)return this.createDeco(Z.view);if(K>-1)return this.updateRange(Z.view,$.map(Z.changes),J,K);return $}updateRange(Z,$,J,K){for(let X of Z.visibleRanges){let Q=Math.max(X.from,J),U=Math.min(X.to,K);if(U>=Q){let Y=Z.state.doc.lineAt(Q),q=Y.to<U?Z.state.doc.lineAt(U):Y,G=Math.max(X.from,Y.from),W=Math.min(X.to,q.to);if(this.boundary){for(;Q>Y.from;Q--)if(this.boundary.test(Y.text[Q-1-Y.from])){G=Q;break}for(;U<q.to;U++)if(this.boundary.test(q.text[U-q.from])){W=U;break}}let j=[],_,z=(V,O,N)=>j.push(N.range(V,O));if(Y==q){this.regexp.lastIndex=G-Y.from;while((_=this.regexp.exec(Y.text))&&_.index<W-Y.from)this.addMatch(_,Z,_.index+Y.from,z)}else k2(Z.state.doc,this.regexp,G,W,(V,O)=>this.addMatch(O,Z,V,z));$=$.update({filterFrom:G,filterTo:W,filter:(V,O)=>V<G||O>W,add:j})}}return $}}var A8=/x/.unicode!=null?"gu":"g",wU=new RegExp(`[\x00-\b
-\x1F-­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,A8),hU={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},t9=null;function vU(){var Z;if(t9==null&&typeof document<"u"&&document.body){let $=document.body.style;t9=((Z=$.tabSize)!==null&&Z!==void 0?Z:$.MozTabSize)!=null}return t9||!1}var N4=C.define({combine(Z){let $=S0(Z,{render:null,specialChars:wU,addSpecialChars:null});if($.replaceTabs=!vU())$.specialChars=new RegExp("\t|"+$.specialChars.source,A8);if($.addSpecialChars)$.specialChars=new RegExp($.specialChars.source+"|"+$.addSpecialChars.source,A8);return $}});function U3(Z={}){return[N4.of(Z),mU()]}var S2=null;function mU(){return S2||(S2=W0.fromClass(class{constructor(Z){this.view=Z,this.decorations=x.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(Z.state.facet(N4)),this.decorations=this.decorator.createDeco(Z)}makeDecorator(Z){return new Q3({regexp:Z.specialChars,decoration:($,J,K)=>{let{doc:X}=J.state,Q=P0($[0],0);if(Q==9){let U=X.lineAt(K),Y=J.state.tabSize,q=k1(U.text,Y,K-U.from);return x.replace({widget:new q3((Y-q%Y)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[Q]||(this.decorationCache[Q]=x.replace({widget:new Y3(Z,Q)}))},boundary:Z.replaceTabs?void 0:/[^]/})}update(Z){let $=Z.state.facet(N4);if(Z.startState.facet(N4)!=$)this.decorator=this.makeDecorator($),this.decorations=this.decorator.createDeco(Z.view);else this.decorations=this.decorator.updateDeco(Z,this.decorations)}},{decorations:(Z)=>Z.decorations}))}var uU="•";function fU(Z){if(Z>=32)return uU;if(Z==10)return"␤";return String.fromCharCode(9216+Z)}class Y3 extends i0{constructor(Z,$){super();this.options=Z,this.code=$}eq(Z){return Z.code==this.code}toDOM(Z){let $=fU(this.code),J=Z.state.phrase("Control character")+" "+(hU[this.code]||"0x"+this.code.toString(16)),K=this.options.render&&this.options.render(this.code,J,$);if(K)return K;let X=document.createElement("span");return X.textContent=$,X.title=J,X.setAttribute("aria-label",J),X.className="cm-specialChar",X}ignoreEvent(){return!1}}class q3 extends i0{constructor(Z){super();this.width=Z}eq(Z){return Z.width==this.width}toDOM(){let Z=document.createElement("span");return Z.textContent="\t",Z.className="cm-tab",Z.style.width=this.width+"px",Z}ignoreEvent(){return!1}}function G3(){return pU}var gU=x.line({class:"cm-activeLine"}),pU=W0.fromClass(class{constructor(Z){this.decorations=this.getDeco(Z)}update(Z){if(Z.docChanged||Z.selectionSet)this.decorations=this.getDeco(Z.view)}getDeco(Z){let $=-1,J=[];for(let K of Z.state.selection.ranges){let X=Z.lineBlockAt(K.head);if(X.from>$)J.push(gU.range(X.from)),$=X.from}return x.set(J)}},{decorations:(Z)=>Z.decorations});var L8=2000;function dU(Z,$,J){let K=Math.min($.line,J.line),X=Math.max($.line,J.line),Q=[];if($.off>L8||J.off>L8||$.col<0||J.col<0){let U=Math.min($.off,J.off),Y=Math.max($.off,J.off);for(let q=K;q<=X;q++){let G=Z.doc.line(q);if(G.length<=Y)Q.push(D.range(G.from+U,G.to+Y))}}else{let U=Math.min($.col,J.col),Y=Math.max($.col,J.col);for(let q=K;q<=X;q++){let G=Z.doc.line(q),W=$4(G.text,U,Z.tabSize,!0);if(W<0)Q.push(D.cursor(G.to));else{let j=$4(G.text,Y,Z.tabSize);Q.push(D.range(G.from+W,G.from+j))}}}return Q}function lU(Z,$){let J=Z.coordsAtPos(Z.viewport.from);return J?Math.round(Math.abs((J.left-$)/Z.defaultCharacterWidth)):-1}function b2(Z,$){let J=Z.posAtCoords({x:$.clientX,y:$.clientY},!1),K=Z.state.doc.lineAt(J),X=J-K.from,Q=X>L8?-1:X==K.length?lU(Z,$.clientX):k1(K.text,Z.state.tabSize,J-K.from);return{line:K.number,col:Q,off:X}}function cU(Z,$){let J=b2(Z,$),K=Z.state.selection;if(!J)return null;return{update(X){if(X.docChanged){let Q=X.changes.mapPos(X.startState.doc.line(J.line).from),U=X.state.doc.lineAt(Q);J={line:U.number,col:J.col,off:Math.min(J.off,U.length)},K=K.map(X.changes)}},get(X,Q,U){let Y=b2(Z,X);if(!Y)return K;let q=dU(Z.state,J,Y);if(!q.length)return K;if(U)return D.create(q.concat(K.ranges));else return D.create(q)}}}function W3(Z){let $=(Z===null||Z===void 0?void 0:Z.eventFilter)||((J)=>J.altKey&&J.button==0);return B.mouseSelectionStyle.of((J,K)=>$(K)?cU(J,K):null)}var sU={Alt:[18,(Z)=>!!Z.altKey],Control:[17,(Z)=>!!Z.ctrlKey],Shift:[16,(Z)=>!!Z.shiftKey],Meta:[91,(Z)=>!!Z.metaKey]},nU={style:"cursor: crosshair"};function j3(Z={}){let[$,J]=sU[Z.key||"Alt"],K=W0.fromClass(class{constructor(X){this.view=X,this.isDown=!1}set(X){if(this.isDown!=X)this.isDown=X,this.view.update([])}},{eventObservers:{keydown(X){this.set(X.keyCode==$||J(X))},keyup(X){if(X.keyCode==$||!J(X))this.set(!1)},mousemove(X){this.set(J(X))}}});return[K,B.contentAttributes.of((X)=>{var Q;return((Q=X.plugin(K))===null||Q===void 0?void 0:Q.isDown)?nU:null})]}var G4="-10000px";class u8{constructor(Z,$,J,K){this.facet=$,this.createTooltipView=J,this.removeTooltipView=K,this.input=Z.state.facet($),this.tooltips=this.input.filter((Q)=>Q);let X=null;this.tooltipViews=this.tooltips.map((Q)=>X=J(Q,X))}update(Z,$){var J;let K=Z.state.facet(this.facet),X=K.filter((Y)=>Y);if(K===this.input){for(let Y of this.tooltipViews)if(Y.update)Y.update(Z);return!1}let Q=[],U=$?[]:null;for(let Y=0;Y<X.length;Y++){let q=X[Y],G=-1;if(!q)continue;for(let W=0;W<this.tooltips.length;W++){let j=this.tooltips[W];if(j&&j.create==q.create)G=W}if(G<0){if(Q[Y]=this.createTooltipView(q,Y?Q[Y-1]:null),U)U[Y]=!!q.above}else{let W=Q[Y]=this.tooltipViews[G];if(U)U[Y]=$[G];if(W.update)W.update(Z)}}for(let Y of this.tooltipViews)if(Q.indexOf(Y)<0)this.removeTooltipView(Y),(J=Y.destroy)===null||J===void 0||J.call(Y);if($)U.forEach((Y,q)=>$[q]=Y),$.length=U.length;return this.input=K,this.tooltips=X,this.tooltipViews=Q,!0}}function iU(Z){let $=Z.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:$.clientHeight,right:$.clientWidth}}var e9=C.define({combine:(Z)=>{var $,J,K;return{position:y.ios?"absolute":(($=Z.find((X)=>X.position))===null||$===void 0?void 0:$.position)||"fixed",parent:((J=Z.find((X)=>X.parent))===null||J===void 0?void 0:J.parent)||null,tooltipSpace:((K=Z.find((X)=>X.tooltipSpace))===null||K===void 0?void 0:K.tooltipSpace)||iU}}}),x2=new WeakMap,f8=W0.fromClass(class{constructor(Z){this.view=Z,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let $=Z.state.facet(e9);this.position=$.position,this.parent=$.parent,this.classes=Z.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new u8(Z,M7,(J,K)=>this.createTooltip(J,K),(J)=>{if(this.resizeObserver)this.resizeObserver.unobserve(J.dom);J.dom.remove()}),this.above=this.manager.tooltips.map((J)=>!!J.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver((J)=>{if(Date.now()>this.lastTransaction-50&&J.length>0&&J[J.length-1].intersectionRatio<1)this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),Z.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){if(this.parent)this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container);else this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let Z of this.manager.tooltipViews)this.intersectionObserver.observe(Z.dom)}}measureSoon(){if(this.measureTimeout<0)this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50)}update(Z){if(Z.transactions.length)this.lastTransaction=Date.now();let $=this.manager.update(Z,this.above);if($)this.observeIntersection();let J=$||Z.geometryChanged,K=Z.state.facet(e9);if(K.position!=this.position&&!this.madeAbsolute){this.position=K.position;for(let X of this.manager.tooltipViews)X.dom.style.position=this.position;J=!0}if(K.parent!=this.parent){if(this.parent)this.container.remove();this.parent=K.parent,this.createContainer();for(let X of this.manager.tooltipViews)this.container.appendChild(X.dom);J=!0}else if(this.parent&&this.view.themeClasses!=this.classes)this.classes=this.container.className=this.view.themeClasses;if(J)this.maybeMeasure()}createTooltip(Z,$){let J=Z.create(this.view),K=$?$.dom:null;if(J.dom.classList.add("cm-tooltip"),Z.arrow&&!J.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let X=document.createElement("div");X.className="cm-tooltip-arrow",J.dom.appendChild(X)}if(J.dom.style.position=this.position,J.dom.style.top=G4,J.dom.style.left="0px",this.container.insertBefore(J.dom,K),J.mount)J.mount(this.view);if(this.resizeObserver)this.resizeObserver.observe(J.dom);return J}destroy(){var Z,$,J;this.view.win.removeEventListener("resize",this.measureSoon);for(let K of this.manager.tooltipViews)K.dom.remove(),(Z=K.destroy)===null||Z===void 0||Z.call(K);if(this.parent)this.container.remove();($=this.resizeObserver)===null||$===void 0||$.disconnect(),(J=this.intersectionObserver)===null||J===void 0||J.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let Z=1,$=1,J=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:Q}=this.manager.tooltipViews[0];if(y.safari){let U=Q.getBoundingClientRect();J=Math.abs(U.top+1e4)>1||Math.abs(U.left)>1}else J=!!Q.offsetParent&&Q.offsetParent!=this.container.ownerDocument.body}if(J||this.position=="absolute")if(this.parent){let Q=this.parent.getBoundingClientRect();if(Q.width&&Q.height)Z=Q.width/this.parent.offsetWidth,$=Q.height/this.parent.offsetHeight}else({scaleX:Z,scaleY:$}=this.view.viewState);let K=this.view.scrollDOM.getBoundingClientRect(),X=x8(this.view);return{visible:{left:K.left+X.left,top:K.top+X.top,right:K.right-X.right,bottom:K.bottom-X.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((Q,U)=>{let Y=this.manager.tooltipViews[U];return Y.getCoords?Y.getCoords(Q.pos):this.view.coordsAtPos(Q.pos)}),size:this.manager.tooltipViews.map(({dom:Q})=>Q.getBoundingClientRect()),space:this.view.state.facet(e9).tooltipSpace(this.view),scaleX:Z,scaleY:$,makeAbsolute:J}}writeMeasure(Z){var $;if(Z.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let Y of this.manager.tooltipViews)Y.dom.style.position="absolute"}let{visible:J,space:K,scaleX:X,scaleY:Q}=Z,U=[];for(let Y=0;Y<this.manager.tooltips.length;Y++){let q=this.manager.tooltips[Y],G=this.manager.tooltipViews[Y],{dom:W}=G,j=Z.pos[Y],_=Z.size[Y];if(!j||q.clip!==!1&&(j.bottom<=Math.max(J.top,K.top)||j.top>=Math.min(J.bottom,K.bottom)||j.right<Math.max(J.left,K.left)-0.1||j.left>Math.min(J.right,K.right)+0.1)){W.style.top=G4;continue}let z=q.arrow?G.dom.querySelector(".cm-tooltip-arrow"):null,V=z?7:0,O=_.right-_.left,N=($=x2.get(G))!==null&&$!==void 0?$:_.bottom-_.top,R=G.offset||rU,A=this.view.textDirection==J0.LTR,L=_.width>K.right-K.left?A?K.left:K.right-_.width:A?Math.max(K.left,Math.min(j.left-(z?14:0)+R.x,K.right-O)):Math.min(Math.max(K.left,j.left-O+(z?14:0)-R.x),K.right-O),E=this.above[Y];if(!q.strictSide&&(E?j.top-N-V-R.y<K.top:j.bottom+N+V+R.y>K.bottom)&&E==K.bottom-j.bottom>j.top-K.top)E=this.above[Y]=!E;let M=(E?j.top-K.top:K.bottom-j.bottom)-V;if(M<N&&G.resize!==!1){if(M<this.view.defaultLineHeight){W.style.top=G4;continue}x2.set(G,N),W.style.height=(N=M)/Q+"px"}else if(W.style.height)W.style.height="";let S=E?j.top-N-V-R.y:j.bottom+V+R.y,T=L+O;if(G.overlap!==!0){for(let f of U)if(f.left<T&&f.right>L&&f.top<S+N&&f.bottom>S)S=E?f.top-N-2-V:f.bottom+V+2}if(this.position=="absolute")W.style.top=(S-Z.parent.top)/Q+"px",w2(W,(L-Z.parent.left)/X);else W.style.top=S/Q+"px",w2(W,L/X);if(z){let f=j.left+(A?R.x:-R.x)-(L+14-7);z.style.left=f/X+"px"}if(G.overlap!==!0)U.push({left:L,top:S,right:T,bottom:S+N});if(W.classList.toggle("cm-tooltip-above",E),W.classList.toggle("cm-tooltip-below",!E),G.positioned)G.positioned(Z.space)}}maybeMeasure(){if(this.manager.tooltips.length){if(this.view.inView)this.view.requestMeasure(this.measureReq);if(this.inView!=this.view.inView){if(this.inView=this.view.inView,!this.inView)for(let Z of this.manager.tooltipViews)Z.dom.style.top=G4}}}},{eventObservers:{scroll(){this.maybeMeasure()}}});function w2(Z,$){let J=parseInt(Z.style.left,10);if(isNaN(J)||Math.abs($-J)>1)Z.style.left=$+"px"}var aU=B.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),rU={x:0,y:0},M7=C.define({enables:[f8,aU]}),C4=C.define({combine:(Z)=>Z.reduce(($,J)=>$.concat(J),[])});class S4{static create(Z){return new S4(Z)}constructor(Z){this.view=Z,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new u8(Z,C4,($,J)=>this.createHostedView($,J),($)=>$.dom.remove())}createHostedView(Z,$){let J=Z.create(this.view);if(J.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(J.dom,$?$.dom.nextSibling:this.dom.firstChild),this.mounted&&J.mount)J.mount(this.view);return J}mount(Z){for(let $ of this.manager.tooltipViews)if($.mount)$.mount(Z);this.mounted=!0}positioned(Z){for(let $ of this.manager.tooltipViews)if($.positioned)$.positioned(Z)}update(Z){this.manager.update(Z)}destroy(){var Z;for(let $ of this.manager.tooltipViews)(Z=$.destroy)===null||Z===void 0||Z.call($)}passProp(Z){let $=void 0;for(let J of this.manager.tooltipViews){let K=J[Z];if(K!==void 0){if($===void 0)$=K;else if($!==K)return}}return $}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}var oU=M7.compute([C4],(Z)=>{let $=Z.facet(C4);if($.length===0)return null;return{pos:Math.min(...$.map((J)=>J.pos)),end:Math.max(...$.map((J)=>{var K;return(K=J.end)!==null&&K!==void 0?K:J.pos})),create:S4.create,above:$[0].above,arrow:$.some((J)=>J.arrow)}});class _3{constructor(Z,$,J,K,X){this.view=Z,this.source=$,this.field=J,this.setHover=K,this.hoverTime=X,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:Z.dom,time:0},this.checkHover=this.checkHover.bind(this),Z.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),Z.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){if(this.pending)this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20)}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let Z=Date.now()-this.lastMove.time;if(Z<this.hoverTime)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-Z);else this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:Z,lastMove:$}=this,J=Z.docView.tile.nearest($.target);if(!J)return;let K,X=1;if(J.isWidget())K=J.posAtStart;else{if(K=Z.posAtCoords($),K==null)return;let U=Z.coordsAtPos(K);if(!U||$.y<U.top||$.y>U.bottom||$.x<U.left-Z.defaultCharacterWidth||$.x>U.right+Z.defaultCharacterWidth)return;let Y=Z.bidiSpans(Z.state.doc.lineAt(K)).find((G)=>G.from<=K&&G.to>=K),q=Y&&Y.dir==J0.RTL?-1:1;X=$.x<U.left?-q:q}let Q=this.source(Z,K,X);if(Q===null||Q===void 0?void 0:Q.then){let U=this.pending={pos:K};Q.then((Y)=>{if(this.pending==U){if(this.pending=null,Y&&!(Array.isArray(Y)&&!Y.length))Z.dispatch({effects:this.setHover.of(Array.isArray(Y)?Y:[Y])})}},(Y)=>T0(Z.state,Y,"hover tooltip"))}else if(Q&&!(Array.isArray(Q)&&!Q.length))Z.dispatch({effects:this.setHover.of(Array.isArray(Q)?Q:[Q])})}get tooltip(){let Z=this.view.plugin(f8),$=Z?Z.manager.tooltips.findIndex((J)=>J.create==S4.create):-1;return $>-1?Z.manager.tooltipViews[$]:null}mousemove(Z){var $,J;if(this.lastMove={x:Z.clientX,y:Z.clientY,target:Z.target,time:Date.now()},this.hoverTimeout<0)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime);let{active:K,tooltip:X}=this;if(K.length&&X&&!tU(X.dom,Z)||this.pending){let{pos:Q}=K[0]||this.pending,U=(J=($=K[0])===null||$===void 0?void 0:$.end)!==null&&J!==void 0?J:Q;if(Q==U?this.view.posAtCoords(this.lastMove)!=Q:!eU(this.view,Q,U,Z.clientX,Z.clientY))this.view.dispatch({effects:this.setHover.of([])}),this.pending=null}}mouseleave(Z){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:$}=this;if($.length){let{tooltip:J}=this;if(!(J&&J.dom.contains(Z.relatedTarget)))this.view.dispatch({effects:this.setHover.of([])});else this.watchTooltipLeave(J.dom)}}watchTooltipLeave(Z){let $=(J)=>{if(Z.removeEventListener("mouseleave",$),this.active.length&&!this.view.dom.contains(J.relatedTarget))this.view.dispatch({effects:this.setHover.of([])})};Z.addEventListener("mouseleave",$)}destroy(){clearTimeout(this.hoverTimeout),clearTimeout(this.restartTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}var W4=4;function tU(Z,$){let{left:J,right:K,top:X,bottom:Q}=Z.getBoundingClientRect(),U;if(U=Z.querySelector(".cm-tooltip-arrow")){let Y=U.getBoundingClientRect();X=Math.min(Y.top,X),Q=Math.max(Y.bottom,Q)}return $.clientX>=J-W4&&$.clientX<=K+W4&&$.clientY>=X-W4&&$.clientY<=Q+W4}function eU(Z,$,J,K,X,Q){let U=Z.scrollDOM.getBoundingClientRect(),Y=Z.documentTop+Z.documentPadding.top+Z.contentHeight;if(U.left>K||U.right<K||U.top>X||Math.min(U.bottom,Y)<X)return!1;let q=Z.posAtCoords({x:K,y:X},!1);return q>=$&&q<=J}function z3(Z,$={}){let J=v.define(),K=j0.define({create(){return[]},update(X,Q){if(X.length){if($.hideOnChange&&(Q.docChanged||Q.selection))X=[];else if($.hideOn)X=X.filter((U)=>!$.hideOn(Q,U));if(Q.docChanged){let U=[];for(let Y of X){let q=Q.changes.mapPos(Y.pos,-1,E0.TrackDel);if(q!=null){let G=Object.assign(Object.create(null),Y);if(G.pos=q,G.end!=null)G.end=Q.changes.mapPos(G.end);U.push(G)}}X=U}}for(let U of Q.effects){if(U.is(J))X=U.value;if(U.is(ZY))X=[]}return X},provide:(X)=>C4.from(X)});return{active:K,extension:[K,W0.define((X)=>new _3(X,Z,K,J,$.hoverTime||300)),oU]}}function g8(Z,$){let J=Z.plugin(f8);if(!J)return null;let K=J.manager.tooltips.indexOf($);return K<0?null:J.manager.tooltipViews[K]}var ZY=v.define();var h2=C.define({combine(Z){let $,J;for(let K of Z)$=$||K.topContainer,J=J||K.bottomContainer;return{topContainer:$,bottomContainer:J}}});function B7(Z,$){let J=Z.plugin(O3),K=J?J.specs.indexOf($):-1;return K>-1?J.panels[K]:null}var O3=W0.fromClass(class{constructor(Z){this.input=Z.state.facet(U5),this.specs=this.input.filter((J)=>J),this.panels=this.specs.map((J)=>J(Z));let $=Z.state.facet(h2);this.top=new q7(Z,!0,$.topContainer),this.bottom=new q7(Z,!1,$.bottomContainer),this.top.sync(this.panels.filter((J)=>J.top)),this.bottom.sync(this.panels.filter((J)=>!J.top));for(let J of this.panels)if(J.dom.classList.add("cm-panel"),J.mount)J.mount()}update(Z){let $=Z.state.facet(h2);if(this.top.container!=$.topContainer)this.top.sync([]),this.top=new q7(Z.view,!0,$.topContainer);if(this.bottom.container!=$.bottomContainer)this.bottom.sync([]),this.bottom=new q7(Z.view,!1,$.bottomContainer);this.top.syncClasses(),this.bottom.syncClasses();let J=Z.state.facet(U5);if(J!=this.input){let K=J.filter((q)=>q),X=[],Q=[],U=[],Y=[];for(let q of K){let G=this.specs.indexOf(q),W;if(G<0)W=q(Z.view),Y.push(W);else if(W=this.panels[G],W.update)W.update(Z);X.push(W),(W.top?Q:U).push(W)}this.specs=K,this.panels=X,this.top.sync(Q),this.bottom.sync(U);for(let q of Y)if(q.dom.classList.add("cm-panel"),q.mount)q.mount()}else for(let K of this.panels)if(K.update)K.update(Z)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:(Z)=>B.scrollMargins.of(($)=>{let J=$.plugin(Z);return J&&{top:J.top.scrollMargin(),bottom:J.bottom.scrollMargin()}})});class q7{constructor(Z,$,J){this.view=Z,this.top=$,this.container=J,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(Z){for(let $ of this.panels)if($.destroy&&Z.indexOf($)<0)$.destroy();this.panels=Z,this.syncDOM()}syncDOM(){if(this.panels.length==0){if(this.dom)this.dom.remove(),this.dom=void 0;return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let $=this.container||this.view.dom;$.insertBefore(this.dom,this.top?$.firstChild:null)}let Z=this.dom.firstChild;for(let $ of this.panels)if($.dom.parentNode==this.dom){while(Z!=$.dom)Z=v2(Z);Z=Z.nextSibling}else this.dom.insertBefore($.dom,Z);while(Z)Z=v2(Z)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!this.container||this.classes==this.view.themeClasses)return;for(let Z of this.classes.split(" "))if(Z)this.container.classList.remove(Z);for(let Z of(this.classes=this.view.themeClasses).split(" "))if(Z)this.container.classList.add(Z)}}function v2(Z){let $=Z.nextSibling;return Z.remove(),$}var U5=C.define({enables:O3});function V3(Z,$){let J,K=new Promise((U)=>J=U),X=(U)=>$Y(U,$,J);if(Z.state.field(Z8,!1))Z.dispatch({effects:H3.of(X)});else Z.dispatch({effects:v.appendConfig.of(Z8.init(()=>[X]))});let Q=N3.of(X);return{close:Q,result:K.then((U)=>{return(Z.win.queueMicrotask||((q)=>Z.win.setTimeout(q,10)))(()=>{if(Z.state.field(Z8).indexOf(X)>-1)Z.dispatch({effects:Q})}),U})}}var Z8=j0.define({create(){return[]},update(Z,$){for(let J of $.effects)if(J.is(H3))Z=[J.value].concat(Z);else if(J.is(N3))Z=Z.filter((K)=>K!=J.value);return Z},provide:(Z)=>U5.computeN([Z],($)=>$.field(Z))}),H3=v.define(),N3=v.define();function $Y(Z,$,J){let K=$.content?$.content(Z,()=>U(null)):null;if(!K){if(K=o("form"),$.input){let Y=o("input",$.input);if(/^(text|password|number|email|tel|url)$/.test(Y.type))Y.classList.add("cm-textfield");if(!Y.name)Y.name="input";K.appendChild(o("label",($.label||"")+": ",Y))}else K.appendChild(document.createTextNode($.label||""));K.appendChild(document.createTextNode(" ")),K.appendChild(o("button",{class:"cm-button",type:"submit"},$.submitLabel||"OK"))}let X=K.nodeName=="FORM"?[K]:K.querySelectorAll("form");for(let Y=0;Y<X.length;Y++){let q=X[Y];q.addEventListener("keydown",(G)=>{if(G.keyCode==27)G.preventDefault(),U(null);else if(G.keyCode==13)G.preventDefault(),U(q)}),q.addEventListener("submit",(G)=>{G.preventDefault(),U(q)})}let Q=o("div",K,o("button",{onclick:()=>U(null),"aria-label":Z.state.phrase("close"),class:"cm-dialog-close",type:"button"},["×"]));if($.class)Q.className=$.class;Q.classList.add("cm-dialog");function U(Y){if(Q.contains(Q.ownerDocument.activeElement))Z.focus();J(Y)}return{dom:Q,top:$.top,mount:()=>{if($.focus){let Y;if(typeof $.focus=="string")Y=K.querySelector($.focus);else Y=K.querySelector("input")||K.querySelector("button");if(Y&&"select"in Y)Y.select();else if(Y&&"focus"in Y)Y.focus()}}}}class Z1 extends W1{compare(Z){return this==Z||this.constructor==Z.constructor&&this.eq(Z)}eq(Z){return!1}destroy(Z){}}Z1.prototype.elementClass="";Z1.prototype.toDOM=void 0;Z1.prototype.mapMode=E0.TrackBefore;Z1.prototype.startSide=Z1.prototype.endSide=-1;Z1.prototype.point=!0;var I4=C.define(),JY=C.define(),KY={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>d.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},_7=C.define();function p8(Z){return[I3(),_7.of({...KY,...Z})]}var M8=C.define({combine:(Z)=>Z.some(($)=>$)});function I3(Z){let $=[XY];if(Z&&Z.fixed===!1)$.push(M8.of(!0));return $}var XY=W0.fromClass(class{constructor(Z){this.view=Z,this.domAfter=null,this.prevViewport=Z.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=Z.state.facet(_7).map(($)=>new E8(Z,$)),this.fixed=!Z.state.facet(M8);for(let $ of this.gutters)if($.config.side=="after")this.getDOMAfter().appendChild($.dom);else this.dom.appendChild($.dom);if(this.fixed)this.dom.style.position="sticky";this.syncGutters(!1),Z.scrollDOM.insertBefore(this.dom,Z.contentDOM)}getDOMAfter(){if(!this.domAfter)this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter);return this.domAfter}update(Z){if(this.updateGutters(Z)){let $=this.prevViewport,J=Z.view.viewport,K=Math.min($.to,J.to)-Math.max($.from,J.from);this.syncGutters(K<(J.to-J.from)*0.8)}if(Z.geometryChanged){let $=this.view.contentHeight/this.view.scaleY+"px";if(this.dom.style.minHeight=$,this.domAfter)this.domAfter.style.minHeight=$}if(this.view.state.facet(M8)!=!this.fixed){if(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter)this.domAfter.style.position=this.fixed?"sticky":""}this.prevViewport=Z.view.viewport}syncGutters(Z){let $=this.dom.nextSibling;if(Z){if(this.dom.remove(),this.domAfter)this.domAfter.remove()}let J=d.iter(this.view.state.facet(I4),this.view.viewport.from),K=[],X=this.gutters.map((Q)=>new R3(Q,this.view.viewport,-this.view.documentPadding.top));for(let Q of this.view.viewportLineBlocks){if(K.length)K=[];if(Array.isArray(Q.type)){let U=!0;for(let Y of Q.type)if(Y.type==y0.Text&&U){B8(J,K,Y.from);for(let q of X)q.line(this.view,Y,K);U=!1}else if(Y.widget)for(let q of X)q.widget(this.view,Y)}else if(Q.type==y0.Text){B8(J,K,Q.from);for(let U of X)U.line(this.view,Q,K)}else if(Q.widget)for(let U of X)U.widget(this.view,Q)}for(let Q of X)Q.finish();if(Z){if(this.view.scrollDOM.insertBefore(this.dom,$),this.domAfter)this.view.scrollDOM.appendChild(this.domAfter)}}updateGutters(Z){let $=Z.startState.facet(_7),J=Z.state.facet(_7),K=Z.docChanged||Z.heightChanged||Z.viewportChanged||!d.eq(Z.startState.facet(I4),Z.state.facet(I4),Z.view.viewport.from,Z.view.viewport.to);if($==J){for(let X of this.gutters)if(X.update(Z))K=!0}else{K=!0;let X=[];for(let Q of J){let U=$.indexOf(Q);if(U<0)X.push(new E8(this.view,Q));else this.gutters[U].update(Z),X.push(this.gutters[U])}for(let Q of this.gutters)if(Q.dom.remove(),X.indexOf(Q)<0)Q.destroy();for(let Q of X)if(Q.config.side=="after")this.getDOMAfter().appendChild(Q.dom);else this.dom.appendChild(Q.dom);this.gutters=X}return K}destroy(){for(let Z of this.gutters)Z.destroy();if(this.dom.remove(),this.domAfter)this.domAfter.remove()}},{provide:(Z)=>B.scrollMargins.of(($)=>{let J=$.plugin(Z);if(!J||J.gutters.length==0||!J.fixed)return null;let K=J.dom.offsetWidth*$.scaleX,X=J.domAfter?J.domAfter.offsetWidth*$.scaleX:0;return $.textDirection==J0.LTR?{left:K,right:X}:{right:K,left:X}})});function m2(Z){return Array.isArray(Z)?Z:[Z]}function B8(Z,$,J){while(Z.value&&Z.from<=J){if(Z.from==J)$.push(Z.value);Z.next()}}class R3{constructor(Z,$,J){this.gutter=Z,this.height=J,this.i=0,this.cursor=d.iter(Z.markers,$.from)}addElement(Z,$,J){let{gutter:K}=this,X=($.top-this.height)/Z.scaleY,Q=$.height/Z.scaleY;if(this.i==K.elements.length){let U=new d8(Z,Q,X,J);K.elements.push(U),K.dom.appendChild(U.dom)}else K.elements[this.i].update(Z,Q,X,J);this.height=$.bottom,this.i++}line(Z,$,J){let K=[];if(B8(this.cursor,K,$.from),J.length)K=K.concat(J);let X=this.gutter.config.lineMarker(Z,$,K);if(X)K.unshift(X);let Q=this.gutter;if(K.length==0&&!Q.config.renderEmptyElements)return;this.addElement(Z,$,K)}widget(Z,$){let J=this.gutter.config.widgetMarker(Z,$.widget,$),K=J?[J]:null;for(let X of Z.state.facet(JY)){let Q=X(Z,$.widget,$);if(Q)(K||(K=[])).push(Q)}if(K)this.addElement(Z,$,K)}finish(){let Z=this.gutter;while(Z.elements.length>this.i){let $=Z.elements.pop();Z.dom.removeChild($.dom),$.destroy()}}}class E8{constructor(Z,$){this.view=Z,this.config=$,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let J in $.domEventHandlers)this.dom.addEventListener(J,(K)=>{let X=K.target,Q;if(X!=this.dom&&this.dom.contains(X)){while(X.parentNode!=this.dom)X=X.parentNode;let Y=X.getBoundingClientRect();Q=(Y.top+Y.bottom)/2}else Q=K.clientY;let U=Z.lineBlockAtHeight(Q-Z.documentTop);if($.domEventHandlers[J](Z,U,K))K.preventDefault()});if(this.markers=m2($.markers(Z)),$.initialSpacer)this.spacer=new d8(Z,0,0,[$.initialSpacer(Z)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none"}update(Z){let $=this.markers;if(this.markers=m2(this.config.markers(Z.view)),this.spacer&&this.config.updateSpacer){let K=this.config.updateSpacer(this.spacer.markers[0],Z);if(K!=this.spacer.markers[0])this.spacer.update(Z.view,0,0,[K])}let J=Z.view.viewport;return!d.eq(this.markers,$,J.from,J.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(Z):!1)}destroy(){for(let Z of this.elements)Z.destroy()}}class d8{constructor(Z,$,J,K){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(Z,$,J,K)}update(Z,$,J,K){if(this.height!=$)this.height=$,this.dom.style.height=$+"px";if(this.above!=J)this.dom.style.marginTop=(this.above=J)?J+"px":"";if(!QY(this.markers,K))this.setMarkers(Z,K)}setMarkers(Z,$){let J="cm-gutterElement",K=this.dom.firstChild;for(let X=0,Q=0;;){let U=Q,Y=X<$.length?$[X++]:null,q=!1;if(Y){let G=Y.elementClass;if(G)J+=" "+G;for(let W=Q;W<this.markers.length;W++)if(this.markers[W].compare(Y)){U=W,q=!0;break}}else U=this.markers.length;while(Q<U){let G=this.markers[Q++];if(G.toDOM){G.destroy(K);let W=K.nextSibling;K.remove(),K=W}}if(!Y)break;if(Y.toDOM)if(q)K=K.nextSibling;else this.dom.insertBefore(Y.toDOM(Z),K);if(q)Q++}this.dom.className=J,this.markers=$}destroy(){this.setMarkers(null,[])}}function QY(Z,$){if(Z.length!=$.length)return!1;for(let J=0;J<Z.length;J++)if(!Z[J].compare($[J]))return!1;return!0}var UY=C.define(),YY=C.define(),A5=C.define({combine(Z){return S0(Z,{formatNumber:String,domEventHandlers:{}},{domEventHandlers($,J){let K=Object.assign({},$);for(let X in J){let Q=K[X],U=J[X];K[X]=Q?(Y,q,G)=>Q(Y,q,G)||U(Y,q,G):U}return K}})}});class R4 extends Z1{constructor(Z){super();this.number=Z}eq(Z){return this.number==Z.number}toDOM(){return document.createTextNode(this.number)}}function $8(Z,$){return Z.state.facet(A5).formatNumber($,Z.state)}var qY=_7.compute([A5],(Z)=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers($){return $.state.facet(UY)},lineMarker($,J,K){if(K.some((X)=>X.toDOM))return null;return new R4($8($,$.state.doc.lineAt(J.from).number))},widgetMarker:($,J,K)=>{for(let X of $.state.facet(YY)){let Q=X($,J,K);if(Q)return Q}return null},lineMarkerChange:($)=>$.startState.facet(A5)!=$.state.facet(A5),initialSpacer($){return new R4($8($,u2($.state.doc.lines)))},updateSpacer($,J){let K=$8(J.view,u2(J.view.state.doc.lines));return K==$.number?$:new R4(K)},domEventHandlers:Z.facet(A5).domEventHandlers,side:"before"}));function F3(Z={}){return[A5.of(Z),I3(),qY]}function u2(Z){let $=9;while($<Z)$=$*10+9;return $}var GY=new class extends Z1{constructor(){super(...arguments);this.elementClass="cm-activeLineGutter"}},WY=I4.compute(["selection"],(Z)=>{let $=[],J=-1;for(let K of Z.selection.ranges){let X=Z.doc.lineAt(K.head).from;if(X>J)J=X,$.push(GY.range(X))}return d.of($)});function D3(){return WY}var jY=0;class x4{constructor(Z,$){this.from=Z,this.to=$}}class l{constructor(Z={}){this.id=jY++,this.perNode=!!Z.perNode,this.deserialize=Z.deserialize||(()=>{throw Error("This node type doesn't define a deserialize function")}),this.combine=Z.combine||null}add(Z){if(this.perNode)throw RangeError("Can't add per-node props to node types");if(typeof Z!="function")Z=v0.match(Z);return($)=>{let J=Z($);return J===void 0?null:[this,J]}}}l.closedBy=new l({deserialize:(Z)=>Z.split(" ")});l.openedBy=new l({deserialize:(Z)=>Z.split(" ")});l.group=new l({deserialize:(Z)=>Z.split(" ")});l.isolate=new l({deserialize:(Z)=>{if(Z&&Z!="rtl"&&Z!="ltr"&&Z!="auto")throw RangeError("Invalid value for isolate: "+Z);return Z||"auto"}});l.contextHash=new l({perNode:!0});l.lookAhead=new l({perNode:!0});l.mounted=new l({perNode:!0});class T5{constructor(Z,$,J,K=!1){this.tree=Z,this.overlay=$,this.parser=J,this.bracketed=K}static get(Z){return Z&&Z.props&&Z.props[l.mounted.id]}}var _Y=Object.create(null);class v0{constructor(Z,$,J,K=0){this.name=Z,this.props=$,this.id=J,this.flags=K}static define(Z){let $=Z.props&&Z.props.length?Object.create(null):_Y,J=(Z.top?1:0)|(Z.skipped?2:0)|(Z.error?4:0)|(Z.name==null?8:0),K=new v0(Z.name||"",$,Z.id,J);if(Z.props)for(let X of Z.props){if(!Array.isArray(X))X=X(K);if(X){if(X[0].perNode)throw RangeError("Can't store a per-node prop on a node type");$[X[0].id]=X[1]}}return K}prop(Z){return this.props[Z.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(Z){if(typeof Z=="string"){if(this.name==Z)return!0;let $=this.prop(l.group);return $?$.indexOf(Z)>-1:!1}return this.id==Z}static match(Z){let $=Object.create(null);for(let J in Z)for(let K of J.split(" "))$[K]=Z[J];return(J)=>{for(let K=J.prop(l.group),X=-1;X<(K?K.length:0);X++){let Q=$[X<0?J.name:K[X]];if(Q)return Q}}}}v0.none=new v0("",Object.create(null),0,8);class v4{constructor(Z){this.types=Z;for(let $=0;$<Z.length;$++)if(Z[$].id!=$)throw RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...Z){let $=[];for(let J of this.types){let K=null;for(let X of Z){let Q=X(J);if(Q){if(!K)K=Object.assign({},J.props);let U=Q[1],Y=Q[0];if(Y.combine&&Y.id in K)U=Y.combine(K[Y.id],U);K[Y.id]=U}}$.push(K?new v0(J.name,K,J.id,J.flags):J)}return new v4($)}}var b4=new WeakMap,A3=new WeakMap,N0;(function(Z){Z[Z.ExcludeBuffers=1]="ExcludeBuffers",Z[Z.IncludeAnonymous=2]="IncludeAnonymous",Z[Z.IgnoreMounts=4]="IgnoreMounts",Z[Z.IgnoreOverlays=8]="IgnoreOverlays",Z[Z.EnterBracketed=16]="EnterBracketed"})(N0||(N0={}));class G0{constructor(Z,$,J,K,X){if(this.type=Z,this.children=$,this.positions=J,this.length=K,this.props=null,X&&X.length){this.props=Object.create(null);for(let[Q,U]of X)this.props[typeof Q=="number"?Q:Q.id]=U}}toString(){let Z=T5.get(this);if(Z&&!Z.overlay)return Z.tree.toString();let $="";for(let J of this.children){let K=J.toString();if(K){if($)$+=",";$+=K}}return!this.type.name?$:(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+($.length?"("+$+")":"")}cursor(Z=0){return new h4(this.topNode,Z)}cursorAt(Z,$=0,J=0){let K=b4.get(this)||this.topNode,X=new h4(K);return X.moveTo(Z,$),b4.set(this,X._tree),X}get topNode(){return new $1(this,0,0,null)}resolve(Z,$=0){let J=E7(b4.get(this)||this.topNode,Z,$,!1);return b4.set(this,J),J}resolveInner(Z,$=0){let J=E7(A3.get(this)||this.topNode,Z,$,!0);return A3.set(this,J),J}resolveStack(Z,$=0){return zY(this,Z,$)}iterate(Z){let{enter:$,leave:J,from:K=0,to:X=this.length}=Z,Q=Z.mode||0,U=(Q&N0.IncludeAnonymous)>0;for(let Y=this.cursor(Q|N0.IncludeAnonymous);;){let q=!1;if(Y.from<=X&&Y.to>=K&&(!U&&Y.type.isAnonymous||$(Y)!==!1)){if(Y.firstChild())continue;q=!0}for(;;){if(q&&J&&(U||!Y.type.isAnonymous))J(Y);if(Y.nextSibling())break;if(!Y.parent())return;q=!0}}}prop(Z){return!Z.perNode?this.type.prop(Z):this.props?this.props[Z.id]:void 0}get propValues(){let Z=[];if(this.props)for(let $ in this.props)Z.push([+$,this.props[$]]);return Z}balance(Z={}){return this.children.length<=8?this:i8(v0.none,this.children,this.positions,0,this.children.length,0,this.length,($,J,K)=>new G0(this.type,$,J,K,this.propValues),Z.makeTree||(($,J,K)=>new G0(v0.none,$,J,K)))}static build(Z){return OY(Z)}}G0.empty=new G0(v0.none,[],[],0);class c8{constructor(Z,$){this.buffer=Z,this.index=$}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new c8(this.buffer,this.index)}}class p1{constructor(Z,$,J){this.buffer=Z,this.length=$,this.set=J}get type(){return v0.none}toString(){let Z=[];for(let $=0;$<this.buffer.length;)Z.push(this.childString($)),$=this.buffer[$+3];return Z.join(",")}childString(Z){let $=this.buffer[Z],J=this.buffer[Z+3],K=this.set.types[$],X=K.name;if(/\W/.test(X)&&!K.isError)X=JSON.stringify(X);if(Z+=4,J==Z)return X;let Q=[];while(Z<J)Q.push(this.childString(Z)),Z=this.buffer[Z+3];return X+"("+Q.join(",")+")"}findChild(Z,$,J,K,X){let{buffer:Q}=this,U=-1;for(let Y=Z;Y!=$;Y=Q[Y+3])if(B3(X,K,Q[Y+1],Q[Y+2])){if(U=Y,J>0)break}return U}slice(Z,$,J){let K=this.buffer,X=new Uint16Array($-Z),Q=0;for(let U=Z,Y=0;U<$;){X[Y++]=K[U++],X[Y++]=K[U++]-J;let q=X[Y++]=K[U++]-J;X[Y++]=K[U++]-Z,Q=Math.max(Q,q)}return new p1(X,Q,this.set)}}function B3(Z,$,J,K){switch(Z){case-2:return J<$;case-1:return K>=$&&J<$;case 0:return J<$&&K>$;case 1:return J<=$&&K>$;case 2:return K>$;case 4:return!0}}function E7(Z,$,J,K){var X;while(Z.from==Z.to||(J<1?Z.from>=$:Z.from>$)||(J>-1?Z.to<=$:Z.to<$)){let U=!K&&Z instanceof $1&&Z.index<0?null:Z.parent;if(!U)return Z;Z=U}let Q=K?0:N0.IgnoreOverlays;if(K){for(let U=Z,Y=U.parent;Y;U=Y,Y=U.parent)if(U instanceof $1&&U.index<0&&((X=Y.enter($,J,Q))===null||X===void 0?void 0:X.from)!=U.from)Z=Y}for(;;){let U=Z.enter($,J,Q);if(!U)return Z;Z=U}}class s8{cursor(Z=0){return new h4(this,Z)}getChild(Z,$=null,J=null){let K=L3(this,Z,$,J);return K.length?K[0]:null}getChildren(Z,$=null,J=null){return L3(this,Z,$,J)}resolve(Z,$=0){return E7(this,Z,$,!1)}resolveInner(Z,$=0){return E7(this,Z,$,!0)}matchContext(Z){return l8(this.parent,Z)}enterUnfinishedNodesBefore(Z){let $=this.childBefore(Z),J=this;while($){let K=$.lastChild;if(!K||K.to!=$.to)break;if(K.type.isError&&K.from==K.to)J=$,$=K.prevSibling;else $=K}return J}get node(){return this}get next(){return this.parent}}class $1 extends s8{constructor(Z,$,J,K){super();this._tree=Z,this.from=$,this.index=J,this._parent=K}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(Z,$,J,K,X=0){var Q;for(let U=this;;){for(let{children:Y,positions:q}=U._tree,G=$>0?Y.length:-1;Z!=G;Z+=$){let W=Y[Z],j=q[Z]+U.from;if(!(X&N0.EnterBracketed&&W instanceof G0&&((Q=T5.get(W))===null||Q===void 0?void 0:Q.overlay)===null&&(j>=J||j+W.length<=J))&&!B3(K,J,j,j+W.length))continue;if(W instanceof p1){if(X&N0.ExcludeBuffers)continue;let _=W.findChild(0,W.buffer.length,$,J-j,K);if(_>-1)return new g1(new E3(U,W,Z,j),null,_)}else if(X&N0.IncludeAnonymous||(!W.type.isAnonymous||n8(W))){let _;if(!(X&N0.IgnoreMounts)&&(_=T5.get(W))&&!_.overlay)return new $1(_.tree,j,Z,U);let z=new $1(W,j,Z,U);return X&N0.IncludeAnonymous||!z.type.isAnonymous?z:z.nextChild($<0?W.children.length-1:0,$,J,K,X)}}if(X&N0.IncludeAnonymous||!U.type.isAnonymous)return null;if(U.index>=0)Z=U.index+$;else Z=$<0?-1:U._parent._tree.children.length;if(U=U._parent,!U)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(Z){return this.nextChild(0,1,Z,2)}childBefore(Z){return this.nextChild(this._tree.children.length-1,-1,Z,-2)}prop(Z){return this._tree.prop(Z)}enter(Z,$,J=0){let K;if(!(J&N0.IgnoreOverlays)&&(K=T5.get(this._tree))&&K.overlay){let X=Z-this.from,Q=J&N0.EnterBracketed&&K.bracketed;for(let{from:U,to:Y}of K.overlay)if(($>0||Q?U<=X:U<X)&&($<0||Q?Y>=X:Y>X))return new $1(K.tree,K.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,Z,$,J)}nextSignificantParent(){let Z=this;while(Z.type.isAnonymous&&Z._parent)Z=Z._parent;return Z}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function L3(Z,$,J,K){let X=Z.cursor(),Q=[];if(!X.firstChild())return Q;if(J!=null){for(let U=!1;!U;)if(U=X.type.is(J),!X.nextSibling())return Q}for(;;){if(K!=null&&X.type.is(K))return Q;if(X.type.is($))Q.push(X.node);if(!X.nextSibling())return K==null?Q:[]}}function l8(Z,$,J=$.length-1){for(let K=Z;J>=0;K=K.parent){if(!K)return!1;if(!K.type.isAnonymous){if($[J]&&$[J]!=K.name)return!1;J--}}return!0}class E3{constructor(Z,$,J,K){this.parent=Z,this.buffer=$,this.index=J,this.start=K}}class g1 extends s8{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(Z,$,J){super();this.context=Z,this._parent=$,this.index=J,this.type=Z.buffer.set.types[Z.buffer.buffer[J]]}child(Z,$,J){let{buffer:K}=this.context,X=K.findChild(this.index+4,K.buffer[this.index+3],Z,$-this.context.start,J);return X<0?null:new g1(this.context,this,X)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(Z){return this.child(1,Z,2)}childBefore(Z){return this.child(-1,Z,-2)}prop(Z){return this.type.prop(Z)}enter(Z,$,J=0){if(J&N0.ExcludeBuffers)return null;let{buffer:K}=this.context,X=K.findChild(this.index+4,K.buffer[this.index+3],$>0?1:-1,Z-this.context.start,$);return X<0?null:new g1(this.context,this,X)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(Z){return this._parent?null:this.context.parent.nextChild(this.context.index+Z,Z,0,4)}get nextSibling(){let{buffer:Z}=this.context,$=Z.buffer[this.index+3];if($<(this._parent?Z.buffer[this._parent.index+3]:Z.buffer.length))return new g1(this.context,this._parent,$);return this.externalSibling(1)}get prevSibling(){let{buffer:Z}=this.context,$=this._parent?this._parent.index+4:0;if(this.index==$)return this.externalSibling(-1);return new g1(this.context,this._parent,Z.findChild($,this.index,-1,0,4))}get tree(){return null}toTree(){let Z=[],$=[],{buffer:J}=this.context,K=this.index+4,X=J.buffer[this.index+3];if(X>K){let Q=J.buffer[this.index+1];Z.push(J.slice(K,X,Q)),$.push(0)}return new G0(this.type,Z,$,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function P3(Z){if(!Z.length)return null;let $=0,J=Z[0];for(let Q=1;Q<Z.length;Q++){let U=Z[Q];if(U.from>J.from||U.to<J.to)J=U,$=Q}let K=J instanceof $1&&J.index<0?null:J.parent,X=Z.slice();if(K)X[$]=K;else X.splice($,1);return new C3(X,J)}class C3{constructor(Z,$){this.heads=Z,this.node=$}get next(){return P3(this.heads)}}function zY(Z,$,J){let K=Z.resolveInner($,J),X=null;for(let Q=K instanceof $1?K:K.context.parent;Q;Q=Q.parent)if(Q.index<0){let U=Q.parent;(X||(X=[K])).push(U.resolve($,J)),Q=U}else{let U=T5.get(Q.tree);if(U&&U.overlay&&U.overlay[0].from<=$&&U.overlay[U.overlay.length-1].to>=$){let Y=new $1(U.tree,U.overlay[0].from+Q.from,-1,Q);(X||(X=[K])).push(E7(Y,$,J,!1))}}return X?P3(X):K}class h4{get name(){return this.type.name}constructor(Z,$=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=$&~N0.EnterBracketed,Z instanceof $1)this.yieldNode(Z);else{this._tree=Z.context.parent,this.buffer=Z.context;for(let J=Z._parent;J;J=J._parent)this.stack.unshift(J.index);this.bufferNode=Z,this.yieldBuf(Z.index)}}yieldNode(Z){if(!Z)return!1;return this._tree=Z,this.type=Z.type,this.from=Z.from,this.to=Z.to,!0}yieldBuf(Z,$){this.index=Z;let{start:J,buffer:K}=this.buffer;return this.type=$||K.set.types[K.buffer[Z]],this.from=J+K.buffer[Z+1],this.to=J+K.buffer[Z+2],!0}yield(Z){if(!Z)return!1;if(Z instanceof $1)return this.buffer=null,this.yieldNode(Z);return this.buffer=Z.context,this.yieldBuf(Z.index,Z.type)}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(Z,$,J){if(!this.buffer)return this.yield(this._tree.nextChild(Z<0?this._tree._tree.children.length-1:0,Z,$,J,this.mode));let{buffer:K}=this.buffer,X=K.findChild(this.index+4,K.buffer[this.index+3],Z,$-this.buffer.start,J);if(X<0)return!1;return this.stack.push(this.index),this.yieldBuf(X)}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(Z){return this.enterChild(1,Z,2)}childBefore(Z){return this.enterChild(-1,Z,-2)}enter(Z,$,J=this.mode){if(!this.buffer)return this.yield(this._tree.enter(Z,$,J));return J&N0.ExcludeBuffers?!1:this.enterChild(1,Z,$)}parent(){if(!this.buffer)return this.yieldNode(this.mode&N0.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let Z=this.mode&N0.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(Z)}sibling(Z){if(!this.buffer)return!this._tree._parent?!1:this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+Z,Z,0,4,this.mode));let{buffer:$}=this.buffer,J=this.stack.length-1;if(Z<0){let K=J<0?0:this.stack[J]+4;if(this.index!=K)return this.yieldBuf($.findChild(K,this.index,-1,0,4))}else{let K=$.buffer[this.index+3];if(K<(J<0?$.buffer.length:$.buffer[this.stack[J]+3]))return this.yieldBuf(K)}return J<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+Z,Z,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(Z){let $,J,{buffer:K}=this;if(K){if(Z>0){if(this.index<K.buffer.buffer.length)return!1}else for(let X=0;X<this.index;X++)if(K.buffer.buffer[X+3]<this.index)return!1;({index:$,parent:J}=K)}else({index:$,_parent:J}=this._tree);for(;J;{index:$,_parent:J}=J)if($>-1)for(let X=$+Z,Q=Z<0?-1:J._tree.children.length;X!=Q;X+=Z){let U=J._tree.children[X];if(this.mode&N0.IncludeAnonymous||U instanceof p1||!U.type.isAnonymous||n8(U))return!1}return!0}move(Z,$){if($&&this.enterChild(Z,0,4))return!0;for(;;){if(this.sibling(Z))return!0;if(this.atLastNode(Z)||!this.parent())return!1}}next(Z=!0){return this.move(1,Z)}prev(Z=!0){return this.move(-1,Z)}moveTo(Z,$=0){while(this.from==this.to||($<1?this.from>=Z:this.from>Z)||($>-1?this.to<=Z:this.to<Z))if(!this.parent())break;while(this.enterChild(1,Z,$));return this}get node(){if(!this.buffer)return this._tree;let Z=this.bufferNode,$=null,J=0;if(Z&&Z.context==this.buffer)Z:for(let K=this.index,X=this.stack.length;X>=0;){for(let Q=Z;Q;Q=Q._parent)if(Q.index==K){if(K==this.index)return Q;$=Q,J=X+1;break Z}K=this.stack[--X]}for(let K=J;K<this.stack.length;K++)$=new g1(this.buffer,$,this.stack[K]);return this.bufferNode=new g1(this.buffer,$,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(Z,$){for(let J=0;;){let K=!1;if(this.type.isAnonymous||Z(this)!==!1){if(this.firstChild()){J++;continue}if(!this.type.isAnonymous)K=!0}for(;;){if(K&&$)$(this);if(K=this.type.isAnonymous,!J)return;if(this.nextSibling())break;this.parent(),J--,K=!0}}}matchContext(Z){if(!this.buffer)return l8(this.node.parent,Z);let{buffer:$}=this.buffer,{types:J}=$.set;for(let K=Z.length-1,X=this.stack.length-1;K>=0;X--){if(X<0)return l8(this._tree,Z,K);let Q=J[$.buffer[this.stack[X]]];if(!Q.isAnonymous){if(Z[K]&&Z[K]!=Q.name)return!1;K--}}return!0}}function n8(Z){return Z.children.some(($)=>$ instanceof p1||!$.type.isAnonymous||n8($))}function OY(Z){var $;let{buffer:J,nodeSet:K,maxBufferLength:X=1024,reused:Q=[],minRepeatType:U=K.types.length}=Z,Y=Array.isArray(J)?new c8(J,J.length):J,q=K.types,G=0,W=0;function j(M,S,T,f,s,K0){let{id:c,start:w,end:e,size:a}=Y,$0=W,A0=G;if(a<0)if(Y.next(),a==-1){let H=Q[c];T.push(H),f.push(w-M);return}else if(a==-3){G=c;return}else if(a==-4){W=c;return}else throw RangeError(`Unrecognized record size: ${a}`);let x0=q[c],o0,D0,I=w-M;if(e-w<=X&&(D0=N(Y.pos-S,s))){let H=new Uint16Array(D0.size-D0.skip),k=Y.pos-D0.size,b=H.length;while(Y.pos>k)b=R(D0.start,H,b);o0=new p1(H,e-D0.start,K),I=D0.start-M}else{let H=Y.pos-a;Y.next();let k=[],b=[],m=c>=U?c:-1,u=0,g=e;while(Y.pos>H)if(m>=0&&Y.id==m&&Y.size>=0){if(Y.end<=g-X)V(k,b,w,u,Y.end,g,m,$0,A0),u=k.length,g=Y.end;Y.next()}else if(K0>2500)_(w,H,k,b);else j(w,H,k,b,m,K0+1);if(m>=0&&u>0&&u<k.length)V(k,b,w,u,w,g,m,$0,A0);if(k.reverse(),b.reverse(),m>-1&&u>0){let h=z(x0,A0);o0=i8(x0,k,b,0,k.length,0,e-w,h,h)}else o0=O(x0,k,b,e-w,$0-e,A0)}T.push(o0),f.push(I)}function _(M,S,T,f){let s=[],K0=0,c=-1;while(Y.pos>S){let{id:w,start:e,end:a,size:$0}=Y;if($0>4)Y.next();else if(c>-1&&e<c)break;else{if(c<0)c=a-X;s.push(w,e,a),K0++,Y.next()}}if(K0){let w=new Uint16Array(K0*4),e=s[s.length-2];for(let a=s.length-3,$0=0;a>=0;a-=3)w[$0++]=s[a],w[$0++]=s[a+1]-e,w[$0++]=s[a+2]-e,w[$0++]=$0;T.push(new p1(w,s[2]-e,K)),f.push(e-M)}}function z(M,S){return(T,f,s)=>{let K0=0,c=T.length-1,w,e;if(c>=0&&(w=T[c])instanceof G0){if(!c&&w.type==M&&w.length==s)return w;if(e=w.prop(l.lookAhead))K0=f[c]+w.length+e}return O(M,T,f,s,K0,S)}}function V(M,S,T,f,s,K0,c,w,e){let a=[],$0=[];while(M.length>f)a.push(M.pop()),$0.push(S.pop()+T-s);M.push(O(K.types[c],a,$0,K0-s,w-K0,e)),S.push(s-T)}function O(M,S,T,f,s,K0,c){if(K0){let w=[l.contextHash,K0];c=c?[w].concat(c):[w]}if(s>25){let w=[l.lookAhead,s];c=c?[w].concat(c):[w]}return new G0(M,S,T,f,c)}function N(M,S){let T=Y.fork(),f=0,s=0,K0=0,c=T.end-X,w={size:0,start:0,skip:0};Z:for(let e=T.pos-M;T.pos>e;){let a=T.size;if(T.id==S&&a>=0){w.size=f,w.start=s,w.skip=K0,K0+=4,f+=4,T.next();continue}let $0=T.pos-a;if(a<0||$0<e||T.start<c)break;let A0=T.id>=U?4:0,x0=T.start;T.next();while(T.pos>$0){if(T.size<0)if(T.size==-3||T.size==-4)A0+=4;else break Z;else if(T.id>=U)A0+=4;T.next()}s=x0,f+=a,K0+=A0}if(S<0||f==M)w.size=f,w.start=s,w.skip=K0;return w.size>4?w:void 0}function R(M,S,T){let{id:f,start:s,end:K0,size:c}=Y;if(Y.next(),c>=0&&f<U){let w=T;if(c>4){let e=Y.pos-(c-4);while(Y.pos>e)T=R(M,S,T)}S[--T]=w,S[--T]=K0-M,S[--T]=s-M,S[--T]=f}else if(c==-3)G=f;else if(c==-4)W=f;return T}let A=[],L=[];while(Y.pos>0)j(Z.start||0,Z.bufferStart||0,A,L,-1,0);let E=($=Z.length)!==null&&$!==void 0?$:A.length?L[0]+A[0].length:0;return new G0(q[Z.topID],A.reverse(),L.reverse(),E)}var M3=new WeakMap;function w4(Z,$){if(!Z.isAnonymous||$ instanceof p1||$.type!=Z)return 1;let J=M3.get($);if(J==null){J=1;for(let K of $.children){if(K.type!=Z||!(K instanceof G0)){J=1;break}J+=w4(Z,K)}M3.set($,J)}return J}function i8(Z,$,J,K,X,Q,U,Y,q){let G=0;for(let V=K;V<X;V++)G+=w4(Z,$[V]);let W=Math.ceil(G*1.5/8),j=[],_=[];function z(V,O,N,R,A){for(let L=N;L<R;){let E=L,M=O[L],S=w4(Z,V[L]);L++;for(;L<R;L++){let T=w4(Z,V[L]);if(S+T>=W)break;S+=T}if(L==E+1){if(S>W){let T=V[E];z(T.children,T.positions,0,T.children.length,O[E]+A);continue}j.push(V[E])}else{let T=O[L-1]+V[L-1].length-M;j.push(i8(Z,V,O,E,L,M,T,null,q))}_.push(M+A-Q)}}return z($,J,K,X,0),(Y||q)(j,_,U)}class d1{constructor(Z,$,J,K,X=!1,Q=!1){this.from=Z,this.to=$,this.tree=J,this.offset=K,this.open=(X?1:0)|(Q?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(Z,$=[],J=!1){let K=[new d1(0,Z.length,Z,0,!1,J)];for(let X of $)if(X.to>Z.length)K.push(X);return K}static applyChanges(Z,$,J=128){if(!$.length)return Z;let K=[],X=1,Q=Z.length?Z[0]:null;for(let U=0,Y=0,q=0;;U++){let G=U<$.length?$[U]:null,W=G?G.fromA:1e9;if(W-Y>=J)while(Q&&Q.from<W){let j=Q;if(Y>=j.from||W<=j.to||q){let _=Math.max(j.from,Y)-q,z=Math.min(j.to,W)-q;j=_>=z?null:new d1(_,z,j.tree,j.offset+q,U>0,!!G)}if(j)K.push(j);if(Q.to>W)break;Q=X<Z.length?Z[X++]:null}if(!G)break;Y=G.toA,q=G.toA-G.toB}return K}}class m4{startParse(Z,$,J){if(typeof Z=="string")Z=new T3(Z);return J=!J?[new x4(0,Z.length)]:J.length?J.map((K)=>new x4(K.from,K.to)):[new x4(0,0)],this.createParse(Z,$||[],J)}parse(Z,$,J){let K=this.startParse(Z,$,J);for(;;){let X=K.advance();if(X)return X}}}class T3{constructor(Z){this.string=Z}get length(){return this.string.length}chunk(Z){return this.string.slice(Z)}get lineChunks(){return!1}read(Z,$){return this.string.slice(Z,$)}}var T_=new l({perNode:!0});var VY=0;class J1{constructor(Z,$,J,K){this.name=Z,this.set=$,this.base=J,this.modified=K,this.id=VY++}toString(){let{name:Z}=this;for(let $ of this.modified)if($.name)Z=`${$.name}(${Z})`;return Z}static define(Z,$){let J=typeof Z=="string"?Z:"?";if(Z instanceof J1)$=Z;if($===null||$===void 0?void 0:$.base)throw Error("Can not derive from a modified tag");let K=new J1(J,[],null,[]);if(K.set.push(K),$)for(let X of $.set)K.set.push(X);return K}static defineModifier(Z){let $=new p4(Z);return(J)=>{if(J.modified.indexOf($)>-1)return J;return p4.get(J.base||J,J.modified.concat($).sort((K,X)=>K.id-X.id))}}}var HY=0;class p4{constructor(Z){this.name=Z,this.instances=[],this.id=HY++}static get(Z,$){if(!$.length)return Z;let J=$[0].instances.find((U)=>U.base==Z&&NY($,U.modified));if(J)return J;let K=[],X=new J1(Z.name,K,Z,$);for(let U of $)U.instances.push(X);let Q=IY($);for(let U of Z.set)if(!U.modified.length)for(let Y of Q)K.push(p4.get(U,Y));return X}}function NY(Z,$){return Z.length==$.length&&Z.every((J,K)=>J==$[K])}function IY(Z){let $=[[]];for(let J=0;J<Z.length;J++)for(let K=0,X=$.length;K<X;K++)$.push($[K].concat(Z[J]));return $.sort((J,K)=>K.length-J.length)}function S3(Z){let $=Object.create(null);for(let J in Z){let K=Z[J];if(!Array.isArray(K))K=[K];for(let X of J.split(" "))if(X){let Q=[],U=2,Y=X;for(let j=0;;){if(Y=="..."&&j>0&&j+3==X.length){U=1;break}let _=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(Y);if(!_)throw RangeError("Invalid path: "+X);if(Q.push(_[0]=="*"?"":_[0][0]=='"'?JSON.parse(_[0]):_[0]),j+=_[0].length,j==X.length)break;let z=X[j++];if(j==X.length&&z=="!"){U=0;break}if(z!="/")throw RangeError("Invalid path: "+X);Y=X.slice(j)}let q=Q.length-1,G=Q[q];if(!G)throw RangeError("Invalid path: "+X);let W=new y5(K,U,q>0?Q.slice(0,q):null);$[G]=W.sort($[G])}}return b3.add($)}var b3=new l({combine(Z,$){let J,K,X;while(Z||$){if(!Z||$&&Z.depth>=$.depth)X=$,$=$.next;else X=Z,Z=Z.next;if(J&&J.mode==X.mode&&!X.context&&!J.context)continue;let Q=new y5(X.tags,X.mode,X.context);if(J)J.next=Q;else K=Q;J=Q}return K}});class y5{constructor(Z,$,J,K){this.tags=Z,this.mode=$,this.context=J,this.next=K}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(Z){if(!Z||Z.depth<this.depth)return this.next=Z,this;return Z.next=this.sort(Z.next),Z}get depth(){return this.context?this.context.length:0}}y5.empty=new y5([],2,null);function o8(Z,$){let J=Object.create(null);for(let Q of Z)if(!Array.isArray(Q.tag))J[Q.tag.id]=Q.class;else for(let U of Q.tag)J[U.id]=Q.class;let{scope:K,all:X=null}=$||{};return{style:(Q)=>{let U=X;for(let Y of Q)for(let q of Y.set){let G=J[q.id];if(G){U=U?U+" "+G:G;break}}return U},scope:K}}function RY(Z,$){let J=null;for(let K of Z){let X=K.style($);if(X)J=J?J+" "+X:X}return J}function x3(Z,$,J,K=0,X=Z.length){let Q=new w3(K,Array.isArray($)?$:[$],J);Q.highlightRange(Z.cursor(),K,X,"",Q.highlighters),Q.flush(X)}class w3{constructor(Z,$,J){this.at=Z,this.highlighters=$,this.span=J,this.class=""}startSpan(Z,$){if($!=this.class){if(this.flush(Z),Z>this.at)this.at=Z;this.class=$}}flush(Z){if(Z>this.at&&this.class)this.span(this.at,Z,this.class)}highlightRange(Z,$,J,K,X){let{type:Q,from:U,to:Y}=Z;if(U>=J||Y<=$)return;if(Q.isTop)X=this.highlighters.filter((_)=>!_.scope||_.scope(Q));let q=K,G=FY(Z)||y5.empty,W=RY(X,G.tags);if(W){if(q)q+=" ";if(q+=W,G.mode==1)K+=(K?" ":"")+W}if(this.startSpan(Math.max($,U),q),G.opaque)return;let j=Z.tree&&Z.tree.prop(l.mounted);if(j&&j.overlay){let _=Z.node.enter(j.overlay[0].from+U,1),z=this.highlighters.filter((O)=>!O.scope||O.scope(j.tree.type)),V=Z.firstChild();for(let O=0,N=U;;O++){let R=O<j.overlay.length?j.overlay[O]:null,A=R?R.from+U:Y,L=Math.max($,N),E=Math.min(J,A);if(L<E&&V){while(Z.from<E)if(this.highlightRange(Z,L,E,K,X),this.startSpan(Math.min(E,Z.to),q),Z.to>=A||!Z.nextSibling())break}if(!R||A>J)break;if(N=R.to+U,N>$)this.highlightRange(_.cursor(),Math.max($,R.from+U),Math.min(J,N),"",z),this.startSpan(Math.min(J,N),q)}if(V)Z.parent()}else if(Z.firstChild()){if(j)K="";do{if(Z.to<=$)continue;if(Z.from>=J)break;this.highlightRange(Z,$,J,K,X),this.startSpan(Math.min(J,Z.to),q)}while(Z.nextSibling());Z.parent()}}}function FY(Z){let $=Z.type.prop(b3);while($&&$.context&&!Z.matchContext($.context))$=$.next;return $||null}var P=J1.define,u4=P(),l1=P(),y3=P(l1),k3=P(l1),c1=P(),f4=P(c1),a8=P(c1),C1=P(),Y5=P(C1),E1=P(),P1=P(),r8=P(),P7=P(r8),g4=P(),F={comment:u4,lineComment:P(u4),blockComment:P(u4),docComment:P(u4),name:l1,variableName:P(l1),typeName:y3,tagName:P(y3),propertyName:k3,attributeName:P(k3),className:P(l1),labelName:P(l1),namespace:P(l1),macroName:P(l1),literal:c1,string:f4,docString:P(f4),character:P(f4),attributeValue:P(f4),number:a8,integer:P(a8),float:P(a8),bool:P(c1),regexp:P(c1),escape:P(c1),color:P(c1),url:P(c1),keyword:E1,self:P(E1),null:P(E1),atom:P(E1),unit:P(E1),modifier:P(E1),operatorKeyword:P(E1),controlKeyword:P(E1),definitionKeyword:P(E1),moduleKeyword:P(E1),operator:P1,derefOperator:P(P1),arithmeticOperator:P(P1),logicOperator:P(P1),bitwiseOperator:P(P1),compareOperator:P(P1),updateOperator:P(P1),definitionOperator:P(P1),typeOperator:P(P1),controlOperator:P(P1),punctuation:r8,separator:P(r8),bracket:P7,angleBracket:P(P7),squareBracket:P(P7),paren:P(P7),brace:P(P7),content:C1,heading:Y5,heading1:P(Y5),heading2:P(Y5),heading3:P(Y5),heading4:P(Y5),heading5:P(Y5),heading6:P(Y5),contentSeparator:P(C1),list:P(C1),quote:P(C1),emphasis:P(C1),strong:P(C1),link:P(C1),monospace:P(C1),strikethrough:P(C1),inserted:P(),deleted:P(),changed:P(),invalid:P(),meta:g4,documentMeta:P(g4),annotation:P(g4),processingInstruction:P(g4),definition:J1.defineModifier("definition"),constant:J1.defineModifier("constant"),function:J1.defineModifier("function"),standard:J1.defineModifier("standard"),local:J1.defineModifier("local"),special:J1.defineModifier("special")};for(let Z in F){let $=F[Z];if($ instanceof J1)$.name=Z}var S_=o8([{tag:F.link,class:"tok-link"},{tag:F.heading,class:"tok-heading"},{tag:F.emphasis,class:"tok-emphasis"},{tag:F.strong,class:"tok-strong"},{tag:F.keyword,class:"tok-keyword"},{tag:F.atom,class:"tok-atom"},{tag:F.bool,class:"tok-bool"},{tag:F.url,class:"tok-url"},{tag:F.labelName,class:"tok-labelName"},{tag:F.inserted,class:"tok-inserted"},{tag:F.deleted,class:"tok-deleted"},{tag:F.literal,class:"tok-literal"},{tag:F.string,class:"tok-string"},{tag:F.number,class:"tok-number"},{tag:[F.regexp,F.escape,F.special(F.string)],class:"tok-string2"},{tag:F.variableName,class:"tok-variableName"},{tag:F.local(F.variableName),class:"tok-variableName tok-local"},{tag:F.definition(F.variableName),class:"tok-variableName tok-definition"},{tag:F.special(F.variableName),class:"tok-variableName2"},{tag:F.definition(F.propertyName),class:"tok-propertyName tok-definition"},{tag:F.typeName,class:"tok-typeName"},{tag:F.namespace,class:"tok-namespace"},{tag:F.className,class:"tok-className"},{tag:F.macroName,class:"tok-macroName"},{tag:F.propertyName,class:"tok-propertyName"},{tag:F.operator,class:"tok-operator"},{tag:F.comment,class:"tok-comment"},{tag:F.meta,class:"tok-meta"},{tag:F.invalid,class:"tok-invalid"},{tag:F.punctuation,class:"tok-punctuation"}]);var t8,k5=new l;function DY(Z){return C.define({combine:Z?($)=>$.concat(Z):void 0})}var AY=new l;class K1{constructor(Z,$,J=[],K=""){if(this.data=Z,this.name=K,!p.prototype.hasOwnProperty("tree"))Object.defineProperty(p.prototype,"tree",{get(){return L0(this)}});this.parser=$,this.extension=[s1.of(this),p.languageData.of((X,Q,U)=>{let Y=h3(X,Q,U),q=Y.type.prop(k5);if(!q)return[];let G=X.facet(q),W=Y.type.prop(AY);if(W){let j=Y.resolve(Q-Y.from,U);for(let _ of W)if(_.test(j,X)){let z=X.facet(_.facet);return _.type=="replace"?z:z.concat(G)}}return G})].concat(J)}isActiveAt(Z,$,J=-1){return h3(Z,$,J).type.prop(k5)==this.data}findRegions(Z){let $=Z.facet(s1);if(($===null||$===void 0?void 0:$.data)==this.data)return[{from:0,to:Z.doc.length}];if(!$||!$.allowsNesting)return[];let J=[],K=(X,Q)=>{if(X.prop(k5)==this.data){J.push({from:Q,to:Q+X.length});return}let U=X.prop(l.mounted);if(U){if(U.tree.prop(k5)==this.data){if(U.overlay)for(let Y of U.overlay)J.push({from:Y.from+Q,to:Y.to+Q});else J.push({from:Q,to:Q+X.length});return}else if(U.overlay){let Y=J.length;if(K(U.tree,U.overlay[0].from+Q),J.length>Y)return}}for(let Y=0;Y<X.children.length;Y++){let q=X.children[Y];if(q instanceof G0)K(q,X.positions[Y]+Q)}};return K(L0(Z),0),J}get allowsNesting(){return!0}}K1.setState=v.define();function h3(Z,$,J){let K=Z.facet(s1),X=L0(Z).topNode;if(!K||K.allowsNesting){for(let Q=X;Q;Q=Q.enter($,J,N0.ExcludeBuffers|N0.EnterBracketed))if(Q.type.isTop)X=Q}return X}function L0(Z){let $=Z.field(K1.state,!1);return $?$.tree:G0.empty}class l3{constructor(Z){this.doc=Z,this.cursorPos=0,this.string="",this.cursor=Z.iter()}get length(){return this.doc.length}syncTo(Z){return this.string=this.cursor.next(Z-this.cursorPos).value,this.cursorPos=Z+this.string.length,this.cursorPos-this.string.length}chunk(Z){return this.syncTo(Z),this.string}get lineChunks(){return!0}read(Z,$){let J=this.cursorPos-this.string.length;if(Z<J||$>=this.cursorPos)return this.doc.sliceString(Z,$);else return this.string.slice(Z-J,$-J)}}var C7=null;class S5{constructor(Z,$,J=[],K,X,Q,U,Y){this.parser=Z,this.state=$,this.fragments=J,this.tree=K,this.treeLen=X,this.viewport=Q,this.skipped=U,this.scheduleOn=Y,this.parse=null,this.tempSkipped=[]}static create(Z,$,J){return new S5(Z,$,[],G0.empty,0,J,[],null)}startParse(){return this.parser.startParse(new l3(this.state.doc),this.fragments)}work(Z,$){if($!=null&&$>=this.state.doc.length)$=void 0;if(this.tree!=G0.empty&&this.isDone($!==null&&$!==void 0?$:this.state.doc.length))return this.takeTree(),!0;return this.withContext(()=>{var J;if(typeof Z=="number"){let K=Date.now()+Z;Z=()=>Date.now()>K}if(!this.parse)this.parse=this.startParse();if($!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>$)&&$<this.state.doc.length)this.parse.stopAt($);for(;;){let K=this.parse.advance();if(K)if(this.fragments=this.withoutTempSkipped(d1.addTree(K,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(J=this.parse.stoppedAt)!==null&&J!==void 0?J:this.state.doc.length,this.tree=K,this.parse=null,this.treeLen<($!==null&&$!==void 0?$:this.state.doc.length))this.parse=this.startParse();else return!0;if(Z())return!1}})}takeTree(){let Z,$;if(this.parse&&(Z=this.parse.parsedPos)>=this.treeLen){if(this.parse.stoppedAt==null||this.parse.stoppedAt>Z)this.parse.stopAt(Z);this.withContext(()=>{while(!($=this.parse.advance()));}),this.treeLen=Z,this.tree=$,this.fragments=this.withoutTempSkipped(d1.addTree(this.tree,this.fragments,!0)),this.parse=null}}withContext(Z){let $=C7;C7=this;try{return Z()}finally{C7=$}}withoutTempSkipped(Z){for(let $;$=this.tempSkipped.pop();)Z=v3(Z,$.from,$.to);return Z}changes(Z,$){let{fragments:J,tree:K,treeLen:X,viewport:Q,skipped:U}=this;if(this.takeTree(),!Z.empty){let Y=[];if(Z.iterChangedRanges((q,G,W,j)=>Y.push({fromA:q,toA:G,fromB:W,toB:j})),J=d1.applyChanges(J,Y),K=G0.empty,X=0,Q={from:Z.mapPos(Q.from,-1),to:Z.mapPos(Q.to,1)},this.skipped.length){U=[];for(let q of this.skipped){let G=Z.mapPos(q.from,1),W=Z.mapPos(q.to,-1);if(G<W)U.push({from:G,to:W})}}}return new S5(this.parser,$,J,K,X,Q,U,this.scheduleOn)}updateViewport(Z){if(this.viewport.from==Z.from&&this.viewport.to==Z.to)return!1;this.viewport=Z;let $=this.skipped.length;for(let J=0;J<this.skipped.length;J++){let{from:K,to:X}=this.skipped[J];if(K<Z.to&&X>Z.from)this.fragments=v3(this.fragments,K,X),this.skipped.splice(J--,1)}if(this.skipped.length>=$)return!1;return this.reset(),!0}reset(){if(this.parse)this.takeTree(),this.parse=null}skipUntilInView(Z,$){this.skipped.push({from:Z,to:$})}static getSkippingParser(Z){return new class extends m4{createParse($,J,K){let X=K[0].from,Q=K[K.length-1].to;return{parsedPos:X,advance(){let Y=C7;if(Y){for(let q of K)Y.tempSkipped.push(q);if(Z)Y.scheduleOn=Y.scheduleOn?Promise.all([Y.scheduleOn,Z]):Z}return this.parsedPos=Q,new G0(v0.none,[],[],Q-X)},stoppedAt:null,stopAt(){}}}}}isDone(Z){Z=Math.min(Z,this.state.doc.length);let $=this.fragments;return this.treeLen>=Z&&$.length&&$[0].from==0&&$[0].to>=Z}static get(){return C7}}function v3(Z,$,J){return d1.applyChanges(Z,[{fromA:$,toA:J,fromB:$,toB:J}])}class b5{constructor(Z){this.context=Z,this.tree=Z.tree}apply(Z){if(!Z.docChanged&&this.tree==this.context.tree)return this;let $=this.context.changes(Z.changes,Z.state),J=this.context.treeLen==Z.startState.doc.length?void 0:Math.max(Z.changes.mapPos(this.context.treeLen),$.viewport.to);if(!$.work(20,J))$.takeTree();return new b5($)}static init(Z){let $=Math.min(3000,Z.doc.length),J=S5.create(Z.facet(s1).parser,Z,{from:0,to:$});if(!J.work(20,$))J.takeTree();return new b5(J)}}K1.state=j0.define({create:b5.init,update(Z,$){for(let J of $.effects)if(J.is(K1.setState))return J.value;if($.startState.facet(s1)!=$.state.facet(s1))return b5.init($.state);return Z.apply($)}});var c3=(Z)=>{let $=setTimeout(()=>Z(),500);return()=>clearTimeout($)};if(typeof requestIdleCallback<"u")c3=(Z)=>{let $=-1,J=setTimeout(()=>{$=requestIdleCallback(Z,{timeout:400})},100);return()=>$<0?clearTimeout(J):cancelIdleCallback($)};var e8=typeof navigator<"u"&&((t8=navigator.scheduling)===null||t8===void 0?void 0:t8.isInputPending)?()=>navigator.scheduling.isInputPending():null,LY=W0.fromClass(class{constructor($){this.view=$,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update($){let J=this.view.state.field(K1.state).context;if(J.updateViewport($.view.viewport)||this.view.viewport.to>J.treeLen)this.scheduleWork();if($.docChanged||$.selectionSet){if(this.view.hasFocus)this.chunkBudget+=50;this.scheduleWork()}this.checkAsyncSchedule(J)}scheduleWork(){if(this.working)return;let{state:$}=this.view,J=$.field(K1.state);if(J.tree!=J.context.tree||!J.context.isDone($.doc.length))this.working=c3(this.work)}work($){this.working=null;let J=Date.now();if(this.chunkEnd<J&&(this.chunkEnd<0||this.view.hasFocus))this.chunkEnd=J+30000,this.chunkBudget=3000;if(this.chunkBudget<=0)return;let{state:K,viewport:{to:X}}=this.view,Q=K.field(K1.state);if(Q.tree==Q.context.tree&&Q.context.isDone(X+1e5))return;let U=Date.now()+Math.min(this.chunkBudget,100,$&&!e8?Math.max(25,$.timeRemaining()-5):1e9),Y=Q.context.treeLen<X&&K.doc.length>X+1000,q=Q.context.work(()=>{return e8&&e8()||Date.now()>U},X+(Y?0:1e5));if(this.chunkBudget-=Date.now()-J,q||this.chunkBudget<=0)Q.context.takeTree(),this.view.dispatch({effects:K1.setState.of(new b5(Q.context))});if(this.chunkBudget>0&&!(q&&!Y))this.scheduleWork();this.checkAsyncSchedule(Q.context)}checkAsyncSchedule($){if($.scheduleOn)this.workScheduled++,$.scheduleOn.then(()=>this.scheduleWork()).catch((J)=>T0(this.view.state,J)).then(()=>this.workScheduled--),$.scheduleOn=null}destroy(){if(this.working)this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),s1=C.define({combine(Z){return Z.length?Z[0]:null},enables:(Z)=>[K1.state,LY,B.contentAttributes.compute([Z],($)=>{let J=$.facet(Z);return J&&J.name?{"data-language":J.name}:{}})]});var MY=C.define(),y7=C.define({combine:(Z)=>{if(!Z.length)return"  ";let $=Z[0];if(!$||/\S/.test($)||Array.from($).some((J)=>J!=$[0]))throw Error("Invalid indent unit: "+JSON.stringify(Z[0]));return $}});function n1(Z){let $=Z.facet(y7);return $.charCodeAt(0)==9?Z.tabSize*$.length:$.length}function x5(Z,$){let J="",K=Z.tabSize,X=Z.facet(y7)[0];if(X=="\t"){while($>=K)J+="\t",$-=K;X=" "}for(let Q=0;Q<$;Q++)J+=X;return J}function s4(Z,$){if(Z instanceof p)Z=new w5(Z);for(let K of Z.state.facet(MY)){let X=K(Z,$);if(X!==void 0)return X}let J=L0(Z.state);return J.length>=$?BY(Z,J,$):null}class w5{constructor(Z,$={}){this.state=Z,this.options=$,this.unit=n1(Z)}lineAt(Z,$=1){let J=this.state.doc.lineAt(Z),{simulateBreak:K,simulateDoubleBreak:X}=this.options;if(K!=null&&K>=J.from&&K<=J.to)if(X&&K==Z)return{text:"",from:Z};else if($<0?K<Z:K<=Z)return{text:J.text.slice(K-J.from),from:K};else return{text:J.text.slice(0,K-J.from),from:J.from};return J}textAfterPos(Z,$=1){if(this.options.simulateDoubleBreak&&Z==this.options.simulateBreak)return"";let{text:J,from:K}=this.lineAt(Z,$);return J.slice(Z-K,Math.min(J.length,Z+100-K))}column(Z,$=1){let{text:J,from:K}=this.lineAt(Z,$),X=this.countColumn(J,Z-K),Q=this.options.overrideIndentation?this.options.overrideIndentation(K):-1;if(Q>-1)X+=Q-this.countColumn(J,J.search(/\S|$/));return X}countColumn(Z,$=Z.length){return k1(Z,this.state.tabSize,$)}lineIndent(Z,$=1){let{text:J,from:K}=this.lineAt(Z,$),X=this.options.overrideIndentation;if(X){let Q=X(K);if(Q>-1)return Q}return this.countColumn(J,J.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}var s3=new l;function BY(Z,$,J){let K=$.resolveStack(J),X=$.resolveInner(J,-1).resolve(J,0).enterUnfinishedNodesBefore(J);if(X!=K.node){let Q=[];for(let U=X;U&&!(U.from<K.node.from||U.to>K.node.to||U.from==K.node.from&&U.type==K.node.type);U=U.parent)Q.push(U);for(let U=Q.length-1;U>=0;U--)K={node:Q[U],next:K}}return n3(K,Z,J)}function n3(Z,$,J){for(let K=Z;K;K=K.next){let X=PY(K.node);if(X)return X(QZ.create($,J,K))}return 0}function EY(Z){return Z.pos==Z.options.simulateBreak&&Z.options.simulateDoubleBreak}function PY(Z){let $=Z.type.prop(s3);if($)return $;let J=Z.firstChild,K;if(J&&(K=J.type.prop(l.closedBy))){let X=Z.lastChild,Q=X&&K.indexOf(X.name)>-1;return(U)=>kY(U,!0,1,void 0,Q&&!EY(U)?X.from:void 0)}return Z.parent==null?CY:null}function CY(){return 0}class QZ extends w5{constructor(Z,$,J){super(Z.state,Z.options);this.base=Z,this.pos=$,this.context=J}get node(){return this.context.node}static create(Z,$,J){return new QZ(Z,$,J)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(Z){let $=this.state.doc.lineAt(Z.from);for(;;){let J=Z.resolve($.from);while(J.parent&&J.parent.from==J.from)J=J.parent;if(TY(J,Z))break;$=this.state.doc.lineAt(J.from)}return this.lineIndent($.from)}continue(){return n3(this.context.next,this.base,this.pos)}}function TY(Z,$){for(let J=$;J;J=J.parent)if(Z==J)return!0;return!1}function yY(Z){let $=Z.node,J=$.childAfter($.from),K=$.lastChild;if(!J)return null;let X=Z.options.simulateBreak,Q=Z.state.doc.lineAt(J.from),U=X==null||X<=Q.from?Q.to:Math.min(Q.to,X);for(let Y=J.to;;){let q=$.childAfter(Y);if(!q||q==K)return null;if(!q.type.isSkipped){if(q.from>=U)return null;let G=/^ */.exec(Q.text.slice(J.to-Q.from))[0].length;return{from:J.from,to:J.to+G}}Y=q.to}}function kY(Z,$,J,K,X){let Q=Z.textAfter,U=Q.match(/^\s*/)[0].length,Y=K&&Q.slice(U,U+K.length)==K||X==Z.pos+U,q=$?yY(Z):null;if(q)return Y?Z.column(q.from):Z.column(q.to);return Z.baseIndent+(Y?0:Z.unit*J)}var SY=200;function i3(){return p.transactionFilter.of((Z)=>{if(!Z.docChanged||!Z.isUserEvent("input.type")&&!Z.isUserEvent("input.complete"))return Z;let $=Z.startState.languageDataAt("indentOnInput",Z.startState.selection.main.head);if(!$.length)return Z;let J=Z.newDoc,{head:K}=Z.newSelection.main,X=J.lineAt(K);if(K>X.from+SY)return Z;let Q=J.sliceString(X.from,K);if(!$.some((G)=>G.test(Q)))return Z;let{state:U}=Z,Y=-1,q=[];for(let{head:G}of U.selection.ranges){let W=U.doc.lineAt(G);if(W.from==Y)continue;Y=W.from;let j=s4(U,W.from);if(j==null)continue;let _=/^\s*/.exec(W.text)[0],z=x5(U,j);if(_!=z)q.push({from:W.from,to:W.from+_.length,insert:z})}return q.length?[Z,{changes:q,sequential:!0}]:Z})}var bY=C.define(),xY=new l;function wY(Z,$,J){let K=L0(Z);if(K.length<J)return null;let X=K.resolveStack(J,1),Q=null;for(let U=X;U;U=U.next){let Y=U.node;if(Y.to<=J||Y.from>J)continue;if(Q&&Y.from<$)break;let q=Y.type.prop(xY);if(q&&(Y.to<K.length-50||K.length==Z.doc.length||!hY(Y))){let G=q(Y,Z);if(G&&G.from<=J&&G.from>=$&&G.to>J)Q=G}}return Q}function hY(Z){let $=Z.lastChild;return $&&$.to==Z.to&&$.type.isError}function l4(Z,$,J){for(let K of Z.facet(bY)){let X=K(Z,$,J);if(X)return X}return wY(Z,$,J)}function a3(Z,$){let J=$.mapPos(Z.from,1),K=$.mapPos(Z.to,-1);return J>=K?void 0:{from:J,to:K}}var n4=v.define({map:a3}),k7=v.define({map:a3});function r3(Z){let $=[];for(let{head:J}of Z.state.selection.ranges){if($.some((K)=>K.from<=J&&K.to>=J))continue;$.push(Z.lineBlockAt(J))}return $}var q5=j0.define({create(){return x.none},update(Z,$){if($.isUserEvent("delete"))$.changes.iterChangedRanges((J,K)=>Z=m3(Z,J,K));Z=Z.map($.changes);for(let J of $.effects)if(J.is(n4)&&!vY(Z,J.value.from,J.value.to)){let{preparePlaceholder:K}=$.state.facet(UZ),X=!K?u3:x.replace({widget:new JJ(K($.state,J.value))});Z=Z.update({add:[X.range(J.value.from,J.value.to)]})}else if(J.is(k7))Z=Z.update({filter:(K,X)=>J.value.from!=K||J.value.to!=X,filterFrom:J.value.from,filterTo:J.value.to});if($.selection)Z=m3(Z,$.selection.main.head);return Z},provide:(Z)=>B.decorations.from(Z),toJSON(Z,$){let J=[];return Z.between(0,$.doc.length,(K,X)=>{J.push(K,X)}),J},fromJSON(Z){if(!Array.isArray(Z)||Z.length%2)throw RangeError("Invalid JSON for fold state");let $=[];for(let J=0;J<Z.length;){let K=Z[J++],X=Z[J++];if(typeof K!="number"||typeof X!="number")throw RangeError("Invalid JSON for fold state");$.push(u3.range(K,X))}return x.set($,!0)}});function m3(Z,$,J=$){let K=!1;return Z.between($,J,(X,Q)=>{if(X<J&&Q>$)K=!0}),!K?Z:Z.update({filterFrom:$,filterTo:J,filter:(X,Q)=>X>=J||Q<=$})}function c4(Z,$,J){var K;let X=null;return(K=Z.field(q5,!1))===null||K===void 0||K.between($,J,(Q,U)=>{if(!X||X.from>Q)X={from:Q,to:U}}),X}function vY(Z,$,J){let K=!1;return Z.between($,$,(X,Q)=>{if(X==$&&Q==J)K=!0}),K}function o3(Z,$){return Z.field(q5,!1)?$:$.concat(v.appendConfig.of(ZJ()))}var mY=(Z)=>{for(let $ of r3(Z)){let J=l4(Z.state,$.from,$.to);if(J)return Z.dispatch({effects:o3(Z.state,[n4.of(J),t3(Z,J)])}),!0}return!1},uY=(Z)=>{if(!Z.state.field(q5,!1))return!1;let $=[];for(let J of r3(Z)){let K=c4(Z.state,J.from,J.to);if(K)$.push(k7.of(K),t3(Z,K,!1))}if($.length)Z.dispatch({effects:$});return $.length>0};function t3(Z,$,J=!0){let K=Z.state.doc.lineAt($.from).number,X=Z.state.doc.lineAt($.to).number;return B.announce.of(`${Z.state.phrase(J?"Folded lines":"Unfolded lines")} ${K} ${Z.state.phrase("to")} ${X}.`)}var fY=(Z)=>{let{state:$}=Z,J=[];for(let K=0;K<$.doc.length;){let X=Z.lineBlockAt(K),Q=l4($,X.from,X.to);if(Q)J.push(n4.of(Q));K=(Q?Z.lineBlockAt(Q.to):X).to+1}if(J.length)Z.dispatch({effects:o3(Z.state,J)});return!!J.length},gY=(Z)=>{let $=Z.state.field(q5,!1);if(!$||!$.size)return!1;let J=[];return $.between(0,Z.state.doc.length,(K,X)=>{J.push(k7.of({from:K,to:X}))}),Z.dispatch({effects:J}),!0};var e3=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:mY},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:uY},{key:"Ctrl-Alt-[",run:fY},{key:"Ctrl-Alt-]",run:gY}],pY={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},UZ=C.define({combine(Z){return S0(Z,pY)}});function ZJ(Z){let $=[q5,lY];if(Z)$.push(UZ.of(Z));return $}function $J(Z,$){let{state:J}=Z,K=J.facet(UZ),X=(U)=>{let Y=Z.lineBlockAt(Z.posAtDOM(U.target)),q=c4(Z.state,Y.from,Y.to);if(q)Z.dispatch({effects:k7.of(q)});U.preventDefault()};if(K.placeholderDOM)return K.placeholderDOM(Z,X,$);let Q=document.createElement("span");return Q.textContent=K.placeholderText,Q.setAttribute("aria-label",J.phrase("folded code")),Q.title=J.phrase("unfold"),Q.className="cm-foldPlaceholder",Q.onclick=X,Q}var u3=x.replace({widget:new class extends i0{toDOM(Z){return $J(Z,null)}}});class JJ extends i0{constructor(Z){super();this.value=Z}eq(Z){return this.value==Z.value}toDOM(Z){return $J(Z,this.value)}}var dY={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class d4 extends Z1{constructor(Z,$){super();this.config=Z,this.open=$}eq(Z){return this.config==Z.config&&this.open==Z.open}toDOM(Z){if(this.config.markerDOM)return this.config.markerDOM(this.open);let $=document.createElement("span");return $.textContent=this.open?this.config.openText:this.config.closedText,$.title=Z.state.phrase(this.open?"Fold line":"Unfold line"),$}}function KJ(Z={}){let $={...dY,...Z},J=new d4($,!0),K=new d4($,!1),X=W0.fromClass(class{constructor(U){this.from=U.viewport.from,this.markers=this.buildMarkers(U)}update(U){if(U.docChanged||U.viewportChanged||U.startState.facet(s1)!=U.state.facet(s1)||U.startState.field(q5,!1)!=U.state.field(q5,!1)||L0(U.startState)!=L0(U.state)||$.foldingChanged(U))this.markers=this.buildMarkers(U.view)}buildMarkers(U){let Y=new l0;for(let q of U.viewportLineBlocks){let G=c4(U.state,q.from,q.to)?K:l4(U.state,q.from,q.to)?J:null;if(G)Y.add(q.from,q.from,G)}return Y.finish()}}),{domEventHandlers:Q}=$;return[X,p8({class:"cm-foldGutter",markers(U){var Y;return((Y=U.plugin(X))===null||Y===void 0?void 0:Y.markers)||d.empty},initialSpacer(){return new d4($,!1)},domEventHandlers:{...Q,click:(U,Y,q)=>{if(Q.click&&Q.click(U,Y,q))return!0;let G=c4(U.state,Y.from,Y.to);if(G)return U.dispatch({effects:k7.of(G)}),!0;let W=l4(U.state,Y.from,Y.to);if(W)return U.dispatch({effects:n4.of(W)}),!0;return!1}}}),ZJ()]}var lY=B.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class h5{constructor(Z,$){this.specs=Z;let J;function K(U){let Y=_1.newName();return(J||(J=Object.create(null)))["."+Y]=U,Y}let X=typeof $.all=="string"?$.all:$.all?K($.all):void 0,Q=$.scope;this.scope=Q instanceof K1?(U)=>U.prop(k5)==Q.data:Q?(U)=>U==Q:void 0,this.style=o8(Z.map((U)=>({tag:U.tag,class:U.class||K(Object.assign({},U,{tag:null}))})),{all:X}).style,this.module=J?new _1(J):null,this.themeType=$.themeType}static define(Z,$){return new h5(Z,$||{})}}var JZ=C.define(),XJ=C.define({combine(Z){return Z.length?[Z[0]]:null}});function ZZ(Z){let $=Z.facet(JZ);return $.length?$:Z.facet(XJ)}function i4(Z,$){let J=[cY],K;if(Z instanceof h5){if(Z.module)J.push(B.styleModule.of(Z.module));K=Z.themeType}if($===null||$===void 0?void 0:$.fallback)J.push(XJ.of(Z));else if(K)J.push(JZ.computeN([B.darkTheme],(X)=>{return X.facet(B.darkTheme)==(K=="dark")?[Z]:[]}));else J.push(JZ.of(Z));return J}class QJ{constructor(Z){this.markCache=Object.create(null),this.tree=L0(Z.state),this.decorations=this.buildDeco(Z,ZZ(Z.state)),this.decoratedTo=Z.viewport.to}update(Z){let $=L0(Z.state),J=ZZ(Z.state),K=J!=ZZ(Z.startState),{viewport:X}=Z.view,Q=Z.changes.mapPos(this.decoratedTo,1);if($.length<X.to&&!K&&$.type==this.tree.type&&Q>=X.to)this.decorations=this.decorations.map(Z.changes),this.decoratedTo=Q;else if($!=this.tree||Z.viewportChanged||K)this.tree=$,this.decorations=this.buildDeco(Z.view,J),this.decoratedTo=X.to}buildDeco(Z,$){if(!$||!this.tree.length)return x.none;let J=new l0;for(let{from:K,to:X}of Z.visibleRanges)x3(this.tree,$,(Q,U,Y)=>{J.add(Q,U,this.markCache[Y]||(this.markCache[Y]=x.mark({class:Y})))},K,X);return J.finish()}}var cY=j1.high(W0.fromClass(QJ,{decorations:(Z)=>Z.decorations})),UJ=h5.define([{tag:F.meta,color:"#404740"},{tag:F.link,textDecoration:"underline"},{tag:F.heading,textDecoration:"underline",fontWeight:"bold"},{tag:F.emphasis,fontStyle:"italic"},{tag:F.strong,fontWeight:"bold"},{tag:F.strikethrough,textDecoration:"line-through"},{tag:F.keyword,color:"#708"},{tag:[F.atom,F.bool,F.url,F.contentSeparator,F.labelName],color:"#219"},{tag:[F.literal,F.inserted],color:"#164"},{tag:[F.string,F.deleted],color:"#a11"},{tag:[F.regexp,F.escape,F.special(F.string)],color:"#e40"},{tag:F.definition(F.variableName),color:"#00f"},{tag:F.local(F.variableName),color:"#30a"},{tag:[F.typeName,F.namespace],color:"#085"},{tag:F.className,color:"#167"},{tag:[F.special(F.variableName),F.macroName],color:"#256"},{tag:F.definition(F.propertyName),color:"#00c"},{tag:F.comment,color:"#940"},{tag:F.invalid,color:"#f00"}]),sY=B.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),YJ=1e4,qJ="()[]{}",GJ=C.define({combine(Z){return S0(Z,{afterCursor:!0,brackets:qJ,maxScanDistance:YJ,renderMatch:aY})}}),nY=x.mark({class:"cm-matchingBracket"}),iY=x.mark({class:"cm-nonmatchingBracket"});function aY(Z){let $=[],J=Z.matched?nY:iY;if($.push(J.range(Z.start.from,Z.start.to)),Z.end)$.push(J.range(Z.end.from,Z.end.to));return $}var rY=j0.define({create(){return x.none},update(Z,$){if(!$.docChanged&&!$.selection)return Z;let J=[],K=$.state.facet(GJ);for(let X of $.state.selection.ranges){if(!X.empty)continue;let Q=N1($.state,X.head,-1,K)||X.head>0&&N1($.state,X.head-1,1,K)||K.afterCursor&&(N1($.state,X.head,1,K)||X.head<$.state.doc.length&&N1($.state,X.head+1,-1,K));if(Q)J=J.concat(K.renderMatch(Q,$.state))}return x.set(J,!0)},provide:(Z)=>B.decorations.from(Z)}),oY=[rY,sY];function WJ(Z={}){return[GJ.of(Z),oY]}var tY=new l;function KZ(Z,$,J){let K=Z.prop($<0?l.openedBy:l.closedBy);if(K)return K;if(Z.name.length==1){let X=J.indexOf(Z.name);if(X>-1&&X%2==($<0?1:0))return[J[X+$]]}return null}function XZ(Z){let $=Z.type.prop(tY);return $?$(Z.node):Z}function N1(Z,$,J,K={}){let X=K.maxScanDistance||YJ,Q=K.brackets||qJ,U=L0(Z),Y=U.resolveInner($,J);for(let q=Y;q;q=q.parent){let G=KZ(q.type,J,Q);if(G&&q.from<q.to){let W=XZ(q);if(W&&(J>0?$>=W.from&&$<W.to:$>W.from&&$<=W.to))return eY(Z,$,J,q,W,G,Q)}}return Zq(Z,$,J,U,Y.type,X,Q)}function eY(Z,$,J,K,X,Q,U){let Y=K.parent,q={from:X.from,to:X.to},G=0,W=Y===null||Y===void 0?void 0:Y.cursor();if(W&&(J<0?W.childBefore(K.from):W.childAfter(K.to)))do if(J<0?W.to<=K.from:W.from>=K.to){if(G==0&&Q.indexOf(W.type.name)>-1&&W.from<W.to){let j=XZ(W);return{start:q,end:j?{from:j.from,to:j.to}:void 0,matched:!0}}else if(KZ(W.type,J,U))G++;else if(KZ(W.type,-J,U)){if(G==0){let j=XZ(W);return{start:q,end:j&&j.from<j.to?{from:j.from,to:j.to}:void 0,matched:!1}}G--}}while(J<0?W.prevSibling():W.nextSibling());return{start:q,matched:!1}}function Zq(Z,$,J,K,X,Q,U){let Y=J<0?Z.sliceDoc($-1,$):Z.sliceDoc($,$+1),q=U.indexOf(Y);if(q<0||q%2==0!=J>0)return null;let G={from:J<0?$-1:$,to:J>0?$+1:$},W=Z.doc.iterRange($,J>0?Z.doc.length:0),j=0;for(let _=0;!W.next().done&&_<=Q;){let z=W.value;if(J<0)_+=z.length;let V=$+_*J;for(let O=J>0?0:z.length-1,N=J>0?z.length:-1;O!=N;O+=J){let R=U.indexOf(z[O]);if(R<0||K.resolveInner(V+O,1).type!=X)continue;if(R%2==0==J>0)j++;else if(j==1)return{start:G,end:{from:V+O,to:V+O+1},matched:R>>1==q>>1};else j--}if(J>0)_+=z.length}return W.done?{start:G,matched:!1}:null}function f3(Z,$,J,K=0,X=0){if($==null){if($=Z.search(/[^\s\u00a0]/),$==-1)$=Z.length}let Q=X;for(let U=K;U<$;U++)if(Z.charCodeAt(U)==9)Q+=J-Q%J;else Q++;return Q}class YZ{constructor(Z,$,J,K){this.string=Z,this.tabSize=$,this.indentUnit=J,this.overrideIndent=K,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(Z){let $=this.string.charAt(this.pos),J;if(typeof Z=="string")J=$==Z;else J=$&&(Z instanceof RegExp?Z.test($):Z($));if(J)return++this.pos,$}eatWhile(Z){let $=this.pos;while(this.eat(Z));return this.pos>$}eatSpace(){let Z=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>Z}skipToEnd(){this.pos=this.string.length}skipTo(Z){let $=this.string.indexOf(Z,this.pos);if($>-1)return this.pos=$,!0}backUp(Z){this.pos-=Z}column(){if(this.lastColumnPos<this.start)this.lastColumnValue=f3(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start;return this.lastColumnValue}indentation(){var Z;return(Z=this.overrideIndent)!==null&&Z!==void 0?Z:f3(this.string,null,this.tabSize)}match(Z,$,J){if(typeof Z=="string"){let K=(Q)=>J?Q.toLowerCase():Q,X=this.string.substr(this.pos,Z.length);if(K(X)==K(Z)){if($!==!1)this.pos+=Z.length;return!0}else return null}else{let K=this.string.slice(this.pos).match(Z);if(K&&K.index>0)return null;if(K&&$!==!1)this.pos+=K[0].length;return K}}current(){return this.string.slice(this.start,this.pos)}}function $q(Z){return{name:Z.name||"",token:Z.token,blankLine:Z.blankLine||(()=>{}),startState:Z.startState||(()=>!0),copyState:Z.copyState||Jq,indent:Z.indent||(()=>null),languageData:Z.languageData||{},tokenTable:Z.tokenTable||GZ,mergeTokens:Z.mergeTokens!==!1}}function Jq(Z){if(typeof Z!="object")return Z;let $={};for(let J in Z){let K=Z[J];$[J]=K instanceof Array?K.slice():K}return $}var g3=new WeakMap;class v5 extends K1{constructor(Z){let $=DY(Z.languageData),J=$q(Z),K,X=new class extends m4{createParse(Q,U,Y){return new _J(K,Q,U,Y)}};super($,X,[],Z.name);this.topNode=Uq($,this),K=this,this.streamParser=J,this.stateAfter=new l({perNode:!0}),this.tokenTable=Z.tokenTable?new WZ(J.tokenTable):Qq}static define(Z){return new v5(Z)}getIndent(Z){let $=void 0,{overrideIndentation:J}=Z.options;if(J){if($=g3.get(Z.state),$!=null&&$<Z.pos-1e4)$=void 0}let K=qZ(this,Z.node.tree,Z.node.from,Z.node.from,$!==null&&$!==void 0?$:Z.pos),X,Q;if(K)Q=K.state,X=K.pos+1;else Q=this.streamParser.startState(Z.unit),X=Z.node.from;if(Z.pos-X>1e4)return null;while(X<Z.pos){let Y=Z.state.doc.lineAt(X),q=Math.min(Z.pos,Y.to);if(Y.length){let G=J?J(Y.from):-1,W=new YZ(Y.text,Z.state.tabSize,Z.unit,G<0?void 0:G);while(W.pos<q-Y.from)zJ(this.streamParser.token,W,Q)}else this.streamParser.blankLine(Q,Z.unit);if(q==Z.pos)break;X=Y.to+1}let U=Z.lineAt(Z.pos);if(J&&$==null)g3.set(Z.state,U.from);return this.streamParser.indent(Q,/^\s*(.*)/.exec(U.text)[1],Z)}get allowsNesting(){return!1}}function qZ(Z,$,J,K,X){let Q=J>=K&&J+$.length<=X&&$.prop(Z.stateAfter);if(Q)return{state:Z.streamParser.copyState(Q),pos:J+$.length};for(let U=$.children.length-1;U>=0;U--){let Y=$.children[U],q=J+$.positions[U],G=Y instanceof G0&&q<X&&qZ(Z,Y,q,K,X);if(G)return G}return null}function jJ(Z,$,J,K,X){if(X&&J<=0&&K>=$.length)return $;if(!X&&J==0&&$.type==Z.topNode)X=!0;for(let Q=$.children.length-1;Q>=0;Q--){let U=$.positions[Q],Y=$.children[Q],q;if(U<K&&Y instanceof G0){if(!(q=jJ(Z,Y,J-U,K-U,X)))break;return!X?q:new G0($.type,$.children.slice(0,Q).concat(q),$.positions.slice(0,Q+1),U+q.length)}}return null}function Kq(Z,$,J,K,X){for(let Q of $){let U=Q.from+(Q.openStart?25:0),Y=Q.to-(Q.openEnd?25:0),q=U<=J&&Y>J&&qZ(Z,Q.tree,0-Q.offset,J,Y),G;if(q&&q.pos<=K&&(G=jJ(Z,Q.tree,J+Q.offset,q.pos+Q.offset,!1)))return{state:q.state,tree:G}}return{state:Z.streamParser.startState(X?n1(X):4),tree:G0.empty}}class _J{constructor(Z,$,J,K){this.lang=Z,this.input=$,this.fragments=J,this.ranges=K,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=K[K.length-1].to;let X=S5.get(),Q=K[0].from,{state:U,tree:Y}=Kq(Z,J,Q,this.to,X===null||X===void 0?void 0:X.state);this.state=U,this.parsedPos=this.chunkStart=Q+Y.length;for(let q=0;q<Y.children.length;q++)this.chunks.push(Y.children[q]),this.chunkPos.push(Y.positions[q]);if(X&&this.parsedPos<X.viewport.from-1e5&&K.some((q)=>q.from<=X.viewport.from&&q.to>=X.viewport.from))this.state=this.lang.streamParser.startState(n1(X.state)),X.skipUntilInView(this.parsedPos,X.viewport.from),this.parsedPos=X.viewport.from;this.moveRangeIndex()}advance(){let Z=S5.get(),$=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),J=Math.min($,this.chunkStart+512);if(Z)J=Math.min(J,Z.viewport.to);while(this.parsedPos<J)this.parseLine(Z);if(this.chunkStart<this.parsedPos)this.finishChunk();if(this.parsedPos>=$)return this.finish();if(Z&&this.parsedPos>=Z.viewport.to)return Z.skipUntilInView(this.parsedPos,$),this.finish();return null}stopAt(Z){this.stoppedAt=Z}lineAfter(Z){let $=this.input.chunk(Z);if(!this.input.lineChunks){let J=$.indexOf(`
`);if(J>-1)$=$.slice(0,J)}else if($==`
`)$="";return Z+$.length<=this.to?$:$.slice(0,this.to-Z)}nextLine(){let Z=this.parsedPos,$=this.lineAfter(Z),J=Z+$.length;for(let K=this.rangeIndex;;){let X=this.ranges[K].to;if(X>=J)break;if($=$.slice(0,X-(J-$.length)),K++,K==this.ranges.length)break;let Q=this.ranges[K].from,U=this.lineAfter(Q);$+=U,J=Q+U.length}return{line:$,end:J}}skipGapsTo(Z,$,J){for(;;){let K=this.ranges[this.rangeIndex].to,X=Z+$;if(J>0?K>X:K>=X)break;let Q=this.ranges[++this.rangeIndex].from;$+=Q-K}return $}moveRangeIndex(){while(this.ranges[this.rangeIndex].to<this.parsedPos)this.rangeIndex++}emitToken(Z,$,J,K){let X=4;if(this.ranges.length>1){K=this.skipGapsTo($,K,1),$+=K;let U=this.chunk.length;K=this.skipGapsTo(J,K,-1),J+=K,X+=this.chunk.length-U}let Q=this.chunk.length-4;if(this.lang.streamParser.mergeTokens&&X==4&&Q>=0&&this.chunk[Q]==Z&&this.chunk[Q+2]==$)this.chunk[Q+2]=J;else this.chunk.push(Z,$,J,X);return K}parseLine(Z){let{line:$,end:J}=this.nextLine(),K=0,{streamParser:X}=this.lang,Q=new YZ($,Z?Z.state.tabSize:4,Z?n1(Z.state):2);if(Q.eol())X.blankLine(this.state,Q.indentUnit);else while(!Q.eol()){let U=zJ(X.token,Q,this.state);if(U)K=this.emitToken(this.lang.tokenTable.resolve(U),this.parsedPos+Q.start,this.parsedPos+Q.pos,K);if(Q.start>1e4)break}if(this.parsedPos=J,this.moveRangeIndex(),this.parsedPos<this.to)this.parsedPos++}finishChunk(){let Z=G0.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Xq,topID:0,maxBufferLength:512,reused:this.chunkReused});Z=new G0(Z.type,Z.children,Z.positions,Z.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(Z),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new G0(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function zJ(Z,$,J){$.start=$.pos;for(let K=0;K<10;K++){let X=Z($,J);if($.pos>$.start)return X}throw Error("Stream parser failed to advance stream.")}var GZ=Object.create(null),T7=[v0.none],Xq=new v4(T7),p3=[],d3=Object.create(null),OJ=Object.create(null);for(let[Z,$]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])OJ[Z]=VJ(GZ,$);class WZ{constructor(Z){this.extra=Z,this.table=Object.assign(Object.create(null),OJ)}resolve(Z){return!Z?0:this.table[Z]||(this.table[Z]=VJ(this.extra,Z))}}var Qq=new WZ(GZ);function $Z(Z,$){if(p3.indexOf(Z)>-1)return;p3.push(Z),console.warn($)}function VJ(Z,$){let J=[];for(let Y of $.split(" ")){let q=[];for(let G of Y.split(".")){let W=Z[G]||F[G];if(!W)$Z(G,`Unknown highlighting tag ${G}`);else if(typeof W=="function")if(!q.length)$Z(G,`Modifier ${G} used at start of tag`);else q=q.map(W);else if(q.length)$Z(G,`Tag ${G} used as modifier`);else q=Array.isArray(W)?W:[W]}for(let G of q)J.push(G)}if(!J.length)return 0;let K=$.replace(/ /g,"_"),X=K+" "+J.map((Y)=>Y.id),Q=d3[X];if(Q)return Q.id;let U=d3[X]=v0.define({id:T7.length,name:K,props:[S3({[K]:J})]});return T7.push(U),U.id}function Uq(Z,$){let J=v0.define({id:T7.length,name:"Document",props:[k5.add(()=>Z),s3.add(()=>(K)=>$.getIndent(K))],top:!0});return T7.push(J),J}var u_={rtl:x.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:J0.RTL}),ltr:x.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:J0.LTR}),auto:x.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})};var Yq=(Z)=>{let{state:$}=Z,J=$.doc.lineAt($.selection.main.from),K=NZ(Z.state,J.from);return K.line?qq(Z):K.block?Wq(Z):!1};function HZ(Z,$){return({state:J,dispatch:K})=>{if(J.readOnly)return!1;let X=Z($,J);if(!X)return!1;return K(J.update(X)),!0}}var qq=HZ(zq,0);var Gq=HZ(MJ,0);var Wq=HZ((Z,$)=>MJ(Z,$,_q($)),0);function NZ(Z,$){let J=Z.languageDataAt("commentTokens",$,1);return J.length?J[0]:{}}var S7=50;function jq(Z,{open:$,close:J},K,X){let Q=Z.sliceDoc(K-S7,K),U=Z.sliceDoc(X,X+S7),Y=/\s*$/.exec(Q)[0].length,q=/^\s*/.exec(U)[0].length,G=Q.length-Y;if(Q.slice(G-$.length,G)==$&&U.slice(q,q+J.length)==J)return{open:{pos:K-Y,margin:Y&&1},close:{pos:X+q,margin:q&&1}};let W,j;if(X-K<=2*S7)W=j=Z.sliceDoc(K,X);else W=Z.sliceDoc(K,K+S7),j=Z.sliceDoc(X-S7,X);let _=/^\s*/.exec(W)[0].length,z=/\s*$/.exec(j)[0].length,V=j.length-z-J.length;if(W.slice(_,_+$.length)==$&&j.slice(V,V+J.length)==J)return{open:{pos:K+_+$.length,margin:/\s/.test(W.charAt(_+$.length))?1:0},close:{pos:X-z-J.length,margin:/\s/.test(j.charAt(V-1))?1:0}};return null}function _q(Z){let $=[];for(let J of Z.selection.ranges){let K=Z.doc.lineAt(J.from),X=J.to<=K.to?K:Z.doc.lineAt(J.to);if(X.from>K.from&&X.from==J.to)X=J.to==K.to+1?K:Z.doc.lineAt(J.to-1);let Q=$.length-1;if(Q>=0&&$[Q].to>K.from)$[Q].to=X.to;else $.push({from:K.from+/^\s*/.exec(K.text)[0].length,to:X.to})}return $}function MJ(Z,$,J=$.selection.ranges){let K=J.map((Q)=>NZ($,Q.from).block);if(!K.every((Q)=>Q))return null;let X=J.map((Q,U)=>jq($,K[U],Q.from,Q.to));if(Z!=2&&!X.every((Q)=>Q))return{changes:$.changes(J.map((Q,U)=>{if(X[U])return[];return[{from:Q.from,insert:K[U].open+" "},{from:Q.to,insert:" "+K[U].close}]}))};else if(Z!=1&&X.some((Q)=>Q)){let Q=[];for(let U=0,Y;U<X.length;U++)if(Y=X[U]){let q=K[U],{open:G,close:W}=Y;Q.push({from:G.pos-q.open.length,to:G.pos+G.margin},{from:W.pos-W.margin,to:W.pos+q.close.length})}return{changes:Q}}return null}function zq(Z,$,J=$.selection.ranges){let K=[],X=-1;for(let{from:Q,to:U}of J){let Y=K.length,q=1e9,G=NZ($,Q).line;if(!G)continue;for(let W=Q;W<=U;){let j=$.doc.lineAt(W);if(j.from>X&&(Q==U||U>j.from)){X=j.from;let _=/^\s*/.exec(j.text)[0].length,z=_==j.length,V=j.text.slice(_,_+G.length)==G?_:-1;if(_<j.text.length&&_<q)q=_;K.push({line:j,comment:V,token:G,indent:_,empty:z,single:!1})}W=j.to+1}if(q<1e9){for(let W=Y;W<K.length;W++)if(K[W].indent<K[W].line.text.length)K[W].indent=q}if(K.length==Y+1)K[Y].single=!0}if(Z!=2&&K.some((Q)=>Q.comment<0&&(!Q.empty||Q.single))){let Q=[];for(let{line:Y,token:q,indent:G,empty:W,single:j}of K)if(j||!W)Q.push({from:Y.from+G,insert:q+" "});let U=$.changes(Q);return{changes:U,selection:$.selection.map(U,1)}}else if(Z!=1&&K.some((Q)=>Q.comment>=0)){let Q=[];for(let{line:U,comment:Y,token:q}of K)if(Y>=0){let G=U.from+Y,W=G+q.length;if(U.text[W-U.from]==" ")W++;Q.push({from:G,to:W})}return{changes:Q}}return null}var _Z=s0.define(),Oq=s0.define(),Vq=C.define(),BJ=C.define({combine(Z){return S0(Z,{minDepth:100,newGroupDelay:500,joinToEvent:($,J)=>J},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:($,J)=>(K,X)=>$(K,X)||J(K,X)})}}),EJ=j0.define({create(){return T1.empty},update(Z,$){let J=$.state.facet(BJ),K=$.annotation(_Z);if(K){let q=g0.fromTransaction($,K.selection),G=K.side,W=G==0?Z.undone:Z.done;if(q)W=r4(W,W.length,J.minDepth,q);else W=yJ(W,$.startState.selection);return new T1(G==0?K.rest:W,G==0?W:K.rest)}let X=$.annotation(Oq);if(X=="full"||X=="before")Z=Z.isolate();if($.annotation(V0.addToHistory)===!1)return!$.changes.empty?Z.addMapping($.changes.desc):Z;let Q=g0.fromTransaction($),U=$.annotation(V0.time),Y=$.annotation(V0.userEvent);if(Q)Z=Z.addChanges(Q,U,Y,J,$);else if($.selection)Z=Z.addSelection($.startState.selection,U,Y,J.newGroupDelay);if(X=="full"||X=="after")Z=Z.isolate();return Z},toJSON(Z){return{done:Z.done.map(($)=>$.toJSON()),undone:Z.undone.map(($)=>$.toJSON())}},fromJSON(Z){return new T1(Z.done.map(g0.fromJSON),Z.undone.map(g0.fromJSON))}});function PJ(Z={}){return[EJ,BJ.of(Z),B.domEventHandlers({beforeinput($,J){let K=$.inputType=="historyUndo"?CJ:$.inputType=="historyRedo"?zZ:null;if(!K)return!1;return $.preventDefault(),K(J)}})]}function o4(Z,$){return function({state:J,dispatch:K}){if(!$&&J.readOnly)return!1;let X=J.field(EJ,!1);if(!X)return!1;let Q=X.pop(Z,J,$);if(!Q)return!1;return K(Q),!0}}var CJ=o4(0,!1),zZ=o4(1,!1),Hq=o4(0,!0),Nq=o4(1,!0);class g0{constructor(Z,$,J,K,X){this.changes=Z,this.effects=$,this.mapped=J,this.startSelection=K,this.selectionsAfter=X}setSelAfter(Z){return new g0(this.changes,this.effects,this.mapped,this.startSelection,Z)}toJSON(){var Z,$,J;return{changes:(Z=this.changes)===null||Z===void 0?void 0:Z.toJSON(),mapped:($=this.mapped)===null||$===void 0?void 0:$.toJSON(),startSelection:(J=this.startSelection)===null||J===void 0?void 0:J.toJSON(),selectionsAfter:this.selectionsAfter.map((K)=>K.toJSON())}}static fromJSON(Z){return new g0(Z.changes&&R0.fromJSON(Z.changes),[],Z.mapped&&G1.fromJSON(Z.mapped),Z.startSelection&&D.fromJSON(Z.startSelection),Z.selectionsAfter.map(D.fromJSON))}static fromTransaction(Z,$){let J=X1;for(let K of Z.startState.facet(Vq)){let X=K(Z);if(X.length)J=J.concat(X)}if(!J.length&&Z.changes.empty)return null;return new g0(Z.changes.invert(Z.startState.doc),J,void 0,$||Z.startState.selection,X1)}static selection(Z){return new g0(void 0,X1,void 0,void 0,Z)}}function r4(Z,$,J,K){let X=$+1>J+20?$-J-1:0,Q=Z.slice(X,$);return Q.push(K),Q}function Iq(Z,$){let J=[],K=!1;return Z.iterChangedRanges((X,Q)=>J.push(X,Q)),$.iterChangedRanges((X,Q,U,Y)=>{for(let q=0;q<J.length;){let G=J[q++],W=J[q++];if(Y>=G&&U<=W)K=!0}}),K}function Rq(Z,$){return Z.ranges.length==$.ranges.length&&Z.ranges.filter((J,K)=>J.empty!=$.ranges[K].empty).length===0}function TJ(Z,$){return!Z.length?$:!$.length?Z:Z.concat($)}var X1=[],Fq=200;function yJ(Z,$){if(!Z.length)return[g0.selection([$])];else{let J=Z[Z.length-1],K=J.selectionsAfter.slice(Math.max(0,J.selectionsAfter.length-Fq));if(K.length&&K[K.length-1].eq($))return Z;return K.push($),r4(Z,Z.length-1,1e9,J.setSelAfter(K))}}function Dq(Z){let $=Z[Z.length-1],J=Z.slice();return J[Z.length-1]=$.setSelAfter($.selectionsAfter.slice(0,$.selectionsAfter.length-1)),J}function jZ(Z,$){if(!Z.length)return Z;let J=Z.length,K=X1;while(J){let X=Aq(Z[J-1],$,K);if(X.changes&&!X.changes.empty||X.effects.length){let Q=Z.slice(0,J);return Q[J-1]=X,Q}else $=X.mapped,J--,K=X.selectionsAfter}return K.length?[g0.selection(K)]:X1}function Aq(Z,$,J){let K=TJ(Z.selectionsAfter.length?Z.selectionsAfter.map((Y)=>Y.map($)):X1,J);if(!Z.changes)return g0.selection(K);let X=Z.changes.map($),Q=$.mapDesc(Z.changes,!0),U=Z.mapped?Z.mapped.composeDesc(Q):Q;return new g0(X,v.mapEffects(Z.effects,$),U,Z.startSelection.map(Q),K)}var Lq=/^(input\.type|delete)($|\.)/;class T1{constructor(Z,$,J=0,K=void 0){this.done=Z,this.undone=$,this.prevTime=J,this.prevUserEvent=K}isolate(){return this.prevTime?new T1(this.done,this.undone):this}addChanges(Z,$,J,K,X){let Q=this.done,U=Q[Q.length-1];if(U&&U.changes&&!U.changes.empty&&Z.changes&&(!J||Lq.test(J))&&(!U.selectionsAfter.length&&$-this.prevTime<K.newGroupDelay&&K.joinToEvent(X,Iq(U.changes,Z.changes))||J=="input.type.compose"))Q=r4(Q,Q.length-1,K.minDepth,new g0(Z.changes.compose(U.changes),TJ(v.mapEffects(Z.effects,U.changes),U.effects),U.mapped,U.startSelection,X1));else Q=r4(Q,Q.length,K.minDepth,Z);return new T1(Q,X1,$,J)}addSelection(Z,$,J,K){let X=this.done.length?this.done[this.done.length-1].selectionsAfter:X1;if(X.length>0&&$-this.prevTime<K&&J==this.prevUserEvent&&J&&/^select($|\.)/.test(J)&&Rq(X[X.length-1],Z))return this;return new T1(yJ(this.done,Z),this.undone,$,J)}addMapping(Z){return new T1(jZ(this.done,Z),jZ(this.undone,Z),this.prevTime,this.prevUserEvent)}pop(Z,$,J){let K=Z==0?this.done:this.undone;if(K.length==0)return null;let X=K[K.length-1],Q=X.selectionsAfter[0]||$.selection;if(J&&X.selectionsAfter.length)return $.update({selection:X.selectionsAfter[X.selectionsAfter.length-1],annotations:_Z.of({side:Z,rest:Dq(K),selection:Q}),userEvent:Z==0?"select.undo":"select.redo",scrollIntoView:!0});else if(!X.changes)return null;else{let U=K.length==1?X1:K.slice(0,K.length-1);if(X.mapped)U=jZ(U,X.mapped);return $.update({changes:X.changes,selection:X.startSelection,effects:X.effects,annotations:_Z.of({side:Z,rest:U,selection:Q}),filter:!1,userEvent:Z==0?"undo":"redo",scrollIntoView:!0})}}}T1.empty=new T1(X1,X1);var kJ=[{key:"Mod-z",run:CJ,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:zZ,preventDefault:!0},{linux:"Ctrl-Shift-z",run:zZ,preventDefault:!0},{key:"Mod-u",run:Hq,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Nq,preventDefault:!0}];function m5(Z,$){return D.create(Z.ranges.map($),Z.mainIndex)}function I1(Z,$){return Z.update({selection:$,scrollIntoView:!0,userEvent:"select"})}function R1({state:Z,dispatch:$},J){let K=m5(Z.selection,J);if(K.eq(Z.selection,!0))return!1;return $(I1(Z,K)),!0}function t4(Z,$){return D.cursor($?Z.to:Z.from)}function SJ(Z,$){return R1(Z,(J)=>J.empty?Z.moveByChar(J,$):t4(J,$))}function b0(Z){return Z.textDirectionAt(Z.state.selection.main.head)==J0.LTR}var bJ=(Z)=>SJ(Z,!b0(Z)),xJ=(Z)=>SJ(Z,b0(Z));function wJ(Z,$){return R1(Z,(J)=>J.empty?Z.moveByGroup(J,$):t4(J,$))}var Mq=(Z)=>wJ(Z,!b0(Z)),Bq=(Z)=>wJ(Z,b0(Z));var a_=typeof Intl<"u"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function Eq(Z,$,J){if($.type.prop(J))return!0;let K=$.to-$.from;return K&&(K>2||/[^\s,.;:]/.test(Z.sliceDoc($.from,$.to)))||$.firstChild}function e4(Z,$,J){let K=L0(Z).resolveInner($.head),X=J?l.closedBy:l.openedBy;for(let q=$.head;;){let G=J?K.childAfter(q):K.childBefore(q);if(!G)break;if(Eq(Z,G,X))K=G;else q=J?G.to:G.from}let Q=K.type.prop(X),U,Y;if(Q&&(U=J?N1(Z,K.from,1):N1(Z,K.to,-1))&&U.matched)Y=J?U.end.to:U.end.from;else Y=J?K.to:K.from;return D.cursor(Y,J?-1:1)}var Pq=(Z)=>R1(Z,($)=>e4(Z.state,$,!b0(Z))),Cq=(Z)=>R1(Z,($)=>e4(Z.state,$,b0(Z)));function hJ(Z,$){return R1(Z,(J)=>{if(!J.empty)return t4(J,$);let K=Z.moveVertically(J,$);return K.head!=J.head?K:Z.moveToLineBoundary(J,$)})}var vJ=(Z)=>hJ(Z,!1),mJ=(Z)=>hJ(Z,!0);function uJ(Z){let $=Z.scrollDOM.clientHeight<Z.scrollDOM.scrollHeight-2,J=0,K=0,X;if($){for(let Q of Z.state.facet(B.scrollMargins)){let U=Q(Z);if(U===null||U===void 0?void 0:U.top)J=Math.max(U===null||U===void 0?void 0:U.top,J);if(U===null||U===void 0?void 0:U.bottom)K=Math.max(U===null||U===void 0?void 0:U.bottom,K)}X=Z.scrollDOM.clientHeight-J-K}else X=(Z.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:J,marginBottom:K,selfScroll:$,height:Math.max(Z.defaultLineHeight,X-5)}}function fJ(Z,$){let J=uJ(Z),{state:K}=Z,X=m5(K.selection,(U)=>{return U.empty?Z.moveVertically(U,$,J.height):t4(U,$)});if(X.eq(K.selection))return!1;let Q;if(J.selfScroll){let U=Z.coordsAtPos(K.selection.main.head),Y=Z.scrollDOM.getBoundingClientRect(),q=Y.top+J.marginTop,G=Y.bottom-J.marginBottom;if(U&&U.top>q&&U.bottom<G)Q=B.scrollIntoView(X.main.head,{y:"start",yMargin:U.top-q})}return Z.dispatch(I1(K,X),{effects:Q}),!0}var HJ=(Z)=>fJ(Z,!1),OZ=(Z)=>fJ(Z,!0);function i1(Z,$,J){let K=Z.lineBlockAt($.head),X=Z.moveToLineBoundary($,J);if(X.head==$.head&&X.head!=(J?K.to:K.from))X=Z.moveToLineBoundary($,J,!1);if(!J&&X.head==K.from&&K.length){let Q=/^\s*/.exec(Z.state.sliceDoc(K.from,Math.min(K.from+100,K.to)))[0].length;if(Q&&$.head!=K.from+Q)X=D.cursor(K.from+Q)}return X}var Tq=(Z)=>R1(Z,($)=>i1(Z,$,!0)),yq=(Z)=>R1(Z,($)=>i1(Z,$,!1)),kq=(Z)=>R1(Z,($)=>i1(Z,$,!b0(Z))),Sq=(Z)=>R1(Z,($)=>i1(Z,$,b0(Z))),bq=(Z)=>R1(Z,($)=>D.cursor(Z.lineBlockAt($.head).from,1)),xq=(Z)=>R1(Z,($)=>D.cursor(Z.lineBlockAt($.head).to,-1));function wq(Z,$,J){let K=!1,X=m5(Z.selection,(Q)=>{let U=N1(Z,Q.head,-1)||N1(Z,Q.head,1)||Q.head>0&&N1(Z,Q.head-1,1)||Q.head<Z.doc.length&&N1(Z,Q.head+1,-1);if(!U||!U.end)return Q;K=!0;let Y=U.start.from==Q.head?U.end.to:U.end.from;return J?D.range(Q.anchor,Y):D.cursor(Y)});if(!K)return!1;return $(I1(Z,X)),!0}var hq=({state:Z,dispatch:$})=>wq(Z,$,!1);function Q1(Z,$){let J=m5(Z.state.selection,(K)=>{let X=$(K);return D.range(K.anchor,X.head,X.goalColumn,X.bidiLevel||void 0)});if(J.eq(Z.state.selection))return!1;return Z.dispatch(I1(Z.state,J)),!0}function gJ(Z,$){return Q1(Z,(J)=>Z.moveByChar(J,$))}var pJ=(Z)=>gJ(Z,!b0(Z)),dJ=(Z)=>gJ(Z,b0(Z));function lJ(Z,$){return Q1(Z,(J)=>Z.moveByGroup(J,$))}var vq=(Z)=>lJ(Z,!b0(Z)),mq=(Z)=>lJ(Z,b0(Z));var uq=(Z)=>Q1(Z,($)=>e4(Z.state,$,!b0(Z))),fq=(Z)=>Q1(Z,($)=>e4(Z.state,$,b0(Z)));function cJ(Z,$){return Q1(Z,(J)=>Z.moveVertically(J,$))}var sJ=(Z)=>cJ(Z,!1),nJ=(Z)=>cJ(Z,!0);function iJ(Z,$){return Q1(Z,(J)=>Z.moveVertically(J,$,uJ(Z).height))}var NJ=(Z)=>iJ(Z,!1),IJ=(Z)=>iJ(Z,!0),gq=(Z)=>Q1(Z,($)=>i1(Z,$,!0)),pq=(Z)=>Q1(Z,($)=>i1(Z,$,!1)),dq=(Z)=>Q1(Z,($)=>i1(Z,$,!b0(Z))),lq=(Z)=>Q1(Z,($)=>i1(Z,$,b0(Z))),cq=(Z)=>Q1(Z,($)=>D.cursor(Z.lineBlockAt($.head).from)),sq=(Z)=>Q1(Z,($)=>D.cursor(Z.lineBlockAt($.head).to)),RJ=({state:Z,dispatch:$})=>{return $(I1(Z,{anchor:0})),!0},FJ=({state:Z,dispatch:$})=>{return $(I1(Z,{anchor:Z.doc.length})),!0},DJ=({state:Z,dispatch:$})=>{return $(I1(Z,{anchor:Z.selection.main.anchor,head:0})),!0},AJ=({state:Z,dispatch:$})=>{return $(I1(Z,{anchor:Z.selection.main.anchor,head:Z.doc.length})),!0},nq=({state:Z,dispatch:$})=>{return $(Z.update({selection:{anchor:0,head:Z.doc.length},userEvent:"select"})),!0},iq=({state:Z,dispatch:$})=>{let J=Z9(Z).map(({from:K,to:X})=>D.range(K,Math.min(X+1,Z.doc.length)));return $(Z.update({selection:D.create(J),userEvent:"select"})),!0},aq=({state:Z,dispatch:$})=>{let J=m5(Z.selection,(K)=>{let X=L0(Z),Q=X.resolveStack(K.from,1);if(K.empty){let U=X.resolveStack(K.from,-1);if(U.node.from>=Q.node.from&&U.node.to<=Q.node.to)Q=U}for(let U=Q;U;U=U.next){let{node:Y}=U;if((Y.from<K.from&&Y.to>=K.to||Y.to>K.to&&Y.from<=K.from)&&U.next)return D.range(Y.to,Y.from)}return K});if(J.eq(Z.selection))return!1;return $(I1(Z,J)),!0};function aJ(Z,$){let{state:J}=Z,K=J.selection,X=J.selection.ranges.slice();for(let Q of J.selection.ranges){let U=J.doc.lineAt(Q.head);if($?U.to<Z.state.doc.length:U.from>0)for(let Y=Q;;){let q=Z.moveVertically(Y,$);if(q.head<U.from||q.head>U.to){if(!X.some((G)=>G.head==q.head))X.push(q);break}else if(q.head==Y.head)break;else Y=q}}if(X.length==K.ranges.length)return!1;return Z.dispatch(I1(J,D.create(X,X.length-1))),!0}var rq=(Z)=>aJ(Z,!1),oq=(Z)=>aJ(Z,!0),tq=({state:Z,dispatch:$})=>{let J=Z.selection,K=null;if(J.ranges.length>1)K=D.create([J.main]);else if(!J.main.empty)K=D.create([D.cursor(J.main.head)]);if(!K)return!1;return $(I1(Z,K)),!0};function b7(Z,$){if(Z.state.readOnly)return!1;let J="delete.selection",{state:K}=Z,X=K.changeByRange((Q)=>{let{from:U,to:Y}=Q;if(U==Y){let q=$(Q);if(q<U)J="delete.backward",q=a4(Z,q,!1);else if(q>U)J="delete.forward",q=a4(Z,q,!0);U=Math.min(U,q),Y=Math.max(Y,q)}else U=a4(Z,U,!1),Y=a4(Z,Y,!0);return U==Y?{range:Q}:{changes:{from:U,to:Y},range:D.cursor(U,U<Q.head?-1:1)}});if(X.changes.empty)return!1;return Z.dispatch(K.update(X,{scrollIntoView:!0,userEvent:J,effects:J=="delete.selection"?B.announce.of(K.phrase("Selection deleted")):void 0})),!0}function a4(Z,$,J){if(Z instanceof B)for(let K of Z.state.facet(B.atomicRanges).map((X)=>X(Z)))K.between($,$,(X,Q)=>{if(X<$&&Q>$)$=J?Q:X});return $}var rJ=(Z,$,J)=>b7(Z,(K)=>{let X=K.from,{state:Q}=Z,U=Q.doc.lineAt(X),Y,q;if(J&&!$&&X>U.from&&X<U.from+200&&!/[^ \t]/.test(Y=U.text.slice(0,X-U.from))){if(Y[Y.length-1]=="\t")return X-1;let G=k1(Y,Q.tabSize),W=G%n1(Q)||n1(Q);for(let j=0;j<W&&Y[Y.length-1-j]==" ";j++)X--;q=X}else if(q=H0(U.text,X-U.from,$,$)+U.from,q==X&&U.number!=($?Q.doc.lines:1))q+=$?1:-1;else if(!$&&/[\ufe00-\ufe0f]/.test(U.text.slice(q-U.from,X-U.from)))q=H0(U.text,q-U.from,!1,!1)+U.from;return q}),VZ=(Z)=>rJ(Z,!1,!0);var oJ=(Z)=>rJ(Z,!0,!1),tJ=(Z,$)=>b7(Z,(J)=>{let K=J.head,{state:X}=Z,Q=X.doc.lineAt(K),U=X.charCategorizer(K);for(let Y=null;;){if(K==($?Q.to:Q.from)){if(K==J.head&&Q.number!=($?X.doc.lines:1))K+=$?1:-1;break}let q=H0(Q.text,K-Q.from,$)+Q.from,G=Q.text.slice(Math.min(K,q)-Q.from,Math.max(K,q)-Q.from),W=U(G);if(Y!=null&&W!=Y)break;if(G!=" "||K!=J.head)Y=W;K=q}return K}),eJ=(Z)=>tJ(Z,!1),eq=(Z)=>tJ(Z,!0);var ZG=(Z)=>b7(Z,($)=>{let J=Z.lineBlockAt($.head).to;return $.head<J?J:Math.min(Z.state.doc.length,$.head+1)});var $G=(Z)=>b7(Z,($)=>{let J=Z.moveToLineBoundary($,!1).head;return $.head>J?J:Math.max(0,$.head-1)}),JG=(Z)=>b7(Z,($)=>{let J=Z.moveToLineBoundary($,!0).head;return $.head<J?J:Math.min(Z.state.doc.length,$.head+1)});var KG=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let J=Z.changeByRange((K)=>{return{changes:{from:K.from,to:K.to,insert:i.of(["",""])},range:D.cursor(K.from)}});return $(Z.update(J,{scrollIntoView:!0,userEvent:"input"})),!0},XG=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let J=Z.changeByRange((K)=>{if(!K.empty||K.from==0||K.from==Z.doc.length)return{range:K};let X=K.from,Q=Z.doc.lineAt(X),U=X==Q.from?X-1:H0(Q.text,X-Q.from,!1)+Q.from,Y=X==Q.to?X+1:H0(Q.text,X-Q.from,!0)+Q.from;return{changes:{from:U,to:Y,insert:Z.doc.slice(X,Y).append(Z.doc.slice(U,X))},range:D.cursor(Y)}});if(J.changes.empty)return!1;return $(Z.update(J,{scrollIntoView:!0,userEvent:"move.character"})),!0};function Z9(Z){let $=[],J=-1;for(let K of Z.selection.ranges){let X=Z.doc.lineAt(K.from),Q=Z.doc.lineAt(K.to);if(!K.empty&&K.to==Q.from)Q=Z.doc.lineAt(K.to-1);if(J>=X.number){let U=$[$.length-1];U.to=Q.to,U.ranges.push(K)}else $.push({from:X.from,to:Q.to,ranges:[K]});J=Q.number+1}return $}function ZK(Z,$,J){if(Z.readOnly)return!1;let K=[],X=[];for(let Q of Z9(Z)){if(J?Q.to==Z.doc.length:Q.from==0)continue;let U=Z.doc.lineAt(J?Q.to+1:Q.from-1),Y=U.length+1;if(J){K.push({from:Q.to,to:U.to},{from:Q.from,insert:U.text+Z.lineBreak});for(let q of Q.ranges)X.push(D.range(Math.min(Z.doc.length,q.anchor+Y),Math.min(Z.doc.length,q.head+Y)))}else{K.push({from:U.from,to:Q.from},{from:Q.to,insert:Z.lineBreak+U.text});for(let q of Q.ranges)X.push(D.range(q.anchor-Y,q.head-Y))}}if(!K.length)return!1;return $(Z.update({changes:K,scrollIntoView:!0,selection:D.create(X,Z.selection.mainIndex),userEvent:"move.line"})),!0}var QG=({state:Z,dispatch:$})=>ZK(Z,$,!1),UG=({state:Z,dispatch:$})=>ZK(Z,$,!0);function $K(Z,$,J){if(Z.readOnly)return!1;let K=[];for(let Q of Z9(Z))if(J)K.push({from:Q.from,insert:Z.doc.slice(Q.from,Q.to)+Z.lineBreak});else K.push({from:Q.to,insert:Z.lineBreak+Z.doc.slice(Q.from,Q.to)});let X=Z.changes(K);return $(Z.update({changes:X,selection:Z.selection.map(X,J?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}var YG=({state:Z,dispatch:$})=>$K(Z,$,!1),qG=({state:Z,dispatch:$})=>$K(Z,$,!0),GG=(Z)=>{if(Z.state.readOnly)return!1;let{state:$}=Z,J=$.changes(Z9($).map(({from:X,to:Q})=>{if(X>0)X--;else if(Q<$.doc.length)Q++;return{from:X,to:Q}})),K=m5($.selection,(X)=>{let Q=void 0;if(Z.lineWrapping){let U=Z.lineBlockAt(X.head),Y=Z.coordsAtPos(X.head,X.assoc||1);if(Y)Q=U.bottom+Z.documentTop-Y.bottom+Z.defaultLineHeight/2}return Z.moveVertically(X,!0,Q)}).map(J);return Z.dispatch({changes:J,selection:K,scrollIntoView:!0,userEvent:"delete.line"}),!0};function WG(Z,$){if(/\(\)|\[\]|\{\}/.test(Z.sliceDoc($-1,$+1)))return{from:$,to:$};let J=L0(Z).resolveInner($),K=J.childBefore($),X=J.childAfter($),Q;if(K&&X&&K.to<=$&&X.from>=$&&(Q=K.type.prop(l.closedBy))&&Q.indexOf(X.name)>-1&&Z.doc.lineAt(K.to).from==Z.doc.lineAt(X.from).from&&!/\S/.test(Z.sliceDoc(K.to,X.from)))return{from:K.to,to:X.from};return null}var LJ=JK(!1),jG=JK(!0);function JK(Z){return({state:$,dispatch:J})=>{if($.readOnly)return!1;let K=$.changeByRange((X)=>{let{from:Q,to:U}=X,Y=$.doc.lineAt(Q),q=!Z&&Q==U&&WG($,Q);if(Z)Q=U=(U<=Y.to?Y:$.doc.lineAt(U)).to;let G=new w5($,{simulateBreak:Q,simulateDoubleBreak:!!q}),W=s4(G,Q);if(W==null)W=k1(/^\s*/.exec($.doc.lineAt(Q).text)[0],$.tabSize);while(U<Y.to&&/\s/.test(Y.text[U-Y.from]))U++;if(q)({from:Q,to:U}=q);else if(Q>Y.from&&Q<Y.from+100&&!/\S/.test(Y.text.slice(0,Q)))Q=Y.from;let j=["",x5($,W)];if(q)j.push(x5($,G.lineIndent(Y.from,-1)));return{changes:{from:Q,to:U,insert:i.of(j)},range:D.cursor(Q+1+j[1].length)}});return J($.update(K,{scrollIntoView:!0,userEvent:"input"})),!0}}function IZ(Z,$){let J=-1;return Z.changeByRange((K)=>{let X=[];for(let U=K.from;U<=K.to;){let Y=Z.doc.lineAt(U);if(Y.number>J&&(K.empty||K.to>Y.from))$(Y,X,K),J=Y.number;U=Y.to+1}let Q=Z.changes(X);return{changes:X,range:D.range(Q.mapPos(K.anchor,1),Q.mapPos(K.head,1))}})}var _G=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let J=Object.create(null),K=new w5(Z,{overrideIndentation:(Q)=>{let U=J[Q];return U==null?-1:U}}),X=IZ(Z,(Q,U,Y)=>{let q=s4(K,Q.from);if(q==null)return;if(!/\S/.test(Q.text))q=0;let G=/^\s*/.exec(Q.text)[0],W=x5(Z,q);if(G!=W||Y.from<Q.from+G.length)J[Q.from]=q,U.push({from:Q.from,to:Q.from+G.length,insert:W})});if(!X.changes.empty)$(Z.update(X,{userEvent:"indent"}));return!0},zG=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;return $(Z.update(IZ(Z,(J,K)=>{K.push({from:J.from,insert:Z.facet(y7)})}),{userEvent:"input.indent"})),!0},OG=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;return $(Z.update(IZ(Z,(J,K)=>{let X=/^\s*/.exec(J.text)[0];if(!X)return;let Q=k1(X,Z.tabSize),U=0,Y=x5(Z,Math.max(0,Q-n1(Z)));while(U<X.length&&U<Y.length&&X.charCodeAt(U)==Y.charCodeAt(U))U++;K.push({from:J.from+U,to:J.from+X.length,insert:Y.slice(U)})}),{userEvent:"delete.dedent"})),!0},VG=(Z)=>{return Z.setTabFocusMode(),!0};var HG=[{key:"Ctrl-b",run:bJ,shift:pJ,preventDefault:!0},{key:"Ctrl-f",run:xJ,shift:dJ},{key:"Ctrl-p",run:vJ,shift:sJ},{key:"Ctrl-n",run:mJ,shift:nJ},{key:"Ctrl-a",run:bq,shift:cq},{key:"Ctrl-e",run:xq,shift:sq},{key:"Ctrl-d",run:oJ},{key:"Ctrl-h",run:VZ},{key:"Ctrl-k",run:ZG},{key:"Ctrl-Alt-h",run:eJ},{key:"Ctrl-o",run:KG},{key:"Ctrl-t",run:XG},{key:"Ctrl-v",run:OZ}],NG=[{key:"ArrowLeft",run:bJ,shift:pJ,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Mq,shift:vq,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:kq,shift:dq,preventDefault:!0},{key:"ArrowRight",run:xJ,shift:dJ,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Bq,shift:mq,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Sq,shift:lq,preventDefault:!0},{key:"ArrowUp",run:vJ,shift:sJ,preventDefault:!0},{mac:"Cmd-ArrowUp",run:RJ,shift:DJ},{mac:"Ctrl-ArrowUp",run:HJ,shift:NJ},{key:"ArrowDown",run:mJ,shift:nJ,preventDefault:!0},{mac:"Cmd-ArrowDown",run:FJ,shift:AJ},{mac:"Ctrl-ArrowDown",run:OZ,shift:IJ},{key:"PageUp",run:HJ,shift:NJ},{key:"PageDown",run:OZ,shift:IJ},{key:"Home",run:yq,shift:pq,preventDefault:!0},{key:"Mod-Home",run:RJ,shift:DJ},{key:"End",run:Tq,shift:gq,preventDefault:!0},{key:"Mod-End",run:FJ,shift:AJ},{key:"Enter",run:LJ,shift:LJ},{key:"Mod-a",run:nq},{key:"Backspace",run:VZ,shift:VZ,preventDefault:!0},{key:"Delete",run:oJ,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:eJ,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:eq,preventDefault:!0},{mac:"Mod-Backspace",run:$G,preventDefault:!0},{mac:"Mod-Delete",run:JG,preventDefault:!0}].concat(HG.map((Z)=>({mac:Z.key,run:Z.run,shift:Z.shift}))),KK=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Pq,shift:uq},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Cq,shift:fq},{key:"Alt-ArrowUp",run:QG},{key:"Shift-Alt-ArrowUp",run:YG},{key:"Alt-ArrowDown",run:UG},{key:"Shift-Alt-ArrowDown",run:qG},{key:"Mod-Alt-ArrowUp",run:rq},{key:"Mod-Alt-ArrowDown",run:oq},{key:"Escape",run:tq},{key:"Mod-Enter",run:jG},{key:"Alt-l",mac:"Ctrl-l",run:iq},{key:"Mod-i",run:aq,preventDefault:!0},{key:"Mod-[",run:OG},{key:"Mod-]",run:zG},{key:"Mod-Alt-\\",run:_G},{key:"Shift-Mod-k",run:GG},{key:"Shift-Mod-\\",run:hq},{key:"Mod-/",run:Yq},{key:"Alt-A",run:Gq},{key:"Ctrl-m",mac:"Shift-Alt-m",run:VG}].concat(NG);var XK=typeof String.prototype.normalize=="function"?(Z)=>Z.normalize("NFKD"):(Z)=>Z;class G5{constructor(Z,$,J=0,K=Z.length,X,Q){this.test=Q,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=Z.iterRange(J,K),this.bufferStart=J,this.normalize=X?(U)=>X(XK(U)):XK,this.query=this.normalize($)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return P0(this.buffer,this.bufferPos)}next(){while(this.matches.length)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let Z=this.peek();if(Z<0)return this.done=!0,this;let $=$7(Z),J=this.bufferStart+this.bufferPos;this.bufferPos+=c0(Z);let K=this.normalize($);if(K.length)for(let X=0,Q=J;;X++){let U=K.charCodeAt(X),Y=this.match(U,Q,this.bufferPos+this.bufferStart);if(X==K.length-1){if(Y)return this.value=Y,this;break}if(Q==J&&X<$.length&&$.charCodeAt(X)==U)Q++}}}match(Z,$,J){let K=null;for(let X=0;X<this.matches.length;X+=2){let Q=this.matches[X],U=!1;if(this.query.charCodeAt(Q)==Z)if(Q==this.query.length-1)K={from:this.matches[X+1],to:J};else this.matches[X]++,U=!0;if(!U)this.matches.splice(X,2),X-=2}if(this.query.charCodeAt(0)==Z)if(this.query.length==1)K={from:$,to:J};else this.matches.push(1,$);if(K&&this.test&&!this.test(K.from,K.to,this.buffer,this.bufferStart))K=null;return K}}if(typeof Symbol<"u")G5.prototype[Symbol.iterator]=function(){return this};var YK={from:-1,to:-1,match:/.*/.exec("")},DZ="gm"+(/x/.unicode==null?"":"u");class AZ{constructor(Z,$,J,K=0,X=Z.length){if(this.text=Z,this.to=X,this.curLine="",this.done=!1,this.value=YK,/\\[sWDnr]|\n|\r|\[\^/.test($))return new LZ(Z,$,J,K,X);this.re=new RegExp($,DZ+((J===null||J===void 0?void 0:J.ignoreCase)?"i":"")),this.test=J===null||J===void 0?void 0:J.test,this.iter=Z.iter();let Q=Z.lineAt(K);this.curLineStart=Q.from,this.matchPos=X9(Z,K),this.getLine(this.curLineStart)}getLine(Z){if(this.iter.next(Z),this.iter.lineBreak)this.curLine="";else{if(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to)this.curLine=this.curLine.slice(0,this.to-this.curLineStart);this.iter.next()}}nextLine(){if(this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to)this.curLine="";else this.getLine(0)}next(){for(let Z=this.matchPos-this.curLineStart;;){this.re.lastIndex=Z;let $=this.matchPos<=this.to&&this.re.exec(this.curLine);if($){let J=this.curLineStart+$.index,K=J+$[0].length;if(this.matchPos=X9(this.text,K+(J==K?1:0)),J==this.curLineStart+this.curLine.length)this.nextLine();if((J<K||J>this.value.to)&&(!this.test||this.test(J,K,$)))return this.value={from:J,to:K,match:$},this;Z=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),Z=0;else return this.done=!0,this}}}var RZ=new WeakMap;class g5{constructor(Z,$){this.from=Z,this.text=$}get to(){return this.from+this.text.length}static get(Z,$,J){let K=RZ.get(Z);if(!K||K.from>=J||K.to<=$){let U=new g5($,Z.sliceString($,J));return RZ.set(Z,U),U}if(K.from==$&&K.to==J)return K;let{text:X,from:Q}=K;if(Q>$)X=Z.sliceString($,Q)+X,Q=$;if(K.to<J)X+=Z.sliceString(K.to,J);return RZ.set(Z,new g5(Q,X)),new g5($,X.slice($-Q,J-Q))}}class LZ{constructor(Z,$,J,K,X){this.text=Z,this.to=X,this.done=!1,this.value=YK,this.matchPos=X9(Z,K),this.re=new RegExp($,DZ+((J===null||J===void 0?void 0:J.ignoreCase)?"i":"")),this.test=J===null||J===void 0?void 0:J.test,this.flat=g5.get(Z,K,this.chunkEnd(K+5000))}chunkEnd(Z){return Z>=this.to?this.to:this.text.lineAt(Z).to}next(){for(;;){let Z=this.re.lastIndex=this.matchPos-this.flat.from,$=this.re.exec(this.flat.text);if($&&!$[0]&&$.index==Z)this.re.lastIndex=Z+1,$=this.re.exec(this.flat.text);if($){let J=this.flat.from+$.index,K=J+$[0].length;if((this.flat.to>=this.to||$.index+$[0].length<=this.flat.text.length-10)&&(!this.test||this.test(J,K,$)))return this.value={from:J,to:K,match:$},this.matchPos=X9(this.text,K+(J==K?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=g5.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}if(typeof Symbol<"u")AZ.prototype[Symbol.iterator]=LZ.prototype[Symbol.iterator]=function(){return this};function IG(Z){try{return new RegExp(Z,DZ),!0}catch($){return!1}}function X9(Z,$){if($>=Z.length)return $;let J=Z.lineAt($),K;while($<J.to&&(K=J.text.charCodeAt($-J.from))>=56320&&K<57344)$++;return $}var RG=(Z)=>{let{state:$}=Z,J=String($.doc.lineAt(Z.state.selection.main.head).number),{close:K,result:X}=V3(Z,{label:$.phrase("Go to line"),input:{type:"text",name:"line",value:J},focus:!0,submitLabel:$.phrase("go")});return X.then((Q)=>{let U=Q&&/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(Q.elements.line.value);if(!U){Z.dispatch({effects:K});return}let Y=$.doc.lineAt($.selection.main.head),[,q,G,W,j]=U,_=W?+W.slice(1):0,z=G?+G:Y.number;if(G&&j){let N=z/100;if(q)N=N*(q=="-"?-1:1)+Y.number/$.doc.lines;z=Math.round($.doc.lines*N)}else if(G&&q)z=z*(q=="-"?-1:1)+Y.number;let V=$.doc.line(Math.max(1,Math.min($.doc.lines,z))),O=D.cursor(V.from+Math.max(0,Math.min(_,V.length)));Z.dispatch({effects:[K,B.scrollIntoView(O.from,{y:"center"})],selection:O})}),!0},FG={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},qK=C.define({combine(Z){return S0(Z,FG,{highlightWordAroundCursor:($,J)=>$||J,minSelectionLength:Math.min,maxMatches:Math.min})}});function GK(Z){let $=[BG,MG];if(Z)$.push(qK.of(Z));return $}var DG=x.mark({class:"cm-selectionMatch"}),AG=x.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function QK(Z,$,J,K){return(J==0||Z($.sliceDoc(J-1,J))!=X0.Word)&&(K==$.doc.length||Z($.sliceDoc(K,K+1))!=X0.Word)}function LG(Z,$,J,K){return Z($.sliceDoc(J,J+1))==X0.Word&&Z($.sliceDoc(K-1,K))==X0.Word}var MG=W0.fromClass(class{constructor(Z){this.decorations=this.getDeco(Z)}update(Z){if(Z.selectionSet||Z.docChanged||Z.viewportChanged)this.decorations=this.getDeco(Z.view)}getDeco(Z){let $=Z.state.facet(qK),{state:J}=Z,K=J.selection;if(K.ranges.length>1)return x.none;let X=K.main,Q,U=null;if(X.empty){if(!$.highlightWordAroundCursor)return x.none;let q=J.wordAt(X.head);if(!q)return x.none;U=J.charCategorizer(X.head),Q=J.sliceDoc(q.from,q.to)}else{let q=X.to-X.from;if(q<$.minSelectionLength||q>200)return x.none;if($.wholeWords){if(Q=J.sliceDoc(X.from,X.to),U=J.charCategorizer(X.head),!(QK(U,J,X.from,X.to)&&LG(U,J,X.from,X.to)))return x.none}else if(Q=J.sliceDoc(X.from,X.to),!Q)return x.none}let Y=[];for(let q of Z.visibleRanges){let G=new G5(J.doc,Q,q.from,q.to);while(!G.next().done){let{from:W,to:j}=G.value;if(!U||QK(U,J,W,j)){if(X.empty&&W<=X.from&&j>=X.to)Y.push(AG.range(W,j));else if(W>=X.to||j<=X.from)Y.push(DG.range(W,j));if(Y.length>$.maxMatches)return x.none}}}return x.set(Y)}},{decorations:(Z)=>Z.decorations}),BG=B.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),EG=({state:Z,dispatch:$})=>{let{selection:J}=Z,K=D.create(J.ranges.map((X)=>Z.wordAt(X.head)||D.cursor(X.head)),J.mainIndex);if(K.eq(J))return!1;return $(Z.update({selection:K})),!0};function PG(Z,$){let{main:J,ranges:K}=Z.selection,X=Z.wordAt(J.head),Q=X&&X.from==J.from&&X.to==J.to;for(let U=!1,Y=new G5(Z.doc,$,K[K.length-1].to);;)if(Y.next(),Y.done){if(U)return null;Y=new G5(Z.doc,$,0,Math.max(0,K[K.length-1].from-1)),U=!0}else{if(U&&K.some((q)=>q.from==Y.value.from))continue;if(Q){let q=Z.wordAt(Y.value.from);if(!q||q.from!=Y.value.from||q.to!=Y.value.to)continue}return Y.value}}var CG=({state:Z,dispatch:$})=>{let{ranges:J}=Z.selection;if(J.some((Q)=>Q.from===Q.to))return EG({state:Z,dispatch:$});let K=Z.sliceDoc(J[0].from,J[0].to);if(Z.selection.ranges.some((Q)=>Z.sliceDoc(Q.from,Q.to)!=K))return!1;let X=PG(Z,K);if(!X)return!1;return $(Z.update({selection:Z.selection.addRange(D.range(X.from,X.to),!1),effects:B.scrollIntoView(X.to)})),!0},p5=C.define({combine(Z){return S0(Z,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:($)=>new NK($),scrollToMatch:($)=>B.scrollIntoView($)})}});class MZ{constructor(Z){this.search=Z.search,this.caseSensitive=!!Z.caseSensitive,this.literal=!!Z.literal,this.regexp=!!Z.regexp,this.replace=Z.replace||"",this.valid=!!this.search&&(!this.regexp||IG(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!Z.wholeWord,this.test=Z.test}unquote(Z){return this.literal?Z:Z.replace(/\\([nrt\\])/g,($,J)=>J=="n"?`
`:J=="r"?"\r":J=="t"?"\t":"\\")}eq(Z){return this.search==Z.search&&this.replace==Z.replace&&this.caseSensitive==Z.caseSensitive&&this.regexp==Z.regexp&&this.wholeWord==Z.wholeWord&&this.test==Z.test}create(){return this.regexp?new jK(this):new WK(this)}getCursor(Z,$=0,J){let K=Z.doc?Z:p.create({doc:Z});if(J==null)J=K.doc.length;return this.regexp?f5(this,K,$,J):u5(this,K,$,J)}}class BZ{constructor(Z){this.spec=Z}}function TG(Z,$,J){return(K,X,Q,U)=>{if(J&&!J(K,X,Q,U))return!1;let Y=K>=U&&X<=U+Q.length?Q.slice(K-U,X-U):$.doc.sliceString(K,X);return Z(Y,$,K,X)}}function u5(Z,$,J,K){let X;if(Z.wholeWord)X=yG($.doc,$.charCategorizer($.selection.main.head));if(Z.test)X=TG(Z.test,$,X);return new G5($.doc,Z.unquoted,J,K,Z.caseSensitive?void 0:(Q)=>Q.toLowerCase(),X)}function yG(Z,$){return(J,K,X,Q)=>{if(Q>J||Q+X.length<K)Q=Math.max(0,J-2),X=Z.sliceString(Q,Math.min(Z.length,K+2));return($(Q9(X,J-Q))!=X0.Word||$(U9(X,J-Q))!=X0.Word)&&($(U9(X,K-Q))!=X0.Word||$(Q9(X,K-Q))!=X0.Word)}}class WK extends BZ{constructor(Z){super(Z)}nextMatch(Z,$,J){let K=u5(this.spec,Z,J,Z.doc.length).nextOverlapping();if(K.done){let X=Math.min(Z.doc.length,$+this.spec.unquoted.length);K=u5(this.spec,Z,0,X).nextOverlapping()}return K.done||K.value.from==$&&K.value.to==J?null:K.value}prevMatchInRange(Z,$,J){for(let K=J;;){let X=Math.max($,K-1e4-this.spec.unquoted.length),Q=u5(this.spec,Z,X,K),U=null;while(!Q.nextOverlapping().done)U=Q.value;if(U)return U;if(X==$)return null;K-=1e4}}prevMatch(Z,$,J){let K=this.prevMatchInRange(Z,0,$);if(!K)K=this.prevMatchInRange(Z,Math.max(0,J-this.spec.unquoted.length),Z.doc.length);return K&&(K.from!=$||K.to!=J)?K:null}getReplacement(Z){return this.spec.unquote(this.spec.replace)}matchAll(Z,$){let J=u5(this.spec,Z,0,Z.doc.length),K=[];while(!J.next().done){if(K.length>=$)return null;K.push(J.value)}return K}highlight(Z,$,J,K){let X=u5(this.spec,Z,Math.max(0,$-this.spec.unquoted.length),Math.min(J+this.spec.unquoted.length,Z.doc.length));while(!X.next().done)K(X.value.from,X.value.to)}}function kG(Z,$,J){return(K,X,Q)=>{return(!J||J(K,X,Q))&&Z(Q[0],$,K,X)}}function f5(Z,$,J,K){let X;if(Z.wholeWord)X=SG($.charCategorizer($.selection.main.head));if(Z.test)X=kG(Z.test,$,X);return new AZ($.doc,Z.search,{ignoreCase:!Z.caseSensitive,test:X},J,K)}function Q9(Z,$){return Z.slice(H0(Z,$,!1),$)}function U9(Z,$){return Z.slice($,H0(Z,$))}function SG(Z){return($,J,K)=>!K[0].length||(Z(Q9(K.input,K.index))!=X0.Word||Z(U9(K.input,K.index))!=X0.Word)&&(Z(U9(K.input,K.index+K[0].length))!=X0.Word||Z(Q9(K.input,K.index+K[0].length))!=X0.Word)}class jK extends BZ{nextMatch(Z,$,J){let K=f5(this.spec,Z,J,Z.doc.length).next();if(K.done)K=f5(this.spec,Z,0,$).next();return K.done?null:K.value}prevMatchInRange(Z,$,J){for(let K=1;;K++){let X=Math.max($,J-K*1e4),Q=f5(this.spec,Z,X,J),U=null;while(!Q.next().done)U=Q.value;if(U&&(X==$||U.from>X+10))return U;if(X==$)return null}}prevMatch(Z,$,J){return this.prevMatchInRange(Z,0,$)||this.prevMatchInRange(Z,J,Z.doc.length)}getReplacement(Z){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,($,J)=>{if(J=="&")return Z.match[0];if(J=="$")return"$";for(let K=J.length;K>0;K--){let X=+J.slice(0,K);if(X>0&&X<Z.match.length)return Z.match[X]+J.slice(K)}return $})}matchAll(Z,$){let J=f5(this.spec,Z,0,Z.doc.length),K=[];while(!J.next().done){if(K.length>=$)return null;K.push(J.value)}return K}highlight(Z,$,J,K){let X=f5(this.spec,Z,Math.max(0,$-250),Math.min(J+250,Z.doc.length));while(!X.next().done)K(X.value.from,X.value.to)}}var x7=v.define(),EZ=v.define(),a1=j0.define({create(Z){return new K9(FZ(Z).create(),null)},update(Z,$){for(let J of $.effects)if(J.is(x7))Z=new K9(J.value.create(),Z.panel);else if(J.is(EZ))Z=new K9(Z.query,J.value?PZ:null);return Z},provide:(Z)=>U5.from(Z,($)=>$.panel)});class K9{constructor(Z,$){this.query=Z,this.panel=$}}var bG=x.mark({class:"cm-searchMatch"}),xG=x.mark({class:"cm-searchMatch cm-searchMatch-selected"}),wG=W0.fromClass(class{constructor(Z){this.view=Z,this.decorations=this.highlight(Z.state.field(a1))}update(Z){let $=Z.state.field(a1);if($!=Z.startState.field(a1)||Z.docChanged||Z.selectionSet||Z.viewportChanged)this.decorations=this.highlight($)}highlight({query:Z,panel:$}){if(!$||!Z.spec.valid)return x.none;let{view:J}=this,K=new l0;for(let X=0,Q=J.visibleRanges,U=Q.length;X<U;X++){let{from:Y,to:q}=Q[X];while(X<U-1&&q>Q[X+1].from-500)q=Q[++X].to;Z.highlight(J.state,Y,q,(G,W)=>{let j=J.state.selection.ranges.some((_)=>_.from==G&&_.to==W);K.add(G,W,j?xG:bG)})}return K.finish()}},{decorations:(Z)=>Z.decorations});function w7(Z){return($)=>{let J=$.state.field(a1,!1);return J&&J.query.spec.valid?Z($,J):OK($)}}var Y9=w7((Z,{query:$})=>{let{to:J}=Z.state.selection.main,K=$.nextMatch(Z.state,J,J);if(!K)return!1;let X=D.single(K.from,K.to),Q=Z.state.facet(p5);return Z.dispatch({selection:X,effects:[CZ(Z,K),Q.scrollToMatch(X.main,Z)],userEvent:"select.search"}),zK(Z),!0}),q9=w7((Z,{query:$})=>{let{state:J}=Z,{from:K}=J.selection.main,X=$.prevMatch(J,K,K);if(!X)return!1;let Q=D.single(X.from,X.to),U=Z.state.facet(p5);return Z.dispatch({selection:Q,effects:[CZ(Z,X),U.scrollToMatch(Q.main,Z)],userEvent:"select.search"}),zK(Z),!0}),hG=w7((Z,{query:$})=>{let J=$.matchAll(Z.state,1000);if(!J||!J.length)return!1;return Z.dispatch({selection:D.create(J.map((K)=>D.range(K.from,K.to))),userEvent:"select.search.matches"}),!0}),vG=({state:Z,dispatch:$})=>{let J=Z.selection;if(J.ranges.length>1||J.main.empty)return!1;let{from:K,to:X}=J.main,Q=[],U=0;for(let Y=new G5(Z.doc,Z.sliceDoc(K,X));!Y.next().done;){if(Q.length>1000)return!1;if(Y.value.from==K)U=Q.length;Q.push(D.range(Y.value.from,Y.value.to))}return $(Z.update({selection:D.create(Q,U),userEvent:"select.search.matches"})),!0},UK=w7((Z,{query:$})=>{let{state:J}=Z,{from:K,to:X}=J.selection.main;if(J.readOnly)return!1;let Q=$.nextMatch(J,K,K);if(!Q)return!1;let U=Q,Y=[],q,G,W=[];if(U.from==K&&U.to==X)G=J.toText($.getReplacement(U)),Y.push({from:U.from,to:U.to,insert:G}),U=$.nextMatch(J,U.from,U.to),W.push(B.announce.of(J.phrase("replaced match on line $",J.doc.lineAt(K).number)+"."));let j=Z.state.changes(Y);if(U)q=D.single(U.from,U.to).map(j),W.push(CZ(Z,U)),W.push(J.facet(p5).scrollToMatch(q.main,Z));return Z.dispatch({changes:j,selection:q,effects:W,userEvent:"input.replace"}),!0}),mG=w7((Z,{query:$})=>{if(Z.state.readOnly)return!1;let J=$.matchAll(Z.state,1e9).map((X)=>{let{from:Q,to:U}=X;return{from:Q,to:U,insert:$.getReplacement(X)}});if(!J.length)return!1;let K=Z.state.phrase("replaced $ matches",J.length)+".";return Z.dispatch({changes:J,effects:B.announce.of(K),userEvent:"input.replace.all"}),!0});function PZ(Z){return Z.state.facet(p5).createPanel(Z)}function FZ(Z,$){var J,K,X,Q,U;let Y=Z.selection.main,q=Y.empty||Y.to>Y.from+100?"":Z.sliceDoc(Y.from,Y.to);if($&&!q)return $;let G=Z.facet(p5);return new MZ({search:((J=$===null||$===void 0?void 0:$.literal)!==null&&J!==void 0?J:G.literal)?q:q.replace(/\n/g,"\\n"),caseSensitive:(K=$===null||$===void 0?void 0:$.caseSensitive)!==null&&K!==void 0?K:G.caseSensitive,literal:(X=$===null||$===void 0?void 0:$.literal)!==null&&X!==void 0?X:G.literal,regexp:(Q=$===null||$===void 0?void 0:$.regexp)!==null&&Q!==void 0?Q:G.regexp,wholeWord:(U=$===null||$===void 0?void 0:$.wholeWord)!==null&&U!==void 0?U:G.wholeWord})}function _K(Z){let $=B7(Z,PZ);return $&&$.dom.querySelector("[main-field]")}function zK(Z){let $=_K(Z);if($&&$==Z.root.activeElement)$.select()}var OK=(Z)=>{let $=Z.state.field(a1,!1);if($&&$.panel){let J=_K(Z);if(J&&J!=Z.root.activeElement){let K=FZ(Z.state,$.query.spec);if(K.valid)Z.dispatch({effects:x7.of(K)});J.focus(),J.select()}}else Z.dispatch({effects:[EZ.of(!0),$?x7.of(FZ(Z.state,$.query.spec)):v.appendConfig.of(fG)]});return!0},VK=(Z)=>{let $=Z.state.field(a1,!1);if(!$||!$.panel)return!1;let J=B7(Z,PZ);if(J&&J.dom.contains(Z.root.activeElement))Z.focus();return Z.dispatch({effects:EZ.of(!1)}),!0},HK=[{key:"Mod-f",run:OK,scope:"editor search-panel"},{key:"F3",run:Y9,shift:q9,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Y9,shift:q9,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:VK,scope:"editor search-panel"},{key:"Mod-Shift-l",run:vG},{key:"Mod-Alt-g",run:RG},{key:"Mod-d",run:CG,preventDefault:!0}];class NK{constructor(Z){this.view=Z;let $=this.query=Z.state.field(a1).query.spec;this.commit=this.commit.bind(this),this.searchField=o("input",{value:$.search,placeholder:a0(Z,"Find"),"aria-label":a0(Z,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=o("input",{value:$.replace,placeholder:a0(Z,"Replace"),"aria-label":a0(Z,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=o("input",{type:"checkbox",name:"case",form:"",checked:$.caseSensitive,onchange:this.commit}),this.reField=o("input",{type:"checkbox",name:"re",form:"",checked:$.regexp,onchange:this.commit}),this.wordField=o("input",{type:"checkbox",name:"word",form:"",checked:$.wholeWord,onchange:this.commit});function J(K,X,Q){return o("button",{class:"cm-button",name:K,onclick:X,type:"button"},Q)}this.dom=o("div",{onkeydown:(K)=>this.keydown(K),class:"cm-search"},[this.searchField,J("next",()=>Y9(Z),[a0(Z,"next")]),J("prev",()=>q9(Z),[a0(Z,"previous")]),J("select",()=>hG(Z),[a0(Z,"all")]),o("label",null,[this.caseField,a0(Z,"match case")]),o("label",null,[this.reField,a0(Z,"regexp")]),o("label",null,[this.wordField,a0(Z,"by word")]),...Z.state.readOnly?[]:[o("br"),this.replaceField,J("replace",()=>UK(Z),[a0(Z,"replace")]),J("replaceAll",()=>mG(Z),[a0(Z,"replace all")])],o("button",{name:"close",onclick:()=>VK(Z),"aria-label":a0(Z,"close"),type:"button"},["×"])])}commit(){let Z=new MZ({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});if(!Z.eq(this.query))this.query=Z,this.view.dispatch({effects:x7.of(Z)})}keydown(Z){if(r$(this.view,Z,"search-panel"))Z.preventDefault();else if(Z.keyCode==13&&Z.target==this.searchField)Z.preventDefault(),(Z.shiftKey?q9:Y9)(this.view);else if(Z.keyCode==13&&Z.target==this.replaceField)Z.preventDefault(),UK(this.view)}update(Z){for(let $ of Z.transactions)for(let J of $.effects)if(J.is(x7)&&!J.value.eq(this.query))this.setQuery(J.value)}setQuery(Z){this.query=Z,this.searchField.value=Z.search,this.replaceField.value=Z.replace,this.caseField.checked=Z.caseSensitive,this.reField.checked=Z.regexp,this.wordField.checked=Z.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(p5).top}}function a0(Z,$){return Z.state.phrase($)}var $9=30,J9=/[\s\.,:;?!]/;function CZ(Z,{from:$,to:J}){let K=Z.state.doc.lineAt($),X=Z.state.doc.lineAt(J).to,Q=Math.max(K.from,$-$9),U=Math.min(X,J+$9),Y=Z.state.sliceDoc(Q,U);if(Q!=K.from){for(let q=0;q<$9;q++)if(!J9.test(Y[q+1])&&J9.test(Y[q])){Y=Y.slice(q);break}}if(U!=X){for(let q=Y.length-1;q>Y.length-$9;q--)if(!J9.test(Y[q-1])&&J9.test(Y[q])){Y=Y.slice(0,q);break}}return B.announce.of(`${Z.state.phrase("current match")}. ${Y} ${Z.state.phrase("on line")} ${K.number}.`)}var uG=B.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),fG=[a1,j1.low(wG),uG];class bZ{constructor(Z,$,J,K){this.state=Z,this.pos=$,this.explicit=J,this.view=K,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(Z){let $=L0(this.state).resolveInner(this.pos,-1);while($&&Z.indexOf($.name)<0)$=$.parent;return $?{from:$.from,to:this.pos,text:this.state.sliceDoc($.from,this.pos),type:$.type}:null}matchBefore(Z){let $=this.state.doc.lineAt(this.pos),J=Math.max($.from,this.pos-250),K=$.text.slice(J-$.from,this.pos-$.from),X=K.search(BK(Z,!1));return X<0?null:{from:J+X,to:this.pos,text:K.slice(X)}}get aborted(){return this.abortListeners==null}addEventListener(Z,$,J){if(Z=="abort"&&this.abortListeners){if(this.abortListeners.push($),J&&J.onDocChange)this.abortOnDocChange=!0}}}function IK(Z){let $=Object.keys(Z).join(""),J=/\w/.test($);if(J)$=$.replace(/\w/g,"");return`[${J?"\\w":""}${$.replace(/[^\w\s]/g,"\\$&")}]`}function gG(Z){let $=Object.create(null),J=Object.create(null);for(let{label:X}of Z){$[X[0]]=!0;for(let Q=1;Q<X.length;Q++)J[X[Q]]=!0}let K=IK($)+IK(J)+"*$";return[new RegExp("^"+K),new RegExp(K)]}function pG(Z){let $=Z.map((X)=>typeof X=="string"?{label:X}:X),[J,K]=$.every((X)=>/^\w+$/.test(X.label))?[/\w*$/,/\w+$/]:gG($);return(X)=>{let Q=X.matchBefore(K);return Q||X.explicit?{from:Q?Q.from:X.pos,options:$,validFor:J}:null}}class SZ{constructor(Z,$,J,K){this.completion=Z,this.source=$,this.match=J,this.score=K}}function j5(Z){return Z.selection.main.from}function BK(Z,$){var J;let{source:K}=Z,X=$&&K[0]!="^",Q=K[K.length-1]!="$";if(!X&&!Q)return Z;return new RegExp(`${X?"^":""}(?:${K})${Q?"$":""}`,(J=Z.flags)!==null&&J!==void 0?J:Z.ignoreCase?"i":"")}var EK=s0.define();function dG(Z,$,J,K){let{main:X}=Z.selection,Q=J-X.from,U=K-X.from;return{...Z.changeByRange((Y)=>{if(Y!=X&&J!=K&&Z.sliceDoc(Y.from+Q,Y.from+U)!=Z.sliceDoc(J,K))return{range:Y};let q=Z.toText($);return{changes:{from:Y.from+Q,to:K==X.from?Y.to:Y.from+U,insert:q},range:D.cursor(Y.from+Q+q.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}var RK=new WeakMap;function lG(Z){if(!Array.isArray(Z))return Z;let $=RK.get(Z);if(!$)RK.set(Z,$=pG(Z));return $}var W9=v.define(),h7=v.define();class PK{constructor(Z){this.pattern=Z,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let $=0;$<Z.length;){let J=P0(Z,$),K=c0(J);this.chars.push(J);let X=Z.slice($,$+K),Q=X.toUpperCase();this.folded.push(P0(Q==X?X.toLowerCase():Q,0)),$+=K}this.astral=Z.length!=this.chars.length}ret(Z,$){return this.score=Z,this.matched=$,this}match(Z){if(this.pattern.length==0)return this.ret(-100,[]);if(Z.length<this.pattern.length)return null;let{chars:$,folded:J,any:K,precise:X,byWord:Q}=this;if($.length==1){let R=P0(Z,0),A=c0(R),L=A==Z.length?0:-100;if(R==$[0]);else if(R==J[0])L+=-200;else return null;return this.ret(L,[0,A])}let U=Z.indexOf(this.pattern);if(U==0)return this.ret(Z.length==this.pattern.length?0:-100,[0,this.pattern.length]);let Y=$.length,q=0;if(U<0){for(let R=0,A=Math.min(Z.length,200);R<A&&q<Y;){let L=P0(Z,R);if(L==$[q]||L==J[q])K[q++]=R;R+=c0(L)}if(q<Y)return null}let G=0,W=0,j=!1,_=0,z=-1,V=-1,O=/[a-z]/.test(Z),N=!0;for(let R=0,A=Math.min(Z.length,200),L=0;R<A&&W<Y;){let E=P0(Z,R);if(U<0){if(G<Y&&E==$[G])X[G++]=R;if(_<Y)if(E==$[_]||E==J[_]){if(_==0)z=R;V=R+1,_++}else _=0}let M,S=E<255?E>=48&&E<=57||E>=97&&E<=122?2:E>=65&&E<=90?1:0:(M=$7(E))!=M.toLowerCase()?1:M!=M.toUpperCase()?2:0;if(!R||S==1&&O||L==0&&S!=0){if($[W]==E||J[W]==E&&(j=!0))Q[W++]=R;else if(Q.length)N=!1}L=S,R+=c0(E)}if(W==Y&&Q[0]==0&&N)return this.result(-100+(j?-200:0),Q,Z);if(_==Y&&z==0)return this.ret(-200-Z.length+(V==Z.length?0:-100),[0,V]);if(U>-1)return this.ret(-700-Z.length,[U,U+this.pattern.length]);if(_==Y)return this.ret(-900-Z.length,[z,V]);if(W==Y)return this.result(-100+(j?-200:0)+-700+(N?0:-1100),Q,Z);return $.length==2?null:this.result((K[0]?-700:0)+-200+-1100,K,Z)}result(Z,$,J){let K=[],X=0;for(let Q of $){let U=Q+(this.astral?c0(P0(J,Q)):1);if(X&&K[X-1]==Q)K[X-1]=U;else K[X++]=Q,K[X++]=U}return this.ret(Z-J.length,K)}}class CK{constructor(Z){this.pattern=Z,this.matched=[],this.score=0,this.folded=Z.toLowerCase()}match(Z){if(Z.length<this.pattern.length)return null;let $=Z.slice(0,this.pattern.length),J=$==this.pattern?0:$.toLowerCase()==this.folded?-200:null;if(J==null)return null;return this.matched=[0,$.length],this.score=J+(Z.length==this.pattern.length?0:-100),this}}var M0=C.define({combine(Z){return S0(Z,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:cG,filterStrict:!1,compareCompletions:($,J)=>($.sortText||$.label).localeCompare(J.sortText||J.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:($,J)=>$&&J,closeOnBlur:($,J)=>$&&J,icons:($,J)=>$&&J,tooltipClass:($,J)=>(K)=>FK($(K),J(K)),optionClass:($,J)=>(K)=>FK($(K),J(K)),addToOptions:($,J)=>$.concat(J),filterStrict:($,J)=>$||J})}});function FK(Z,$){return Z?$?Z+" "+$:Z:$}function cG(Z,$,J,K,X,Q){let U=Z.textDirection==J0.RTL,Y=U,q=!1,G="top",W,j,_=$.left-X.left,z=X.right-$.right,V=K.right-K.left,O=K.bottom-K.top;if(Y&&_<Math.min(V,z))Y=!1;else if(!Y&&z<Math.min(V,_))Y=!0;if(V<=(Y?_:z))W=Math.max(X.top,Math.min(J.top,X.bottom-O))-$.top,j=Math.min(400,Y?_:z);else{q=!0,j=Math.min(400,(U?$.right:X.right-$.left)-30);let A=X.bottom-$.bottom;if(A>=O||A>$.top)W=J.bottom-$.top;else G="bottom",W=$.bottom-J.top}let N=($.bottom-$.top)/Q.offsetHeight,R=($.right-$.left)/Q.offsetWidth;return{style:`${G}: ${W/N}px; max-width: ${j/R}px`,class:"cm-completionInfo-"+(q?U?"left-narrow":"right-narrow":Y?"left":"right")}}function sG(Z){let $=Z.addToOptions.slice();if(Z.icons)$.push({render(J){let K=document.createElement("div");if(K.classList.add("cm-completionIcon"),J.type)K.classList.add(...J.type.split(/\s+/g).map((X)=>"cm-completionIcon-"+X));return K.setAttribute("aria-hidden","true"),K},position:20});return $.push({render(J,K,X,Q){let U=document.createElement("span");U.className="cm-completionLabel";let Y=J.displayLabel||J.label,q=0;for(let G=0;G<Q.length;){let W=Q[G++],j=Q[G++];if(W>q)U.appendChild(document.createTextNode(Y.slice(q,W)));let _=U.appendChild(document.createElement("span"));_.appendChild(document.createTextNode(Y.slice(W,j))),_.className="cm-completionMatchedText",q=j}if(q<Y.length)U.appendChild(document.createTextNode(Y.slice(q)));return U},position:50},{render(J){if(!J.detail)return null;let K=document.createElement("span");return K.className="cm-completionDetail",K.textContent=J.detail,K},position:80}),$.sort((J,K)=>J.position-K.position).map((J)=>J.render)}function TZ(Z,$,J){if(Z<=J)return{from:0,to:Z};if($<0)$=0;if($<=Z>>1){let X=Math.floor($/J);return{from:X*J,to:(X+1)*J}}let K=Math.floor((Z-$)/J);return{from:Z-(K+1)*J,to:Z-K*J}}class TK{constructor(Z,$,J){this.view=Z,this.stateField=$,this.applyCompletion=J,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:(Y)=>this.placeInfo(Y),key:this},this.space=null,this.currentClass="";let K=Z.state.field($),{options:X,selected:Q}=K.open,U=Z.state.facet(M0);this.optionContent=sG(U),this.optionClass=U.optionClass,this.tooltipClass=U.tooltipClass,this.range=TZ(X.length,Q,U.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(Z.state),this.dom.addEventListener("mousedown",(Y)=>{let{options:q}=Z.state.field($).open;for(let G=Y.target,W;G&&G!=this.dom;G=G.parentNode)if(G.nodeName=="LI"&&(W=/-(\d+)$/.exec(G.id))&&+W[1]<q.length){this.applyCompletion(Z,q[+W[1]]),Y.preventDefault();return}}),this.dom.addEventListener("focusout",(Y)=>{let q=Z.state.field(this.stateField,!1);if(q&&q.tooltip&&Z.state.facet(M0).closeOnBlur&&Y.relatedTarget!=Z.contentDOM)Z.dispatch({effects:h7.of(null)})}),this.showOptions(X,K.id)}mount(){this.updateSel()}showOptions(Z,$){if(this.list)this.list.remove();this.list=this.dom.appendChild(this.createListBox(Z,$,this.range)),this.list.addEventListener("scroll",()=>{if(this.info)this.view.requestMeasure(this.placeInfoReq)})}update(Z){var $;let J=Z.state.field(this.stateField),K=Z.startState.field(this.stateField);if(this.updateTooltipClass(Z.state),J!=K){let{options:X,selected:Q,disabled:U}=J.open;if(!K.open||K.open.options!=X)this.range=TZ(X.length,Q,Z.state.facet(M0).maxRenderedOptions),this.showOptions(X,J.id);if(this.updateSel(),U!=(($=K.open)===null||$===void 0?void 0:$.disabled))this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!U)}}updateTooltipClass(Z){let $=this.tooltipClass(Z);if($!=this.currentClass){for(let J of this.currentClass.split(" "))if(J)this.dom.classList.remove(J);for(let J of $.split(" "))if(J)this.dom.classList.add(J);this.currentClass=$}}positioned(Z){if(this.space=Z,this.info)this.view.requestMeasure(this.placeInfoReq)}updateSel(){let Z=this.view.state.field(this.stateField),$=Z.open;if($.selected>-1&&$.selected<this.range.from||$.selected>=this.range.to)this.range=TZ($.options.length,$.selected,this.view.state.facet(M0).maxRenderedOptions),this.showOptions($.options,Z.id);let J=this.updateSelectedOption($.selected);if(J){this.destroyInfo();let{completion:K}=$.options[$.selected],{info:X}=K;if(!X)return;let Q=typeof X==="string"?document.createTextNode(X):X(K);if(!Q)return;if("then"in Q)Q.then((U)=>{if(U&&this.view.state.field(this.stateField,!1)==Z)this.addInfoPane(U,K)}).catch((U)=>T0(this.view.state,U,"completion info"));else this.addInfoPane(Q,K),J.setAttribute("aria-describedby",this.info.id)}}addInfoPane(Z,$){this.destroyInfo();let J=this.info=document.createElement("div");if(J.className="cm-tooltip cm-completionInfo",J.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),Z.nodeType!=null)J.appendChild(Z),this.infoDestroy=null;else{let{dom:K,destroy:X}=Z;J.appendChild(K),this.infoDestroy=X||null}this.dom.appendChild(J),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(Z){let $=null;for(let J=this.list.firstChild,K=this.range.from;J;J=J.nextSibling,K++)if(J.nodeName!="LI"||!J.id)K--;else if(K==Z){if(!J.hasAttribute("aria-selected"))J.setAttribute("aria-selected","true"),$=J}else if(J.hasAttribute("aria-selected"))J.removeAttribute("aria-selected"),J.removeAttribute("aria-describedby");if($)iG(this.list,$);return $}measureInfo(){let Z=this.dom.querySelector("[aria-selected]");if(!Z||!this.info)return null;let $=this.dom.getBoundingClientRect(),J=this.info.getBoundingClientRect(),K=Z.getBoundingClientRect(),X=this.space;if(!X){let Q=this.dom.ownerDocument.documentElement;X={left:0,top:0,right:Q.clientWidth,bottom:Q.clientHeight}}if(K.top>Math.min(X.bottom,$.bottom)-10||K.bottom<Math.max(X.top,$.top)+10)return null;return this.view.state.facet(M0).positionInfo(this.view,$,K,J,X,this.dom)}placeInfo(Z){if(this.info)if(Z){if(Z.style)this.info.style.cssText=Z.style;this.info.className="cm-tooltip cm-completionInfo "+(Z.class||"")}else this.info.style.cssText="top: -1e6px"}createListBox(Z,$,J){let K=document.createElement("ul");K.id=$,K.setAttribute("role","listbox"),K.setAttribute("aria-expanded","true"),K.setAttribute("aria-label",this.view.state.phrase("Completions")),K.addEventListener("mousedown",(Q)=>{if(Q.target==K)Q.preventDefault()});let X=null;for(let Q=J.from;Q<J.to;Q++){let{completion:U,match:Y}=Z[Q],{section:q}=U;if(q){let j=typeof q=="string"?q:q.name;if(j!=X&&(Q>J.from||J.from==0))if(X=j,typeof q!="string"&&q.header)K.appendChild(q.header(q));else{let _=K.appendChild(document.createElement("completion-section"));_.textContent=j}}let G=K.appendChild(document.createElement("li"));G.id=$+"-"+Q,G.setAttribute("role","option");let W=this.optionClass(U);if(W)G.className=W;for(let j of this.optionContent){let _=j(U,this.view.state,this.view,Y);if(_)G.appendChild(_)}}if(J.from)K.classList.add("cm-completionListIncompleteTop");if(J.to<Z.length)K.classList.add("cm-completionListIncompleteBottom");return K}destroyInfo(){if(this.info){if(this.infoDestroy)this.infoDestroy();this.info.remove(),this.info=null}}destroy(){this.destroyInfo()}}function nG(Z,$){return(J)=>new TK(J,Z,$)}function iG(Z,$){let J=Z.getBoundingClientRect(),K=$.getBoundingClientRect(),X=J.height/Z.offsetHeight;if(K.top<J.top)Z.scrollTop-=(J.top-K.top)/X;else if(K.bottom>J.bottom)Z.scrollTop+=(K.bottom-J.bottom)/X}function DK(Z){return(Z.boost||0)*100+(Z.apply?10:0)+(Z.info?5:0)+(Z.type?1:0)}function aG(Z,$){let J=[],K=null,X=null,Q=(W)=>{J.push(W);let{section:j}=W.completion;if(j){if(!K)K=[];let _=typeof j=="string"?j:j.name;if(!K.some((z)=>z.name==_))K.push(typeof j=="string"?{name:_}:j)}},U=$.facet(M0);for(let W of Z)if(W.hasResult()){let j=W.result.getMatch;if(W.result.filter===!1)for(let _ of W.result.options)Q(new SZ(_,W.source,j?j(_):[],1e9-J.length));else{let _=$.sliceDoc(W.from,W.to),z,V=U.filterStrict?new CK(_):new PK(_);for(let O of W.result.options)if(z=V.match(O.label)){let N=!O.displayLabel?z.matched:j?j(O,z.matched):[],R=z.score+(O.boost||0);if(Q(new SZ(O,W.source,N,R)),typeof O.section=="object"&&O.section.rank==="dynamic"){let{name:A}=O.section;if(!X)X=Object.create(null);X[A]=Math.max(R,X[A]||-1e9)}}}}if(K){let W=Object.create(null),j=0,_=(z,V)=>{return(z.rank==="dynamic"&&V.rank==="dynamic"?X[V.name]-X[z.name]:0)||(typeof z.rank=="number"?z.rank:1e9)-(typeof V.rank=="number"?V.rank:1e9)||(z.name<V.name?-1:1)};for(let z of K.sort(_))j-=1e5,W[z.name]=j;for(let z of J){let{section:V}=z.completion;if(V)z.score+=W[typeof V=="string"?V:V.name]}}let Y=[],q=null,G=U.compareCompletions;for(let W of J.sort((j,_)=>_.score-j.score||G(j.completion,_.completion))){let j=W.completion;if(!q||q.label!=j.label||q.detail!=j.detail||q.type!=null&&j.type!=null&&q.type!=j.type||q.apply!=j.apply||q.boost!=j.boost)Y.push(W);else if(DK(W.completion)>DK(q))Y[Y.length-1]=W;q=W.completion}return Y}class d5{constructor(Z,$,J,K,X,Q){this.options=Z,this.attrs=$,this.tooltip=J,this.timestamp=K,this.selected=X,this.disabled=Q}setSelected(Z,$){return Z==this.selected||Z>=this.options.length?this:new d5(this.options,AK($,Z),this.tooltip,this.timestamp,Z,this.disabled)}static build(Z,$,J,K,X,Q){if(K&&!Q&&Z.some((q)=>q.isPending))return K.setDisabled();let U=aG(Z,$);if(!U.length)return K&&Z.some((q)=>q.isPending)?K.setDisabled():null;let Y=$.facet(M0).selectOnOpen?0:-1;if(K&&K.selected!=Y&&K.selected!=-1){let q=K.options[K.selected].completion;for(let G=0;G<U.length;G++)if(U[G].completion==q){Y=G;break}}return new d5(U,AK(J,Y),{pos:Z.reduce((q,G)=>G.hasResult()?Math.min(q,G.from):q,1e8),create:$W,above:X.aboveCursor},K?K.timestamp:Date.now(),Y,!1)}map(Z){return new d5(this.options,this.attrs,{...this.tooltip,pos:Z.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new d5(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class j9{constructor(Z,$,J){this.active=Z,this.id=$,this.open=J}static start(){return new j9(eG,"cm-ac-"+Math.floor(Math.random()*2000000).toString(36),null)}update(Z){let{state:$}=Z,J=$.facet(M0),X=(J.override||$.languageDataAt("autocomplete",j5($)).map(lG)).map((Y)=>{return(this.active.find((G)=>G.source==Y)||new U1(Y,this.active.some((G)=>G.state!=0)?1:0)).update(Z,J)});if(X.length==this.active.length&&X.every((Y,q)=>Y==this.active[q]))X=this.active;let Q=this.open,U=Z.effects.some((Y)=>Y.is(xZ));if(Q&&Z.docChanged)Q=Q.map(Z.changes);if(Z.selection||X.some((Y)=>Y.hasResult()&&Z.changes.touchesRange(Y.from,Y.to))||!rG(X,this.active)||U)Q=d5.build(X,$,this.id,Q,J,U);else if(Q&&Q.disabled&&!X.some((Y)=>Y.isPending))Q=null;if(!Q&&X.every((Y)=>!Y.isPending)&&X.some((Y)=>Y.hasResult()))X=X.map((Y)=>Y.hasResult()?new U1(Y.source,0):Y);for(let Y of Z.effects)if(Y.is(kK))Q=Q&&Q.setSelected(Y.value,this.id);return X==this.active&&Q==this.open?this:new j9(X,this.id,Q)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?oG:tG}}function rG(Z,$){if(Z==$)return!0;for(let J=0,K=0;;){while(J<Z.length&&!Z[J].hasResult())J++;while(K<$.length&&!$[K].hasResult())K++;let X=J==Z.length,Q=K==$.length;if(X||Q)return X==Q;if(Z[J++].result!=$[K++].result)return!1}}var oG={"aria-autocomplete":"list"},tG={};function AK(Z,$){let J={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":Z};if($>-1)J["aria-activedescendant"]=Z+"-"+$;return J}var eG=[];function yK(Z,$){if(Z.isUserEvent("input.complete")){let K=Z.annotation(EK);if(K&&$.activateOnCompletion(K))return 12}let J=Z.isUserEvent("input.type");return J&&$.activateOnTyping?5:J?1:Z.isUserEvent("delete.backward")?2:Z.selection?8:Z.docChanged?16:0}class U1{constructor(Z,$,J=!1){this.source=Z,this.state=$,this.explicit=J}hasResult(){return!1}get isPending(){return this.state==1}update(Z,$){let J=yK(Z,$),K=this;if(J&8||J&16&&this.touches(Z))K=new U1(K.source,0);if(J&4&&K.state==0)K=new U1(this.source,1);K=K.updateFor(Z,J);for(let X of Z.effects)if(X.is(W9))K=new U1(K.source,1,X.value);else if(X.is(h7))K=new U1(K.source,0);else if(X.is(xZ)){for(let Q of X.value)if(Q.source==K.source)K=Q}return K}updateFor(Z,$){return this.map(Z.changes)}map(Z){return this}touches(Z){return Z.changes.touchesRange(j5(Z.state))}}class l5 extends U1{constructor(Z,$,J,K,X,Q){super(Z,3,$);this.limit=J,this.result=K,this.from=X,this.to=Q}hasResult(){return!0}updateFor(Z,$){var J;if(!($&3))return this.map(Z.changes);let K=this.result;if(K.map&&!Z.changes.empty)K=K.map(K,Z.changes);let X=Z.changes.mapPos(this.from),Q=Z.changes.mapPos(this.to,1),U=j5(Z.state);if(U>Q||!K||$&2&&(j5(Z.startState)==this.from||U<this.limit))return new U1(this.source,$&4?1:0);let Y=Z.changes.mapPos(this.limit);if(ZW(K.validFor,Z.state,X,Q))return new l5(this.source,this.explicit,Y,K,X,Q);if(K.update&&(K=K.update(K,X,Q,new bZ(Z.state,U,!1))))return new l5(this.source,this.explicit,Y,K,K.from,(J=K.to)!==null&&J!==void 0?J:j5(Z.state));return new U1(this.source,1,this.explicit)}map(Z){if(Z.empty)return this;if(!(this.result.map?this.result.map(this.result,Z):this.result))return new U1(this.source,0);return new l5(this.source,this.explicit,Z.mapPos(this.limit),this.result,Z.mapPos(this.from),Z.mapPos(this.to,1))}touches(Z){return Z.changes.touchesRange(this.from,this.to)}}function ZW(Z,$,J,K){if(!Z)return!1;let X=$.sliceDoc(J,K);return typeof Z=="function"?Z(X,J,K,$):BK(Z,!0).test(X)}var xZ=v.define({map(Z,$){return Z.map((J)=>J.map($))}}),kK=v.define(),p0=j0.define({create(){return j9.start()},update(Z,$){return Z.update($)},provide:(Z)=>[M7.from(Z,($)=>$.tooltip),B.contentAttributes.from(Z,($)=>$.attrs)]});function wZ(Z,$){let J=$.completion.apply||$.completion.label,K=Z.state.field(p0).active.find((X)=>X.source==$.source);if(!(K instanceof l5))return!1;if(typeof J=="string")Z.dispatch({...dG(Z.state,J,K.from,K.to),annotations:EK.of($.completion)});else J(Z,$.completion,K.from,K.to);return!0}var $W=nG(p0,wZ);function G9(Z,$="option"){return(J)=>{let K=J.state.field(p0,!1);if(!K||!K.open||K.open.disabled||Date.now()-K.open.timestamp<J.state.facet(M0).interactionDelay)return!1;let X=1,Q;if($=="page"&&(Q=g8(J,K.open.tooltip)))X=Math.max(2,Math.floor(Q.dom.offsetHeight/Q.dom.querySelector("li").offsetHeight)-1);let{length:U}=K.open.options,Y=K.open.selected>-1?K.open.selected+X*(Z?1:-1):Z?0:U-1;if(Y<0)Y=$=="page"?0:U-1;else if(Y>=U)Y=$=="page"?U-1:0;return J.dispatch({effects:kK.of(Y)}),!0}}var JW=(Z)=>{let $=Z.state.field(p0,!1);if(Z.state.readOnly||!$||!$.open||$.open.selected<0||$.open.disabled||Date.now()-$.open.timestamp<Z.state.facet(M0).interactionDelay)return!1;return wZ(Z,$.open.options[$.open.selected])},yZ=(Z)=>{if(!Z.state.field(p0,!1))return!1;return Z.dispatch({effects:W9.of(!0)}),!0},KW=(Z)=>{let $=Z.state.field(p0,!1);if(!$||!$.active.some((J)=>J.state!=0))return!1;return Z.dispatch({effects:h7.of(null)}),!0};class SK{constructor(Z,$){this.active=Z,this.context=$,this.time=Date.now(),this.updates=[],this.done=void 0}}var XW=50,QW=1000,UW=W0.fromClass(class{constructor(Z){this.view=Z,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let $ of Z.state.field(p0).active)if($.isPending)this.startQuery($)}update(Z){let $=Z.state.field(p0),J=Z.state.facet(M0);if(!Z.selectionSet&&!Z.docChanged&&Z.startState.field(p0)==$)return;let K=Z.transactions.some((Q)=>{let U=yK(Q,J);return U&8||(Q.selection||Q.docChanged)&&!(U&3)});for(let Q=0;Q<this.running.length;Q++){let U=this.running[Q];if(K||U.context.abortOnDocChange&&Z.docChanged||U.updates.length+Z.transactions.length>XW&&Date.now()-U.time>QW){for(let Y of U.context.abortListeners)try{Y()}catch(q){T0(this.view.state,q)}U.context.abortListeners=null,this.running.splice(Q--,1)}else U.updates.push(...Z.transactions)}if(this.debounceUpdate>-1)clearTimeout(this.debounceUpdate);if(Z.transactions.some((Q)=>Q.effects.some((U)=>U.is(W9))))this.pendingStart=!0;let X=this.pendingStart?50:J.activateOnTypingDelay;if(this.debounceUpdate=$.active.some((Q)=>Q.isPending&&!this.running.some((U)=>U.active.source==Q.source))?setTimeout(()=>this.startUpdate(),X):-1,this.composing!=0){for(let Q of Z.transactions)if(Q.isUserEvent("input.type"))this.composing=2;else if(this.composing==2&&Q.selection)this.composing=3}}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:Z}=this.view,$=Z.field(p0);for(let J of $.active)if(J.isPending&&!this.running.some((K)=>K.active.source==J.source))this.startQuery(J);if(this.running.length&&$.open&&$.open.disabled)this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(M0).updateSyncTime)}startQuery(Z){let{state:$}=this.view,J=j5($),K=new bZ($,J,Z.explicit,this.view),X=new SK(Z,K);this.running.push(X),Promise.resolve(Z.source(K)).then((Q)=>{if(!X.context.aborted)X.done=Q||null,this.scheduleAccept()},(Q)=>{this.view.dispatch({effects:h7.of(null)}),T0(this.view.state,Q)})}scheduleAccept(){if(this.running.every((Z)=>Z.done!==void 0))this.accept();else if(this.debounceAccept<0)this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(M0).updateSyncTime)}accept(){var Z;if(this.debounceAccept>-1)clearTimeout(this.debounceAccept);this.debounceAccept=-1;let $=[],J=this.view.state.facet(M0),K=this.view.state.field(p0);for(let X=0;X<this.running.length;X++){let Q=this.running[X];if(Q.done===void 0)continue;if(this.running.splice(X--,1),Q.done){let Y=j5(Q.updates.length?Q.updates[0].startState:this.view.state),q=Math.min(Y,Q.done.from+(Q.active.explicit?0:1)),G=new l5(Q.active.source,Q.active.explicit,q,Q.done,Q.done.from,(Z=Q.done.to)!==null&&Z!==void 0?Z:Y);for(let W of Q.updates)G=G.update(W,J);if(G.hasResult()){$.push(G);continue}}let U=K.active.find((Y)=>Y.source==Q.active.source);if(U&&U.isPending)if(Q.done==null){let Y=new U1(Q.active.source,0);for(let q of Q.updates)Y=Y.update(q,J);if(!Y.isPending)$.push(Y)}else this.startQuery(U)}if($.length||K.open&&K.open.disabled)this.view.dispatch({effects:xZ.of($)})}},{eventHandlers:{blur(Z){let $=this.view.state.field(p0,!1);if($&&$.tooltip&&this.view.state.facet(M0).closeOnBlur){let J=$.open&&g8(this.view,$.open.tooltip);if(!J||!J.dom.contains(Z.relatedTarget))setTimeout(()=>this.view.dispatch({effects:h7.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){if(this.composing==3)setTimeout(()=>this.view.dispatch({effects:W9.of(!1)}),20);this.composing=0}}}),YW=typeof navigator=="object"&&/Win/.test(navigator.platform),qW=j1.highest(B.domEventHandlers({keydown(Z,$){let J=$.state.field(p0,!1);if(!J||!J.open||J.open.disabled||J.open.selected<0||Z.key.length>1||Z.ctrlKey&&!(YW&&Z.altKey)||Z.metaKey)return!1;let K=J.open.options[J.open.selected],X=J.active.find((U)=>U.source==K.source),Q=K.completion.commitCharacters||X.result.commitCharacters;if(Q&&Q.indexOf(Z.key)>-1)wZ($,K);return!1}})),GW=B.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:0.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:0.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'\uD835\uDC65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\uD835\uDC36'"}},".cm-completionIcon-type":{"&:after":{content:"'\uD835\uDC61'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\uD83D\uDD11︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});var v7={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},W5=v.define({map(Z,$){let J=$.mapPos(Z,-1,E0.TrackAfter);return J==null?void 0:J}}),hZ=new class extends W1{};hZ.startSide=1;hZ.endSide=-1;var bK=j0.define({create(){return d.empty},update(Z,$){if(Z=Z.map($.changes),$.selection){let J=$.state.doc.lineAt($.selection.main.head);Z=Z.update({filter:(K)=>K>=J.from&&K<=J.to})}for(let J of $.effects)if(J.is(W5))Z=Z.update({add:[hZ.range(J.value,J.value+1)]});return Z}});function xK(){return[jW,bK]}var kZ="()[]{}<>«»»«［］｛｝";function wK(Z){for(let $=0;$<kZ.length;$+=2)if(kZ.charCodeAt($)==Z)return kZ.charAt($+1);return $7(Z<128?Z:Z+1)}function hK(Z,$){return Z.languageDataAt("closeBrackets",$)[0]||v7}var WW=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),jW=B.inputHandler.of((Z,$,J,K)=>{if((WW?Z.composing:Z.compositionStarted)||Z.state.readOnly)return!1;let X=Z.state.selection.main;if(K.length>2||K.length==2&&c0(P0(K,0))==1||$!=X.from||J!=X.to)return!1;let Q=zW(Z.state,K);if(!Q)return!1;return Z.dispatch(Q),!0}),_W=({state:Z,dispatch:$})=>{if(Z.readOnly)return!1;let K=hK(Z,Z.selection.main.head).brackets||v7.brackets,X=null,Q=Z.changeByRange((U)=>{if(U.empty){let Y=OW(Z.doc,U.head);for(let q of K)if(q==Y&&_9(Z.doc,U.head)==wK(P0(q,0)))return{changes:{from:U.head-q.length,to:U.head+q.length},range:D.cursor(U.head-q.length)}}return{range:X=U}});if(!X)$(Z.update(Q,{scrollIntoView:!0,userEvent:"delete.backward"}));return!X},vK=[{key:"Backspace",run:_W}];function zW(Z,$){let J=hK(Z,Z.selection.main.head),K=J.brackets||v7.brackets;for(let X of K){let Q=wK(P0(X,0));if($==X)return Q==X?NW(Z,X,K.indexOf(X+X+X)>-1,J):VW(Z,X,Q,J.before||v7.before);if($==Q&&mK(Z,Z.selection.main.from))return HW(Z,X,Q)}return null}function mK(Z,$){let J=!1;return Z.field(bK).between(0,Z.doc.length,(K)=>{if(K==$)J=!0}),J}function _9(Z,$){let J=Z.sliceString($,$+2);return J.slice(0,c0(P0(J,0)))}function OW(Z,$){let J=Z.sliceString($-2,$);return c0(P0(J,0))==J.length?J:J.slice(1)}function VW(Z,$,J,K){let X=null,Q=Z.changeByRange((U)=>{if(!U.empty)return{changes:[{insert:$,from:U.from},{insert:J,from:U.to}],effects:W5.of(U.to+$.length),range:D.range(U.anchor+$.length,U.head+$.length)};let Y=_9(Z.doc,U.head);if(!Y||/\s/.test(Y)||K.indexOf(Y)>-1)return{changes:{insert:$+J,from:U.head},effects:W5.of(U.head+$.length),range:D.cursor(U.head+$.length)};return{range:X=U}});return X?null:Z.update(Q,{scrollIntoView:!0,userEvent:"input.type"})}function HW(Z,$,J){let K=null,X=Z.changeByRange((Q)=>{if(Q.empty&&_9(Z.doc,Q.head)==J)return{changes:{from:Q.head,to:Q.head+J.length,insert:J},range:D.cursor(Q.head+J.length)};return K={range:Q}});return K?null:Z.update(X,{scrollIntoView:!0,userEvent:"input.type"})}function NW(Z,$,J,K){let X=K.stringPrefixes||v7.stringPrefixes,Q=null,U=Z.changeByRange((Y)=>{if(!Y.empty)return{changes:[{insert:$,from:Y.from},{insert:$,from:Y.to}],effects:W5.of(Y.to+$.length),range:D.range(Y.anchor+$.length,Y.head+$.length)};let q=Y.head,G=_9(Z.doc,q),W;if(G==$){if(LK(Z,q))return{changes:{insert:$+$,from:q},effects:W5.of(q+$.length),range:D.cursor(q+$.length)};else if(mK(Z,q)){let _=J&&Z.sliceDoc(q,q+$.length*3)==$+$+$?$+$+$:$;return{changes:{from:q,to:q+_.length,insert:_},range:D.cursor(q+_.length)}}}else if(J&&Z.sliceDoc(q-2*$.length,q)==$+$&&(W=MK(Z,q-2*$.length,X))>-1&&LK(Z,W))return{changes:{insert:$+$+$+$,from:q},effects:W5.of(q+$.length),range:D.cursor(q+$.length)};else if(Z.charCategorizer(q)(G)!=X0.Word){if(MK(Z,q,X)>-1&&!IW(Z,q,$,X))return{changes:{insert:$+$,from:q},effects:W5.of(q+$.length),range:D.cursor(q+$.length)}}return{range:Q=Y}});return Q?null:Z.update(U,{scrollIntoView:!0,userEvent:"input.type"})}function LK(Z,$){let J=L0(Z).resolveInner($+1);return J.parent&&J.from==$}function IW(Z,$,J,K){let X=L0(Z).resolveInner($,-1),Q=K.reduce((U,Y)=>Math.max(U,Y.length),0);for(let U=0;U<5;U++){let Y=Z.sliceDoc(X.from,Math.min(X.to,X.from+J.length+Q)),q=Y.indexOf(J);if(!q||q>-1&&K.indexOf(Y.slice(0,q))>-1){let W=X.firstChild;while(W&&W.from==X.from&&W.to-W.from>J.length+q){if(Z.sliceDoc(W.to-J.length,W.to)==J)return!1;W=W.firstChild}return!0}let G=X.to==$&&X.parent;if(!G)break;X=G}return!1}function MK(Z,$,J){let K=Z.charCategorizer($);if(K(Z.sliceDoc($-1,$))!=X0.Word)return $;for(let X of J){let Q=$-X.length;if(Z.sliceDoc(Q,$)==X&&K(Z.sliceDoc(Q-1,Q))!=X0.Word)return Q}return-1}function uK(Z={}){return[qW,p0,M0.of(Z),UW,RW,GW]}var vZ=[{key:"Ctrl-Space",run:yZ},{mac:"Alt-`",run:yZ},{mac:"Alt-i",run:yZ},{key:"Escape",run:KW},{key:"ArrowDown",run:G9(!0)},{key:"ArrowUp",run:G9(!1)},{key:"PageDown",run:G9(!0,"page")},{key:"PageUp",run:G9(!1,"page")},{key:"Enter",run:JW}],RW=j1.highest(A7.computeN([M0],(Z)=>Z.facet(M0).defaultKeymap?[vZ]:[]));class mZ{constructor(Z,$,J){this.from=Z,this.to=$,this.diagnostic=J}}class _5{constructor(Z,$,J){this.diagnostics=Z,this.panel=$,this.selected=J}static init(Z,$,J){let K=J.facet(m7).markerFilter;if(K)Z=K(Z,J);let X=Z.slice().sort((_,z)=>_.from-z.from||_.to-z.to),Q=new l0,U=[],Y=0,q=J.doc.iter(),G=0,W=J.doc.length;for(let _=0;;){let z=_==X.length?null:X[_];if(!z&&!U.length)break;let V,O;if(U.length)V=Y,O=U.reduce((A,L)=>Math.min(A,L.to),z&&z.from>V?z.from:1e8);else{if(V=z.from,V>W)break;O=z.to,U.push(z),_++}while(_<X.length){let A=X[_];if(A.from==V&&(A.to>A.from||A.to==V))U.push(A),_++,O=Math.min(A.to,O);else{O=Math.min(A.from,O);break}}O=Math.min(O,W);let N=!1;if(U.some((A)=>A.from==V&&(A.to==O||O==W))){if(N=V==O,!N&&O-V<10){let A=V-(G+q.value.length);if(A>0)q.next(A),G=V;for(let L=V;;){if(L>=O){N=!0;break}if(!q.lineBreak&&G+q.value.length>L)break;L=G+q.value.length,G+=q.value.length,q.next()}}}let R=yW(U);if(N)Q.add(V,V,x.widget({widget:new nK(R),diagnostics:U.slice()}));else{let A=U.reduce((L,E)=>E.markClass?L+" "+E.markClass:L,"");Q.add(V,O,x.mark({class:"cm-lintRange cm-lintRange-"+R+A,diagnostics:U.slice(),inclusiveEnd:U.some((L)=>L.to>O)}))}if(Y=O,Y==W)break;for(let A=0;A<U.length;A++)if(U[A].to<=Y)U.splice(A--,1)}let j=Q.finish();return new _5(j,$,c5(j))}}function c5(Z,$=null,J=0){let K=null;return Z.between(J,1e9,(X,Q,{spec:U})=>{if($&&U.diagnostics.indexOf($)<0)return;if(!K)K=new mZ(X,Q,$||U.diagnostics[0]);else if(U.diagnostics.indexOf(K.diagnostic)<0)return!1;else K=new mZ(K.from,Q,K.diagnostic)}),K}function FW(Z,$){let J=$.pos,K=$.end||J,X=Z.state.facet(m7).hideOn(Z,J,K);if(X!=null)return X;let Q=Z.startState.doc.lineAt($.pos);return!!(Z.effects.some((U)=>U.is(pK))||Z.changes.touchesRange(Q.from,Math.max(Q.to,K)))}function DW(Z,$){return Z.field(r0,!1)?$:$.concat(v.appendConfig.of(kW))}var pK=v.define(),fZ=v.define(),dK=v.define(),r0=j0.define({create(){return new _5(x.none,null,null)},update(Z,$){if($.docChanged&&Z.diagnostics.size){let J=Z.diagnostics.map($.changes),K=null,X=Z.panel;if(Z.selected){let Q=$.changes.mapPos(Z.selected.from,1);K=c5(J,Z.selected.diagnostic,Q)||c5(J,null,Q)}if(!J.size&&X&&$.state.facet(m7).autoPanel)X=null;Z=new _5(J,X,K)}for(let J of $.effects)if(J.is(pK)){let K=!$.state.facet(m7).autoPanel?Z.panel:J.value.length?u7.open:null;Z=_5.init(J.value,K,$.state)}else if(J.is(fZ))Z=new _5(Z.diagnostics,J.value?u7.open:null,Z.selected);else if(J.is(dK))Z=new _5(Z.diagnostics,Z.panel,J.value);return Z},provide:(Z)=>[U5.from(Z,($)=>$.panel),B.decorations.from(Z,($)=>$.diagnostics)]});var AW=x.mark({class:"cm-lintRange cm-lintRange-active"});function LW(Z,$,J){let{diagnostics:K}=Z.state.field(r0),X,Q=-1,U=-1;K.between($-(J<0?1:0),$+(J>0?1:0),(q,G,{spec:W})=>{if($>=q&&$<=G&&(q==G||($>q||J>0)&&($<G||J<0)))return X=W.diagnostics,Q=q,U=G,!1});let Y=Z.state.facet(m7).tooltipFilter;if(X&&Y)X=Y(X,Z.state);if(!X)return null;return{pos:Q,end:U,above:Z.state.doc.lineAt(Q).to<U,create(){return{dom:MW(Z,X)}}}}function MW(Z,$){return o("ul",{class:"cm-tooltip-lint"},$.map((J)=>sK(Z,J,!1)))}var BW=(Z)=>{let $=Z.state.field(r0,!1);if(!$||!$.panel)Z.dispatch({effects:DW(Z.state,[fZ.of(!0)])});let J=B7(Z,u7.open);if(J)J.dom.querySelector(".cm-panel-lint ul").focus();return!0},fK=(Z)=>{let $=Z.state.field(r0,!1);if(!$||!$.panel)return!1;return Z.dispatch({effects:fZ.of(!1)}),!0},EW=(Z)=>{let $=Z.state.field(r0,!1);if(!$)return!1;let J=Z.state.selection.main,K=$.diagnostics.iter(J.to+1);if(!K.value){if(K=$.diagnostics.iter(0),!K.value||K.from==J.from&&K.to==J.to)return!1}return Z.dispatch({selection:{anchor:K.from,head:K.to},scrollIntoView:!0}),!0};var lK=[{key:"Mod-Shift-m",run:BW,preventDefault:!0},{key:"F8",run:EW}];var m7=C.define({combine(Z){return{sources:Z.map(($)=>$.source).filter(($)=>$!=null),...S0(Z.map(($)=>$.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:gK,tooltipFilter:gK,needsRefresh:($,J)=>!$?J:!J?$:(K)=>$(K)||J(K),hideOn:($,J)=>!$?J:!J?$:(K,X,Q)=>$(K,X,Q)||J(K,X,Q),autoPanel:($,J)=>$||J})}}});function gK(Z,$){return!Z?$:!$?Z:(J,K)=>$(Z(J,K),K)}function cK(Z){let $=[];if(Z)Z:for(let{name:J}of Z){for(let K=0;K<J.length;K++){let X=J[K];if(/[a-zA-Z]/.test(X)&&!$.some((Q)=>Q.toLowerCase()==X.toLowerCase())){$.push(X);continue Z}}$.push("")}return $}function sK(Z,$,J){var K;let X=J?cK($.actions):[];return o("li",{class:"cm-diagnostic cm-diagnostic-"+$.severity},o("span",{class:"cm-diagnosticText"},$.renderMessage?$.renderMessage(Z):$.message),(K=$.actions)===null||K===void 0?void 0:K.map((Q,U)=>{let Y=!1,q=(z)=>{if(z.preventDefault(),Y)return;Y=!0;let V=c5(Z.state.field(r0).diagnostics,$);if(V)Q.apply(Z,V.from,V.to)},{name:G}=Q,W=X[U]?G.indexOf(X[U]):-1,j=W<0?G:[G.slice(0,W),o("u",G.slice(W,W+1)),G.slice(W+1)],_=Q.markClass?" "+Q.markClass:"";return o("button",{type:"button",class:"cm-diagnosticAction"+_,onclick:q,onmousedown:q,"aria-label":` Action: ${G}${W<0?"":` (access key "${X[U]})"`}.`},j)}),$.source&&o("div",{class:"cm-diagnosticSource"},$.source))}class nK extends i0{constructor(Z){super();this.sev=Z}eq(Z){return Z.sev==this.sev}toDOM(){return o("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class uZ{constructor(Z,$){this.diagnostic=$,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=sK(Z,$,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class u7{constructor(Z){this.view=Z,this.items=[];let $=(K)=>{if(K.ctrlKey||K.altKey||K.metaKey)return;if(K.keyCode==27)fK(this.view),this.view.focus();else if(K.keyCode==38||K.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(K.keyCode==40||K.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(K.keyCode==36)this.moveSelection(0);else if(K.keyCode==35)this.moveSelection(this.items.length-1);else if(K.keyCode==13)this.view.focus();else if(K.keyCode>=65&&K.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:X}=this.items[this.selectedIndex],Q=cK(X.actions);for(let U=0;U<Q.length;U++)if(Q[U].toUpperCase().charCodeAt(0)==K.keyCode){let Y=c5(this.view.state.field(r0).diagnostics,X);if(Y)X.actions[U].apply(Z,Y.from,Y.to)}}else return;K.preventDefault()},J=(K)=>{for(let X=0;X<this.items.length;X++)if(this.items[X].dom.contains(K.target))this.moveSelection(X)};this.list=o("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:$,onclick:J}),this.dom=o("div",{class:"cm-panel-lint"},this.list,o("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>fK(this.view)},"×")),this.update()}get selectedIndex(){let Z=this.view.state.field(r0).selected;if(!Z)return-1;for(let $=0;$<this.items.length;$++)if(this.items[$].diagnostic==Z.diagnostic)return $;return-1}update(){let{diagnostics:Z,selected:$}=this.view.state.field(r0),J=0,K=!1,X=null,Q=new Set;Z.between(0,this.view.state.doc.length,(U,Y,{spec:q})=>{for(let G of q.diagnostics){if(Q.has(G))continue;Q.add(G);let W=-1,j;for(let _=J;_<this.items.length;_++)if(this.items[_].diagnostic==G){W=_;break}if(W<0)j=new uZ(this.view,G),this.items.splice(J,0,j),K=!0;else if(j=this.items[W],W>J)this.items.splice(J,W-J),K=!0;if($&&j.diagnostic==$.diagnostic){if(!j.dom.hasAttribute("aria-selected"))j.dom.setAttribute("aria-selected","true"),X=j}else if(j.dom.hasAttribute("aria-selected"))j.dom.removeAttribute("aria-selected");J++}});while(J<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0))K=!0,this.items.pop();if(this.items.length==0)this.items.push(new uZ(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),K=!0;if(X)this.list.setAttribute("aria-activedescendant",X.id),this.view.requestMeasure({key:this,read:()=>({sel:X.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:U,panel:Y})=>{let q=Y.height/this.list.offsetHeight;if(U.top<Y.top)this.list.scrollTop-=(Y.top-U.top)/q;else if(U.bottom>Y.bottom)this.list.scrollTop+=(U.bottom-Y.bottom)/q}});else if(this.selectedIndex<0)this.list.removeAttribute("aria-activedescendant");if(K)this.sync()}sync(){let Z=this.list.firstChild;function $(){let J=Z;Z=J.nextSibling,J.remove()}for(let J of this.items)if(J.dom.parentNode==this.list){while(Z!=J.dom)$();Z=J.dom.nextSibling}else this.list.insertBefore(J.dom,Z);while(Z)$()}moveSelection(Z){if(this.selectedIndex<0)return;let $=this.view.state.field(r0),J=c5($.diagnostics,this.items[Z].diagnostic);if(!J)return;this.view.dispatch({selection:{anchor:J.from,head:J.to},scrollIntoView:!0,effects:dK.of(J)})}static open(Z){return new u7(Z)}}function PW(Z,$='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${$}>${encodeURIComponent(Z)}</svg>')`}function z9(Z){return PW(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${Z}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}var CW=B.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:0.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:z9("#d11")},".cm-lintRange-warning":{backgroundImage:z9("orange")},".cm-lintRange-info":{backgroundImage:z9("#999")},".cm-lintRange-hint":{backgroundImage:z9("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function TW(Z){return Z=="error"?4:Z=="warning"?3:Z=="info"?2:1}function yW(Z){let $="hint",J=1;for(let K of Z){let X=TW(K.severity);if(X>J)J=X,$=K.severity}return $}var kW=[r0,B.decorations.compute([r0],(Z)=>{let{selected:$,panel:J}=Z.field(r0);return!$||!J||$.from==$.to?x.none:x.set([AW.range($.from,$.to)])}),z3(LW,{hideOn:FW}),CW];var iK=(()=>[F3(),D3(),U3(),PJ(),KJ(),$3(),X3(),p.allowMultipleSelections.of(!0),i3(),i4(UJ,{fallback:!0}),WJ(),xK(),uK(),W3(),j3(),G3(),GK(),A7.of([...vK,...KK,...HK,...kJ,...e3,...vZ,...lK])])();function gZ(Z){var $={as:"keyword",do:"keyword",else:"keyword",end:"keyword",exception:"keyword",fun:"keyword",functor:"keyword",if:"keyword",in:"keyword",include:"keyword",let:"keyword",of:"keyword",open:"keyword",rec:"keyword",struct:"keyword",then:"keyword",type:"keyword",val:"keyword",while:"keyword",with:"keyword"},J=Z.extraWords||{};for(var K in J)if(J.hasOwnProperty(K))$[K]=Z.extraWords[K];var X=[];for(var Q in $)X.push(Q);function U(W,j){var _=W.next();if(_==='"')return j.tokenize=Y,j.tokenize(W,j);if(_==="{"){if(W.eat("|"))return j.longString=!0,j.tokenize=G,j.tokenize(W,j)}if(_==="("){if(W.match(/^\*(?!\))/))return j.commentLevel++,j.tokenize=q,j.tokenize(W,j)}if(_==="~"||_==="?")return W.eatWhile(/\w/),"variableName.special";if(_==="`")return W.eatWhile(/\w/),"quote";if(_==="/"&&Z.slashComments&&W.eat("/"))return W.skipToEnd(),"comment";if(/\d/.test(_)){if(_==="0"&&W.eat(/[bB]/))W.eatWhile(/[01]/);if(_==="0"&&W.eat(/[xX]/))W.eatWhile(/[0-9a-fA-F]/);if(_==="0"&&W.eat(/[oO]/))W.eatWhile(/[0-7]/);else{if(W.eatWhile(/[\d_]/),W.eat("."))W.eatWhile(/[\d]/);if(W.eat(/[eE]/))W.eatWhile(/[\d\-+]/)}return"number"}if(/[+\-*&%=<>!?|@\.~:]/.test(_))return"operator";if(/[\w\xa1-\uffff]/.test(_)){W.eatWhile(/[\w\xa1-\uffff]/);var z=W.current();return $.hasOwnProperty(z)?$[z]:"variable"}return null}function Y(W,j){var _,z=!1,V=!1;while((_=W.next())!=null){if(_==='"'&&!V){z=!0;break}V=!V&&_==="\\"}if(z&&!V)j.tokenize=U;return"string"}function q(W,j){var _,z;while(j.commentLevel>0&&(z=W.next())!=null){if(_==="("&&z==="*")j.commentLevel++;if(_==="*"&&z===")")j.commentLevel--;_=z}if(j.commentLevel<=0)j.tokenize=U;return"comment"}function G(W,j){var _,z;while(j.longString&&(z=W.next())!=null){if(_==="|"&&z==="}")j.longString=!1;_=z}if(!j.longString)j.tokenize=U;return"string"}return{startState:function(){return{tokenize:U,commentLevel:0,longString:!1}},token:function(W,j){if(W.eatSpace())return null;return j.tokenize(W,j)},languageData:{autocomplete:X,commentTokens:{line:Z.slashComments?"//":void 0,block:{open:"(*",close:"*)"}}}}}var O9=gZ({name:"ocaml",extraWords:{and:"keyword",assert:"keyword",begin:"keyword",class:"keyword",constraint:"keyword",done:"keyword",downto:"keyword",external:"keyword",function:"keyword",initializer:"keyword",lazy:"keyword",match:"keyword",method:"keyword",module:"keyword",mutable:"keyword",new:"keyword",nonrec:"keyword",object:"keyword",private:"keyword",sig:"keyword",to:"keyword",try:"keyword",value:"keyword",virtual:"keyword",when:"keyword",raise:"builtin",failwith:"builtin",true:"builtin",false:"builtin",asr:"builtin",land:"builtin",lor:"builtin",lsl:"builtin",lsr:"builtin",lxor:"builtin",mod:"builtin",or:"builtin",raise_notrace:"builtin",trace:"builtin",exit:"builtin",print_string:"builtin",print_endline:"builtin",int:"type",float:"type",bool:"type",char:"type",string:"type",unit:"type",List:"builtin"}}),Az=gZ({name:"fsharp",extraWords:{abstract:"keyword",assert:"keyword",base:"keyword",begin:"keyword",class:"keyword",default:"keyword",delegate:"keyword","do!":"keyword",done:"keyword",downcast:"keyword",downto:"keyword",elif:"keyword",extern:"keyword",finally:"keyword",for:"keyword",function:"keyword",global:"keyword",inherit:"keyword",inline:"keyword",interface:"keyword",internal:"keyword",lazy:"keyword","let!":"keyword",match:"keyword",member:"keyword",module:"keyword",mutable:"keyword",namespace:"keyword",new:"keyword",null:"keyword",override:"keyword",private:"keyword",public:"keyword","return!":"keyword",return:"keyword",select:"keyword",static:"keyword",to:"keyword",try:"keyword",upcast:"keyword","use!":"keyword",use:"keyword",void:"keyword",when:"keyword","yield!":"keyword",yield:"keyword",atomic:"keyword",break:"keyword",checked:"keyword",component:"keyword",const:"keyword",constraint:"keyword",constructor:"keyword",continue:"keyword",eager:"keyword",event:"keyword",external:"keyword",fixed:"keyword",method:"keyword",mixin:"keyword",object:"keyword",parallel:"keyword",process:"keyword",protected:"keyword",pure:"keyword",sealed:"keyword",tailcall:"keyword",trait:"keyword",virtual:"keyword",volatile:"keyword",List:"builtin",Seq:"builtin",Map:"builtin",Set:"builtin",Option:"builtin",int:"builtin",string:"builtin",not:"builtin",true:"builtin",false:"builtin",raise:"builtin",failwith:"builtin"},slashComments:!0}),Lz=gZ({name:"sml",extraWords:{abstype:"keyword",and:"keyword",andalso:"keyword",case:"keyword",datatype:"keyword",fn:"keyword",handle:"keyword",infix:"keyword",infixr:"keyword",local:"keyword",nonfix:"keyword",op:"keyword",orelse:"keyword",raise:"keyword",withtype:"keyword",eqtype:"keyword",sharing:"keyword",sig:"keyword",signature:"keyword",structure:"keyword",where:"keyword",true:"keyword",false:"keyword",int:"builtin",real:"builtin",string:"builtin",char:"builtin",bool:"builtin"},slashComments:!0});var SW="#e5c07b",aK="#e06c75",bW="#56b6c2",xW="#ffffff",V9="#abb2bf",dZ="#7d8799",wW="#61afef",hW="#98c379",rK="#d19a66",vW="#c678dd",mW="#21252b",oK="#2c313a",tK="#282c34",pZ="#353a42",uW="#3E4451",eK="#528bff";var fW=B.theme({"&":{color:V9,backgroundColor:tK},".cm-content":{caretColor:eK},".cm-cursor, .cm-dropCursor":{borderLeftColor:eK},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:uW},".cm-panels":{backgroundColor:mW,color:V9},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:tK,color:dZ,border:"none"},".cm-activeLineGutter":{backgroundColor:oK},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:pZ},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:pZ,borderBottomColor:pZ},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:oK,color:V9}}},{dark:!0}),gW=h5.define([{tag:F.keyword,color:vW},{tag:[F.name,F.deleted,F.character,F.propertyName,F.macroName],color:aK},{tag:[F.function(F.variableName),F.labelName],color:wW},{tag:[F.color,F.constant(F.name),F.standard(F.name)],color:rK},{tag:[F.definition(F.name),F.separator],color:V9},{tag:[F.typeName,F.className,F.number,F.changed,F.annotation,F.modifier,F.self,F.namespace],color:SW},{tag:[F.operator,F.operatorKeyword,F.url,F.escape,F.regexp,F.link,F.special(F.string)],color:bW},{tag:[F.meta,F.comment],color:dZ},{tag:F.strong,fontWeight:"bold"},{tag:F.emphasis,fontStyle:"italic"},{tag:F.strikethrough,textDecoration:"line-through"},{tag:F.link,color:dZ,textDecoration:"underline"},{tag:F.heading,fontWeight:"bold",color:aK},{tag:[F.atom,F.bool,F.special(F.variableName)],color:rK},{tag:[F.processingInstruction,F.string,F.inserted],color:hW},{tag:F.invalid,color:xW}]),H9=[fW,i4(gW)];var s5=null;function ZX(Z){let $=document.getElementById("editor");if(!$)return;if(!s5){let J=p.create({doc:Z,extensions:[iK,v5.define(O9),H9,B.theme({"&":{height:"100%",backgroundColor:"#1e1e1e",outline:"none !important"},".cm-scroller":{overflow:"auto",fontFamily:"var(--font-mono)"},".cm-content":{padding:"24px 16px",whiteSpace:"pre",flexShrink:"0"},".cm-gutters":{backgroundColor:"#1e1e1e",borderRight:"1px solid #334155"},".cm-gutterElement":{padding:"0 8px"}})]});s5=new B({state:J,parent:$})}else{let J=s5.state.doc.toString();if(J!==Z)s5.dispatch({changes:{from:0,to:J.length,insert:Z}})}}function $X(){return s5?s5.state.doc.toString():""}function lZ(){return!!(window.ocaml&&window.ocaml.run)}async function JX(Z){if(!window.ocaml||!window.ocaml.run)throw Error("Compiler not ready yet.");return window.ocaml.run(Z)}function sZ(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var O5=sZ();function GX(Z){O5=Z}var d7={exec:()=>null};function t(Z,$=""){let J=typeof Z=="string"?Z:Z.source,K={replace:(X,Q)=>{let U=typeof Q=="string"?Q:Q.source;return U=U.replace(m0.caret,"$1"),J=J.replace(X,U),K},getRegex:()=>new RegExp(J,$)};return K}var pW=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),m0={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:(Z)=>new RegExp(`^( {0,3}${Z})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}#`),htmlBeginRegex:(Z)=>new RegExp(`^ {0,${Math.min(3,Z-1)}}<(?:[a-z].*>|!--)`,"i")},dW=/^(?:[ \t]*(?:\n|$))+/,lW=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,cW=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,l7=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,sW=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,nZ=/(?:[*+-]|\d{1,9}[.)])/,WX=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,jX=t(WX).replace(/bull/g,nZ).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),nW=t(WX).replace(/bull/g,nZ).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),iZ=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,iW=/^[^\n]+/,aZ=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,aW=t(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",aZ).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),rW=t(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,nZ).getRegex(),D9="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",rZ=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,oW=t("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",rZ).replace("tag",D9).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),_X=t(iZ).replace("hr",l7).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D9).getRegex(),tW=t(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",_X).getRegex(),oZ={blockquote:tW,code:lW,def:aW,fences:cW,heading:sW,hr:l7,html:oW,lheading:jX,list:rW,newline:dW,paragraph:_X,table:d7,text:iW},KX=t("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",l7).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D9).getRegex(),eW={...oZ,lheading:nW,table:KX,paragraph:t(iZ).replace("hr",l7).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",KX).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D9).getRegex()},Zj={...oZ,html:t(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",rZ).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:d7,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:t(iZ).replace("hr",l7).replace("heading",` *#{1,6} *[^
]`).replace("lheading",jX).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},$j=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Jj=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,zX=/^( {2,}|\\)\n(?!\s*$)/,Kj=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,A9=/[\p{P}\p{S}]/u,tZ=/[\s\p{P}\p{S}]/u,OX=/[^\s\p{P}\p{S}]/u,Xj=t(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,tZ).getRegex(),VX=/(?!~)[\p{P}\p{S}]/u,Qj=/(?!~)[\s\p{P}\p{S}]/u,Uj=/(?:[^\s\p{P}\p{S}]|~)/u,Yj=t(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",pW?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),HX=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,qj=t(HX,"u").replace(/punct/g,A9).getRegex(),Gj=t(HX,"u").replace(/punct/g,VX).getRegex(),NX="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Wj=t(NX,"gu").replace(/notPunctSpace/g,OX).replace(/punctSpace/g,tZ).replace(/punct/g,A9).getRegex(),jj=t(NX,"gu").replace(/notPunctSpace/g,Uj).replace(/punctSpace/g,Qj).replace(/punct/g,VX).getRegex(),_j=t("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,OX).replace(/punctSpace/g,tZ).replace(/punct/g,A9).getRegex(),zj=t(/\\(punct)/,"gu").replace(/punct/g,A9).getRegex(),Oj=t(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Vj=t(rZ).replace("(?:-->|$)","-->").getRegex(),Hj=t("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Vj).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),I9=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Nj=t(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",I9).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),IX=t(/^!?\[(label)\]\[(ref)\]/).replace("label",I9).replace("ref",aZ).getRegex(),RX=t(/^!?\[(ref)\](?:\[\])?/).replace("ref",aZ).getRegex(),Ij=t("reflink|nolink(?!\\()","g").replace("reflink",IX).replace("nolink",RX).getRegex(),XX=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,eZ={_backpedal:d7,anyPunctuation:zj,autolink:Oj,blockSkip:Yj,br:zX,code:Jj,del:d7,emStrongLDelim:qj,emStrongRDelimAst:Wj,emStrongRDelimUnd:_j,escape:$j,link:Nj,nolink:RX,punctuation:Xj,reflink:IX,reflinkSearch:Ij,tag:Hj,text:Kj,url:d7},Rj={...eZ,link:t(/^!?\[(label)\]\((.*?)\)/).replace("label",I9).getRegex(),reflink:t(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",I9).getRegex()},cZ={...eZ,emStrongRDelimAst:jj,emStrongLDelim:Gj,url:t(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",XX).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:t(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",XX).getRegex()},Fj={...cZ,br:t(zX).replace("{2,}","*").getRegex(),text:t(cZ.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},N9={normal:oZ,gfm:eW,pedantic:Zj},f7={normal:eZ,gfm:cZ,breaks:Fj,pedantic:Rj},Dj={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},QX=(Z)=>Dj[Z];function w1(Z,$){if($){if(m0.escapeTest.test(Z))return Z.replace(m0.escapeReplace,QX)}else if(m0.escapeTestNoEncode.test(Z))return Z.replace(m0.escapeReplaceNoEncode,QX);return Z}function UX(Z){try{Z=encodeURI(Z).replace(m0.percentDecode,"%")}catch{return null}return Z}function YX(Z,$){let J=Z.replace(m0.findPipe,(Q,U,Y)=>{let q=!1,G=U;for(;--G>=0&&Y[G]==="\\";)q=!q;return q?"|":" |"}),K=J.split(m0.splitPipe),X=0;if(K[0].trim()||K.shift(),K.length>0&&!K.at(-1)?.trim()&&K.pop(),$)if(K.length>$)K.splice($);else for(;K.length<$;)K.push("");for(;X<K.length;X++)K[X]=K[X].trim().replace(m0.slashPipe,"|");return K}function g7(Z,$,J){let K=Z.length;if(K===0)return"";let X=0;for(;X<K;){let Q=Z.charAt(K-X-1);if(Q===$&&!J)X++;else if(Q!==$&&J)X++;else break}return Z.slice(0,K-X)}function Aj(Z,$){if(Z.indexOf($[1])===-1)return-1;let J=0;for(let K=0;K<Z.length;K++)if(Z[K]==="\\")K++;else if(Z[K]===$[0])J++;else if(Z[K]===$[1]&&(J--,J<0))return K;return J>0?-2:-1}function qX(Z,$,J,K,X){let Q=$.href,U=$.title||null,Y=Z[1].replace(X.other.outputLinkReplace,"$1");K.state.inLink=!0;let q={type:Z[0].charAt(0)==="!"?"image":"link",raw:J,href:Q,title:U,text:Y,tokens:K.inlineTokens(Y)};return K.state.inLink=!1,q}function Lj(Z,$,J){let K=Z.match(J.other.indentCodeCompensation);if(K===null)return $;let X=K[1];return $.split(`
`).map((Q)=>{let U=Q.match(J.other.beginningSpace);if(U===null)return Q;let[Y]=U;return Y.length>=X.length?Q.slice(X.length):Q}).join(`
`)}var R9=class{options;rules;lexer;constructor(Z){this.options=Z||O5}space(Z){let $=this.rules.block.newline.exec(Z);if($&&$[0].length>0)return{type:"space",raw:$[0]}}code(Z){let $=this.rules.block.code.exec(Z);if($){let J=$[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:$[0],codeBlockStyle:"indented",text:this.options.pedantic?J:g7(J,`
`)}}}fences(Z){let $=this.rules.block.fences.exec(Z);if($){let J=$[0],K=Lj(J,$[3]||"",this.rules);return{type:"code",raw:J,lang:$[2]?$[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):$[2],text:K}}}heading(Z){let $=this.rules.block.heading.exec(Z);if($){let J=$[2].trim();if(this.rules.other.endingHash.test(J)){let K=g7(J,"#");(this.options.pedantic||!K||this.rules.other.endingSpaceChar.test(K))&&(J=K.trim())}return{type:"heading",raw:$[0],depth:$[1].length,text:J,tokens:this.lexer.inline(J)}}}hr(Z){let $=this.rules.block.hr.exec(Z);if($)return{type:"hr",raw:g7($[0],`
`)}}blockquote(Z){let $=this.rules.block.blockquote.exec(Z);if($){let J=g7($[0],`
`).split(`
`),K="",X="",Q=[];for(;J.length>0;){let U=!1,Y=[],q;for(q=0;q<J.length;q++)if(this.rules.other.blockquoteStart.test(J[q]))Y.push(J[q]),U=!0;else if(!U)Y.push(J[q]);else break;J=J.slice(q);let G=Y.join(`
`),W=G.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");K=K?`${K}
${G}`:G,X=X?`${X}
${W}`:W;let j=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(W,Q,!0),this.lexer.state.top=j,J.length===0)break;let _=Q.at(-1);if(_?.type==="code")break;if(_?.type==="blockquote"){let z=_,V=z.raw+`
`+J.join(`
`),O=this.blockquote(V);Q[Q.length-1]=O,K=K.substring(0,K.length-z.raw.length)+O.raw,X=X.substring(0,X.length-z.text.length)+O.text;break}else if(_?.type==="list"){let z=_,V=z.raw+`
`+J.join(`
`),O=this.list(V);Q[Q.length-1]=O,K=K.substring(0,K.length-_.raw.length)+O.raw,X=X.substring(0,X.length-z.raw.length)+O.raw,J=V.substring(Q.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:K,tokens:Q,text:X}}}list(Z){let $=this.rules.block.list.exec(Z);if($){let J=$[1].trim(),K=J.length>1,X={type:"list",raw:"",ordered:K,start:K?+J.slice(0,-1):"",loose:!1,items:[]};J=K?`\\d{1,9}\\${J.slice(-1)}`:`\\${J}`,this.options.pedantic&&(J=K?J:"[*+-]");let Q=this.rules.other.listItemRegex(J),U=!1;for(;Z;){let q=!1,G="",W="";if(!($=Q.exec(Z))||this.rules.block.hr.test(Z))break;G=$[0],Z=Z.substring(G.length);let j=$[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,(O)=>" ".repeat(3*O.length)),_=Z.split(`
`,1)[0],z=!j.trim(),V=0;if(this.options.pedantic?(V=2,W=j.trimStart()):z?V=$[1].length+1:(V=$[2].search(this.rules.other.nonSpaceChar),V=V>4?1:V,W=j.slice(V),V+=$[1].length),z&&this.rules.other.blankLine.test(_)&&(G+=_+`
`,Z=Z.substring(_.length+1),q=!0),!q){let O=this.rules.other.nextBulletRegex(V),N=this.rules.other.hrRegex(V),R=this.rules.other.fencesBeginRegex(V),A=this.rules.other.headingBeginRegex(V),L=this.rules.other.htmlBeginRegex(V);for(;Z;){let E=Z.split(`
`,1)[0],M;if(_=E,this.options.pedantic?(_=_.replace(this.rules.other.listReplaceNesting,"  "),M=_):M=_.replace(this.rules.other.tabCharGlobal,"    "),R.test(_)||A.test(_)||L.test(_)||O.test(_)||N.test(_))break;if(M.search(this.rules.other.nonSpaceChar)>=V||!_.trim())W+=`
`+M.slice(V);else{if(z||j.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||R.test(j)||A.test(j)||N.test(j))break;W+=`
`+_}!z&&!_.trim()&&(z=!0),G+=E+`
`,Z=Z.substring(E.length+1),j=M.slice(V)}}X.loose||(U?X.loose=!0:this.rules.other.doubleBlankLine.test(G)&&(U=!0)),X.items.push({type:"list_item",raw:G,task:!!this.options.gfm&&this.rules.other.listIsTask.test(W),loose:!1,text:W,tokens:[]}),X.raw+=G}let Y=X.items.at(-1);if(Y)Y.raw=Y.raw.trimEnd(),Y.text=Y.text.trimEnd();else return;X.raw=X.raw.trimEnd();for(let q of X.items){if(this.lexer.state.top=!1,q.tokens=this.lexer.blockTokens(q.text,[]),q.task){if(q.text=q.text.replace(this.rules.other.listReplaceTask,""),q.tokens[0]?.type==="text"||q.tokens[0]?.type==="paragraph"){q.tokens[0].raw=q.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),q.tokens[0].text=q.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let W=this.lexer.inlineQueue.length-1;W>=0;W--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[W].src)){this.lexer.inlineQueue[W].src=this.lexer.inlineQueue[W].src.replace(this.rules.other.listReplaceTask,"");break}}let G=this.rules.other.listTaskCheckbox.exec(q.raw);if(G){let W={type:"checkbox",raw:G[0]+" ",checked:G[0]!=="[ ]"};q.checked=W.checked,X.loose?q.tokens[0]&&["paragraph","text"].includes(q.tokens[0].type)&&"tokens"in q.tokens[0]&&q.tokens[0].tokens?(q.tokens[0].raw=W.raw+q.tokens[0].raw,q.tokens[0].text=W.raw+q.tokens[0].text,q.tokens[0].tokens.unshift(W)):q.tokens.unshift({type:"paragraph",raw:W.raw,text:W.raw,tokens:[W]}):q.tokens.unshift(W)}}if(!X.loose){let G=q.tokens.filter((j)=>j.type==="space"),W=G.length>0&&G.some((j)=>this.rules.other.anyLine.test(j.raw));X.loose=W}}if(X.loose)for(let q of X.items){q.loose=!0;for(let G of q.tokens)G.type==="text"&&(G.type="paragraph")}return X}}html(Z){let $=this.rules.block.html.exec(Z);if($)return{type:"html",block:!0,raw:$[0],pre:$[1]==="pre"||$[1]==="script"||$[1]==="style",text:$[0]}}def(Z){let $=this.rules.block.def.exec(Z);if($){let J=$[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),K=$[2]?$[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",X=$[3]?$[3].substring(1,$[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):$[3];return{type:"def",tag:J,raw:$[0],href:K,title:X}}}table(Z){let $=this.rules.block.table.exec(Z);if(!$||!this.rules.other.tableDelimiter.test($[2]))return;let J=YX($[1]),K=$[2].replace(this.rules.other.tableAlignChars,"").split("|"),X=$[3]?.trim()?$[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],Q={type:"table",raw:$[0],header:[],align:[],rows:[]};if(J.length===K.length){for(let U of K)this.rules.other.tableAlignRight.test(U)?Q.align.push("right"):this.rules.other.tableAlignCenter.test(U)?Q.align.push("center"):this.rules.other.tableAlignLeft.test(U)?Q.align.push("left"):Q.align.push(null);for(let U=0;U<J.length;U++)Q.header.push({text:J[U],tokens:this.lexer.inline(J[U]),header:!0,align:Q.align[U]});for(let U of X)Q.rows.push(YX(U,Q.header.length).map((Y,q)=>({text:Y,tokens:this.lexer.inline(Y),header:!1,align:Q.align[q]})));return Q}}lheading(Z){let $=this.rules.block.lheading.exec(Z);if($)return{type:"heading",raw:$[0],depth:$[2].charAt(0)==="="?1:2,text:$[1],tokens:this.lexer.inline($[1])}}paragraph(Z){let $=this.rules.block.paragraph.exec(Z);if($){let J=$[1].charAt($[1].length-1)===`
`?$[1].slice(0,-1):$[1];return{type:"paragraph",raw:$[0],text:J,tokens:this.lexer.inline(J)}}}text(Z){let $=this.rules.block.text.exec(Z);if($)return{type:"text",raw:$[0],text:$[0],tokens:this.lexer.inline($[0])}}escape(Z){let $=this.rules.inline.escape.exec(Z);if($)return{type:"escape",raw:$[0],text:$[1]}}tag(Z){let $=this.rules.inline.tag.exec(Z);if($)return!this.lexer.state.inLink&&this.rules.other.startATag.test($[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test($[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test($[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test($[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:$[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:$[0]}}link(Z){let $=this.rules.inline.link.exec(Z);if($){let J=$[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(J)){if(!this.rules.other.endAngleBracket.test(J))return;let Q=g7(J.slice(0,-1),"\\");if((J.length-Q.length)%2===0)return}else{let Q=Aj($[2],"()");if(Q===-2)return;if(Q>-1){let U=($[0].indexOf("!")===0?5:4)+$[1].length+Q;$[2]=$[2].substring(0,Q),$[0]=$[0].substring(0,U).trim(),$[3]=""}}let K=$[2],X="";if(this.options.pedantic){let Q=this.rules.other.pedanticHrefTitle.exec(K);Q&&(K=Q[1],X=Q[3])}else X=$[3]?$[3].slice(1,-1):"";return K=K.trim(),this.rules.other.startAngleBracket.test(K)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(J)?K=K.slice(1):K=K.slice(1,-1)),qX($,{href:K&&K.replace(this.rules.inline.anyPunctuation,"$1"),title:X&&X.replace(this.rules.inline.anyPunctuation,"$1")},$[0],this.lexer,this.rules)}}reflink(Z,$){let J;if((J=this.rules.inline.reflink.exec(Z))||(J=this.rules.inline.nolink.exec(Z))){let K=(J[2]||J[1]).replace(this.rules.other.multipleSpaceGlobal," "),X=$[K.toLowerCase()];if(!X){let Q=J[0].charAt(0);return{type:"text",raw:Q,text:Q}}return qX(J,X,J[0],this.lexer,this.rules)}}emStrong(Z,$,J=""){let K=this.rules.inline.emStrongLDelim.exec(Z);if(!K||K[3]&&J.match(this.rules.other.unicodeAlphaNumeric))return;if(!(K[1]||K[2])||!J||this.rules.inline.punctuation.exec(J)){let X=[...K[0]].length-1,Q,U,Y=X,q=0,G=K[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(G.lastIndex=0,$=$.slice(-1*Z.length+X);(K=G.exec($))!=null;){if(Q=K[1]||K[2]||K[3]||K[4]||K[5]||K[6],!Q)continue;if(U=[...Q].length,K[3]||K[4]){Y+=U;continue}else if((K[5]||K[6])&&X%3&&!((X+U)%3)){q+=U;continue}if(Y-=U,Y>0)continue;U=Math.min(U,U+Y+q);let W=[...K[0]][0].length,j=Z.slice(0,X+K.index+W+U);if(Math.min(X,U)%2){let z=j.slice(1,-1);return{type:"em",raw:j,text:z,tokens:this.lexer.inlineTokens(z)}}let _=j.slice(2,-2);return{type:"strong",raw:j,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(Z){let $=this.rules.inline.code.exec(Z);if($){let J=$[2].replace(this.rules.other.newLineCharGlobal," "),K=this.rules.other.nonSpaceChar.test(J),X=this.rules.other.startingSpaceChar.test(J)&&this.rules.other.endingSpaceChar.test(J);return K&&X&&(J=J.substring(1,J.length-1)),{type:"codespan",raw:$[0],text:J}}}br(Z){let $=this.rules.inline.br.exec(Z);if($)return{type:"br",raw:$[0]}}del(Z){let $=this.rules.inline.del.exec(Z);if($)return{type:"del",raw:$[0],text:$[2],tokens:this.lexer.inlineTokens($[2])}}autolink(Z){let $=this.rules.inline.autolink.exec(Z);if($){let J,K;return $[2]==="@"?(J=$[1],K="mailto:"+J):(J=$[1],K=J),{type:"link",raw:$[0],text:J,href:K,tokens:[{type:"text",raw:J,text:J}]}}}url(Z){let $;if($=this.rules.inline.url.exec(Z)){let J,K;if($[2]==="@")J=$[0],K="mailto:"+J;else{let X;do X=$[0],$[0]=this.rules.inline._backpedal.exec($[0])?.[0]??"";while(X!==$[0]);J=$[0],$[1]==="www."?K="http://"+$[0]:K=$[0]}return{type:"link",raw:$[0],text:J,href:K,tokens:[{type:"text",raw:J,text:J}]}}}inlineText(Z){let $=this.rules.inline.text.exec(Z);if($){let J=this.lexer.state.inRawBlock;return{type:"text",raw:$[0],text:$[0],escaped:J}}}},F1=class Z{tokens;options;state;inlineQueue;tokenizer;constructor($){this.tokens=[],this.tokens.links=Object.create(null),this.options=$||O5,this.options.tokenizer=this.options.tokenizer||new R9,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let J={other:m0,block:N9.normal,inline:f7.normal};this.options.pedantic?(J.block=N9.pedantic,J.inline=f7.pedantic):this.options.gfm&&(J.block=N9.gfm,this.options.breaks?J.inline=f7.breaks:J.inline=f7.gfm),this.tokenizer.rules=J}static get rules(){return{block:N9,inline:f7}}static lex($,J){return new Z(J).lex($)}static lexInline($,J){return new Z(J).inlineTokens($)}lex($){$=$.replace(m0.carriageReturn,`
`),this.blockTokens($,this.tokens);for(let J=0;J<this.inlineQueue.length;J++){let K=this.inlineQueue[J];this.inlineTokens(K.src,K.tokens)}return this.inlineQueue=[],this.tokens}blockTokens($,J=[],K=!1){for(this.options.pedantic&&($=$.replace(m0.tabCharGlobal,"    ").replace(m0.spaceLine,""));$;){let X;if(this.options.extensions?.block?.some((U)=>(X=U.call({lexer:this},$,J))?($=$.substring(X.raw.length),J.push(X),!0):!1))continue;if(X=this.tokenizer.space($)){$=$.substring(X.raw.length);let U=J.at(-1);X.raw.length===1&&U!==void 0?U.raw+=`
`:J.push(X);continue}if(X=this.tokenizer.code($)){$=$.substring(X.raw.length);let U=J.at(-1);U?.type==="paragraph"||U?.type==="text"?(U.raw+=(U.raw.endsWith(`
`)?"":`
`)+X.raw,U.text+=`
`+X.text,this.inlineQueue.at(-1).src=U.text):J.push(X);continue}if(X=this.tokenizer.fences($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.heading($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.hr($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.blockquote($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.list($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.html($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.def($)){$=$.substring(X.raw.length);let U=J.at(-1);U?.type==="paragraph"||U?.type==="text"?(U.raw+=(U.raw.endsWith(`
`)?"":`
`)+X.raw,U.text+=`
`+X.raw,this.inlineQueue.at(-1).src=U.text):this.tokens.links[X.tag]||(this.tokens.links[X.tag]={href:X.href,title:X.title},J.push(X));continue}if(X=this.tokenizer.table($)){$=$.substring(X.raw.length),J.push(X);continue}if(X=this.tokenizer.lheading($)){$=$.substring(X.raw.length),J.push(X);continue}let Q=$;if(this.options.extensions?.startBlock){let U=1/0,Y=$.slice(1),q;this.options.extensions.startBlock.forEach((G)=>{q=G.call({lexer:this},Y),typeof q=="number"&&q>=0&&(U=Math.min(U,q))}),U<1/0&&U>=0&&(Q=$.substring(0,U+1))}if(this.state.top&&(X=this.tokenizer.paragraph(Q))){let U=J.at(-1);K&&U?.type==="paragraph"?(U.raw+=(U.raw.endsWith(`
`)?"":`
`)+X.raw,U.text+=`
`+X.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=U.text):J.push(X),K=Q.length!==$.length,$=$.substring(X.raw.length);continue}if(X=this.tokenizer.text($)){$=$.substring(X.raw.length);let U=J.at(-1);U?.type==="text"?(U.raw+=(U.raw.endsWith(`
`)?"":`
`)+X.raw,U.text+=`
`+X.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=U.text):J.push(X);continue}if($){let U="Infinite loop on byte: "+$.charCodeAt(0);if(this.options.silent){console.error(U);break}else throw Error(U)}}return this.state.top=!0,J}inline($,J=[]){return this.inlineQueue.push({src:$,tokens:J}),J}inlineTokens($,J=[]){let K=$,X=null;if(this.tokens.links){let q=Object.keys(this.tokens.links);if(q.length>0)for(;(X=this.tokenizer.rules.inline.reflinkSearch.exec(K))!=null;)q.includes(X[0].slice(X[0].lastIndexOf("[")+1,-1))&&(K=K.slice(0,X.index)+"["+"a".repeat(X[0].length-2)+"]"+K.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(X=this.tokenizer.rules.inline.anyPunctuation.exec(K))!=null;)K=K.slice(0,X.index)+"++"+K.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let Q;for(;(X=this.tokenizer.rules.inline.blockSkip.exec(K))!=null;)Q=X[2]?X[2].length:0,K=K.slice(0,X.index+Q)+"["+"a".repeat(X[0].length-Q-2)+"]"+K.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);K=this.options.hooks?.emStrongMask?.call({lexer:this},K)??K;let U=!1,Y="";for(;$;){U||(Y=""),U=!1;let q;if(this.options.extensions?.inline?.some((W)=>(q=W.call({lexer:this},$,J))?($=$.substring(q.raw.length),J.push(q),!0):!1))continue;if(q=this.tokenizer.escape($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.tag($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.link($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.reflink($,this.tokens.links)){$=$.substring(q.raw.length);let W=J.at(-1);q.type==="text"&&W?.type==="text"?(W.raw+=q.raw,W.text+=q.text):J.push(q);continue}if(q=this.tokenizer.emStrong($,K,Y)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.codespan($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.br($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.del($)){$=$.substring(q.raw.length),J.push(q);continue}if(q=this.tokenizer.autolink($)){$=$.substring(q.raw.length),J.push(q);continue}if(!this.state.inLink&&(q=this.tokenizer.url($))){$=$.substring(q.raw.length),J.push(q);continue}let G=$;if(this.options.extensions?.startInline){let W=1/0,j=$.slice(1),_;this.options.extensions.startInline.forEach((z)=>{_=z.call({lexer:this},j),typeof _=="number"&&_>=0&&(W=Math.min(W,_))}),W<1/0&&W>=0&&(G=$.substring(0,W+1))}if(q=this.tokenizer.inlineText(G)){$=$.substring(q.raw.length),q.raw.slice(-1)!=="_"&&(Y=q.raw.slice(-1)),U=!0;let W=J.at(-1);W?.type==="text"?(W.raw+=q.raw,W.text+=q.text):J.push(q);continue}if($){let W="Infinite loop on byte: "+$.charCodeAt(0);if(this.options.silent){console.error(W);break}else throw Error(W)}}return J}},F9=class{options;parser;constructor(Z){this.options=Z||O5}space(Z){return""}code({text:Z,lang:$,escaped:J}){let K=($||"").match(m0.notSpaceStart)?.[0],X=Z.replace(m0.endingNewline,"")+`
`;return K?'<pre><code class="language-'+w1(K)+'">'+(J?X:w1(X,!0))+`</code></pre>
`:"<pre><code>"+(J?X:w1(X,!0))+`</code></pre>
`}blockquote({tokens:Z}){return`<blockquote>
${this.parser.parse(Z)}</blockquote>
`}html({text:Z}){return Z}def(Z){return""}heading({tokens:Z,depth:$}){return`<h${$}>${this.parser.parseInline(Z)}</h${$}>
`}hr(Z){return`<hr>
`}list(Z){let{ordered:$,start:J}=Z,K="";for(let U=0;U<Z.items.length;U++){let Y=Z.items[U];K+=this.listitem(Y)}let X=$?"ol":"ul",Q=$&&J!==1?' start="'+J+'"':"";return"<"+X+Q+`>
`+K+"</"+X+`>
`}listitem(Z){return`<li>${this.parser.parse(Z.tokens)}</li>
`}checkbox({checked:Z}){return"<input "+(Z?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:Z}){return`<p>${this.parser.parseInline(Z)}</p>
`}table(Z){let $="",J="";for(let X=0;X<Z.header.length;X++)J+=this.tablecell(Z.header[X]);$+=this.tablerow({text:J});let K="";for(let X=0;X<Z.rows.length;X++){let Q=Z.rows[X];J="";for(let U=0;U<Q.length;U++)J+=this.tablecell(Q[U]);K+=this.tablerow({text:J})}return K&&(K=`<tbody>${K}</tbody>`),`<table>
<thead>
`+$+`</thead>
`+K+`</table>
`}tablerow({text:Z}){return`<tr>
${Z}</tr>
`}tablecell(Z){let $=this.parser.parseInline(Z.tokens),J=Z.header?"th":"td";return(Z.align?`<${J} align="${Z.align}">`:`<${J}>`)+$+`</${J}>
`}strong({tokens:Z}){return`<strong>${this.parser.parseInline(Z)}</strong>`}em({tokens:Z}){return`<em>${this.parser.parseInline(Z)}</em>`}codespan({text:Z}){return`<code>${w1(Z,!0)}</code>`}br(Z){return"<br>"}del({tokens:Z}){return`<del>${this.parser.parseInline(Z)}</del>`}link({href:Z,title:$,tokens:J}){let K=this.parser.parseInline(J),X=UX(Z);if(X===null)return K;Z=X;let Q='<a href="'+Z+'"';return $&&(Q+=' title="'+w1($)+'"'),Q+=">"+K+"</a>",Q}image({href:Z,title:$,text:J,tokens:K}){K&&(J=this.parser.parseInline(K,this.parser.textRenderer));let X=UX(Z);if(X===null)return w1(J);Z=X;let Q=`<img src="${Z}" alt="${J}"`;return $&&(Q+=` title="${w1($)}"`),Q+=">",Q}text(Z){return"tokens"in Z&&Z.tokens?this.parser.parseInline(Z.tokens):("escaped"in Z)&&Z.escaped?Z.text:w1(Z.text)}},Z6=class{strong({text:Z}){return Z}em({text:Z}){return Z}codespan({text:Z}){return Z}del({text:Z}){return Z}html({text:Z}){return Z}text({text:Z}){return Z}link({text:Z}){return""+Z}image({text:Z}){return""+Z}br(){return""}checkbox({raw:Z}){return Z}},D1=class Z{options;renderer;textRenderer;constructor($){this.options=$||O5,this.options.renderer=this.options.renderer||new F9,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Z6}static parse($,J){return new Z(J).parse($)}static parseInline($,J){return new Z(J).parseInline($)}parse($){let J="";for(let K=0;K<$.length;K++){let X=$[K];if(this.options.extensions?.renderers?.[X.type]){let U=X,Y=this.options.extensions.renderers[U.type].call({parser:this},U);if(Y!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(U.type)){J+=Y||"";continue}}let Q=X;switch(Q.type){case"space":{J+=this.renderer.space(Q);break}case"hr":{J+=this.renderer.hr(Q);break}case"heading":{J+=this.renderer.heading(Q);break}case"code":{J+=this.renderer.code(Q);break}case"table":{J+=this.renderer.table(Q);break}case"blockquote":{J+=this.renderer.blockquote(Q);break}case"list":{J+=this.renderer.list(Q);break}case"checkbox":{J+=this.renderer.checkbox(Q);break}case"html":{J+=this.renderer.html(Q);break}case"def":{J+=this.renderer.def(Q);break}case"paragraph":{J+=this.renderer.paragraph(Q);break}case"text":{J+=this.renderer.text(Q);break}default:{let U='Token with "'+Q.type+'" type was not found.';if(this.options.silent)return console.error(U),"";throw Error(U)}}}return J}parseInline($,J=this.renderer){let K="";for(let X=0;X<$.length;X++){let Q=$[X];if(this.options.extensions?.renderers?.[Q.type]){let Y=this.options.extensions.renderers[Q.type].call({parser:this},Q);if(Y!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Q.type)){K+=Y||"";continue}}let U=Q;switch(U.type){case"escape":{K+=J.text(U);break}case"html":{K+=J.html(U);break}case"link":{K+=J.link(U);break}case"image":{K+=J.image(U);break}case"checkbox":{K+=J.checkbox(U);break}case"strong":{K+=J.strong(U);break}case"em":{K+=J.em(U);break}case"codespan":{K+=J.codespan(U);break}case"br":{K+=J.br(U);break}case"del":{K+=J.del(U);break}case"text":{K+=J.text(U);break}default:{let Y='Token with "'+U.type+'" type was not found.';if(this.options.silent)return console.error(Y),"";throw Error(Y)}}}return K}},p7=class{options;block;constructor(Z){this.options=Z||O5}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(Z){return Z}postprocess(Z){return Z}processAllTokens(Z){return Z}emStrongMask(Z){return Z}provideLexer(){return this.block?F1.lex:F1.lexInline}provideParser(){return this.block?D1.parse:D1.parseInline}},Mj=class{defaults=sZ();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=D1;Renderer=F9;TextRenderer=Z6;Lexer=F1;Tokenizer=R9;Hooks=p7;constructor(...Z){this.use(...Z)}walkTokens(Z,$){let J=[];for(let K of Z)switch(J=J.concat($.call(this,K)),K.type){case"table":{let X=K;for(let Q of X.header)J=J.concat(this.walkTokens(Q.tokens,$));for(let Q of X.rows)for(let U of Q)J=J.concat(this.walkTokens(U.tokens,$));break}case"list":{let X=K;J=J.concat(this.walkTokens(X.items,$));break}default:{let X=K;this.defaults.extensions?.childTokens?.[X.type]?this.defaults.extensions.childTokens[X.type].forEach((Q)=>{let U=X[Q].flat(1/0);J=J.concat(this.walkTokens(U,$))}):X.tokens&&(J=J.concat(this.walkTokens(X.tokens,$)))}}return J}use(...Z){let $=this.defaults.extensions||{renderers:{},childTokens:{}};return Z.forEach((J)=>{let K={...J};if(K.async=this.defaults.async||K.async||!1,J.extensions&&(J.extensions.forEach((X)=>{if(!X.name)throw Error("extension name required");if("renderer"in X){let Q=$.renderers[X.name];Q?$.renderers[X.name]=function(...U){let Y=X.renderer.apply(this,U);return Y===!1&&(Y=Q.apply(this,U)),Y}:$.renderers[X.name]=X.renderer}if("tokenizer"in X){if(!X.level||X.level!=="block"&&X.level!=="inline")throw Error("extension level must be 'block' or 'inline'");let Q=$[X.level];Q?Q.unshift(X.tokenizer):$[X.level]=[X.tokenizer],X.start&&(X.level==="block"?$.startBlock?$.startBlock.push(X.start):$.startBlock=[X.start]:X.level==="inline"&&($.startInline?$.startInline.push(X.start):$.startInline=[X.start]))}"childTokens"in X&&X.childTokens&&($.childTokens[X.name]=X.childTokens)}),K.extensions=$),J.renderer){let X=this.defaults.renderer||new F9(this.defaults);for(let Q in J.renderer){if(!(Q in X))throw Error(`renderer '${Q}' does not exist`);if(["options","parser"].includes(Q))continue;let U=Q,Y=J.renderer[U],q=X[U];X[U]=(...G)=>{let W=Y.apply(X,G);return W===!1&&(W=q.apply(X,G)),W||""}}K.renderer=X}if(J.tokenizer){let X=this.defaults.tokenizer||new R9(this.defaults);for(let Q in J.tokenizer){if(!(Q in X))throw Error(`tokenizer '${Q}' does not exist`);if(["options","rules","lexer"].includes(Q))continue;let U=Q,Y=J.tokenizer[U],q=X[U];X[U]=(...G)=>{let W=Y.apply(X,G);return W===!1&&(W=q.apply(X,G)),W}}K.tokenizer=X}if(J.hooks){let X=this.defaults.hooks||new p7;for(let Q in J.hooks){if(!(Q in X))throw Error(`hook '${Q}' does not exist`);if(["options","block"].includes(Q))continue;let U=Q,Y=J.hooks[U],q=X[U];p7.passThroughHooks.has(Q)?X[U]=(G)=>{if(this.defaults.async&&p7.passThroughHooksRespectAsync.has(Q))return(async()=>{let j=await Y.call(X,G);return q.call(X,j)})();let W=Y.call(X,G);return q.call(X,W)}:X[U]=(...G)=>{if(this.defaults.async)return(async()=>{let j=await Y.apply(X,G);return j===!1&&(j=await q.apply(X,G)),j})();let W=Y.apply(X,G);return W===!1&&(W=q.apply(X,G)),W}}K.hooks=X}if(J.walkTokens){let X=this.defaults.walkTokens,Q=J.walkTokens;K.walkTokens=function(U){let Y=[];return Y.push(Q.call(this,U)),X&&(Y=Y.concat(X.call(this,U))),Y}}this.defaults={...this.defaults,...K}}),this}setOptions(Z){return this.defaults={...this.defaults,...Z},this}lexer(Z,$){return F1.lex(Z,$??this.defaults)}parser(Z,$){return D1.parse(Z,$??this.defaults)}parseMarkdown(Z){return($,J)=>{let K={...J},X={...this.defaults,...K},Q=this.onError(!!X.silent,!!X.async);if(this.defaults.async===!0&&K.async===!1)return Q(Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof $>"u"||$===null)return Q(Error("marked(): input parameter is undefined or null"));if(typeof $!="string")return Q(Error("marked(): input parameter is of type "+Object.prototype.toString.call($)+", string expected"));if(X.hooks&&(X.hooks.options=X,X.hooks.block=Z),X.async)return(async()=>{let U=X.hooks?await X.hooks.preprocess($):$,Y=await(X.hooks?await X.hooks.provideLexer():Z?F1.lex:F1.lexInline)(U,X),q=X.hooks?await X.hooks.processAllTokens(Y):Y;X.walkTokens&&await Promise.all(this.walkTokens(q,X.walkTokens));let G=await(X.hooks?await X.hooks.provideParser():Z?D1.parse:D1.parseInline)(q,X);return X.hooks?await X.hooks.postprocess(G):G})().catch(Q);try{X.hooks&&($=X.hooks.preprocess($));let U=(X.hooks?X.hooks.provideLexer():Z?F1.lex:F1.lexInline)($,X);X.hooks&&(U=X.hooks.processAllTokens(U)),X.walkTokens&&this.walkTokens(U,X.walkTokens);let Y=(X.hooks?X.hooks.provideParser():Z?D1.parse:D1.parseInline)(U,X);return X.hooks&&(Y=X.hooks.postprocess(Y)),Y}catch(U){return Q(U)}}}onError(Z,$){return(J)=>{if(J.message+=`
Please report this to https://github.com/markedjs/marked.`,Z){let K="<p>An error occurred:</p><pre>"+w1(J.message+"",!0)+"</pre>";return $?Promise.resolve(K):K}if($)return Promise.reject(J);throw J}}},z5=new Mj;function Z0(Z,$){return z5.parse(Z,$)}Z0.options=Z0.setOptions=function(Z){return z5.setOptions(Z),Z0.defaults=z5.defaults,GX(Z0.defaults),Z0};Z0.getDefaults=sZ;Z0.defaults=O5;Z0.use=function(...Z){return z5.use(...Z),Z0.defaults=z5.defaults,GX(Z0.defaults),Z0};Z0.walkTokens=function(Z,$){return z5.walkTokens(Z,$)};Z0.parseInline=z5.parseInline;Z0.Parser=D1;Z0.parser=D1.parse;Z0.Renderer=F9;Z0.TextRenderer=Z6;Z0.Lexer=F1;Z0.lexer=F1.lex;Z0.Tokenizer=R9;Z0.Hooks=p7;Z0.parse=Z0;var{options:hz,setOptions:vz,use:mz,walkTokens:uz,parseInline:fz}=Z0;var gz=D1.parse,pz=F1.lex;var $6={};(function Z($,J,K,X){var Q=!!($.Worker&&$.Blob&&$.Promise&&$.OffscreenCanvas&&$.OffscreenCanvasRenderingContext2D&&$.HTMLCanvasElement&&$.HTMLCanvasElement.prototype.transferControlToOffscreen&&$.URL&&$.URL.createObjectURL),U=typeof Path2D==="function"&&typeof DOMMatrix==="function",Y=function(){if(!$.OffscreenCanvas)return!1;try{var I=new OffscreenCanvas(1,1),H=I.getContext("2d");H.fillRect(0,0,1,1);var k=I.transferToImageBitmap();H.createPattern(k,"no-repeat")}catch(b){return!1}return!0}();function q(){}function G(I){var H=J.exports.Promise,k=H!==void 0?H:$.Promise;if(typeof k==="function")return new k(I);return I(q,q),null}var W=function(I,H){return{transform:function(k){if(I)return k;if(H.has(k))return H.get(k);var b=new OffscreenCanvas(k.width,k.height),m=b.getContext("2d");return m.drawImage(k,0,0),H.set(k,b),b},clear:function(){H.clear()}}}(Y,new Map),j=function(){var I=Math.floor(16.666666666666668),H,k,b={},m=0;if(typeof requestAnimationFrame==="function"&&typeof cancelAnimationFrame==="function")H=function(u){var g=Math.random();return b[g]=requestAnimationFrame(function h(n){if(m===n||m+I-1<n)m=n,delete b[g],u();else b[g]=requestAnimationFrame(h)}),g},k=function(u){if(b[u])cancelAnimationFrame(b[u])};else H=function(u){return setTimeout(u,I)},k=function(u){return clearTimeout(u)};return{frame:H,cancel:k}}(),_=function(){var I,H,k={};function b(m){function u(g,h){m.postMessage({options:g||{},callback:h})}m.init=function(h){var n=h.transferControlToOffscreen();m.postMessage({canvas:n},[n])},m.fire=function(h,n,U0){if(H)return u(h,null),H;var z0=Math.random().toString(36).slice(2);return H=G(function(q0){function O0(B0){if(B0.data.callback!==z0)return;delete k[z0],m.removeEventListener("message",O0),H=null,W.clear(),U0(),q0()}m.addEventListener("message",O0),u(h,z0),k[z0]=O0.bind(null,{data:{callback:z0}})}),H},m.reset=function(){m.postMessage({reset:!0});for(var h in k)k[h](),delete k[h]}}return function(){if(I)return I;if(!K&&Q){var m=["var CONFETTI, SIZE = {}, module = {};","("+Z.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{I=new Worker(URL.createObjectURL(new Blob([m])))}catch(u){return typeof console<"u"&&typeof console.warn==="function"&&console.warn("\uD83C\uDF8A Could not load worker",u),null}b(I)}return I}}(),z={particleCount:50,angle:90,spread:45,startVelocity:45,decay:0.9,gravity:1,drift:0,ticks:200,x:0.5,y:0.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function V(I,H){return H?H(I):I}function O(I){return!(I===null||I===void 0)}function N(I,H,k){return V(I&&O(I[H])?I[H]:z[H],k)}function R(I){return I<0?0:Math.floor(I)}function A(I,H){return Math.floor(Math.random()*(H-I))+I}function L(I){return parseInt(I,16)}function E(I){return I.map(M)}function M(I){var H=String(I).replace(/[^0-9a-f]/gi,"");if(H.length<6)H=H[0]+H[0]+H[1]+H[1]+H[2]+H[2];return{r:L(H.substring(0,2)),g:L(H.substring(2,4)),b:L(H.substring(4,6))}}function S(I){var H=N(I,"origin",Object);return H.x=N(H,"x",Number),H.y=N(H,"y",Number),H}function T(I){I.width=document.documentElement.clientWidth,I.height=document.documentElement.clientHeight}function f(I){var H=I.getBoundingClientRect();I.width=H.width,I.height=H.height}function s(I){var H=document.createElement("canvas");return H.style.position="fixed",H.style.top="0px",H.style.left="0px",H.style.pointerEvents="none",H.style.zIndex=I,H}function K0(I,H,k,b,m,u,g,h,n){I.save(),I.translate(H,k),I.rotate(u),I.scale(b,m),I.arc(0,0,1,g,h,n),I.restore()}function c(I){var H=I.angle*(Math.PI/180),k=I.spread*(Math.PI/180);return{x:I.x,y:I.y,wobble:Math.random()*10,wobbleSpeed:Math.min(0.11,Math.random()*0.1+0.05),velocity:I.startVelocity*0.5+Math.random()*I.startVelocity,angle2D:-H+(0.5*k-Math.random()*k),tiltAngle:(Math.random()*0.5+0.25)*Math.PI,color:I.color,shape:I.shape,tick:0,totalTicks:I.ticks,decay:I.decay,drift:I.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:I.gravity*3,ovalScalar:0.6,scalar:I.scalar,flat:I.flat}}function w(I,H){if(H.x+=Math.cos(H.angle2D)*H.velocity+H.drift,H.y+=Math.sin(H.angle2D)*H.velocity+H.gravity,H.velocity*=H.decay,H.flat)H.wobble=0,H.wobbleX=H.x+10*H.scalar,H.wobbleY=H.y+10*H.scalar,H.tiltSin=0,H.tiltCos=0,H.random=1;else H.wobble+=H.wobbleSpeed,H.wobbleX=H.x+10*H.scalar*Math.cos(H.wobble),H.wobbleY=H.y+10*H.scalar*Math.sin(H.wobble),H.tiltAngle+=0.1,H.tiltSin=Math.sin(H.tiltAngle),H.tiltCos=Math.cos(H.tiltAngle),H.random=Math.random()+2;var k=H.tick++/H.totalTicks,b=H.x+H.random*H.tiltCos,m=H.y+H.random*H.tiltSin,u=H.wobbleX+H.random*H.tiltCos,g=H.wobbleY+H.random*H.tiltSin;if(I.fillStyle="rgba("+H.color.r+", "+H.color.g+", "+H.color.b+", "+(1-k)+")",I.beginPath(),U&&H.shape.type==="path"&&typeof H.shape.path==="string"&&Array.isArray(H.shape.matrix))I.fill(x0(H.shape.path,H.shape.matrix,H.x,H.y,Math.abs(u-b)*0.1,Math.abs(g-m)*0.1,Math.PI/10*H.wobble));else if(H.shape.type==="bitmap"){var h=Math.PI/10*H.wobble,n=Math.abs(u-b)*0.1,U0=Math.abs(g-m)*0.1,z0=H.shape.bitmap.width*H.scalar,q0=H.shape.bitmap.height*H.scalar,O0=new DOMMatrix([Math.cos(h)*n,Math.sin(h)*n,-Math.sin(h)*U0,Math.cos(h)*U0,H.x,H.y]);O0.multiplySelf(new DOMMatrix(H.shape.matrix));var B0=I.createPattern(W.transform(H.shape.bitmap),"no-repeat");B0.setTransform(O0),I.globalAlpha=1-k,I.fillStyle=B0,I.fillRect(H.x-z0/2,H.y-q0/2,z0,q0),I.globalAlpha=1}else if(H.shape==="circle")I.ellipse?I.ellipse(H.x,H.y,Math.abs(u-b)*H.ovalScalar,Math.abs(g-m)*H.ovalScalar,Math.PI/10*H.wobble,0,2*Math.PI):K0(I,H.x,H.y,Math.abs(u-b)*H.ovalScalar,Math.abs(g-m)*H.ovalScalar,Math.PI/10*H.wobble,0,2*Math.PI);else if(H.shape==="star"){var r=Math.PI/2*3,u0=4*H.scalar,Y1=8*H.scalar,q1=H.x,y1=H.y,r1=5,A1=Math.PI/r1;while(r1--)q1=H.x+Math.cos(r)*Y1,y1=H.y+Math.sin(r)*Y1,I.lineTo(q1,y1),r+=A1,q1=H.x+Math.cos(r)*u0,y1=H.y+Math.sin(r)*u0,I.lineTo(q1,y1),r+=A1}else I.moveTo(Math.floor(H.x),Math.floor(H.y)),I.lineTo(Math.floor(H.wobbleX),Math.floor(m)),I.lineTo(Math.floor(u),Math.floor(g)),I.lineTo(Math.floor(b),Math.floor(H.wobbleY));return I.closePath(),I.fill(),H.tick<H.totalTicks}function e(I,H,k,b,m){var u=H.slice(),g=I.getContext("2d"),h,n,U0=G(function(z0){function q0(){h=n=null,g.clearRect(0,0,b.width,b.height),W.clear(),m(),z0()}function O0(){if(K&&!(b.width===X.width&&b.height===X.height))b.width=I.width=X.width,b.height=I.height=X.height;if(!b.width&&!b.height)k(I),b.width=I.width,b.height=I.height;if(g.clearRect(0,0,b.width,b.height),u=u.filter(function(B0){return w(g,B0)}),u.length)h=j.frame(O0);else q0()}h=j.frame(O0),n=q0});return{addFettis:function(z0){return u=u.concat(z0),U0},canvas:I,promise:U0,reset:function(){if(h)j.cancel(h);if(n)n()}}}function a(I,H){var k=!I,b=!!N(H||{},"resize"),m=!1,u=N(H,"disableForReducedMotion",Boolean),g=Q&&!!N(H||{},"useWorker"),h=g?_():null,n=k?T:f,U0=I&&h?!!I.__confetti_initialized:!1,z0=typeof matchMedia==="function"&&matchMedia("(prefers-reduced-motion)").matches,q0;function O0(r,u0,Y1){var q1=N(r,"particleCount",R),y1=N(r,"angle",Number),r1=N(r,"spread",Number),A1=N(r,"startVelocity",Number),MX=N(r,"decay",Number),BX=N(r,"gravity",Number),EX=N(r,"drift",Number),X6=N(r,"colors",E),PX=N(r,"ticks",Number),Q6=N(r,"shapes"),CX=N(r,"scalar"),TX=!!N(r,"flat"),U6=S(r),Y6=q1,M9=[],yX=I.width*U6.x,kX=I.height*U6.y;while(Y6--)M9.push(c({x:yX,y:kX,angle:y1,spread:r1,startVelocity:A1,color:X6[Y6%X6.length],shape:Q6[A(0,Q6.length)],ticks:PX,decay:MX,gravity:BX,drift:EX,scalar:CX,flat:TX}));if(q0)return q0.addFettis(M9);return q0=e(I,M9,n,u0,Y1),q0.promise}function B0(r){var u0=u||N(r,"disableForReducedMotion",Boolean),Y1=N(r,"zIndex",Number);if(u0&&z0)return G(function(A1){A1()});if(k&&q0)I=q0.canvas;else if(k&&!I)I=s(Y1),document.body.appendChild(I);if(b&&!U0)n(I);var q1={width:I.width,height:I.height};if(h&&!U0)h.init(I);if(U0=!0,h)I.__confetti_initialized=!0;function y1(){if(h){var A1={getBoundingClientRect:function(){if(!k)return I.getBoundingClientRect()}};n(A1),h.postMessage({resize:{width:A1.width,height:A1.height}});return}q1.width=q1.height=null}function r1(){if(q0=null,b)m=!1,$.removeEventListener("resize",y1);if(k&&I){if(document.body.contains(I))document.body.removeChild(I);I=null,U0=!1}}if(b&&!m)m=!0,$.addEventListener("resize",y1,!1);if(h)return h.fire(r,q1,r1);return O0(r,q1,r1)}return B0.reset=function(){if(h)h.reset();if(q0)q0.reset()},B0}var $0;function A0(){if(!$0)$0=a(null,{useWorker:!0,resize:!0});return $0}function x0(I,H,k,b,m,u,g){var h=new Path2D(I),n=new Path2D;n.addPath(h,new DOMMatrix(H));var U0=new Path2D;return U0.addPath(n,new DOMMatrix([Math.cos(g)*m,Math.sin(g)*m,-Math.sin(g)*u,Math.cos(g)*u,k,b])),U0}function o0(I){if(!U)throw Error("path confetti are not supported in this browser");var H,k;if(typeof I==="string")H=I;else H=I.path,k=I.matrix;var b=new Path2D(H),m=document.createElement("canvas"),u=m.getContext("2d");if(!k){var g=1000,h=g,n=g,U0=0,z0=0,q0,O0;for(var B0=0;B0<g;B0+=2)for(var r=0;r<g;r+=2)if(u.isPointInPath(b,B0,r,"nonzero"))h=Math.min(h,B0),n=Math.min(n,r),U0=Math.max(U0,B0),z0=Math.max(z0,r);q0=U0-h,O0=z0-n;var u0=10,Y1=Math.min(u0/q0,u0/O0);k=[Y1,0,0,Y1,-Math.round(q0/2+h)*Y1,-Math.round(O0/2+n)*Y1]}return{type:"path",path:H,matrix:k}}function D0(I){var H,k=1,b="#000000",m='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';if(typeof I==="string")H=I;else H=I.text,k="scalar"in I?I.scalar:k,m="fontFamily"in I?I.fontFamily:m,b="color"in I?I.color:b;var u=10*k,g=""+u+"px "+m,h=new OffscreenCanvas(u,u),n=h.getContext("2d");n.font=g;var U0=n.measureText(H),z0=Math.ceil(U0.actualBoundingBoxRight+U0.actualBoundingBoxLeft),q0=Math.ceil(U0.actualBoundingBoxAscent+U0.actualBoundingBoxDescent),O0=2,B0=U0.actualBoundingBoxLeft+O0,r=U0.actualBoundingBoxAscent+O0;z0+=O0+O0,q0+=O0+O0,h=new OffscreenCanvas(z0,q0),n=h.getContext("2d"),n.font=g,n.fillStyle=b,n.fillText(H,B0,r);var u0=1/k;return{type:"bitmap",bitmap:h.transferToImageBitmap(),matrix:[u0,0,0,u0,-z0*u0/2,-q0*u0/2]}}J.exports=function(){return A0().apply(this,arguments)},J.exports.reset=function(){A0().reset()},J.exports.create=a,J.exports.shapeFromPath=o0,J.exports.shapeFromText=D0})(function(){if(typeof window<"u")return window;if(typeof self<"u")return self;return this||{}}(),$6,!1);var FX=$6.exports,az=$6.exports.create;var DX={CHECK:`<svg xmlns="http://www.w3.org/2000/svg"
    width="14" height="14" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"
    class="text-green-500">
    <polyline points="20 6 9 17 4 12"></polyline></svg>`};var J6=document.getElementById("ex-desc"),Bj=document.getElementById("sidebar-list"),s7=document.getElementById("run-btn"),d0=document.getElementById("status"),n5=document.getElementById("console-output"),AX=document.getElementById("sidebar-toggle"),c7=document.getElementById("sidebar-nav"),i5=document.getElementById("tab-problem"),a5=document.getElementById("tab-code"),L9=document.getElementById("code-pane");function LX(Z){if(Z==="problem")J6.classList.remove("hidden"),L9.classList.add("hidden"),L9.classList.remove("flex"),i5.classList.add("text-white","border-brand-500"),i5.classList.remove("text-slate-500","border-transparent"),a5.classList.add("text-slate-500","border-transparent"),a5.classList.remove("text-white","border-brand-500");else J6.classList.add("hidden"),L9.classList.remove("hidden"),L9.classList.add("flex"),a5.classList.add("text-white","border-brand-500"),a5.classList.remove("text-slate-500","border-transparent"),i5.classList.add("text-slate-500","border-transparent"),i5.classList.remove("text-white","border-brand-500")}if(i5&&a5)i5.addEventListener("click",()=>LX("problem")),a5.addEventListener("click",()=>LX("code"));var Ej={code({text:Z,lang:$}){return`<div class="cm-static-code mb-4" data-lang="${$||""}">${Z}</div>`}};Z0.use({renderer:Ej});var Pj=(Z)=>{return Z0.parse(Z)};function Cj(){document.querySelectorAll(".cm-static-code").forEach(($)=>{let J=$.textContent||"",K=$.getAttribute("data-lang");$.textContent="",new B({state:p.create({doc:J,extensions:[p.readOnly.of(!0),B.editable.of(!1),H9,K==="ocaml"||!K?v5.define(O9):[],B.lineWrapping,B.theme({"&":{borderRadius:"4px",overflow:"hidden"},".cm-scroller":{overflow:"visible"}})]}),parent:$})})}function K6(){let{currentExerciseId:Z,completedIds:$}=o1.getState(),J=h1.find((X)=>X.id===Z);if(!J)return;let K=`<h1 class="text-3xl font-bold mb-6 text-white">${J.id} ${J.title}</h1>`;J6.innerHTML=K+`<div class="markdown-body">${Pj(J.description)}</div>`,Cj(),Bj.innerHTML=h1.map((X)=>{let Q=$.includes(X.id);return`<div class="nav-item cursor-pointer p-3 text-sm flex justify-between items-center transition-colors ${X.id===Z?"bg-slate-800 text-white border-l-2 border-yellow-500":"text-slate-400 hover:text-slate-300"} ${Q?"opacity-40":""}"
                    onclick="location.hash='#${X.id}'">
                  <span>${X.id} ${X.title}</span>
                  ${Q?DX.CHECK:""}
                </div>`}).join(""),ZX(J.initialCode),n5.textContent="// Ready..."}async function Tj(){if(!lZ()){alert("Compiler is still loading... please wait.");return}let{currentExerciseId:Z}=o1.getState(),$=h1.find((K)=>K.id===Z);if(!$)return;d0.textContent="Running...",d0.className="text-yellow-500 text-xs font-mono animate-pulse",s7.disabled=!0,n5.textContent="";let J="";try{let K=$X(),X=K+`
`+($.testCode||""),Q=await JX(X);if(!Q.success){d0.textContent="FAILED",d0.className="text-red-500 font-bold text-xs",n5.textContent=Q.err||"Compilation/Runtime Error";return}if(J=Q.out,n5.textContent=J,J.includes("Test failed")||J.includes("Failure")){d0.textContent="FAILED",d0.className="text-red-500 font-bold text-xs";return}let U=$.validate(K,Q.out);if(U!==!0){d0.textContent="FAILED",d0.className="text-red-500 font-bold text-xs",n5.textContent+=`

${U}`;return}d0.textContent="PASSED",d0.className="text-green-500 font-bold text-xs",o1.getState().markComplete($.id),FX({particleCount:100,spread:70,origin:{y:0.6}}),K6()}catch(K){d0.textContent="ERROR",d0.className="text-red-600 font-bold text-xs",n5.textContent="Runtime Error: "+K.message}finally{s7.disabled=!1}}function yj(){let Z=setInterval(()=>{if(lZ())clearInterval(Z),d0.textContent="Compiler Ready",d0.className="text-green-600 text-xs font-mono",s7.classList.remove("opacity-50","cursor-not-allowed"),s7.disabled=!1},500)}o1.subscribe(K6);s7.addEventListener("click",Tj);if(AX&&c7)AX.addEventListener("click",()=>{c7.classList.toggle("hidden"),c7.classList.toggle("flex"),c7.classList.toggle("lg:hidden"),c7.classList.toggle("lg:flex")});window.addEventListener("hashchange",()=>{let Z=window.location.hash.slice(1);if(h1.find(($)=>$.id===Z))o1.getState().setCurrent(Z)});yj();var kj=window.location.hash.slice(1)||h1[0].id;o1.getState().setCurrent(kj);K6();
