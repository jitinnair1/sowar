<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Sowar | OCaml exercises</title>

  <!--//fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=JetBrains+Mono&display=swap"
    rel="stylesheet">

  <!--//css post tailwind -->
  <link rel="stylesheet" href="./style.css">

  <!--//KaTeX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    xintegrity="sha384-n8MVd4RsNIU0KOVEMeaYGTAnNKSCpI/8SRouQsMYDHX4GkAeNfG5tyJwv/WnVOCS" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
    xintegrity="sha384-XjKyOOlVwcjNWFMgZHwExtensionsQ7MTCVYTffsRjKaOOgbaJPfnKjWjiV0KIl3BORwf"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    xintegrity="sha384-+VBxd3r6XgURPiLLnucSUEQGzNMNjEBW3OrK5OKvDir/iQIY5CAncwYqtU3fSFEGD"
    crossorigin="anonymous"></script>

  <!--//favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
  <link rel="manifest" href="./favicon/site.webmanifest">

  <!-- toplevel from src/compiler -->
  <script src="./sowar_toplevel.bc.js"></script>

</head>

<body class="bg-bg-app text-fg-primary h-dvh flex flex-col overflow-hidden font-sans selection:bg-brand/30">

  <!-- site header -->
  <header
    class="h-14 border-b border-border-default bg-bg-surface flex items-center justify-between px-6 z-10 shrink-0">
    <div class="flex items-center gap-3">

      <div class="text-xl opacity-80" id="header-logo">üê™</div>
      <div>
        <h1 id="header-title" class="font-bold text-fg-primary tracking-tight text-lg leading-tight">sowar</h1>
        <p id="header-subtitle" class="text-[10px] text-fg-muted font-mono uppercase tracking-wider leading-none">OCaml
          Exercises
        </p>
      </div>
    </div>
  </header>

  <!-- page layout -->
  <div class="flex-1 flex flex-col overflow-hidden relative">

    <!-- navigation -->
    <nav class="flex h-12 border-b border-border-default bg-bg-surface items-center px-4 shrink-0">
      <!-- left section -->
      <div class="flex items-center gap-4">
        <button id="sidebar-toggle" class="text-fg-muted hover:text-fg-primary transition-colors"
          title="Toggle Sidebar">
          <!-- icon here -->
        </button>
      </div>

      <!-- center: progress bar -->
      <div class="hidden md:flex flex-1 max-w-md mx-auto justify-center" id="progress-container">
        <!-- progress content -->
      </div>

      <!-- spacer for mobile -->
      <div class="flex-1 md:hidden"></div>

      <!-- right section -->
      <div class="relative flex items-center gap-4 pl-4 border-l border-border-default">
        <!-- status -->
        <div class="absolute right-full mr-6 flex items-center gap-1 whitespace-nowrap">
          <div id="status-dot" class="w-2 h-2 rounded-full bg-fg-muted animate-pulse"></div>
          <span id="status" class="text-xs font-mono text-fg-muted text-right max-w-24 md:max-w-40 truncate">
            Loading ...
          </span>
        </div>

        <!-- nav controls -->
        <div class="flex items-center gap-1">
          <button id="nav-prev"
            class="p-1.5 hover:bg-bg-app rounded text-fg-muted hover:text-fg-primary transition-colors disabled:opacity-30"
            title="Previous">
          </button>
          <button id="nav-next"
            class="p-1.5 hover:bg-bg-app rounded text-fg-muted hover:text-fg-primary transition-colors disabled:opacity-30"
            title="Next">
          </button>
        </div>

        <button id="shortcuts-btn"
          class="hidden md:block p-1.5 text-fg-muted hover:text-fg-primary hover:bg-bg-app rounded transition-colors"
          title="Keyboard Shortcuts">
        </button>

        <button id="run-btn"
          class="bg-brand hover:opacity-90 text-white pl-3 pr-4 py-1.5 rounded text-sm font-semibold transition-opacity flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
          disabled>
          <svg fill="currentColor" width="16" height="16" viewBox="0 0 24 24">
            <path
              d="M18.54,9,8.88,3.46a3.42,3.42,0,0,0-5.13,3V17.58A3.42,3.42,0,0,0,7.17,21a3.43,3.43,0,0,0,1.71-.46L18.54,15a3.42,3.42,0,0,0,0-5.92Zm-1,4.19L7.88,18.81a1.44,1.44,0,0,1-1.42,0,1.42,1.42,0,0,1-.71-1.23V6.42a1.42,1.42,0,0,1,.71-1.23A1.51,1.51,0,0,1,7.17,5a1.54,1.54,0,0,1,.71.19l9.66,5.58a1.42,1.42,0,0,1,0,2.46Z" />
          </svg>
          <span>Run</span>
        </button>
      </div>
    </nav>


    <!-- mobile only tab bar -->
    <div class="flex md:hidden border-b border-border-default bg-bg-surface shrink-0">
      <button id="tab-problem"
        class="flex-1 py-2 text-xs font-bold text-fg-primary border-b-2 border-brand transition-colors">
        Problem
      </button>
      <button id="tab-code"
        class="flex-1 py-2 text-xs font-bold text-fg-muted hover:text-fg-primary transition-colors border-b-2 border-transparent">
        Code
      </button>
    </div>

    <!-- main panes -->
    <div class="flex-1 flex flex-col md:flex-row overflow-hidden relative">

      <!-- sidebar -->
      <nav id="sidebar-nav"
        class="absolute inset-y-0 left-0 z-50 w-64 bg-bg-surface border-r border-border-default hidden flex-col transition-all duration-300 shadow-xl lg:static lg:flex lg:shadow-none">
        <div
          class="h-10 px-4 flex justify-between items-center border-b border-border-default select-none shrink-0 bg-bg-surface order-first md:order-0">
          <span class="text-[10px] font-bold text-fg-muted uppercase tracking-wider">Exercises</span>
          <span id="app-version" class="text-[10px] text-fg-muted bg-bg-app px-1.5 py-0.5 rounded">v0.1</span>
        </div>
        <div id="sidebar-list" class="flex-1 overflow-y-auto p-2 space-y-1">
        </div>
      </nav>

      <!-- problem description (desktop) -->
      <div id="ex-desc-desktop" class="hidden md:block order-1 md:order-0 w-full h-full md:w-1/2 lg:w-5/12 bg-bg-surface border-r
                 border-border-default overflow-y-auto relative p-8 pb-32 prose prose-invert prose-sm max-w-none">
      </div>

      <!-- horizontal resize handle -->
      <div id="drag-h-desktop"
        class="hidden md:block w-0.5 bg-border-default hover:bg-brand cursor-col-resize z-10 transition-colors select-none">
      </div>

      <!-- problem description (mobile) -->
      <div id="ex-desc-mobile"
        class="md:hidden order-1 w-full h-full bg-bg-surface p-8 overflow-y-auto prose prose-invert prose-sm max-w-none">
      </div>

      <!-- editor + console panel -->
      <div id="editor-and-console-panel"
        class="hidden md:flex flex-col order-2 md:order-0 w-full h-full md:flex-1 md:h-auto bg-bg-app min-h-0 min-w-0">

        <!-- editor -->
        <div class="flex flex-col h-[60%] md:h-auto md:flex-1 relative min-h-0">
          <div
            class="h-10 px-4 bg-bg-surface text-[10px] uppercase font-bold text-fg-muted tracking-wider flex items-center justify-between select-none border-b border-border-default shrink-0">
            <span>Editor</span>
            <button id="reset-btn" class="hover:cursor-pointer" title="Reset">
            </button>
          </div>

          <div class="flex-1 relative min-h-0" id="editor-wrapper">
            <div id="editor" class="w-full h-full outline-none"></div>
          </div>
        </div>

        <!-- vertical resize handle -->
        <div id="drag-v-console"
          class="hidden md:block h-0.5 bg-border-default hover:bg-brand cursor-row-resize z-10 transition-colors select-none">
        </div>

        <!-- console -->
        <div id="pane-console"
          class="h-[40%] md:h-48 bg-bg-app border-t border-border-default flex flex-col shrink-0 min-h-0">
          <div
            class="h-10 px-4 bg-bg-surface text-[10px] font-bold text-fg-muted uppercase tracking-wider flex items-center justify-between select-none border-b border-border-default">
            <span>Console</span>
            <button id="clear-console-btn" class="hover:cursor-pointer" title="Clear Console">
            </button>
          </div>
          <div id="console-output"
            class="flex-1 p-4 font-mono text-xs overflow-auto text-fg-primary whitespace-pre-wrap selection:bg-bg-surface">
          </div>
        </div>
      </div>
    </div>

    <!-- footer -->
    <footer id="footer" class="flex items-center justify-center px-6 py-4 border-t border-border-default bg-bg-surface">
    </footer>

    <!-- shortcuts modal -->
    <div id="shortcuts-modal"
      class="hidden fixed inset-0 z-100 items-center justify-center bg-black/50 backdrop-blur-sm p-4">
      <div
        class="bg-bg-surface border border-border-default rounded-xl shadow-2xl p-6 w-full max-w-2xl relative flex flex-col gap-4">
        <div class="flex items-center justify-between">
          <h2 class="text-lg font-bold text-fg-primary">Keyboard Shortcuts</h2>
          <button id="close-shortcuts-btn"
            class="text-fg-muted hover:text-fg-primary transition-colors p-1 rounded-md hover:bg-bg-app">
            <!-- close icon injected via js -->
          </button>
        </div>
        <div id="shortcuts-list" class="space-y-3">
          <!-- content injected via js -->
        </div>
      </div>
    </div>

    <!-- main app script -->
    <script type="module" src="./main.js"></script>
</body>

</html>